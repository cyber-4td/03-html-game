window.__require=function t(e,a,i){function o(r,s){if(!a[r]){if(!e[r]){var c=r.split("/");if(c=c[c.length-1],!e[c]){var l="function"==typeof __require&&__require;if(!s&&l)return l(c,!0);if(n)return n(c,!0);throw new Error("Cannot find module '"+r+"'")}r=c}var u=a[r]={exports:{}};e[r][0].call(u.exports,function(t){return o(e[r][1][t]||t)},u,u.exports,t,e,a,i)}return a[r].exports}for(var n="function"==typeof __require&&__require,r=0;r<i.length;r++)o(i[r]);return o}({1:[function(t,e,a){"use strict";a.byteLength=function(t){var e=l(t),a=e[0],i=e[1];return 3*(a+i)/4-i},a.toByteArray=function(t){var e,a,i=l(t),r=i[0],s=i[1],c=new n(u(0,r,s)),p=0,h=s>0?r-4:r;for(a=0;a<h;a+=4)e=o[t.charCodeAt(a)]<<18|o[t.charCodeAt(a+1)]<<12|o[t.charCodeAt(a+2)]<<6|o[t.charCodeAt(a+3)],c[p++]=e>>16&255,c[p++]=e>>8&255,c[p++]=255&e;return 2===s&&(e=o[t.charCodeAt(a)]<<2|o[t.charCodeAt(a+1)]>>4,c[p++]=255&e),1===s&&(e=o[t.charCodeAt(a)]<<10|o[t.charCodeAt(a+1)]<<4|o[t.charCodeAt(a+2)]>>2,c[p++]=e>>8&255,c[p++]=255&e),c},a.fromByteArray=function(t){for(var e,a=t.length,o=a%3,n=[],r=0,s=a-o;r<s;r+=16383)n.push(p(t,r,r+16383>s?s:r+16383));return 1===o?(e=t[a-1],n.push(i[e>>2]+i[e<<4&63]+"==")):2===o&&(e=(t[a-2]<<8)+t[a-1],n.push(i[e>>10]+i[e>>4&63]+i[e<<2&63]+"=")),n.join("")};for(var i=[],o=[],n="undefined"!=typeof Uint8Array?Uint8Array:Array,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,c=r.length;s<c;++s)i[s]=r[s],o[r.charCodeAt(s)]=s;function l(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var a=t.indexOf("=");return-1===a&&(a=e),[a,a===e?0:4-a%4]}function u(t,e,a){return 3*(e+a)/4-a}function p(t,e,a){for(var o,n,r=[],s=e;s<a;s+=3)o=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(255&t[s+2]),r.push(i[(n=o)>>18&63]+i[n>>12&63]+i[n>>6&63]+i[63&n]);return r.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},{}],2:[function(t,e,a){(function(e){"use strict";var i=t("base64-js"),o=t("ieee754"),n=t("isarray");function r(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(t,e){if(r()<e)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=c.prototype:(null===t&&(t=new c(e)),t.length=e),t}function c(t,e,a){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(t,e,a);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return h(this,t)}return l(this,t,e,a)}function l(t,e,a,i){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?f(t,e,a,i):"string"==typeof e?d(t,e,a):_(t,e)}function u(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function p(t,e,a,i){return u(e),e<=0?s(t,e):void 0!==a?"string"==typeof i?s(t,e).fill(a,i):s(t,e).fill(a):s(t,e)}function h(t,e){if(u(e),t=s(t,e<0?0:0|y(e)),!c.TYPED_ARRAY_SUPPORT)for(var a=0;a<e;++a)t[a]=0;return t}function d(t,e,a){if("string"==typeof a&&""!==a||(a="utf8"),!c.isEncoding(a))throw new TypeError('"encoding" must be a valid string encoding');var i=0|g(e,a),o=(t=s(t,i)).write(e,a);return o!==i&&(t=t.slice(0,o)),t}function m(t,e){var a=e.length<0?0:0|y(e.length);t=s(t,a);for(var i=0;i<a;i+=1)t[i]=255&e[i];return t}function f(t,e,a,i){if(e.byteLength,a<0||e.byteLength<a)throw new RangeError("'offset' is out of bounds");if(e.byteLength<a+(i||0))throw new RangeError("'length' is out of bounds");return e=void 0===a&&void 0===i?new Uint8Array(e):void 0===i?new Uint8Array(e,a):new Uint8Array(e,a,i),c.TYPED_ARRAY_SUPPORT?(t=e).__proto__=c.prototype:t=m(t,e),t}function _(t,e){if(c.isBuffer(e)){var a=0|y(e.length);return 0===(t=s(t,a)).length?t:(e.copy(t,0,0,a),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(i=e.length)!=i?s(t,0):m(t,e);if("Buffer"===e.type&&n(e.data))return m(t,e.data)}var i;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function y(t){if(t>=r())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r().toString(16)+" bytes");return 0|t}function g(t,e){if(c.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var a=t.length;if(0===a)return 0;for(var i=!1;;)switch(e){case"ascii":case"latin1":case"binary":return a;case"utf8":case"utf-8":case void 0:return Y(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*a;case"hex":return a>>>1;case"base64":return Z(t).length;default:if(i)return Y(t).length;e=(""+e).toLowerCase(),i=!0}}function v(t,e,a){var i=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===a||a>this.length)&&(a=this.length),a<=0)return"";if((a>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return k(this,e,a);case"utf8":case"utf-8":return N(this,e,a);case"ascii":return I(this,e,a);case"latin1":case"binary":return w(this,e,a);case"base64":return M(this,e,a);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return F(this,e,a);default:if(i)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),i=!0}}function P(t,e,a){var i=t[e];t[e]=t[a],t[a]=i}function b(t,e,a,i,o){if(0===t.length)return-1;if("string"==typeof a?(i=a,a=0):a>2147483647?a=2147483647:a<-2147483648&&(a=-2147483648),a=+a,isNaN(a)&&(a=o?0:t.length-1),a<0&&(a=t.length+a),a>=t.length){if(o)return-1;a=t.length-1}else if(a<0){if(!o)return-1;a=0}if("string"==typeof e&&(e=c.from(e,i)),c.isBuffer(e))return 0===e.length?-1:D(t,e,a,i,o);if("number"==typeof e)return e&=255,c.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(t,e,a):Uint8Array.prototype.lastIndexOf.call(t,e,a):D(t,[e],a,i,o);throw new TypeError("val must be string, number or Buffer")}function D(t,e,a,i,o){var n,r=1,s=t.length,c=e.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(t.length<2||e.length<2)return-1;r=2,s/=2,c/=2,a/=2}function l(t,e){return 1===r?t[e]:t.readUInt16BE(e*r)}if(o){var u=-1;for(n=a;n<s;n++)if(l(t,n)===l(e,-1===u?0:n-u)){if(-1===u&&(u=n),n-u+1===c)return u*r}else-1!==u&&(n-=n-u),u=-1}else for(a+c>s&&(a=s-c),n=a;n>=0;n--){for(var p=!0,h=0;h<c;h++)if(l(t,n+h)!==l(e,h)){p=!1;break}if(p)return n}return-1}function S(t,e,a,i){a=Number(a)||0;var o=t.length-a;i?(i=Number(i))>o&&(i=o):i=o;var n=e.length;if(n%2!=0)throw new TypeError("Invalid hex string");i>n/2&&(i=n/2);for(var r=0;r<i;++r){var s=parseInt(e.substr(2*r,2),16);if(isNaN(s))return r;t[a+r]=s}return r}function C(t,e,a,i){return X(Y(e,t.length-a),t,a,i)}function E(t,e,a,i){return X(J(e),t,a,i)}function B(t,e,a,i){return E(t,e,a,i)}function A(t,e,a,i){return X(Z(e),t,a,i)}function x(t,e,a,i){return X(K(e,t.length-a),t,a,i)}function M(t,e,a){return 0===e&&a===t.length?i.fromByteArray(t):i.fromByteArray(t.slice(e,a))}function N(t,e,a){a=Math.min(t.length,a);for(var i=[],o=e;o<a;){var n,r,s,c,l=t[o],u=null,p=l>239?4:l>223?3:l>191?2:1;if(o+p<=a)switch(p){case 1:l<128&&(u=l);break;case 2:128==(192&(n=t[o+1]))&&(c=(31&l)<<6|63&n)>127&&(u=c);break;case 3:n=t[o+1],r=t[o+2],128==(192&n)&&128==(192&r)&&(c=(15&l)<<12|(63&n)<<6|63&r)>2047&&(c<55296||c>57343)&&(u=c);break;case 4:n=t[o+1],r=t[o+2],s=t[o+3],128==(192&n)&&128==(192&r)&&128==(192&s)&&(c=(15&l)<<18|(63&n)<<12|(63&r)<<6|63&s)>65535&&c<1114112&&(u=c)}null===u?(u=65533,p=1):u>65535&&(u-=65536,i.push(u>>>10&1023|55296),u=56320|1023&u),i.push(u),o+=p}return T(i)}a.Buffer=c,a.SlowBuffer=function(t){return+t!=t&&(t=0),c.alloc(+t)},a.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(e){return!1}}(),a.kMaxLength=r(),c.poolSize=8192,c._augment=function(t){return t.__proto__=c.prototype,t},c.from=function(t,e,a){return l(null,t,e,a)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(t,e,a){return p(null,t,e,a)},c.allocUnsafe=function(t){return h(null,t)},c.allocUnsafeSlow=function(t){return h(null,t)},c.isBuffer=function(t){return!(null==t||!t._isBuffer)},c.compare=function(t,e){if(!c.isBuffer(t)||!c.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var a=t.length,i=e.length,o=0,n=Math.min(a,i);o<n;++o)if(t[o]!==e[o]){a=t[o],i=e[o];break}return a<i?-1:i<a?1:0},c.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(t,e){if(!n(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return c.alloc(0);var a;if(void 0===e)for(e=0,a=0;a<t.length;++a)e+=t[a].length;var i=c.allocUnsafe(e),o=0;for(a=0;a<t.length;++a){var r=t[a];if(!c.isBuffer(r))throw new TypeError('"list" argument must be an Array of Buffers');r.copy(i,o),o+=r.length}return i},c.byteLength=g,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)P(this,e,e+1);return this},c.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)P(this,e,e+3),P(this,e+1,e+2);return this},c.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)P(this,e,e+7),P(this,e+1,e+6),P(this,e+2,e+5),P(this,e+3,e+4);return this},c.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?N(this,0,t):v.apply(this,arguments)},c.prototype.equals=function(t){if(!c.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===c.compare(this,t)},c.prototype.inspect=function(){var t="",e=a.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,e).match(/.{2}/g).join(" "),this.length>e&&(t+=" ... ")),"<Buffer "+t+">"},c.prototype.compare=function(t,e,a,i,o){if(!c.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===a&&(a=t?t.length:0),void 0===i&&(i=0),void 0===o&&(o=this.length),e<0||a>t.length||i<0||o>this.length)throw new RangeError("out of range index");if(i>=o&&e>=a)return 0;if(i>=o)return-1;if(e>=a)return 1;if(this===t)return 0;for(var n=(o>>>=0)-(i>>>=0),r=(a>>>=0)-(e>>>=0),s=Math.min(n,r),l=this.slice(i,o),u=t.slice(e,a),p=0;p<s;++p)if(l[p]!==u[p]){n=l[p],r=u[p];break}return n<r?-1:r<n?1:0},c.prototype.includes=function(t,e,a){return-1!==this.indexOf(t,e,a)},c.prototype.indexOf=function(t,e,a){return b(this,t,e,a,!0)},c.prototype.lastIndexOf=function(t,e,a){return b(this,t,e,a,!1)},c.prototype.write=function(t,e,a,i){if(void 0===e)i="utf8",a=this.length,e=0;else if(void 0===a&&"string"==typeof e)i=e,a=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(a)?(a|=0,void 0===i&&(i="utf8")):(i=a,a=void 0)}var o=this.length-e;if((void 0===a||a>o)&&(a=o),t.length>0&&(a<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var n=!1;;)switch(i){case"hex":return S(this,t,e,a);case"utf8":case"utf-8":return C(this,t,e,a);case"ascii":return E(this,t,e,a);case"latin1":case"binary":return B(this,t,e,a);case"base64":return A(this,t,e,a);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,t,e,a);default:if(n)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),n=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var R=4096;function T(t){var e=t.length;if(e<=R)return String.fromCharCode.apply(String,t);for(var a="",i=0;i<e;)a+=String.fromCharCode.apply(String,t.slice(i,i+=R));return a}function I(t,e,a){var i="";a=Math.min(t.length,a);for(var o=e;o<a;++o)i+=String.fromCharCode(127&t[o]);return i}function w(t,e,a){var i="";a=Math.min(t.length,a);for(var o=e;o<a;++o)i+=String.fromCharCode(t[o]);return i}function k(t,e,a){var i,o=t.length;(!e||e<0)&&(e=0),(!a||a<0||a>o)&&(a=o);for(var n="",r=e;r<a;++r)n+=(i=t[r])<16?"0"+i.toString(16):i.toString(16);return n}function F(t,e,a){for(var i=t.slice(e,a),o="",n=0;n<i.length;n+=2)o+=String.fromCharCode(i[n]+256*i[n+1]);return o}function L(t,e,a){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>a)throw new RangeError("Trying to access beyond buffer length")}function O(t,e,a,i,o,n){if(!c.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>o||e<n)throw new RangeError('"value" argument is out of bounds');if(a+i>t.length)throw new RangeError("Index out of range")}function U(t,e,a,i){e<0&&(e=65535+e+1);for(var o=0,n=Math.min(t.length-a,2);o<n;++o)t[a+o]=(e&255<<8*(i?o:1-o))>>>8*(i?o:1-o)}function G(t,e,a,i){e<0&&(e=4294967295+e+1);for(var o=0,n=Math.min(t.length-a,4);o<n;++o)t[a+o]=e>>>8*(i?o:3-o)&255}function V(t,e,a,i){if(a+i>t.length)throw new RangeError("Index out of range");if(a<0)throw new RangeError("Index out of range")}function H(t,e,a,i,n){return n||V(t,0,a,4),o.write(t,e,a,i,23,4),a+4}function W(t,e,a,i,n){return n||V(t,0,a,8),o.write(t,e,a,i,52,8),a+8}c.prototype.slice=function(t,e){var a,i=this.length;if((t=~~t)<0?(t+=i)<0&&(t=0):t>i&&(t=i),(e=void 0===e?i:~~e)<0?(e+=i)<0&&(e=0):e>i&&(e=i),e<t&&(e=t),c.TYPED_ARRAY_SUPPORT)(a=this.subarray(t,e)).__proto__=c.prototype;else{var o=e-t;a=new c(o,void 0);for(var n=0;n<o;++n)a[n]=this[n+t]}return a},c.prototype.readUIntLE=function(t,e,a){t|=0,e|=0,a||L(t,e,this.length);for(var i=this[t],o=1,n=0;++n<e&&(o*=256);)i+=this[t+n]*o;return i},c.prototype.readUIntBE=function(t,e,a){t|=0,e|=0,a||L(t,e,this.length);for(var i=this[t+--e],o=1;e>0&&(o*=256);)i+=this[t+--e]*o;return i},c.prototype.readUInt8=function(t,e){return e||L(t,1,this.length),this[t]},c.prototype.readUInt16LE=function(t,e){return e||L(t,2,this.length),this[t]|this[t+1]<<8},c.prototype.readUInt16BE=function(t,e){return e||L(t,2,this.length),this[t]<<8|this[t+1]},c.prototype.readUInt32LE=function(t,e){return e||L(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},c.prototype.readUInt32BE=function(t,e){return e||L(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},c.prototype.readIntLE=function(t,e,a){t|=0,e|=0,a||L(t,e,this.length);for(var i=this[t],o=1,n=0;++n<e&&(o*=256);)i+=this[t+n]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*e)),i},c.prototype.readIntBE=function(t,e,a){t|=0,e|=0,a||L(t,e,this.length);for(var i=e,o=1,n=this[t+--i];i>0&&(o*=256);)n+=this[t+--i]*o;return n>=(o*=128)&&(n-=Math.pow(2,8*e)),n},c.prototype.readInt8=function(t,e){return e||L(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},c.prototype.readInt16LE=function(t,e){e||L(t,2,this.length);var a=this[t]|this[t+1]<<8;return 32768&a?4294901760|a:a},c.prototype.readInt16BE=function(t,e){e||L(t,2,this.length);var a=this[t+1]|this[t]<<8;return 32768&a?4294901760|a:a},c.prototype.readInt32LE=function(t,e){return e||L(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},c.prototype.readInt32BE=function(t,e){return e||L(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},c.prototype.readFloatLE=function(t,e){return e||L(t,4,this.length),o.read(this,t,!0,23,4)},c.prototype.readFloatBE=function(t,e){return e||L(t,4,this.length),o.read(this,t,!1,23,4)},c.prototype.readDoubleLE=function(t,e){return e||L(t,8,this.length),o.read(this,t,!0,52,8)},c.prototype.readDoubleBE=function(t,e){return e||L(t,8,this.length),o.read(this,t,!1,52,8)},c.prototype.writeUIntLE=function(t,e,a,i){t=+t,e|=0,a|=0,i||O(this,t,e,a,Math.pow(2,8*a)-1,0);var o=1,n=0;for(this[e]=255&t;++n<a&&(o*=256);)this[e+n]=t/o&255;return e+a},c.prototype.writeUIntBE=function(t,e,a,i){t=+t,e|=0,a|=0,i||O(this,t,e,a,Math.pow(2,8*a)-1,0);var o=a-1,n=1;for(this[e+o]=255&t;--o>=0&&(n*=256);)this[e+o]=t/n&255;return e+a},c.prototype.writeUInt8=function(t,e,a){return t=+t,e|=0,a||O(this,t,e,1,255,0),c.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},c.prototype.writeUInt16LE=function(t,e,a){return t=+t,e|=0,a||O(this,t,e,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):U(this,t,e,!0),e+2},c.prototype.writeUInt16BE=function(t,e,a){return t=+t,e|=0,a||O(this,t,e,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):U(this,t,e,!1),e+2},c.prototype.writeUInt32LE=function(t,e,a){return t=+t,e|=0,a||O(this,t,e,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):G(this,t,e,!0),e+4},c.prototype.writeUInt32BE=function(t,e,a){return t=+t,e|=0,a||O(this,t,e,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):G(this,t,e,!1),e+4},c.prototype.writeIntLE=function(t,e,a,i){if(t=+t,e|=0,!i){var o=Math.pow(2,8*a-1);O(this,t,e,a,o-1,-o)}var n=0,r=1,s=0;for(this[e]=255&t;++n<a&&(r*=256);)t<0&&0===s&&0!==this[e+n-1]&&(s=1),this[e+n]=(t/r>>0)-s&255;return e+a},c.prototype.writeIntBE=function(t,e,a,i){if(t=+t,e|=0,!i){var o=Math.pow(2,8*a-1);O(this,t,e,a,o-1,-o)}var n=a-1,r=1,s=0;for(this[e+n]=255&t;--n>=0&&(r*=256);)t<0&&0===s&&0!==this[e+n+1]&&(s=1),this[e+n]=(t/r>>0)-s&255;return e+a},c.prototype.writeInt8=function(t,e,a){return t=+t,e|=0,a||O(this,t,e,1,127,-128),c.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},c.prototype.writeInt16LE=function(t,e,a){return t=+t,e|=0,a||O(this,t,e,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):U(this,t,e,!0),e+2},c.prototype.writeInt16BE=function(t,e,a){return t=+t,e|=0,a||O(this,t,e,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):U(this,t,e,!1),e+2},c.prototype.writeInt32LE=function(t,e,a){return t=+t,e|=0,a||O(this,t,e,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):G(this,t,e,!0),e+4},c.prototype.writeInt32BE=function(t,e,a){return t=+t,e|=0,a||O(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):G(this,t,e,!1),e+4},c.prototype.writeFloatLE=function(t,e,a){return H(this,t,e,!0,a)},c.prototype.writeFloatBE=function(t,e,a){return H(this,t,e,!1,a)},c.prototype.writeDoubleLE=function(t,e,a){return W(this,t,e,!0,a)},c.prototype.writeDoubleBE=function(t,e,a){return W(this,t,e,!1,a)},c.prototype.copy=function(t,e,a,i){if(a||(a=0),i||0===i||(i=this.length),e>=t.length&&(e=t.length),e||(e=0),i>0&&i<a&&(i=a),i===a)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(a<0||a>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-e<i-a&&(i=t.length-e+a);var o,n=i-a;if(this===t&&a<e&&e<i)for(o=n-1;o>=0;--o)t[o+e]=this[o+a];else if(n<1e3||!c.TYPED_ARRAY_SUPPORT)for(o=0;o<n;++o)t[o+e]=this[o+a];else Uint8Array.prototype.set.call(t,this.subarray(a,a+n),e);return n},c.prototype.fill=function(t,e,a,i){if("string"==typeof t){if("string"==typeof e?(i=e,e=0,a=this.length):"string"==typeof a&&(i=a,a=this.length),1===t.length){var o=t.charCodeAt(0);o<256&&(t=o)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!c.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<a)throw new RangeError("Out of range index");if(a<=e)return this;var n;if(e>>>=0,a=void 0===a?this.length:a>>>0,t||(t=0),"number"==typeof t)for(n=e;n<a;++n)this[n]=t;else{var r=c.isBuffer(t)?t:Y(new c(t,i).toString()),s=r.length;for(n=0;n<a-e;++n)this[n+e]=r[n%s]}return this};var q=/[^+\/0-9A-Za-z-_]/g;function z(t){if((t=j(t).replace(q,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}function j(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function Y(t,e){var a;e=e||1/0;for(var i=t.length,o=null,n=[],r=0;r<i;++r){if((a=t.charCodeAt(r))>55295&&a<57344){if(!o){if(a>56319){(e-=3)>-1&&n.push(239,191,189);continue}if(r+1===i){(e-=3)>-1&&n.push(239,191,189);continue}o=a;continue}if(a<56320){(e-=3)>-1&&n.push(239,191,189),o=a;continue}a=65536+(o-55296<<10|a-56320)}else o&&(e-=3)>-1&&n.push(239,191,189);if(o=null,a<128){if((e-=1)<0)break;n.push(a)}else if(a<2048){if((e-=2)<0)break;n.push(a>>6|192,63&a|128)}else if(a<65536){if((e-=3)<0)break;n.push(a>>12|224,a>>6&63|128,63&a|128)}else{if(!(a<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;n.push(a>>18|240,a>>12&63|128,a>>6&63|128,63&a|128)}}return n}function J(t){for(var e=[],a=0;a<t.length;++a)e.push(255&t.charCodeAt(a));return e}function K(t,e){for(var a,i,o,n=[],r=0;r<t.length&&!((e-=2)<0);++r)i=(a=t.charCodeAt(r))>>8,o=a%256,n.push(o),n.push(i);return n}function Z(t){return i.toByteArray(z(t))}function X(t,e,a,i){for(var o=0;o<i&&!(o+a>=e.length||o>=t.length);++o)e[o+a]=t[o];return o}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"base64-js":1,ieee754:4,isarray:3}],3:[function(t,e){var a={}.toString;e.exports=Array.isArray||function(t){return"[object Array]"==a.call(t)}},{}],4:[function(t,e,a){a.read=function(t,e,a,i,o){var n,r,s=8*o-i-1,c=(1<<s)-1,l=c>>1,u=-7,p=a?o-1:0,h=a?-1:1,d=t[e+p];for(p+=h,n=d&(1<<-u)-1,d>>=-u,u+=s;u>0;n=256*n+t[e+p],p+=h,u-=8);for(r=n&(1<<-u)-1,n>>=-u,u+=i;u>0;r=256*r+t[e+p],p+=h,u-=8);if(0===n)n=1-l;else{if(n===c)return r?NaN:1/0*(d?-1:1);r+=Math.pow(2,i),n-=l}return(d?-1:1)*r*Math.pow(2,n-i)},a.write=function(t,e,a,i,o,n){var r,s,c,l=8*n-o-1,u=(1<<l)-1,p=u>>1,h=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,d=i?0:n-1,m=i?1:-1,f=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,r=u):(r=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-r))<1&&(r--,c*=2),(e+=r+p>=1?h/c:h*Math.pow(2,1-p))*c>=2&&(r++,c/=2),r+p>=u?(s=0,r=u):r+p>=1?(s=(e*c-1)*Math.pow(2,o),r+=p):(s=e*Math.pow(2,p-1)*Math.pow(2,o),r=0));o>=8;t[a+d]=255&s,d+=m,s/=256,o-=8);for(r=r<<o|s,l+=o;l>0;t[a+d]=255&r,d+=m,r/=256,l-=8);t[a+d-m]|=128*f}},{}],ActiveSuperPlant:[function(t,e,a){"use strict";cc._RF.push(e,"348214RzfpOIoPDtYqJFhjH","ActiveSuperPlant");var i=t,o=e,n=a;cc._RF.push(o,"ae6a9WheDFLNKp7wR9wZjnK","ActiveSuperPlant"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("HomeEnum"),c=cc._decorator,l=c.ccclass,u=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mSpine=null,e}return __extends(e,t),e.prototype.onLoad=function(){var t=this;this.mSpine.setCompleteListener(function(){t.node.destroy(),t.node.removeFromParent()})},e.prototype.play=function(){this.mSpine.setAnimation(0,"jihuo",!1),r.AudioManager.instance.playEffectPath("sounds/New_Fish",s.Bundles.RES)},__decorate([u(sp.Skeleton)],e.prototype,"mSpine",void 0),__decorate([l],e)}(cc.Component);n.default=p,cc._RF.pop(),cc._RF.pop()},{}],AdsMgr:[function(t,e,a){"use strict";cc._RF.push(e,"10997Jq5uFJMI8asMGtIKAG","AdsMgr");var i=t,o=e,n=a;cc._RF.push(o,"56b7d8dCDpN1bATyXr0eOHM","AdsMgr");var r=__decorate;Object.defineProperty(n,"__esModule",{value:!0}),n.AdsParam=void 0,i("UserDataProxy");var s=cc._decorator,c=s.ccclass,l=(s.property,function(t,e,a,i,o){this.success=null,this.fail=null,this.error=null,this.id=t,this.eventId=e,this.success=a,this.fail=i,this.error=o});n.AdsParam=l;var u=function(){function t(){}return t.showVideoAds=function(t){t.success&&t.success()},r([c],t)}();n.default=u,cc._RF.pop(),cc._RF.pop()},{}],Agent:[function(t,e,a){"use strict";cc._RF.push(e,"af2158ImkxIgKwSo26uM598","Agent");var i=t,o=e,n=a;cc._RF.push(o,"cdc7dLHMBlLiIa5eEudtjNc","Agent"),Object.defineProperty(n,"__esModule",{value:!0}),n.Agent=void 0;var r=i("Common"),s=function(){function t(){this.agentNeighbors_=[],this.obstaclNeighbors_=[],this.orcaLines_=[],this.position_=new r.Vector2(0,0),this.prefVelocity_=new r.Vector2(0,0),this.velocity_=new r.Vector2(0,0),this.id=0,this.maxNeighbors_=0,this.maxSpeed_=0,this._neighborDist=0,this.radius_=0,this.timeHorizon=0,this.timeHorizonObst=0,this.newVelocity_=new r.Vector2(0,0),this.mass=1}return Object.defineProperty(t.prototype,"neighborDist",{get:function(){return this._neighborDist},set:function(t){this._neighborDist=t},enumerable:!1,configurable:!0}),t.prototype.computeNeighbors=function(t){this.obstaclNeighbors_.length=0;var e=Math.pow(this.timeHorizonObst*this.maxSpeed_+this.radius_,2);t.kdTree.computeObstacleNeighbors(this,e),this.agentNeighbors_.length=0,this.maxNeighbors_>0&&(e=Math.pow(this.neighborDist,2),e=t.kdTree.computeAgentNeighbors(this,e))},t.prototype.computeNewVelocity=function(t){this.orcaLines_.length=0;for(var e=this.orcaLines_,a=1/this.timeHorizonObst,i=0;i<this.obstaclNeighbors_.length;++i){for(var o=this.obstaclNeighbors_[i].value,n=o.next,s=o.point.minus(this.position_),c=n.point.minus(this.position_),l=!1,u=0;u<e.length;++u)if(r.RVOMath.det(s.scale(a).minus(e[u].point),e[u].direction)-a*this.radius_>=-r.RVOMath.RVO_EPSILON&&r.RVOMath.det(c.scale(a).minus(e[u].point),e[u].direction)-a*this.radius_>=-r.RVOMath.RVO_EPSILON){l=!0;break}if(!l){var p=r.RVOMath.absSq(s),h=r.RVOMath.absSq(c),d=r.RVOMath.sqr(this.radius_),m=n.point.minus(o.point),f=s.scale(-1).multiply(m)/r.RVOMath.absSq(m),_=r.RVOMath.absSq(s.scale(-1).minus(m.scale(f))),y=new r.Line;if(f<0&&p<=d)o.convex&&(y.point=new r.Vector2(0,0),y.direction=r.RVOMath.normalize(new r.Vector2(-s.y,s.x)),e.push(y));else if(f>1&&h<=d)n.convex&&r.RVOMath.det(c,n.direction)>=0&&(y.point=new r.Vector2(0,0),y.direction=r.RVOMath.normalize(new r.Vector2(-c.y,c.x)),e.push(y));else if(f>=0&&f<=1&&_<=d)y.point=new r.Vector2(0,0),y.direction=o.direction.scale(-1),e.push(y);else{var g=void 0,v=void 0;if(f<0&&_<=d){if(!o.convex)continue;n=o;var P=Math.sqrt(p-d);g=new r.Vector2(s.x*P-s.y*this.radius_,s.x*this.radius_+s.y*P).scale(1/p),v=new r.Vector2(s.x*P+s.y*this.radius_,-s.x*this.radius_+s.y*P).scale(1/p)}else if(f>1&&_<=d){if(!n.convex)continue;o=n;var b=Math.sqrt(h-d);g=new r.Vector2(c.x*b-c.y*this.radius_,c.x*this.radius_+c.y*b).scale(1/h),v=new r.Vector2(c.x*b+c.y*this.radius_,-c.x*this.radius_+c.y*b).scale(1/h)}else o.convex?(P=Math.sqrt(p-d),g=new r.Vector2(s.x*P-s.y*this.radius_,s.x*this.radius_+s.y*P).scale(1/p)):g=o.direction.scale(-1),n.convex?(b=Math.sqrt(h-d),v=new r.Vector2(c.x*b+c.y*this.radius_,-c.x*this.radius_+c.y*b).scale(1/h)):v=o.direction;var D=o.previous,S=!1,C=!1;o.convex&&r.RVOMath.det(g,D.direction.scale(-1))>=0&&(g=D.direction.scale(-1),S=!0),n.convex&&r.RVOMath.det(v,n.direction)<=0&&(v=n.direction,C=!0);var E=o.point.minus(this.position_).scale(a),B=n.point.minus(this.position_).scale(a),A=B.minus(E),x=o==n?.5:this.velocity_.minus(E).multiply(A)/r.RVOMath.absSq(A),M=this.velocity_.minus(E).multiply(g),N=this.velocity_.minus(B).multiply(v);if(x<0&&M<0||o==n&&M<0&&N<0){var R=r.RVOMath.normalize(this.velocity_.minus(E));y.direction=new r.Vector2(R.y,-R.x),y.point=E.plus(R.scale(this.radius_*a)),e.push(y)}else if(x>1&&N<0)R=r.RVOMath.normalize(this.velocity_.minus(B)),y.direction=new r.Vector2(R.y,-R.x),y.point=B.plus(R.scale(this.radius_*a)),e.push(y);else{var T=x<0||x>1||o==n?1/0:r.RVOMath.absSq(this.velocity_.minus(A.scale(x).plus(E))),I=M<0?1/0:r.RVOMath.absSq(this.velocity_.minus(g.scale(M).plus(E))),w=N<0?1/0:r.RVOMath.absSq(this.velocity_.minus(v.scale(N).plus(B)));if(T<=I&&T<=w){y.direction=o.direction.scale(-1);var k=new r.Vector2(-y.direction.y,y.direction.x);y.point=k.scale(this.radius_*a).plus(E),e.push(y)}else if(I<=w){if(S)continue;y.direction=g,k=new r.Vector2(-y.direction.y,y.direction.x),y.point=k.scale(this.radius_*a).plus(E),e.push(y)}else C||(y.direction=v.scale(-1),k=new r.Vector2(-y.direction.y,y.direction.x),y.point=k.scale(this.radius_*a).plus(B),e.push(y))}}}}var F=e.length,L=1/this.timeHorizon;for(i=0;i<this.agentNeighbors_.length;++i){var O=this.agentNeighbors_[i].value,U=O.position_.minus(this.position_),G=O.mass/(this.mass+O.mass),V=this.mass/(this.mass+O.mass),H=G>=.5?this.velocity_.minus(this.velocity_.scale(G)).scale(2):this.prefVelocity_.plus(this.velocity_.minus(this.prefVelocity_).scale(2*G)),W=V>=.5?O.velocity_.scale(2).scale(1-V):O.prefVelocity_.plus(O.velocity_.minus(O.prefVelocity_).scale(2*V)),q=H.minus(W),z=r.RVOMath.absSq(U),j=this.radius_+O.radius_,Y=r.RVOMath.sqr(j),J=void(y=new r.Line);if(z>Y){var K=q.minus(U.scale(L)),Z=r.RVOMath.absSq(K),X=K.multiply(U);if(X<0&&r.RVOMath.sqr(X)>Y*Z){var Q=Math.sqrt(Z);R=K.scale(1/Q),y.direction=new r.Vector2(R.y,-R.x),J=R.scale(j*L-Q)}else{var $=Math.sqrt(z-Y);r.RVOMath.det(U,K)>0?(k=new r.Vector2(U.x*$-U.y*j,U.x*j+U.y*$),y.direction=k.scale(1/z)):(k=new r.Vector2(U.x*$+U.y*j,-U.x*j+U.y*$),y.direction=k.scale(-1/z));var tt=q.multiply(y.direction);J=y.direction.scale(tt).minus(q)}}else{var et=1/t;K=q.minus(U.scale(et)),Q=r.RVOMath.abs(K),R=K.scale(1/Q),y.direction=new r.Vector2(R.y,-R.x),J=R.scale(j*et-Q)}y.point=H.plus(J.scale(G)),e.push(y)}var at=this.linearProgram2(e,this.maxSpeed_,this.prefVelocity_,!1,this.newVelocity_);at<e.length&&this.linearProgram3(e,F,at,this.maxSpeed_,this.newVelocity_)},t.prototype.insertAgentNeighbor=function(t,e){if(this!=t){var a=r.RVOMath.absSq(this.position_.minus(t.position_));if(a<e){this.agentNeighbors_.length<this.maxNeighbors_&&this.agentNeighbors_.push(new r.KeyValuePair(a,t));for(var i=this.agentNeighbors_.length-1;0!=i&&a<this.agentNeighbors_[i-1].key;)this.agentNeighbors_[i]=this.agentNeighbors_[i-1],--i;this.agentNeighbors_[i]=new r.KeyValuePair(a,t),this.agentNeighbors_.length==this.maxNeighbors_&&(e=this.agentNeighbors_[this.agentNeighbors_.length-1].key)}}return e},t.prototype.insertObstacleNeighbor=function(t,e){var a=t.next,i=r.RVOMath.distSqPointLineSegment(t.point,a.point,this.position_);if(i<e){this.obstaclNeighbors_.push(new r.KeyValuePair(i,t));for(var o=this.obstaclNeighbors_.length-1;0!=o&&i<this.obstaclNeighbors_[o-1].key;)this.obstaclNeighbors_[o]=this.obstaclNeighbors_[o-1],--o;this.obstaclNeighbors_[o]=new r.KeyValuePair(i,t)}},t.prototype.update=function(t){this.velocity_.copy(this.newVelocity_),this.position_.copy(this.position_.plus(this.velocity_.scale(t)))},t.prototype.linearProgram1=function(t,e,a,i,o,n){var s=t[e].point.multiply(t[e].direction),c=r.RVOMath.sqr(s)+r.RVOMath.sqr(a)-r.RVOMath.absSq(t[e].point);if(c<0)return!1;for(var l=Math.sqrt(c),u=-s-l,p=-s+l,h=0;h<e;++h){var d=r.RVOMath.det(t[e].direction,t[h].direction),m=r.RVOMath.det(t[h].direction,t[e].point.minus(t[h].point));if(Math.abs(d)<=r.RVOMath.RVO_EPSILON){if(m<0)return!1}else{var f=m/d;if(d>=0?p=Math.min(p,f):u=Math.max(u,f),u>p)return!1}}return o?i.multiply(t[e].direction)>0?n.copy(t[e].point.plus(t[e].direction.scale(p))):n.copy(t[e].point.plus(t[e].direction.scale(u))):(f=t[e].direction.multiply(i.minus(t[e].point)))<u?n.copy(t[e].point.plus(t[e].direction.scale(u))):f>p?n.copy(t[e].point.plus(t[e].direction.scale(p))):n.copy(t[e].point.plus(t[e].direction.scale(f))),!0},t.prototype.linearProgram2=function(t,e,a,i,o){i?o.copy(a.scale(e)):r.RVOMath.absSq(a)>r.RVOMath.sqr(e)?o.copy(r.RVOMath.normalize(a).scale(e)):o.copy(a);for(var n=0;n<t.length;++n)if(r.RVOMath.det(t[n].direction,t[n].point.minus(o))>0){var s=o.clone();if(!this.linearProgram1(t,n,e,a,i,o))return o.copy(s),n}return t.length},t.prototype.linearProgram3=function(t,e,a,i,o){for(var n=0,s=a;s<t.length;++s)if(r.RVOMath.det(t[s].direction,t[s].point.minus(o))>n){for(var c=[],l=0;l<e;++l)c.push(t[l]);for(var u=e;u<s;++u){var p=new r.Line,h=r.RVOMath.det(t[s].direction,t[u].direction);if(Math.abs(h)<=r.RVOMath.RVO_EPSILON){if(t[s].direction.multiply(t[u].direction)>0)continue;p.point=t[s].point.plus(t[u].point).scale(.5)}else p.point=t[s].point.plus(t[s].direction.scale(r.RVOMath.det(t[u].direction,t[s].point.minus(t[u].point))/h));p.direction=r.RVOMath.normalize(t[u].direction.minus(t[s].direction)),c.push(p)}var d=o.clone();this.linearProgram2(c,i,new r.Vector2(-t[s].direction.y,t[s].direction.x),!0,o)<c.length&&o.copy(d),n=r.RVOMath.det(t[s].direction,t[s].point.minus(o))}},t}();n.Agent=s,cc._RF.pop(),cc._RF.pop()},{}],AnimUtils:[function(t,e,a){"use strict";cc._RF.push(e,"10bf1900bpO9YGc11NMaeTe","AnimUtils");var i=t,o=e,n=a;cc._RF.push(o,"92c31OvBSxHyph0m01apuo+","AnimUtils"),Object.defineProperty(n,"__esModule",{value:!0}),n.AnimUtil=void 0;var r=i("BattleDataProxy"),s=i("RandomUtil"),c=function(){function t(){}return t.floatAnim=function(t,e,a){void 0===e&&(e=1),void 0===a&&(a=25),cc.Tween.stopAllByTarget(t);var i=t.y;cc.tween(t).to(e,{y:i+a}).to(e,{y:i}).union().repeatForever().start()},t.shakeAnim=function(t,e,a,i){void 0===i&&(i=1),cc.Tween.stopAllByTarget(t);var o=t.x,n=t.y;cc.tween(t).to(.02,{x:o+3*i,y:n+4*i}).to(.02,{x:o-3*i,y:n+4*i}).to(.02,{x:o-5*i,y:n+1*i}).to(.02,{x:o+1*i,y:n-3*i}).to(.02,{x:o-3*i,y:n+3*i}).to(.02,{x:o+1*i,y:n-4*i}).to(.02,{x:o-4*i,y:n-5*i}).to(.02,{x:o+1*i,y:n+5*i}).to(.02,{x:o,y:n}).union().repeatForever().start();var r=setTimeout(function(){clearTimeout(r),cc.Tween.stopAllByTarget(t),t.x=o,t.y=n,a&&a()},e)},t.flyItemAnim=function(t,e,a,i,o,n){void 0===o&&(o=60);var c=t.length,l=this.getCirclePoints(e,cc.v3(a,a.y),c,o);t.forEach(function(t,e){t.active=!1;var o=s.RandomUtil.randomInt(0,l.length),u=cc.v2(l[o].x,l[o].y),p=Math.min(Math.abs(u.y-i.y)/500,.8);p=Math.max(p,.5),p/=r.battleDataProxy.gameSpeed;var h=u.add(cc.v2(u.x>=a.x?s.RandomUtil.randomInt(0,300):s.RandomUtil.randomInt(-300,0),s.RandomUtil.randomInt(0,150)));cc.tween(t).delay(.01*e).call(function(){t.active=!0}).to(.05,{x:u.x,y:u.y}).bezierTo(p,u,h,cc.v2(i.x,i.y)).call(function(){t.active=!1,e===c-1&&n&&n()}).start()})},t.getCirclePoints=function(t,e,a,i){void 0===i&&(i=60);for(var o=[],n=Math.PI/180*Math.round(360/a),r=0;r<a;r++){var s=e.x+t*Math.sin(n*r),c=e.y+t*Math.cos(n*r);o.unshift(cc.v3(s+Math.random()*i,c+Math.random()*i,0))}return o},t.breathAnim=function(t,e,a){void 0===e&&(e=1.2),void 0===a&&(a=.5),cc.Tween.stopAllByTarget(t),cc.tween(t).to(a,{scale:e}).to(a,{scale:1}).union().repeatForever().start()},t.rotateAnim=function(t,e){cc.Tween.stopAllByTarget(t),cc.tween(t).by(1,{angle:e}).union().repeatForever().start()},t.swingAnim=function(t,e,a,i,o,n){void 0===n&&(n=""),cc.Tween.stopAllByTarget(t),cc.tween(t).to(i/2,{angle:e}).to(i/2,{angle:a},{easing:n}).delay(o).union().repeatForever().start()},t.dropItemAnim=function(e,a,i,o,n,r){void 0===o&&(o=60);var c=e.length,l=t.getCirclePoints(a,i,c,o);e.forEach(function(t,e){t.setPosition(l[e]);var a=t.position,o=Math.abs(i.y-n),u=s.RandomUtil.randomInt(-30,o/300*50),p=o/300*1.6,h=cc.v3(i.x>a.x?a.x-u:i.x<a.x?a.x+u:i.x,n);cc.Tween.stopAllByTarget(t);var d=Object.create(null),m=!1;d.progress=function(t,e,a,i){return m?a.x=e.x:(a.x=t.x+(e.x-t.x)*i,i>.98&&(m=!0)),a.y=t.y+(e.y-t.y)*i,a},d.easing="bounceOut",cc.tween(t).to(p,{position:h},d).delay(.3).call(function(){--c<=0&&r&&r()}).start()})},t.flyDropItemAnim=function(t,e,a,i){var o=t.length;t.forEach(function(t){cc.Tween.stopAllByTarget(t);var n=t.getPosition(),r=e,c=n.add(cc.v2(s.RandomUtil.randomInt(-300,300),s.RandomUtil.randomInt(0,150)));cc.tween(t).bezierTo(.7,n,c,r).call(function(){i&&i(t),--o<=0&&a&&a()}).start()})},t.swingLRAnim=function(t,e,a){cc.Tween.stopAllByTarget(t),cc.tween(t).by(a/2,{x:-e}).by(a/2,{x:e}).union().repeatForever().start()},t.breathAndFadeAnim=function(t,e,a,i,o){void 0===e&&(e=1.2),void 0===a&&(a=0),void 0===i&&(i=255),void 0===o&&(o=.5),cc.Tween.stopAllByTarget(t),cc.tween(t).parallel(cc.tween().to(o,{opacity:a}).to(o,{opacity:i}).union(),cc.tween().to(o,{scale:e}).to(o,{scale:1}).union()).union().repeatForever().start()},t.blickAnim=function(t,e,a){void 0===e&&(e=0),void 0===a&&(a=.5),cc.Tween.stopAllByTarget(t),cc.tween(t).to(a,{opacity:e}).to(a,{opacity:255}).union().repeatForever().start()},t.shakeAngle=function(t,e,a,i){void 0===e&&(e=10),void 0===a&&(a=.5),void 0===i&&(i=null);var o=t.angle,n=function(e,a){if(e<1||a<.1)cc.tween(t).to(.2,{angle:o}).call(function(){i&&i()}).start();else{var r=.3*a,s=.5*e,c=a-r;cc.tween(t).to(r,{angle:-e},{easing:"sineInOut"}).to(r,{angle:e},{easing:"sineInOut"}).call(function(){n(s,c)}).start()}};cc.tween(t).to(.25*a,{angle:e},{easing:"sineOut"}).call(function(){n(.5*e,.75*a)}).start()},t}();n.AnimUtil=c,cc._RF.pop(),cc._RF.pop()},{}],AnimationCfgMgr:[function(t,e,a){"use strict";cc._RF.push(e,"90778zV6y5MZ7TqZfteMrl/","AnimationCfgMgr");var i=t,o=e,n=a;cc._RF.push(o,"2bbb46iwTVDUpMDWyKYX38V","AnimationCfgMgr"),Object.defineProperty(n,"__esModule",{value:!0}),n.AnimationCfgMgr=void 0;var r=i("BattleDataProxy"),s=function(){function t(){}return Object.defineProperty(t,"instance",{get:function(){return null==this._instance&&(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t.prototype.getAnimationCfg=function(t){if(4==t.type)return 4001==t.id?this.getEnemy4001Cfg():4002==t.id?this.getEnemy4002Cfg():4003==t.id?this.getEnemy4003Cfg():4004==t.id?this.getEnemy4004Cfg():4005==t.id?this.getEnemy4005Cfg():4006==t.id?this.getEnemy4006Cfg():[];var e=[],a=t.modeName+"_die_",i=t.modeName+"_move_",o="textures/monster/"+t.modeName,n=t.frame.split("|").map(Number);e.push({actionName:"move",frameNum:n[1],bundleName:"Game",spriteFrameNameHead:i,path:o,frameEventIndexs:[1]},{actionName:"die",frameNum:n[0],bundleName:"Game",spriteFrameNameHead:a,path:o});var r=t.atkFrame;if("0"!=r){var s=r.split("|").map(Number);if(s.length<2)e.push({actionName:"atk",frameNum:s[0],bundleName:"Game",spriteFrameNameHead:t.modeName+"_atk_",path:o,frameEventIndexs:[1]});else for(var c=0;c<s.length;++c){var l=s[c];e.push({actionName:"atk"+c,frameNum:l,bundleName:"Game",spriteFrameNameHead:t.modeName+"_atk"+(c+1)+"_",path:o,frameEventIndexs:[1]})}}return e},t.prototype.getBulletHitCfg=function(t,e,a){void 0===a&&(a=!1);var i=10,o="";a||r.battleDataProxy.getIsSuperPlant(t)?(3==t?i=13:4==t?i=15:7==t?i=19:11==t?i=20:12==t?i=22:14==t?i=13:15==t&&(i=12),o="CWzidan"+t+"_liekai_"):(4==t?i=14:11==t?i=17:12==t?i=22:13==t?i=12:14==t?i=13:15==t&&(i=12),o="zidan"+t+"_liekai_");var n=[];return n.push({actionName:"bulletHit",frameNum:i,bundleName:"Game",spriteFrameNameHead:o,path:"textures/bulletHit/BulletHit",frameEventIndexs:[1]}),n},t.prototype.getBulletBoom=function(){var t=[];return t.push({actionName:"bulletBoom",frameNum:15,bundleName:"Game",spriteFrameNameHead:"bullet_boom_",path:"textures/bulletHit/BulletHit",frameEventIndexs:[1]}),t},t.prototype.getDizzinessEffect=function(){var t=[];return t.push({actionName:"dizziness",frameNum:21,bundleName:"Game",spriteFrameNameHead:"dizziness_",path:"textures/dizziness",frameEventIndexs:[1]}),t},t.prototype.getRushEffect=function(){var t=[];return t.push({actionName:"rush",frameNum:2,bundleName:"Game",spriteFrameNameHead:"benpao_",path:"textures/benPao",frameEventIndexs:[1]}),t},t.prototype.getEnemyBoomDie=function(){var t=[];return t.push({actionName:"boomDie",frameNum:44,bundleName:"Game",spriteFrameNameHead:"zombie_boomDie_",path:"textures/monster/boomDie",frameEventIndexs:[1]}),t},t.prototype.getEarthSoilEffect=function(){var t=[];return t.push({actionName:"earthSoil",frameNum:35,bundleName:"Game",spriteFrameNameHead:"nitu_",path:"textures/monster/zombie_SP1",frameEventIndexs:[1]}),t},t.prototype.getEnemy4001Cfg=function(){var t=[];return t.push({actionName:"move",frameNum:40,bundleName:"Game",spriteFrameNameHead:"zombie_SP1_move_",path:"textures/monster/zombie_SP1",frameEventIndexs:[1]},{actionName:"atk",frameNum:15,bundleName:"Game",spriteFrameNameHead:"zombie_SP1_atk_",path:"textures/monster/zombie_SP1",frameEventIndexs:[1]},{actionName:"die",frameNum:35,bundleName:"Game",spriteFrameNameHead:"zombie_SP1_die_",path:"textures/monster/zombie_SP1",frameEventIndexs:[1]},{actionName:"stop",frameNum:45,bundleName:"Game",spriteFrameNameHead:"zombie_SP1_stop_",path:"textures/monster/zombie_SP1",frameEventIndexs:[1]},{actionName:"move2",frameNum:32,bundleName:"Game",spriteFrameNameHead:"zombie_SP1_move_zuandi_",path:"textures/monster/zombie_SP1",frameEventIndexs:[1]}),t},t.prototype.getEnemy4002Cfg=function(){var t=[];return t.push({actionName:"move",frameNum:40,bundleName:"Game",spriteFrameNameHead:"zombie_SP2_move_shiti_",path:"textures/monster/zombie_SP2",frameEventIndexs:[1]},{actionName:"atk",frameNum:15,bundleName:"Game",spriteFrameNameHead:"zombie_SP2_atk_",path:"textures/monster/zombie_SP2",frameEventIndexs:[1]},{actionName:"die",frameNum:30,bundleName:"Game",spriteFrameNameHead:"zombie_SP2_die_",path:"textures/monster/zombie_SP2",frameEventIndexs:[1]},{actionName:"show",frameNum:40,bundleName:"Game",spriteFrameNameHead:"zombie_SP2_xianxing_",path:"textures/monster/zombie_SP2",frameEventIndexs:[1]},{actionName:"move2",frameNum:40,bundleName:"Game",spriteFrameNameHead:"zombie_SP2_move_xuti_",path:"textures/monster/zombie_SP2",frameEventIndexs:[1]},{actionName:"hide",frameNum:40,bundleName:"Game",spriteFrameNameHead:"zombie_SP2_yinshen_",path:"textures/monster/zombie_SP2",frameEventIndexs:[1]},{actionName:"atk2",frameNum:15,bundleName:"Game",spriteFrameNameHead:"zombie_SP2_atk_xuti_",path:"textures/monster/zombie_SP2",frameEventIndexs:[1]}),t},t.prototype.getEnemy4003Cfg=function(){var t=[];return t.push({actionName:"move",frameNum:40,bundleName:"Game",spriteFrameNameHead:"zombie_SP3_move_",path:"textures/monster/zombie_SP3",frameEventIndexs:[1]},{actionName:"atk",frameNum:15,bundleName:"Game",spriteFrameNameHead:"zombie_SP3_atk_",path:"textures/monster/zombie_SP3",frameEventIndexs:[1]},{actionName:"die",frameNum:22,bundleName:"Game",spriteFrameNameHead:"zombie_SP3_die_",path:"textures/monster/zombie_SP3",frameEventIndexs:[1]},{actionName:"jumpAtk",frameNum:16,bundleName:"Game",spriteFrameNameHead:"zombie_SP3_atk_tiaotiao_",path:"textures/monster/zombie_SP3",frameEventIndexs:[1]},{actionName:"move2",frameNum:13,bundleName:"Game",spriteFrameNameHead:"zombie_SP3_move_tiaotiao_",path:"textures/monster/zombie_SP3",frameEventIndexs:[1]},{actionName:"vehiclesDestroy",frameNum:20,bundleName:"Game",spriteFrameNameHead:"zombie_SP3_hit_",path:"textures/monster/zombie_SP3",frameEventIndexs:[1]}),t},t.prototype.getEnemy4004Cfg=function(){var t=[];return t.push({actionName:"move",frameNum:40,bundleName:"Game",spriteFrameNameHead:"zombie_SP4_move_",path:"textures/monster/zombie_SP4",frameEventIndexs:[1]},{actionName:"atk",frameNum:20,bundleName:"Game",spriteFrameNameHead:"zombie_SP4_atk_",path:"textures/monster/zombie_SP4",frameEventIndexs:[1]},{actionName:"die",frameNum:24,bundleName:"Game",spriteFrameNameHead:"zombie_SP4_fuhuo_die_",path:"textures/monster/zombie_SP4",frameEventIndexs:[1]},{actionName:"atk2",frameNum:15,bundleName:"Game",spriteFrameNameHead:"zombie_SP4_fuhuo_atk_",path:"textures/monster/zombie_SP4",frameEventIndexs:[1]},{actionName:"move2",frameNum:20,bundleName:"Game",spriteFrameNameHead:"zombie_SP4_fuhuo_move_",path:"textures/monster/zombie_SP4",frameEventIndexs:[1]},{actionName:"fuhuo",frameNum:23,bundleName:"Game",spriteFrameNameHead:"zombie_SP4_fuhuo_",path:"textures/monster/zombie_SP4",frameEventIndexs:[1]},{actionName:"fuhuozhong",frameNum:65,bundleName:"Game",spriteFrameNameHead:"zombie_SP4_fuhuoing_",path:"textures/monster/zombie_SP4",frameEventIndexs:[1]},{actionName:"die2",frameNum:45,bundleName:"Game",spriteFrameNameHead:"zombie_SP4_die_",path:"textures/monster/zombie_SP4",frameEventIndexs:[1]}),t},t.prototype.getEnemy4005Cfg=function(){var t=[];return t.push({actionName:"move",frameNum:32,bundleName:"Game",spriteFrameNameHead:"zombie_SP5_move1_",path:"textures/monster/zombie_SP5",frameEventIndexs:[1]},{actionName:"atk",frameNum:15,bundleName:"Game",spriteFrameNameHead:"zombie_SP5_atk_",path:"textures/monster/zombie_SP5",frameEventIndexs:[1]},{actionName:"die",frameNum:22,bundleName:"Game",spriteFrameNameHead:"zombie_SP5_die_",path:"textures/monster/zombie_SP5",frameEventIndexs:[1]},{actionName:"move2",frameNum:32,bundleName:"Game",spriteFrameNameHead:"zombie_SP5_move2_",path:"textures/monster/zombie_SP5",frameEventIndexs:[1]}),t},t.prototype.getEnemy4006Cfg=function(){var t=[];return t.push({actionName:"move",frameNum:32,bundleName:"Game",spriteFrameNameHead:"zombie_SP6_move1_",path:"textures/monster/zombie_SP6",frameEventIndexs:[1]},{actionName:"die",frameNum:22,bundleName:"Game",spriteFrameNameHead:"zombie_SP6_die_",path:"textures/monster/zombie_SP6",frameEventIndexs:[1]},{actionName:"move2",frameNum:32,bundleName:"Game",spriteFrameNameHead:"zombie_SP6_move2_",path:"textures/monster/zombie_SP6",frameEventIndexs:[1]}),t},t.prototype.getGTBulletHit=function(t){switch(t){case"CWzidan1_2":return(e=[]).push({actionName:"liekai2",frameNum:10,bundleName:"res_GuardingTheBridge",spriteFrameNameHead:"CWzidan1_liekai2_",path:"textrues/bulletHit",frameEventIndexs:[]}),e;case"CWzidan8_2":return(e=[]).push({actionName:"liekai2",frameNum:13,bundleName:"res_GuardingTheBridge",spriteFrameNameHead:"CWzidan8_liekai2_",path:"textrues/bulletHit",frameEventIndexs:[]}),e;case"CWzidan11_2":var e;return(e=[]).push({actionName:"liekai2",frameNum:13,bundleName:"res_GuardingTheBridge",spriteFrameNameHead:"CWzidan11_liekai2_",path:"textrues/bulletHit",frameEventIndexs:[]}),e}},t._instance=null,t}();n.AnimationCfgMgr=s,cc._RF.pop(),cc._RF.pop()},{}],AnimationCtrl:[function(t,e,a){"use strict";cc._RF.push(e,"1613fL/8/dEcYTbCAcGjrIC","AnimationCtrl");var i=t,o=e,n=a;cc._RF.push(o,"be471JmrDBPfLKnysV3lkof","AnimationCtrl"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("ResUtil"),s=cc._decorator,c=s.ccclass,l=s.property,u=s.menu,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.animation=null,e._curAnimName="",e._onceFrameEvent=null,e._defaultSpd=.2,e._animationClipInfoMap=new Map,e}return __extends(e,t),e.prototype.loadAnimation=function(t){return __awaiter(this,void 0,Promise,function(){var e,a,i;return __generator(this,function(o){switch(o.label){case 0:if(!this.node||!this.node.isValid)return[2,Promise.resolve()];this._animationClipInfoMap.clear(),e=function(e){var i,o,n,s,c,l;return __generator(this,function(u){switch(u.label){case 0:i=t[e],o=[],n={actionName:i.actionName,frameNum:i.frameNum,frameEventIndexs:i.frameEventIndexs},s=0,u.label=1;case 1:return s<i.frameNum?[4,r.ResUtil.loadAsset({bundleName:i.bundleName,path:i.path+"/"+i.spriteFrameNameHead+s,type:cc.SpriteFrame})]:[3,4];case 2:(c=u.sent())instanceof cc.Asset&&(o[s]=c),u.label=3;case 3:return++s,[3,1];case 4:return a._animationClipInfoMap||(a._animationClipInfoMap=new Map),a._animationClipInfoMap.set(i.actionName,n),(l=cc.AnimationClip.createWithSpriteFrames(o,60)).name=i.actionName,l.speed=.2,i.frameEventIndexs&&i.frameEventIndexs.forEach(function(t){l.events.push({frame:t/i.frameNum*l.duration,func:"onFrameEvent",params:[i.actionName,t.toString()]})}),a.animation&&a.animation.addClip(l),[2]}})},a=this,i=0,o.label=1;case 1:return i<t.length?[5,e(i)]:[3,4];case 2:o.sent(),o.label=3;case 3:return i++,[3,1];case 4:return this.animation&&(this.animation.onFrameEvent=this.onFrameEvent.bind(this)),[2,Promise.resolve()]}})})},e.prototype.loadAtlasAnimation=function(t){return __awaiter(this,void 0,Promise,function(){var e,a,i;return __generator(this,function(o){switch(o.label){case 0:if(!this.node||!this.node.isValid)return[2,Promise.resolve()];this._animationClipInfoMap.clear(),e=function(e){var i,o,n,s,c,l;return __generator(this,function(u){switch(u.label){case 0:return i=t[e],o=[],n={actionName:i.actionName,frameNum:i.frameNum,frameEventIndexs:i.frameEventIndexs},[4,r.ResUtil.loadAsset({bundleName:"Game",path:i.path,type:cc.SpriteAtlas})];case 1:for(s=u.sent(),c=0;c<i.frameNum;++c)o[c]=s.getSpriteFrame(""+i.spriteFrameNameHead+c);return a._animationClipInfoMap||(a._animationClipInfoMap=new Map),a._animationClipInfoMap.set(i.actionName,n),(l=cc.AnimationClip.createWithSpriteFrames(o,60)).name=i.actionName,l.speed=.2,i.frameEventIndexs&&i.frameEventIndexs.forEach(function(t){l.events.push({frame:t/i.frameNum*l.duration,func:"onFrameEvent",params:[i.actionName,t.toString()]})}),a.animation&&a.animation.addClip(l),[2]}})},a=this,i=0,o.label=1;case 1:return i<t.length?[5,e(i)]:[3,4];case 2:o.sent(),o.label=3;case 3:return i++,[3,1];case 4:return this.animation&&(this.animation.onFrameEvent=this.onFrameEvent.bind(this)),[2,Promise.resolve()]}})})},e.prototype.init=function(){},e.prototype.playAnim=function(t,e,a,i,o){if(void 0===e&&(e=!1),void 0===a&&(a=null),void 0===i&&(i=null),void 0===o&&(o=1),this._curAnimName!=t&&this.node&&this.node.isValid){a&&this.animation.once(cc.Animation.EventType.FINISHED,function(){a&&a()},this);var n=this.animation.getClips().find(function(e){return e.name==t});n?(e&&(n.wrapMode=cc.WrapMode.Loop),this._onceFrameEvent=i,this._curAnimName=t,this.animation.stop(),this.animation.play(t,0).speed=this._defaultSpd*o):cc.error("\u6ca1\u6709\u8fd9\u4e2a\u52a8\u753b",t)}},e.prototype.setSpeed=function(t){this.animation.getAnimationState(this._curAnimName).speed=this._defaultSpd*t},e.prototype.clearAnimEvent=function(){this._curAnimName="",this.animation.onFrameEvent=null,this.animation.off(cc.Animation.EventType.FINISHED)},e.prototype.onFrameEvent=function(t,e){this._onceFrameEvent&&this._onceFrameEvent(Number(e))},__decorate([l(cc.Animation)],e.prototype,"animation",void 0),__decorate([c,u("\u5e27\u52a8\u753b\u7ec4\u4ef6/AnimationCtrl")],e)}(cc.Component);n.default=p,cc._RF.pop(),cc._RF.pop()},{}],AnimationMgr:[function(t,e,a){"use strict";cc._RF.push(e,"67938E7vr9Lx7/0y2cUki0E","AnimationMgr");var i=t,o=e,n=a;cc._RF.push(o,"a04d2BtWBFDJJXCO8NJwCBh","AnimationMgr"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("ResUtil"),s=i("PopupManager"),c=i("HomeEnum"),l=i("DataManager"),u=i("NodePoolManager"),p=i("BattleDataProxy"),h=i("ItemAni"),d=cc._decorator,m=d.ccclass,f=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._flyItemPb=null,e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!1,configurable:!0}),e.prototype.showAwardAni=function(t,e,a,i,o){var n,p=this,d=null;d=e||s.PopupManager.instance.getPopupNode(),n=a?d.convertToNodeSpaceAR(a.parent.convertToWorldSpaceAR(a.position)):cc.v3(0,0);var m=l.DataManager.instance.eData.dataitem[t.id];if(o||(o=this.getEndPos(m,d)),o){var f=t.num,_=20;8==t.id&&(_=30),this.getItemIconPrefab(function(){for(var e=function(e){if(e>=_)return"break";var a=u.default.instance.getNode(p._flyItemPb);if(a){a.scale=8==t.id?1:.8;var s=a.getChildByName("itemIcon");r.ResUtil.loadAsset({path:"textures/item/"+m.icon,type:cc.SpriteFrame,bundleName:c.Bundles.GAME}).then(function(t){s.getComponent(cc.Sprite).spriteFrame=t}).catch(function(t){console.log("error:",t)}),a.parent=d,a.getComponent(h.default).init(t,n,o,i,0==e),a.active=!0,a.zIndex=1e3}else cc.error("\u5bf9\u8c61\u6c60\u6ca1\u83b7\u53d6\u5230")},a=0;a<f&&"break"!==e(a);a++);})}},e.prototype.getItemIconPrefab=function(t){var e=this;this._flyItemPb?t&&t():r.ResUtil.loadAsset({path:"prefabs/homeItem/FlyItem",type:cc.Prefab,bundleName:c.Bundles.GAME}).then(function(a){e._flyItemPb=a,e._flyItemPb.addRef(),t&&t()}).catch(function(t){console.log("error:",t)})},e.prototype.getEndPos=function(t,e){var a=null;return 1==t.id?a=cc.find("Canvas/topUI/goldRoot"):2==t.id?a=cc.find("Canvas/topUI/diamondRoot"):4==t.id||6==t.id||7==t.id?a=cc.find("Canvas/downUI/BtnShop"):3==t.id?a=cc.find("Canvas/topUI/physicalRoot"):2==t.type?a=cc.find("Canvas/downUI/BtnPlant"):5==t.type||5==t.id||8==t.id&&(a=p.battleDataProxy.sunshineRoot),a?e.convertToNodeSpaceAR(a.parent.convertToWorldSpaceAR(a.position)):null},e.prototype.usePowerAni=function(t){var e=this;void 0===t&&(t=1);var a=cc.find("Canvas");this.getItemIconPrefab(function(){var i=u.default.instance.getNode(e._flyItemPb),o=i.getChildByName("itemIcon");r.ResUtil.loadAsset({path:"textures/item/icon_3",type:cc.SpriteFrame,bundleName:c.Bundles.GAME}).then(function(t){o.getComponent(cc.Sprite).spriteFrame=t}).catch(function(t){console.log("error:",t)});var n,s=cc.find("Canvas/TopLayer/physicalBox"),l=a.convertToNodeSpaceAR(s.parent.convertToWorldSpaceAR(s.position));n=1==t?cc.find("Canvas/UILayer/HomeView/battleStarBtn"):cc.find("Canvas/UILayer/HomeView/saodanBox");var p=a.convertToNodeSpaceAR(n.parent.convertToWorldSpaceAR(n.position));i.scale=1.2,i.parent=a,i.setPosition(l),i.active=!0,i.zIndex=1e3,i.getComponent(h.default).init2(p,.5)})},e.prototype.getCardAni=function(){},e._instance=null,__decorate([m],e)}(cc.Component));n.default=f,cc._RF.pop(),cc._RF.pop()},{}],AppBase:[function(t,e,a){"use strict";cc._RF.push(e,"dd3decLkXZESZrS13QLqVoz","AppBase");var i=t,o=e,n=a;cc._RF.push(o,"7109fs8dr9Dz4NuzN3TMm8a","AppBase"),Object.defineProperty(n,"__esModule",{value:!0}),n.AppBase=n.topNode=n.rootNode=void 0;var r=i("GameEnum"),s=i("EventManager"),c={},l=function(){function t(){}return t.getSystemInfoSync=function(){return c},t.init=function(){if(!this.appBaseInit){var t=cc.view.getVisibleSize();n.rootNode=new cc.Node("Root"),n.rootNode.width=t.width,n.rootNode.height=t.height,n.rootNode.x=t.width/2,n.rootNode.y=t.height/2,cc.director.getScene().addChild(n.rootNode),cc.game.addPersistRootNode(n.rootNode),n.topNode=new cc.Node("Top"),n.topNode.width=t.width,n.topNode.height=t.height,n.topNode.x=t.width/2,n.topNode.y=t.height/2,cc.director.getScene().addChild(n.topNode),cc.game.addPersistRootNode(n.topNode),n.topNode.on(cc.Node.EventType.TOUCH_START,function(t){s.EventManager.instance.emit(r.EGameEvent.SCENE_TOUCH_START,t)},n.topNode);var e=n.topNode;e._touchListener&&e._touchListener.setSwallowTouches(!1),this.appBaseInit=!0}},t.getRoot=function(){return null!=n.rootNode?Promise.resolve(n.rootNode):new Promise(function(t){var e=null;e=setInterval(function(){null!=n.rootNode&&(e&&clearInterval(e),t(n.rootNode))},100)})},t.appBaseInit=!1,t.onShow=function(t){cc.game.on(cc.game.EVENT_SHOW,t)},t.offShow=function(t){cc.game.off(cc.game.EVENT_SHOW,t)},t.onHide=function(t){cc.game.on(cc.game.EVENT_HIDE,t)},t.offHide=function(t){cc.game.off(cc.game.EVENT_HIDE,t)},t}();n.AppBase=l,cc._RF.pop(),cc._RF.pop()},{}],AppManager:[function(t,e,a){"use strict";cc._RF.push(e,"bdc065sc4BL6J10g2nShw22","AppManager");var i=t,o=e,n=a;cc._RF.push(o,"0d398YQcMdOqI4qeEAejnyf","AppManager"),Object.defineProperty(n,"__esModule",{value:!0}),n.AppManager=void 0;var r=i("AppProxy"),s=i("TimeUtil"),c=i("EventManager"),l=function(){function t(){this._endTime=0}return Object.defineProperty(t,"instance",{get:function(){return null==t._instance&&(t._instance=new t),t._instance},enumerable:!1,configurable:!0}),t.prototype.checkEndTime=function(){var t=s.TimeUtil.getTime();0===this._endTime&&(this._endTime=s.TimeUtil.getDayEndTime(t)),t>this._endTime&&(this._endTime=s.TimeUtil.getDayEndTime(t),c.EventManager.instance.emit(r.AppEvent.DAY_UPDATE)),setTimeout(this.checkEndTime.bind(this),6e4)},t._instance=null,t}();n.AppManager=l,cc._RF.pop(),cc._RF.pop()},{}],AppProxy:[function(t,e,a){"use strict";cc._RF.push(e,"39cf5iWxnZJNbW/pFU/paVd","AppProxy");var i=t,o=e,n=a;cc._RF.push(o,"f64bbmzhX9NRL5aMiWfyolA","AppProxy"),Object.defineProperty(n,"__esModule",{value:!0}),n.appProxy=n.BgmTypes=n.AppEvent=void 0;var r=i("ProxyBase");(function(t){t.POPUP_SHOW="APP_POPUP_SHOW",t.POPUP_HIDE="APP_POPUP_HIDE",t.ENTER_GAME="APP_ENTER_GAME",t.AUDIO_CLICK="APP_AUDIO_CLICK",t.BGM_CHANGED="BGM_CHANGED",t.BGM_CHANGE_TOP="BGM_CHANGE_TOP",t.POPUP_CHANGED="APP_POPUP_CHANGED",t.SCENE_CHANGED="APP_SCENE_CHANGED",t.FRAGMENT_CHANGED="APP_FRAGMENT_CHANGED",t.STYLE="APP_STYLE",t.DAY_UPDATE="APP_DAY_UPDATE",t.FOLLOW_GAME="APP_FOLLOW_GAME",t.ADD_SHORTCUT="APP_ADD_SHORTCUT",t.TIME_DOWN_END="APP_TIME_DOWN_END",t.GAME_SHOW="APP_GAME_SHOW",t.GAME_HIDE="APP_GAME_HIDE",t.GET_SIDEBAR="GET_SIDEBAR"})(n.AppEvent||(n.AppEvent={})),function(t){t[t.none=0]="none",t[t.close=1]="close",t[t.open=2]="open",t[t.load=3]="load",t[t.main=4]="main",t[t.draw=5]="draw",t[t.battle_ready=6]="battle_ready",t[t.battle=7]="battle"}(n.BgmTypes||(n.BgmTypes={}));var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"clientVersion",{get:function(){return this._data.clientVersion},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clientCode",{get:function(){return this._data.clientCode},enumerable:!1,configurable:!0}),e.prototype.setClientVersion=function(t,e){this._data.clientVersion=t,this._data.clientCode=e},Object.defineProperty(e.prototype,"buttonSound",{get:function(){return this._data.buttonSound},set:function(t){this._data.buttonSound=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"autoRef",{get:function(){return this._data.autoRef},enumerable:!1,configurable:!0}),e}(r.ProxyBase);n.appProxy=new s(function(){this.privacyUrl=null,this.agreementUrl=null,this.clientVersion=null,this.clientCode=0,this.autoRef=!0,this.buttonSound=null}),cc._RF.pop(),cc._RF.pop()},{}],ArcProgressBar:[function(t,e,a){"use strict";cc._RF.push(e,"45d9aMqA71GfbZtcm4TUd9a","ArcProgressBar");var i=t,o=e,n=a;cc._RF.push(o,"04834LBSY1MIJScqVgY/vl8","ArcProgressBar"),Object.defineProperty(n,"__esModule",{value:!0}),n.ArcProgressBar=void 0;var r=i("MathUtil"),s=cc._decorator,c=s.ccclass,l=s.property,u=s.requireComponent,p=s.executeInEditMode,h=(s.help,s.menu,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.graphics=null,e._radius=100,e._clockwise=!0,e._startAngle=90,e._range=180,e._lineWidth=20,e._progress=.4,e._lineCap=cc.Graphics.LineCap.ROUND,e._backgroundColor=new cc.Color(255,255,255,255),e._progressColor=new cc.Color(50,101,246,255),e.curStartAngle=0,e.curStartRadians=0,e.curEndRadians=0,e.curTween=null,e.curTweenRes=null,e}return __extends(e,t),Object.defineProperty(e.prototype,"radius",{get:function(){return this._radius},set:function(t){this._radius=t,this.updateProperties()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clockwise",{get:function(){return this._clockwise},set:function(t){this._clockwise=t,this.updateProperties()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"startAngle",{get:function(){return this._startAngle},set:function(t){this._startAngle=t,this.updateProperties()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"range",{get:function(){return this._range},set:function(t){this._range=t,this.updateProperties()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lineWidth",{get:function(){return this._lineWidth},set:function(t){this._lineWidth=t,this.updateProperties()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"progress",{get:function(){return this._progress},set:function(t){this.updateProgress(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lineCap",{get:function(){return this._lineCap},set:function(t){this._lineCap=t,this.updateProperties()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(t){this._backgroundColor=t,this.updateProperties()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"progressColor",{get:function(){return this._progressColor},set:function(t){this._progressColor=t,this.updateProperties()},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){this.init()},e.prototype.resetInEditor=function(){this.init()},e.prototype.init=function(){this.graphics||(this.graphics=this.getComponent(cc.Graphics)),this.updateProperties()},e.prototype.show=function(){var t=this;return new Promise(function(e){var a=t.graphics.node;a.opacity=0,a.active=!0,cc.tween(a).to(.1,{opacity:255}).call(e).start()})},e.prototype.hide=function(){var t=this;return new Promise(function(e){var a=t.graphics.node;cc.tween(a).to(.1,{opacity:0}).set({active:!1}).call(e).start()})},e.prototype.updateProperties=function(){var t=this.graphics;t.lineWidth=this._lineWidth,t.lineCap=this._lineCap,this.curStartAngle=this._startAngle+90,this.curStartRadians=r.MathUtil.angle2Radians(this.curStartAngle);var e=this.curStartAngle+(this._clockwise?-this._range:this._range);this.curEndRadians=r.MathUtil.angle2Radians(e),this.updateProgress(this._progress)},e.prototype.updateProgress=function(t){t<0?t=0:t>1&&(t=1),this._progress=t;var e=this.graphics;e.clear(),e.strokeColor=this._backgroundColor,e.arc(0,0,this._radius,this.curStartRadians,this.curEndRadians,!this._clockwise),e.stroke();var a=this._clockwise?-this._range:this._range,i=this.curStartAngle+a*t,o=r.MathUtil.angle2Radians(i);e.strokeColor=this._progressColor,e.arc(0,0,this._radius,this.curStartRadians,o,!this._clockwise),e.stroke()},e.prototype.to=function(t,e){var a=this;return new Promise(function(i){a.stop(),a.curTweenRes=i,a.curTween=cc.tween(a).to(t,{progress:e}).call(function(){a.curTween=null,a.curTweenRes=null}).call(i).start()})},e.prototype.stop=function(){this.curTween&&(this.curTween.stop(),this.curTween=null),this.curTweenRes&&(this.curTweenRes(),this.curTweenRes=null)},__decorate([l(cc.Graphics)],e.prototype,"graphics",void 0),__decorate([l()],e.prototype,"_radius",void 0),__decorate([l({tooltip:!1})],e.prototype,"radius",null),__decorate([l()],e.prototype,"_clockwise",void 0),__decorate([l({tooltip:!1})],e.prototype,"clockwise",null),__decorate([l()],e.prototype,"_startAngle",void 0),__decorate([l({tooltip:!1})],e.prototype,"startAngle",null),__decorate([l()],e.prototype,"_range",void 0),__decorate([l({tooltip:!1})],e.prototype,"range",null),__decorate([l()],e.prototype,"_lineWidth",void 0),__decorate([l({tooltip:!1})],e.prototype,"lineWidth",null),__decorate([l()],e.prototype,"_progress",void 0),__decorate([l({range:[0,1],step:.01,tooltip:!1})],e.prototype,"progress",null),__decorate([l()],e.prototype,"_lineCap",void 0),__decorate([l({type:cc.Graphics.LineCap,tooltip:!1})],e.prototype,"lineCap",null),__decorate([l()],e.prototype,"_backgroundColor",void 0),__decorate([l({type:cc.Color,tooltip:!1})],e.prototype,"backgroundColor",null),__decorate([l()],e.prototype,"_progressColor",void 0),__decorate([l({type:cc.Color,tooltip:!1})],e.prototype,"progressColor",null),__decorate([c,u(cc.Graphics),p],e)}(cc.Component));n.ArcProgressBar=h,cc._RF.pop(),cc._RF.pop()},{}],Arrayincludes:[function(t,e){"use strict";cc._RF.push(e,"5a2dcJ5tq1MYpObCKQqAUiQ","Arrayincludes"),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(t,e){if(null==this)throw new TypeError('"this" is null or not defined');var a=Object(this),i=a.length>>>0;if(0==i)return!1;for(var o,n,r=0|e,s=Math.max(0<=r?r:i-Math.abs(r),0);s<i;){if((o=a[s])===(n=t)||"number"==typeof o&&"number"==typeof n&&isNaN(o)&&isNaN(n))return!0;s++}return!1}}),cc._RF.pop()},{}],AudioManager:[function(t,e,a){"use strict";cc._RF.push(e,"e9c2bBuEtNBS5FokbPsewGw","AudioManager");var i=t,o=e,n=a;cc._RF.push(o,"68d25tcM/hE17uoU+d7h0An","AudioManager"),Object.defineProperty(n,"__esModule",{value:!0}),n.AudioManager=n.EAudioEvent=void 0;var r,s=i("GameEnum"),c=i("HomeEnum"),l=i("BattleDataProxy"),u=i("EventManager"),p=i("ResUtil"),h=i("BasicsProxy");(function(t){t.BATTLE_EFFECT_SWITCH_CHANGE="BATTLE_EFFECT_SWITCH_CHANGE",t.EFFECT_AUDIO_SWITCH_CHANGE="EFFECT_AUDIO_SWITCH_CHANGE",t.BACKGROUND_AUDIO_SWITCH_CHANGE="BACKGROUND_AUDIO_SWITCH_CHANGE"})(r=n.EAudioEvent||(n.EAudioEvent={}));var d=function(){function t(){this._bgmPath="",this._bgmId=-1,this._clips=Object.create(null),this._loading=[],this._isOpenEffectAudio=!0,this._isOpenBackgroundAudio=!0,this._isOpenBattleEffect=!0,this._bgmId=-1,cc.audioEngine.setEffectsVolume(h.basicsProxy.effectVolume),cc.audioEngine.setMusicVolume(h.basicsProxy.bgmVolume)}return Object.defineProperty(t,"instance",{get:function(){return null==t._instance&&(t._instance=new t),t._instance},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isOpenBattleEffect",{get:function(){return this._isOpenBattleEffect},set:function(t){this._isOpenBattleEffect!==t&&(this._isOpenBattleEffect=t,u.EventManager.instance.emit(r.BATTLE_EFFECT_SWITCH_CHANGE))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isOpenEffectAudio",{get:function(){return this._isOpenEffectAudio},set:function(t){this._isOpenEffectAudio!==t&&(this._isOpenEffectAudio=t,u.EventManager.instance.emit(r.EFFECT_AUDIO_SWITCH_CHANGE))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isOpenBackgroundAudio",{get:function(){return this._isOpenBackgroundAudio},set:function(t){this._isOpenBackgroundAudio!==t&&(this._isOpenBackgroundAudio=t,t?l.battleDataProxy.gameState!=s.GameState.PLAYING&&l.battleDataProxy.gameState!=s.GameState.PAUSE?this.playBgmPath("sounds/homeBgm",c.Bundles.RES,!0):this.playBgmPath("sounds/battleBGM",c.Bundles.RES,!0):this.stopBgm(),u.EventManager.instance.emit(r.BACKGROUND_AUDIO_SWITCH_CHANGE))},enumerable:!1,configurable:!0}),t.prototype.setBgmVolume=function(t){h.basicsProxy.bgmVolume=t,cc.audioEngine.setMusicVolume(h.basicsProxy.bgmVolume),0===t?this.pauseBgm():this.isBgmPlaying()||this.resumeBgm()},t.prototype.playBgm=function(t,e){void 0===e&&(e=!0),this._isOpenBackgroundAudio&&(-1!==this._bgmId&&this.stopBgm(),this._bgmId=cc.audioEngine.playMusic(t,e))},t.prototype.playBgmPath=function(t,e,a){var i=this;void 0===e&&(e=void 0),void 0===a&&(a=!0);var o=(e||"")+t;this._bgmPath!=o&&(this._bgmPath=o,this._loading.push(o),p.ResUtil.loadAsset({bundleName:e,path:t,type:cc.AudioClip,success:function(t){var e=i._loading.indexOf(o);-1!==e&&(i._loading.splice(e,1),i.playBgm(t,a))}}))},t.prototype.isBgmPlaying=function(){return cc.audioEngine.isMusicPlaying()},t.prototype.resumeBgm=function(){this._isOpenBackgroundAudio&&cc.audioEngine.resumeMusic()},t.prototype.pauseBgm=function(){this._isOpenBackgroundAudio&&cc.audioEngine.pauseMusic()},t.prototype.stopBgm=function(){cc.audioEngine.stopMusic(),this._bgmId=-1},t.prototype.setEffectVolume=function(t){h.basicsProxy.effectVolume=t,cc.audioEngine.setEffectsVolume(h.basicsProxy.effectVolume),0===t&&this.stopAllEffect()},t.prototype.playEffect=function(t,e,a){if(void 0===e&&(e=!1),void 0===a&&(a=""),this._isOpenEffectAudio){if(0===h.basicsProxy.effectVolume)return-1;var i=cc.audioEngine.playEffect(t,e);return this._clips[t.name+a]=i,i}},t.prototype.playBattleEffect=function(t,e,a,i,o){void 0===e&&(e=c.Bundles.RES),void 0===a&&(a=!1),void 0===i&&(i=!1),void 0===o&&(o=""),this._isOpenBattleEffect&&this.playEffectPath(t,e,a,i,o)},t.prototype.playEffectPath=function(t,e,a,i,o){var n=this;if(void 0===e&&(e=c.Bundles.RES),void 0===a&&(a=!1),void 0===i&&(i=!1),void 0===o&&(o=""),"sounds/click"!=t&&"sounds/pop"!=t){if(l.battleDataProxy.audioFilterInfo[t]){if(l.battleDataProxy.audioFilterInfo[t].time>0)return}else l.battleDataProxy.audioFilterInfo[t]={time:0};l.battleDataProxy.audioFilterInfo[t].time=.2}var r=(e||"")+t;this._loading.push(r),p.ResUtil.loadAsset({path:t,bundleName:e,type:cc.AudioClip,success:function(t){a&&t.addRef();var e=n._loading.indexOf(r);if(-1!==e){n._loading.splice(e,1);var s=n.playEffect(t,i,o);a&&cc.audioEngine.setFinishCallback(s,function(){t.decRef()})}else a&&t.decRef()}})},t.prototype.playCourseSound=function(t,e,a){var i=this;void 0===e&&(e=c.Bundles.RES),p.ResUtil.loadAsset({path:t,bundleName:e,type:cc.AudioClip,success:function(t){var e=i.playEffect(t,!1);a&&a(e)}})},t.prototype.pauseEffect=function(t,e){void 0===e&&(e="");var a=this._clips[t+e];a&&cc.audioEngine.pauseEffect(a)},t.prototype.resumeEffect=function(t,e){void 0===e&&(e="");var a=this._clips[t+e];a&&cc.audioEngine.resumeEffect(a)},t.prototype.stopEffect=function(t,e){void 0===e&&(e="");var a=this._clips[t+e];a&&(cc.audioEngine.stopEffect(a),delete this._clips[t+e])},t.prototype.stopAllEffect=function(){for(var t in this._clips)if("draw"!=t){var e=this._clips[t];e&&(cc.audioEngine.stopEffect(e),delete this._clips[t])}},t._instance=null,t}();n.AudioManager=d,cc._RF.pop(),cc._RF.pop()},{}],AudioUtil:[function(t,e,a){"use strict";cc._RF.push(e,"0fc00ZEj69KKJ2svgazTiDy","AudioUtil");var i=t,o=e,n=a;cc._RF.push(o,"5be1cP57kpASIk3cMWNUMWX","AudioUtil"),Object.defineProperty(n,"__esModule",{value:!0}),n.audioUtil=n.AudioUtil=void 0;var r=i("AudioManager"),s=i("SqlUtil"),c=function(){function t(){this._vibrate=1,this._shockScreen=1}return Object.defineProperty(t.prototype,"vibrate",{get:function(){return this._vibrate},set:function(t){s.SqlUtil.set("vibrate",t),this._vibrate=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shockScreen",{get:function(){return this._shockScreen},set:function(t){s.SqlUtil.set("shockScreen",t),this._shockScreen=t},enumerable:!1,configurable:!0}),t.prototype.init=function(){this._vibrate=s.SqlUtil.get("vibrate",1),this._shockScreen=s.SqlUtil.get("shockScreen",1)},t.prototype.vibrateShort=function(){this.vibrate},t.prototype.vibrateLong=function(){this.vibrate},t.prototype.playBtnAudio=function(){r.AudioManager.instance.playEffectPath("sounds/click","Res")},t}();n.AudioUtil=c,n.audioUtil=new c,cc._RF.pop(),cc._RF.pop()},{}],BagBtnCtl:[function(t,e,a){"use strict";cc._RF.push(e,"a3ef7WrfnlAZ7BmXfwRwQho","BagBtnCtl");var i=t,o=e,n=a;cc._RF.push(o,"99434VxbAlDso+2zoYhBx6V","BagBtnCtl"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("EventManager"),s=i("PopupManager"),c=i("SceneManager"),l=i("AdsMgr"),u=i("HomeEnum"),p=i("DataManager"),h=i("MBGameDataProxy"),d=i("UserDataProxy"),m=i("Util"),f=i("GameUIManager"),_=cc._decorator,y=_.ccclass,g=(_.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onEnable=function(){this.updateView(),r.EventManager.instance.on(u.EHomeEvent.CHAPTER_SELECT,this.updateUnlock,this),r.EventManager.instance.on(u.EHomeEvent.UPDATE_MINI_BTN_VIEW,this.updateView,this)},e.prototype.onDisable=function(){r.EventManager.instance.off(u.EHomeEvent.CHAPTER_SELECT,this.updateUnlock,this),r.EventManager.instance.off(u.EHomeEvent.UPDATE_MINI_BTN_VIEW,this.updateView,this)},e.prototype.updateView=function(){p.DataManager.instance.isSubGameOpen(u.ESubGameSwitch.BAG)?(this.node.active=!0,this.updateUnlock()):this.node.active=!1},e.prototype.updateUnlock=function(){var t=Number(p.DataManager.instance.eData.datapara[1801].num);this.node.getChildByName("cdTime").active=!1,d.userDataProxy.userData.passChapter>=t?(this.updateTime(),m.default.setSpriteNormalMaterial(this.node.getChildByName("icon_wujing").getComponent(cc.Sprite))):m.default.setSpriteGrayMaterial(this.node.getChildByName("icon_wujing").getComponent(cc.Sprite)),this.node.getChildByName("txt").getComponent(cc.Label).string="\u80cc\u5305\u5927\u6218",this.node.getChildByName("tipLabel").active=d.userDataProxy.userData.passChapter<t,this.node.getChildByName("tipLabel").getComponent(cc.Label).string="\u901a\u8fc7\u7b2c"+t+"\u7ae0\u89e3\u9501"},e.prototype.updateTime=function(){var t=this,e=this.node.getChildByName("cdTime");e.active=!1;var a=h.mbGameDataProxy.btnStartTime;if(a>0){var i=6e4*Number(p.DataManager.instance.eData.datapara[1802].num),o=e.getComponent(cc.Label),n=m.default.getTimeLeftTime(a,i);o.string=m.default.formatTimeMS(n,3),this.schedule(function(){(n=m.default.getTimeLeftTime(a,i))<=0&&(t.unscheduleAllCallbacks(),h.mbGameDataProxy.btnStartTime=0,t.node.getChildByName("ad").active=!1,e.active=!1),o.string=m.default.formatTimeMS(n,3)},1),e.active=!0}else e.active=!1;this.node.getChildByName("ad").active=a>0},e.prototype.onEnterMiniGame=function(){var t=this,e=Number(p.DataManager.instance.eData.datapara[1801].num);d.userDataProxy.userData.passChapter>=e?h.mbGameDataProxy.btnStartTime>0?l.default.showVideoAds({id:1,eventId:"mb_game_enter",success:function(){t.enterGame()},fail:function(){},error:function(t){cc.log(t)}},!0):this.enterGame():f.gameUIMgr.showTips("\u7b2c"+e+"\u7ae0\u89e3\u9501!")},e.prototype.enterGame=function(){s.PopupManager.instance.removeAll(),c.SceneManager.instance.runScene("mb","res_MB")},__decorate([y],e)}(cc.Component));n.default=g,cc._RF.pop(),cc._RF.pop()},{}],BallCollisionEffect:[function(t,e,a){"use strict";cc._RF.push(e,"b67efhM7ehEm6X5njpu/ZvN","BallCollisionEffect");var i=t,o=e,n=a;cc._RF.push(o,"b9b7eoldbNCrp9Nc9vrjNAB","BallCollisionEffect"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("NodePoolManager"),s=cc._decorator,c=s.ccclass,l=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mSpine=null,e}return __extends(e,t),e.prototype.onLoad=function(){var t=this;this.mSpine.setCompleteListener(function(){r.default.instance.putNode(t.node)})},e.prototype.play=function(){this.mSpine.setAnimation(0,"animation",!1)},__decorate([l(sp.Skeleton)],e.prototype,"mSpine",void 0),__decorate([c],e)}(cc.Component);n.default=u,cc._RF.pop(),cc._RF.pop()},{}],BaseSimplyCollider:[function(t,e,a){"use strict";cc._RF.push(e,"f52dbxbPt5KZp5c5Z6CzEug","BaseSimplyCollider");var i=e,o=a;cc._RF.push(i,"704c4FfDNtCPY7OdBItAp/T","BaseSimplyCollider"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,r=n.ccclass,s=n.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isDrawCollider=!1,e.Tag=0,e.graphics=null,e}return __extends(e,t),e.prototype.start=function(){if(this.isDrawCollider){var t=new cc.Node("DrawNode");t.zIndex=cc.macro.MAX_ZINDEX,this.node.addChild(t),this.graphics=t.addComponent(cc.Graphics),this.graphics.lineWidth=5,this.graphics.strokeColor=cc.Color.RED,this.drawCollider()}},e.prototype.update=function(){this.isDrawCollider&&this.drawCollider()},e.prototype.drawCollider=function(){},Object.defineProperty(e.prototype,"tag",{get:function(){return this.Tag},enumerable:!1,configurable:!0}),__decorate([s()],e.prototype,"isDrawCollider",void 0),__decorate([s()],e.prototype,"Tag",void 0),__decorate([r],e)}(cc.Component);o.default=c,cc._RF.pop(),cc._RF.pop()},{}],BasicsProxy:[function(t,e,a){"use strict";cc._RF.push(e,"41463VQKeZA+Ljhbo7fZheF","BasicsProxy");var i=t,o=e,n=a;cc._RF.push(o,"9c617mt4UBDcapjvDn8yg23","BasicsProxy"),Object.defineProperty(n,"__esModule",{value:!0}),n.basicsProxy=void 0;var r=i("ProxyBase"),s=i("TimeUtil"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"bgmVolume",{get:function(){return this._data.bgm_volume},set:function(t){this._data.bgm_volume=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"effectVolume",{get:function(){return this._data.effect_volume},set:function(t){this._data.effect_volume=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"vibrateEnable",{get:function(){return this._data.vibrate_enable},set:function(t){this._data.vibrate_enable=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"followTime",{get:function(){return this._data.follow_time},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shortcutTime",{get:function(){return this._data.shortcut_time},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"favoriteGuideTime",{get:function(){return this._data.favorite_guide_time},enumerable:!1,configurable:!0}),e.prototype.addCustomAdNum=function(){this._data.custom_ad_num=(this._data.custom_ad_num||0)+1},e.prototype.saveSettings=function(){},e.prototype.getTodayNum=function(t){return this._checkSameDay(),this._data.today_num[t]||0},e.prototype._checkSameDay=function(){var t=s.TimeUtil.getTime();if(!s.TimeUtil.isSameDay(t,this._data.sync_time)){for(var e in this._data.today_num)this._data.today_num[e]=0;this._data.sync_time=t}},e}(r.ProxyBase);n.basicsProxy=new c(function(){this.bgm_volume=1,this.effect_volume=1,this.vibrate_enable=!0,this.follow_time=0,this.shortcut_time=0,this.favorite_guide_time=0,this.rv_sum=0,this.rv_list="",this.custom_ad_num=0,this.today_num={},this.sync_time=0,this.push_id=null,this.push_open_time=0}),cc._RF.pop(),cc._RF.pop()},{}],BattleBaseInfoView:[function(t,e,a){"use strict";cc._RF.push(e,"46c16IE6TtFQboWOhFksDln","BattleBaseInfoView");var i=t,o=e,n=a;cc._RF.push(o,"dec83rxS/5EZr7ObLKzUOyH","BattleBaseInfoView"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("EventManager"),s=i("GameEnum"),c=i("DataManager"),l=i("BattleDataProxy"),u=i("UserDataProxy"),p=i("GameUIManager"),h=cc._decorator,d=h.ccclass,m=h.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mSunshineNum=null,e.mTips=null,e.mWaveProgressBar=null,e.mExpProgressBar=null,e.mWaveBlock=null,e.mWaveLab=null,e.mVideoCardNum=null,e.mBossTips=null,e.mFinishTips=null,e._endlessMaxLv=0,e}return __extends(e,t),e.prototype.initBattleBaseInfoView=function(){r.EventManager.instance.on(l.EBattleEvent.UPDATE_SUNSHINE,this.updateSunshine,this),r.EventManager.instance.on(l.EBattleEvent.UPDATE_EXP,this.updateExp,this),r.EventManager.instance.on(l.EBattleEvent.SHOW_BOSS_TIPS,this.showBossTips,this),r.EventManager.instance.on(u.EUserDataEvent.UPDATE_VIDEO_CARD,this.updateVideoCardNum,this),r.EventManager.instance.on(l.EBattleEvent.REMOVE_ENEMY,this.removeEnemy,this),r.EventManager.instance.on(l.EBattleEvent.GM_SET_ENDLESS_WAVE,this.passWave,this),l.battleDataProxy.sunshineRoot=this.mSunshineNum.node.parent,this._endlessMaxLv=Number(c.DataManager.instance.eData.datapara[1002].num),this.updateSunshine(),this.updateVideoCardNum(),this.setTipsIsShow(!0),this.seBattleUiIsShow(!1),this.passWave(),this.updateExp(0)},e.prototype.onDestroy=function(){r.EventManager.instance.off(l.EBattleEvent.UPDATE_SUNSHINE,this.updateSunshine,this),r.EventManager.instance.off(l.EBattleEvent.UPDATE_EXP,this.updateExp,this),r.EventManager.instance.off(l.EBattleEvent.SHOW_BOSS_TIPS,this.showBossTips,this),r.EventManager.instance.off(u.EUserDataEvent.UPDATE_VIDEO_CARD,this.updateVideoCardNum,this),r.EventManager.instance.off(l.EBattleEvent.REMOVE_ENEMY,this.removeEnemy,this),r.EventManager.instance.off(l.EBattleEvent.GM_SET_ENDLESS_WAVE,this.passWave,this)},e.prototype.removeEnemy=function(){l.battleDataProxy.waveResidueNum--,this.mWaveProgressBar.fillRange=1-l.battleDataProxy.waveResidueNum/l.battleDataProxy.waveEnemyNum;var t=-this.mWaveBlock.parent.width/2+this.mWaveBlock.parent.width*this.mWaveProgressBar.fillRange;this.mWaveBlock.position=cc.v3(t,0)},e.prototype.showBossTips=function(){var t=this;this.mBossTips.active=!0,this.mBossTips.scale=1,cc.Tween.stopAllByTarget(this.mBossTips);var e=cc.tween(this.mBossTips).to(.3,{scale:1.3}).to(.3,{scale:1});cc.tween(this.mBossTips).repeat(3,e).call(function(){t.mBossTips.active=!1}).start()},e.prototype.passWave=function(){if(l.battleDataProxy.isEndless)this.mWaveLab.string="\u6ce2\u6b21\uff1a"+l.battleDataProxy.endlessCurWave;else if(l.battleDataProxy.weatherType!=s.WeatherType.NONE){var t=u.userDataProxy.userData.curWeatherWave;this.mWaveLab.string="\u6ce2\u6b21\uff1a"+t+"/20"}else{var e=u.userDataProxy.userData.curChapter,a=l.battleDataProxy.getStageRewardCfg(e),i=(t=u.userDataProxy.userData.curWave,Number(a.wave));this.mWaveLab.string="\u6ce2\u6b21\uff1a"+t+"/"+i}},e.prototype.updateVideoCardNum=function(){this.mVideoCardNum.string=""+u.userDataProxy.getProp(4)},e.prototype.updateSunshine=function(){this.mSunshineNum.string=""+l.battleDataProxy.sunshineNum},e.prototype.onTestSunshine=function(){var t=l.battleDataProxy.sunshineNum;t+=100,l.battleDataProxy.sunshineNum=t},e.prototype.setTipsIsShow=function(t){if(this.mTips.active=t,t)if(l.battleDataProxy.isEndless)this.mFinishTips.string="\u5df2\u5b8c\u6210\uff1a"+(l.battleDataProxy.endlessCurWave-1);else if(l.battleDataProxy.weatherType!=s.WeatherType.NONE){var e=u.userDataProxy.userData.curWeatherWave;this.mFinishTips.string="\u5df2\u5b8c\u6210\uff1a"+(e-1)+"/20"}else{var a=u.userDataProxy.userData.curChapter,i=l.battleDataProxy.getStageRewardCfg(a),o=Number(i.wave);this.mFinishTips.string="\u5df2\u5b8c\u6210\uff1a"+(u.userDataProxy.userData.curWave-1)+"/"+o}},e.prototype.seBattleUiIsShow=function(t){this.mWaveProgressBar.node.parent.active=t,l.battleDataProxy.isEndless?this.mExpProgressBar.node.parent.active=!1:this.mExpProgressBar.node.parent.active=t},e.prototype.updateExp=function(t){var e=l.battleDataProxy.battleData.expLevel;if(!l.battleDataProxy.isEndless){var a=l.battleDataProxy.battleData.expNum;a+=t,l.battleDataProxy.battleData.expNum=a;var i=c.DataManager.instance.eData.datalevel[e];if(i){var o=i.exp;if(l.battleDataProxy.battleData.expNum>=o){l.battleDataProxy.battleData.expNum-=o,l.battleDataProxy.battleData.expLevel++;var n=c.DataManager.instance.eData.datalevel[l.battleDataProxy.battleData.expLevel];if(!n)return console.log("\u6ee1\u7ea7\u4e86"),void(this.mExpProgressBar.fillRange=1);o=n.exp;var r=l.battleDataProxy.getSkillList();r&&r.length>0?(p.gameUIMgr.showSelectSkillPopup(),l.battleDataProxy.gameState=s.GameState.PAUSE):console.log("\u6ca1\u6280\u80fd\u4e86\uff0c\u4e0d\u5f39\u7a97")}this.mExpProgressBar.fillRange=l.battleDataProxy.battleData.expNum/o}else this.mExpProgressBar.fillRange=1}},__decorate([m(cc.Label)],e.prototype,"mSunshineNum",void 0),__decorate([m(cc.Node)],e.prototype,"mTips",void 0),__decorate([m(cc.Sprite)],e.prototype,"mWaveProgressBar",void 0),__decorate([m(cc.Sprite)],e.prototype,"mExpProgressBar",void 0),__decorate([m(cc.Node)],e.prototype,"mWaveBlock",void 0),__decorate([m(cc.Label)],e.prototype,"mWaveLab",void 0),__decorate([m(cc.Label)],e.prototype,"mVideoCardNum",void 0),__decorate([m(cc.Node)],e.prototype,"mBossTips",void 0),__decorate([m(cc.Label)],e.prototype,"mFinishTips",void 0),__decorate([d],e)}(cc.Component);n.default=f,cc._RF.pop(),cc._RF.pop()},{}],BattleDataProxy:[function(t,e,a){"use strict";cc._RF.push(e,"f07d3ng6x1M3Iq/IrIs2WIB","BattleDataProxy");var i=t,o=e,n=a;cc._RF.push(o,"465f1jj1AVFAbMqzpukot1V","BattleDataProxy"),Object.defineProperty(n,"__esModule",{value:!0}),n.battleDataProxy=n.BattleData=n.EBattleEvent=n.BlockSize=n.TreeSize=void 0;var r,s=i("GameUIManager"),c=i("AnimationMgr"),l=i("SkillDataMgr"),u=i("ProxyBase"),p=i("EventManager"),h=i("HttpRequest"),d=i("MathUtil"),m=i("ResUtil"),f=i("SqlUtil"),_=i("FlyItemAnimCtrl2"),y=i("GameEnum"),g=i("HomeEnum"),v=i("DataManager"),P=i("UserDataProxy");n.TreeSize=100,n.BlockSize=512,function(t){t.SELECT_SKILL="SELECT_SKILL",t.REMOVE_ENEMY="REMOVE_ENEMY",t.PASS_WAVE="PASS_WAVE",t.UPDATE_SUNSHINE="UPDATE_SUNSHINE",t.UPDATE_EXP="UPDATE_EXP",t.UPDATE_HOUSE_HP="UPDATE_HOUSE_HP",t.RESURGENCE="RESURGENCE",t.GM_ADD_EQUIP="GM_ADD_EQUIP",t.SHOW_BOSS_TIPS="SHOW_BOSS_TIPS",t.GM_ADD_ENEMY="GM_ADD_ENEMY",t.SELECT_SUPER_PLANT="SELECT_SUPER_PLANT",t.UPDATE_SUPER_STATE="UPDATE_SUPER_STATE",t.GM_ADD_FIXEDPLANT="GM_ADD_FIXEDPLANT",t.GM_ADD_BALL="GM_ADD_BALL",t.RESUME_BALL="RESUME_BALL",t.CLEAN_BOSS_BALL="CLEAN_BOSS_BALL",t.UPDATE_SUPER_PLANT_NUM="UPDATE_SUPER_PLANT_NUM",t.MAP_BLOCK_DESTROY="MAP_BLOCK_DESTROY",t.LOSE_COURSE_VIEW="LOSE_COURSE_VIEW",t.ACTIVE_FRENZY="ACTIVE_FRENZY",t.SELECT_SKILL_FINISH="SELECT_SKILL_FINISH",t.GM_SET_ENDLESS_WAVE="GM_SET_ENDLESS_WAVE"}(r=n.EBattleEvent||(n.EBattleEvent={}));var b=function(){this.ownSkillList=[],this.houseHp=0,this.houseMaxHp=0,this.sunshineNum=0,this.expNum=0,this.expLevel=1,this.refreshNum=0,this.getAllNum=0,this.reviveNum=0,this.ballNum=1,this.superPlantId=0,this.battleChapter=0,this.battleWave=0};n.BattleData=b;var D=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.uiCamera=null,e.gameCamera=null,e.battleView=null,e.pathPointView=null,e.blackHoleView=null,e.blockLayout=null,e.excludeCollisionView=null,e.iceView=null,e.waterView=null,e.mTopUI=null,e.numberView=null,e.equipRoot=null,e.top1=null,e.gameUI=null,e.blackHoleNodes=[],e.audioFilterInfo={},e._gameState=y.GameState.NONE,e._gameSpeed=1,e.mapTree={},e.enemyMovePaths=[],e.enemyNodes=[],e.stageInfo=null,e.weatherStageInfo=null,e.pathRatios=[],e.bulletBalls=[],e.house=null,e.houseBaseHp=0,e.baseSunshine=0,e.plantRefreshPrice=0,e.plantPriceRate=[],e.recyclePriceRate=[],e.isStartFight=!1,e.isDad=!1,e.sunshineRoot=null,e.waveEnemyNum=0,e.waveResidueNum=0,e.isActiveSuperPlant=!1,e.superPlantNum=0,e.pathWalls=[],e.fixedPlantAtkRate=0,e.nutWalNodes=[],e.gridsMap=new Map,e.wateringCart=null,e.bossSkillBall=[],e.enemyDetailsIds=[],e.bossSkillCourseIds=[],e.mapBlockNum=0,e.testBlock=!1,e.isGameLose=!1,e.firstPlayChapter=[],e.successLv=[],e.isActiveFrenzy=!1,e.superFrameDatas=[],e.topSuperId=0,e.soundWaveTime=0,e.isEndless=!1,e.endlessCurWave=1,e.endlessVideoSunNum=0,e.endlessSelectSkillNum=0,e.endlessIsDad=!1,e.enemyAirship=[],e.airshipSoldier=[],e.priestZombie=[],e.enemyPathIce=[],e.weatherType=y.WeatherType.NONE,e.weatherHeavyFog=null,e.bulletView=null,e}return __extends(e,t),Object.defineProperty(e.prototype,"battleData",{get:function(){return this._data},set:function(t){this._data=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gameSpeed",{get:function(){return this._gameSpeed},set:function(t){this._gameSpeed=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gameState",{get:function(){return this._gameState},set:function(t){this._gameState=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sunshineNum",{get:function(){return this.battleData.sunshineNum},set:function(t){this.battleData.sunshineNum=t,p.EventManager.instance.emit(r.UPDATE_SUNSHINE)},enumerable:!1,configurable:!0}),e.prototype.resetData=function(){this._data=new b,f.SqlUtil.setLocalUserData("BattleData",""),f.SqlUtil.setLocalUserData("BattlePlantData","")},e.prototype.loadSuperFrameDatas=function(t){var e=this;this.superFrameDatas.length=0;for(var a=P.userDataProxy.userData.combatEqus,i=0,o=function(o){var n=a[o];m.ResUtil.loadAsset({path:"textures/superBigImg/pic_CWplant"+n,type:cc.SpriteFrame,bundleName:g.Bundles.GAME}).then(function(o){e.superFrameDatas.push({frame:o,plantId:n}),++i>=a.length&&t&&t()}).catch(function(t){console.log("error:",t)})},n=0;n<a.length;++n)o(n)},e.prototype.getBulletPathPoints=function(t){for(var e=null,a=this.pathPointView.children,i=1e4,o=0,n=[],r=0;r<a.length;++r){var s=a[r],c=d.MathUtil.distance(s.position,t);c<i&&(o=r,i=c,e=s)}return n.push(e),0==o?(n.push(a[1]),n.push(a[2])):o>=a.length-1?(n.push(a[a.length-2]),n.push(a[a.length-3])):(n.push(a[o-1]),n.push(a[o+1])),n},e.prototype.getBulletPathPointsEx=function(t){for(var e=this.pathPointView.children,a=1e4,i=0,o=[],n=0;n<e.length;++n){var r=e[n],s=d.MathUtil.distance(r.position,t);s<a&&(i=n,a=s)}return o.push(e[i]),i<=1?(o.push(e[1+i]),o.push(e[2+i])):(o.push(e[i-1]),o.push(e[i-2])),o},e.prototype.getEnemyPathPoint=function(t){for(var e=null,a=this.pathPointView.children,i=1e4,o=0,n=0;n<a.length;++n){var r=a[n],s=d.MathUtil.distance(r.position,t);s<i&&(o=n,i=s,e=r)}return{nearestPoint:e,nearestIdx:o}},e.prototype.setEnemyMovePaths=function(t){n.battleDataProxy.enemyMovePaths=[];for(var e=0;e<t.length;++e)n.battleDataProxy.enemyMovePaths[e]=t[e].children;this.pathRatios.length=0;var a=this.getPathDis(2);for(e=0;e<n.battleDataProxy.enemyMovePaths.length;++e){var i=a/this.getPathDis(e);this.pathRatios.push(i)}},e.prototype.getPathDis=function(t){for(var e=0,a=n.battleDataProxy.enemyMovePaths[t][0].position,i=1;i<n.battleDataProxy.enemyMovePaths[t].length;++i){var o=n.battleDataProxy.enemyMovePaths[t][i];e+=d.MathUtil.distance(a,o.position)}return e},e.prototype.removeEnemyNode=function(t){for(var e=0;e<this.enemyNodes.length;++e)if(this.enemyNodes[e]==t){this.enemyNodes.splice(e,1);break}p.EventManager.instance.emit(r.REMOVE_ENEMY,t)},e.prototype.getEnemyMovePaths=function(t){void 0===t&&(t=1);var e=1;return 1==t&&(e=this.enemyNodes.length%3),{movePath:this.enemyMovePaths[e],idx:e}},e.prototype.getEndlessEnemyMovePaths=function(t,e){void 0===e&&(e=1);var a=1;return 1==e&&(a=this.enemyNodes.length%3),t||(a+=3),{movePath:this.enemyMovePaths[a],idx:a}},e.prototype.getPathPos=function(t,e){return n.battleDataProxy.enemyMovePaths[t][e].position},e.prototype.getPlantAtkTargets=function(t,e,a,i,o){var n,r=this;if(a)return[this.house];if(this.enemyNodes.length<=0)return[];if(107==e&&this.enemyAirship.length>0)return this.enemyAirship;if(this.airshipSoldier.length>0){for(var s=[],c=0;c<this.airshipSoldier.length;++c){var l=this.airshipSoldier[c];l&&l.isValid?(null===(n=l.getComponent("EnemyBase"))||void 0===n?void 0:n.getIsCanChoose(e))&&s.push(l):this.airshipSoldier.splice(c--,1)}if(s.length>0)return s}var u=[];if(o)for(c=0;c<this.enemyNodes.length;++c)(p=this.enemyNodes[c])&&p.isValid&&p.getComponent("EnemyBase").isTop==i&&u.push(p);else for(c=0;c<this.enemyNodes.length;++c){var p;(p=this.enemyNodes[c])&&p.isValid&&u.push(p)}u.sort(function(t,e){var a,i,o,n,s=null===(a=t.getComponent("EnemyBase"))||void 0===a?void 0:a.moveDis,c=null===(i=t.getComponent("EnemyBase"))||void 0===i?void 0:i.pathIdx,l=null===(o=e.getComponent("EnemyBase"))||void 0===o?void 0:o.moveDis,u=null===(n=e.getComponent("EnemyBase"))||void 0===n?void 0:n.pathIdx,p=s*r.pathRatios[c];return l*r.pathRatios[u]-p});var h=[];for(c=0;c<u.length;++c){var d=u[c];if(!d||!d.isValid)break;var m=null==d?void 0:d.parent;if(m&&m.isValid&&!(d.x>d.parent.width/2-50)&&d.getComponent("EnemyBase").getIsCanChoose(e)&&(d.getComponent("EnemyBase").moveDis>70&&h.push(d),h.length>=t))break}return this.wateringCart&&h.indexOf(this.wateringCart)<0&&h.unshift(this.wateringCart),h},e.prototype.getEnemyById=function(t){var e=this.enemyNodes.findIndex(function(e){return e.getComponent("EnemyBase").monsterCfg.id==t});return e<0?null:this.enemyNodes[e]},e.prototype.initData=function(){},e.prototype.saveData=function(){},e.prototype.loadBattleData=function(){return f.SqlUtil.getLocalUserData("BattleData","")},e.prototype.saveBattlePlantData=function(t){this.isEndless||f.SqlUtil.setLocalUserData("BattlePlantData",t)},e.prototype.loadBattlePlantData=function(){return f.SqlUtil.getLocalUserData("BattlePlantData","")+""},e.prototype.saveEnemyDetailsIds=function(){f.SqlUtil.setLocalUserData("EnemyDetailsIds",JSON.stringify(this.enemyDetailsIds))},e.prototype.loadEnemyDetailsIds=function(){var t=f.SqlUtil.getLocalUserData("EnemyDetailsIds","");""!=t&&(this.enemyDetailsIds=JSON.parse(t+""))},e.prototype.saveBossSkillCourseIds=function(){f.SqlUtil.setLocalUserData("bossSkillCourseIds",JSON.stringify(this.bossSkillCourseIds))},e.prototype.loadBossSkillCourseIds=function(){var t=f.SqlUtil.getLocalUserData("bossSkillCourseIds","");""!=t&&(this.bossSkillCourseIds=JSON.parse(t+""))},e.prototype.saveFirstPlayChapter=function(){f.SqlUtil.setLocalUserData("FirstPlayChapter",JSON.stringify(this.firstPlayChapter))},e.prototype.loadFirstPlayChapter=function(){var t=f.SqlUtil.getLocalUserData("FirstPlayChapter","");""!=t&&(this.firstPlayChapter=JSON.parse(t+""))},e.prototype.pushFirstPlayChapter=function(){var t=P.userDataProxy.userData.curChapter,e=P.userDataProxy.userData.curWave,a=t+"_"+e;this.firstPlayChapter.indexOf(a)<0&&(this.firstPlayChapter.push(a),mm.platform.umaTrackEvent("lv",{userA:"start_lv_"+t+"_"+e}),this.saveFirstPlayChapter())},e.prototype.loadSuccessLv=function(){var t=f.SqlUtil.getLocalUserData("SuccessLv","");""!=t&&(this.successLv=JSON.parse(t+""))},e.prototype.pushSuccessLv=function(){var t=P.userDataProxy.userData.curChapter,e=P.userDataProxy.userData.curWave,a=t+"_"+e;this.successLv.indexOf(a)<0&&(this.successLv.push(a),mm.platform.umaTrackEvent("lv",{userA:"success_lv_"+t+"_"+e}),f.SqlUtil.setLocalUserData("SuccessLv",JSON.stringify(this.successLv)))},e.prototype.enterGame=function(){this.bulletBalls=[],this.isEndless?this.baseSunshine=Number(v.DataManager.instance.eData.datapara[1016].num):this.baseSunshine=Number(v.DataManager.instance.eData.datapara[42].num),this.plantRefreshPrice=Number(v.DataManager.instance.eData.datapara[26].num),this.plantPriceRate=v.DataManager.instance.eData.datapara[64].num.split("|").map(Number),this.recyclePriceRate=v.DataManager.instance.eData.datapara[63].num.split("|").map(Number),this.houseBaseHp=Number(v.DataManager.instance.eData.datapara[31].num),this.loadEnemyDetailsIds(),this.loadBossSkillCourseIds(),this.loadFirstPlayChapter(),this.loadSuccessLv(),this.battleData.houseHp=this.battleData.houseMaxHp=this.houseBaseHp,l.default.instance.removeSkillInfo(),this.battleData.ownSkillList=[],this.sunshineNum=this.baseSunshine,this.battleData.expNum=0,this.battleData.expLevel=1,this.battleData.refreshNum=0,this.battleData.getAllNum=0,this.battleData.reviveNum=0,this.battleData.ballNum=1},e.prototype.clearData=function(){this.battleData.ownSkillList=[],this.battleData.houseHp=0,this.battleData.houseMaxHp=0,this.battleData.sunshineNum=0,this.battleData.expNum=0,this.battleData.expLevel=1,this.battleData.refreshNum=0,this.battleData.getAllNum=0,this.battleData.reviveNum=0,this.battleData.ballNum=1,this.battleData.battleChapter=0,this.battleData.battleWave=0,this.enemyNodes=[],this.equipRoot=null,this.battleData.superPlantId=0,this.isActiveSuperPlant=!1,this.superPlantNum=0,this.isStartFight=!1,this.fixedPlantAtkRate=0,this.nutWalNodes.length=0,this.wateringCart=null,this.bossSkillBall=[],this.blackHoleNodes=[],this.mapBlockNum=0,this.testBlock=!1,this.isActiveFrenzy=!1,this.soundWaveTime=0,this.endlessCurWave=1,l.default.instance.removeSkillInfo(),this.endlessVideoSunNum=Number(v.DataManager.instance.eData.datapara[1007].num),this.endlessSelectSkillNum=3,this.enemyAirship=[],this.airshipSoldier=[],this.priestZombie=[],this.enemyPathIce=[],n.battleDataProxy.saveBattlePlantData(""),n.battleDataProxy.saveData("")},e.prototype.setVideoCardIcon=function(t,e,a){void 0===e&&(e=1),void 0===a&&(a=1);var i=P.userDataProxy.getProp(4),o=a,n="";i>0?(n="textures/item/icon_4",o=.5*a):n="textures/public/pic_AD_"+e,m.ResUtil.loadAsset({path:n,type:cc.SpriteFrame,bundleName:g.Bundles.GAME}).then(function(e){t&&t.isValid&&(t.getComponent(cc.Sprite).spriteFrame=e,t.scale=o)}).catch(function(t){console.log("error:",t)})},e.prototype.getPlantRefreshPrice=function(){return this.plantRefreshPrice},e.prototype.getPlantPrice=function(t,e){e>=this.plantPriceRate.length&&(e=this.plantPriceRate.length-1);var a=v.DataManager.instance.eData.dataplant[t].cost;return Math.floor(a*this.plantPriceRate[e-1])},e.prototype.getRecyclePlantPrice=function(t,e){var a=v.DataManager.instance.eData.dataplant[t].cost;return Math.floor(a*this.recyclePriceRate[e-1])},e.prototype.getWaveSunshineNum=function(t){var e=0;if(this.isEndless)e=Number(v.DataManager.instance.eData.datapara[1003].num);else if(this.weatherType!=y.WeatherType.NONE){var a=P.userDataProxy.userData.cursWeatherChapter;e=v.DataManager.instance.eData.data_weather[a].waveGold}else e=this.getStageRewardCfg().stone.split("|").map(Number)[t-1];return l.default.instance.getSkillProperty(48,0)+e},e.prototype.updateHouseHp=function(t){if(!(this.battleData.houseHp<=0||this.isDad||this.endlessIsDad||t.num<0&&(this.enemyNodes.length<=0||!this.isStartFight))){t.num=Math.floor(t.num),isNaN(t.num)&&(t.num=1),this.battleData.houseHp+=t.num,t.num<0?this.battleData.houseHp<0&&(this.battleData.houseHp=0):this.battleData.houseHp>this.battleData.houseMaxHp&&(this.battleData.houseHp=this.battleData.houseMaxHp),isNaN(this.battleData.houseHp)&&(this.battleData.houseHp=10);var e=P.userDataProxy.userData.curChapter;if(1==e&&this.battleData.houseHp<=10&&(this.battleData.houseHp=0),this.battleData.houseHp<=0){if(n.battleDataProxy.gameState=y.GameState.OVER,n.battleDataProxy.isEndless)return void s.gameUIMgr.showEndlessOverPopup();var a=P.userDataProxy.userData.curWave;mm.platform.umaTrackEvent("lv",{userA:"fail_lv_"+e+"_"+a}),this.battleData.reviveNum<=2?(console.log("\u5f39\u590d\u6d3b\u754c\u9762"),this.battleData.reviveNum++,s.gameUIMgr.showGameRevivePopup()):(console.log("\u5f39\u5931\u8d25\u7ed3\u7b97\u754c\u9762"),s.gameUIMgr.showGameLosePopup())}p.EventManager.instance.emit(r.UPDATE_HOUSE_HP,t.num)}},e.prototype.insertMap=function(){return""},e.prototype.getMapItemByKey=function(){},e.prototype.removeMapItem=function(){},e.prototype.getGameSpd=function(){return cc.director.getScheduler().getTimeScale()},e.prototype.getSkillAttribute=function(t){return v.DataManager.instance.eData.dataskill[t].attribute.split("_").map(Number)},e.prototype.selectSkill=function(t,e){var a=this._data.ownSkillList.findIndex(function(e){return e.id==t});if(-1==a){var i={id:t,count:1};this._data.ownSkillList.push(i)}else this._data.ownSkillList[a].count++;if(6001==t){var o=this.getSkillAttribute(t),s=this.sunshineNum;if(s+=o[1],this.sunshineNum=s,e){var u=n.battleDataProxy.sunshineRoot,h=this.battleView.convertToNodeSpaceAR(u.parent.convertToWorldSpaceAR(u.position)),d=n.battleDataProxy.gameCamera;c.default.instance.showAwardAni({id:8,num:o[1]},this.battleView,e,0,h.addSelf(d.position))}}else if(1001==t||1002==t){o=this.getSkillAttribute(t);var m=this.battleData.houseMaxHp,f=Math.floor(m*o[1]);this.battleData.houseMaxHp=m+f,this.updateHouseHp({isCirt:!1,num:f})}else 4001==t&&(o=this.getSkillAttribute(t),m=this.battleData.houseMaxHp,f=Math.floor(m*o[1]),this.updateHouseHp({isCirt:!1,num:f}));l.default.instance.pushSkillInfo(t),p.EventManager.instance.emit(r.SELECT_SKILL,t),this.saveData()},e.prototype.flyMoneyIcon=function(t,e,a){var i="textures/public/icon_zuanshi";t==_.E_ItemIDType.Star?i="textures/public/icon_xingyaoshi":t==_.E_ItemIDType.GOLD&&(i="textures/public/icon_jingbi");var o={itemId:t,itemNum:e,startWorldPos:a.convertToWorldSpaceAR(cc.v2(0,0)),onComplete:null,iconPath:i,iconScale:.9};p.EventManager.instance.emit(_.EFlyItemAnimEvent.FLY_ITEM_ANIM,o)},e.prototype.checkHasSkill=function(t){var e=this._data.ownSkillList.find(function(e){return e.id==t}),a=v.DataManager.instance.eData.dataskill[(null==e?void 0:e.id)||0];return a?{skillData:a,count:e.count}:null},e.prototype.getEachEquipCountInfo=function(){for(var t,e,a={},i=0;i<(null===(e=null===(t=this.equipRoot)||void 0===t?void 0:t.children)||void 0===e?void 0:e.length);++i){var o=this.equipRoot.children[i],n=o.getComponent("EquipmentItem").equipId;a[n]||(a[n]=[]);var r={level:o.getComponent("EquipmentItem").level};a[n].push(r)}return a},e.prototype.getBulletHarm=function(t,e,a,i,o,n,r,s){var c,u,p=this.getPlantAtk(e,a);this.weatherType==y.WeatherType.Night&&(3==e||10==e?10==e?this.getIsSuperPlant(10)&&(p*=1.5):p*=1.5:p*=.5),s&&(p*=l.default.instance.getSkillProperty(14,e));var h=l.default.instance.getSkillProperty(10,e),d=5,m=(null===(c=this.checkHasSkill(30001))||void 0===c?void 0:c.skillData)||null;m&&(d=m.maxNum+1),(null===(u=this.checkHasSkill(30004))||void 0===u?void 0:u.skillData)&&(d=m.maxNum+1),o>d&&(o=d),p*=1+h*(o-1);var f=this.getIsCrit(e,i);return f&&(p*=this.getCritMultiple(e)),1!=t&&(p*=1+this.getHitBossHarm(e)),p*=n,p*=r,{isCrit:f,num:Math.ceil(p)}},e.prototype.getFixedPlantBulletHarm=function(t,e,a){return 2==e&&(t*=1+this.getHitBossHarm(0)),t*=a,{isCrit:!1,num:Math.ceil(t)}},e.prototype.getPlantAtk=function(t,e,a){var i=v.DataManager.instance.eData.dataplant[t];a||(a=P.userDataProxy.getPlantData(t).lv);var o=i.atack.split("|").map(Number)[a-1];if(!o)return 0;var n=i.growup.split("|").map(Number)[e-1],r=l.default.instance.getSkillProperty(2,t),s=o*(1+(r+=this.getPlantShiftAttack()))*n;return Math.floor(s)},e.prototype.getPlantShiftAttack=function(){if(!this.equipRoot||!this.equipRoot.isValid)return 0;var t=this.equipRoot.childrenCount;return l.default.instance.getSkillProperty(42,0)*t},e.prototype.getCatapultNumber=function(t){return l.default.instance.getSkillProperty(20,t)},e.prototype.getAtkTargetNum=function(t){return 1+l.default.instance.getSkillProperty(21,t)},e.prototype.getBulletNum=function(t,e){var a=99999999999,i=this.checkHasSkill(50001);if(i&&i.skillData.equipId==e){a=i.skillData.needTime;var o=this.checkHasSkill(50004);o&&(a=o.skillData.needTime)}return t%a==0?i?1+i.skillData.attribute.split("_").map(Number)[1]:1+l.default.instance.getSkillProperty(22,e):1},e.prototype.getFireNum=function(t){return 1+l.default.instance.getSkillProperty(18,t)},e.prototype.getCritProb=function(t){return 0+l.default.instance.getSkillProperty(11,t)},e.prototype.getCritMultiple=function(t){return 2+l.default.instance.getSkillProperty(12,t)},e.prototype.getIsCrit=function(t,e){var a=this.getCertainlyCritNum(t);if(a>0&&e%(a+1)==0)return!0;var i=this.getCritProb(t);return Math.floor(1e3*Math.random())%100<100*i},e.prototype.getCertainlyCritNum=function(t){var e=-1;if(12==t){var a=this.checkHasSkill(120001),i=this.checkHasSkill(120002);a&&(e=v.DataManager.instance.eData.dataskill[120001].needTime),i&&(e-=v.DataManager.instance.eData.dataskill[120002].needTime)}return e},e.prototype.getHitBossHarm=function(t){return 0+l.default.instance.getSkillProperty(36,t)},e.prototype.getIsSuperPlant=function(t){return!!this.isActiveSuperPlant&&t==this.battleData.superPlantId},e.prototype.getSuperPlantNum=function(){var t;if(!this.equipRoot)return 0;for(var e=0,a=0;a<(null===(t=this.equipRoot.children)||void 0===t?void 0:t.length);++a)this.equipRoot.children[a].getComponent("EquipmentItem").getComponent("EquipmentItem").mEquipId==n.battleDataProxy.battleData.superPlantId&&e++;return e},e.prototype.getSkillList=function(){var t=[];if(P.userDataProxy.userData.gameCourseData.curId<=3&&1==P.userDataProxy.userData.curChapter&&1==P.userDataProxy.userData.curWave)return t.push(v.DataManager.instance.eData.dataskill[4001]),t.push(v.DataManager.instance.eData.dataskill[5001]),t.push(v.DataManager.instance.eData.dataskill[30001]),t;var e=v.DataManager.instance.eData.dataskill;for(var a in e)(o=e[a]).id%1e4!=5&&1==o.use&&(o.equipId?P.userDataProxy.combatEqus.indexOf(o.equipId)>-1&&P.userDataProxy.getPlantData(o.equipId).lv>=o.equipLevel&&o.Weight>0&&t.push(o):t.push(o));for(var i=t.length-1;i>=0;i--)(o=t[i]).frontSkill&&(n.battleDataProxy.checkHasSkill(o.frontSkill)||t.splice(i,1));for(i=t.length-1;i>=0;i--){var o;(o=t[i]).repeat||n.battleDataProxy.checkHasSkill(o.id)&&t.splice(i,1)}return t},e.prototype.getIsCheckCollision=function(t){return!(this.excludeCollisionView&&this.excludeCollisionView.isValid&&(!t||!t.isValid||this.excludeCollisionView.getBoundingBox().contains(t.getPosition())))},e.prototype.uploadEndlessResult=function(t){var e="endless";v.DataManager.instance.getIsZbRank()&&(e="endlessZB");var a=P.userDataProxy.userData.endlessData.maxWave;this.endlessCurWave>a&&(P.userDataProxy.userData.endlessData.maxWave=a);var i={key:e,sort:0,value:n.battleDataProxy.endlessCurWave},o=JSON.stringify({params:h.HttpRequest.inst.encryptStr(JSON.stringify(i))});h.HttpRequest.inst.request("POST","/rank/update",o).then(function(e){console.log("\u4e0a\u4f20\u6210\u7ee9\u6210\u529f:",e),t&&t(!0)}).catch(function(e){console.error("\u4e0a\u4f20\u6210\u7ee9\u5931\u8d25\uff1a",e),t&&t(!1)})},e.prototype.getEndlessRankDatas=function(t){var e="endless";v.DataManager.instance.getIsZbRank()&&(e="endlessZB");var a={key:e},i=JSON.stringify({params:h.HttpRequest.inst.encryptStr(JSON.stringify(a))});h.HttpRequest.inst.request("POST","/rank/list",i).then(function(e){if(t&&t(e),200==e.code){console.log("res:",e);var a=e.data.myRank;a&&(P.userDataProxy.userData.endlessData.myRank=a.rank)}}).catch(function(t){console.error("\u83b7\u53d6\u6392\u884c\u699c\u5931\u8d25\uff1a",t)})},e.prototype.getStageRewardCfg=function(t){t||(t=P.userDataProxy.userData.curChapter),t<1&&(t=1);var e=v.DataManager.instance.eData.datastagereward[t];if(!e){var a=v.DataManager.instance.eData.datastagereward,i=Object.keys(a).length,o=Object.keys(a)[i-1];e=v.DataManager.instance.eData.datastagereward[o]}return e},e}(u.ProxyBase);n.default=D,n.battleDataProxy=new D(b),cc._RF.pop(),cc._RF.pop()},{}],BattleUI:[function(t,e,a){"use strict";cc._RF.push(e,"1d705ufVbVEeLSIZfRzuD9J","BattleUI");var i=e,o=a;cc._RF.push(i,"cc163L62LZETLSZThaIIP/W","BattleUI"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,r=n.ccclass,s=n.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mWaveLab=null,e.mChapterBar=null,e.mChapterBarBlock=null,e}return __extends(e,t),__decorate([s(cc.Label)],e.prototype,"mWaveLab",void 0),__decorate([s(cc.Sprite)],e.prototype,"mChapterBar",void 0),__decorate([s(cc.Node)],e.prototype,"mChapterBarBlock",void 0),__decorate([r],e)}(cc.Component);o.default=c,cc._RF.pop(),cc._RF.pop()},{}],BattleView:[function(t,e,a){"use strict";cc._RF.push(e,"fa375BuUDRCNYNS8qGX/W5J","BattleView");var i=t,o=e,n=a;cc._RF.push(o,"637c5VZ0FVBbKml+GW0Sfke","BattleView"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("EventManager"),c=i("ResUtil"),l=i("Common"),u=i("Simulator"),p=i("GameEnum"),h=i("HomeEnum"),d=i("DataManager"),m=i("BattleDataProxy"),f=i("UserDataProxy"),_=i("GameUIManager"),y=i("AnimationMgr"),g=i("Enemy4005"),v=i("Enemy4006"),P=i("EnemyBase"),b=cc._decorator,D=b.ccclass,S=b.property,C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mEnemyNormalPb=null,e.mEnemyBossPb=null,e._frameDt=0,e._createEnemyTimes=[],e._enemyDatas=[],e}return __extends(e,t),e.prototype.update=function(t){for(var e in m.battleDataProxy.audioFilterInfo)m.battleDataProxy.audioFilterInfo[e].time-=t;if(m.battleDataProxy.soundWaveTime>0&&(m.battleDataProxy.soundWaveTime-=t),m.battleDataProxy.gameState==p.GameState.PLAYING){this._frameDt+=t;for(var a=0;a<this._enemyDatas.length;++a){var i=this._enemyDatas[a];if(!(this._frameDt<i.startTime||i.createNum>=i.maxNum)){var o=this._createEnemyTimes[a];o+=t,i.createTime<=o&&(o-=i.createTime,i.createNum++,m.battleDataProxy.isEndless?this.createEndlessEnemy(i.stageInfo):this.createEnemy(i.enemyId,i.weatherData)),this._createEnemyTimes[a]=o}}}},e.prototype.onDestroy=function(){s.EventManager.instance.off(m.EBattleEvent.REMOVE_ENEMY,this.removeEnemy,this),s.EventManager.instance.off(m.EBattleEvent.GM_ADD_ENEMY,this.createEnemy,this),s.EventManager.instance.off(m.EBattleEvent.GM_SET_ENDLESS_WAVE,this.initEnemyDatas,this)},e.prototype.initBattleView=function(){u.Simulator.instance.clear(),u.Simulator.instance.setAgentDefaults(100,5,1,.1,0,9999999,new l.Vector2(0,0)),s.EventManager.instance.on(m.EBattleEvent.REMOVE_ENEMY,this.removeEnemy,this),s.EventManager.instance.on(m.EBattleEvent.GM_ADD_ENEMY,this.createEnemy,this),s.EventManager.instance.on(m.EBattleEvent.GM_SET_ENDLESS_WAVE,this.initEnemyDatas,this),this.initEnemyDatas(),this.preLoadEnemyAni()},e.prototype.preLoadEnemyAni=function(){for(var t=[],e=0;e<this._enemyDatas.length;++e){var a=this._enemyDatas[e];t.indexOf(a.enemyId)<0&&t.push(a.enemyId)}for(e=0;e<t.length;++e){var i=t[e],o=d.DataManager.instance.eData.datamonster[i];2!=o.type&&4!=o.type&&c.ResUtil.loadAsset({bundleName:"Game",path:"textures/monster/"+o.modeName,type:cc.SpriteAtlas})}},e.prototype.initChapterEnemy=function(){var t=f.userDataProxy.userData.curChapter,e=f.userDataProxy.userData.curWave,a=m.battleDataProxy.getStageRewardCfg(t).monsterList,i=a.replace("stage","");for(var o in d.DataManager.instance.eData.datastage){var n=d.DataManager.instance.eData.datastage[o];if(n.stage==Number(i)&&n.wave==e){m.battleDataProxy.stageInfo=n;break}}var r=d.DataManager.instance.eData["data"+a];this._frameDt=0,this._enemyDatas.length=0,this._createEnemyTimes.length=0;var s=0;for(var o in r){var c=r[o];if(c.wave==e){var l=c.startTime,u=c.armyId,p=c.num,h=c.time;0==l&&(h=.5*Math.random());var _={enemyId:u,maxNum:p,createTime:h,createNum:0,startTime:l};this._enemyDatas.push(_),this._createEnemyTimes.push(0),s+=p}}m.battleDataProxy.waveEnemyNum=s,m.battleDataProxy.waveResidueNum=s},e.prototype.initEndlessEnemy=function(){this._frameDt=0,this._enemyDatas.length=0,this._createEnemyTimes.length=0;var t=d.DataManager.instance.eData.dataendlessstage,e=0;for(var a in console.log("battleDataProxy.endlessCurWave:",m.battleDataProxy.endlessCurWave),t){var i=t[a];if(i.wave==m.battleDataProxy.endlessCurWave){var o=i.startTime,n=i.armyId,r=i.num,s=i.time;0==o&&(s=.5*Math.random());var c={enemyId:n,maxNum:r,createTime:s,createNum:0,startTime:o,stageInfo:i};this._enemyDatas.push(c),this._createEnemyTimes.push(0),3==i.seat?e+=2*r:e+=r}}m.battleDataProxy.waveEnemyNum=e,m.battleDataProxy.waveResidueNum=e},e.prototype.initWeatherEnemy=function(){var t=f.userDataProxy.userData.cursWeatherChapter,e=f.userDataProxy.userData.curWeatherWave,a=d.DataManager.instance.eData.data_weather[t];if(a){m.battleDataProxy.weatherStageInfo=a,this._frameDt=0,this._enemyDatas.length=0,this._createEnemyTimes.length=0;var i=d.DataManager.instance.eData.data_weatherdata,o=0;for(var n in i){var r=i[n];if(r.stageId==t&&r.wave==e){var s=r.startTime,c=r.armyId,l=r.num,u=r.time;0==s&&(u=.5*Math.random());var p={enemyId:c,maxNum:l,createTime:u,createNum:0,startTime:s,weatherData:r};this._enemyDatas.push(p),this._createEnemyTimes.push(0),o+=l}}m.battleDataProxy.waveEnemyNum=o,m.battleDataProxy.waveResidueNum=o}else console.log("\u5173\u5361\u4fe1\u606f\u8bfb\u53d6\u5931\u8d25")},e.prototype.initEnemyDatas=function(){m.battleDataProxy.isEndless?this.initEndlessEnemy():m.battleDataProxy.weatherType!=p.WeatherType.NONE?this.initWeatherEnemy():this.initChapterEnemy()},e.prototype.startFight=function(){m.battleDataProxy.gameState=p.GameState.PLAYING;var t=f.userDataProxy.userData.curWave;m.battleDataProxy.isEndless?t=m.battleDataProxy.endlessCurWave:m.battleDataProxy.weatherType!=p.WeatherType.NONE&&(t=f.userDataProxy.userData.curWeatherWave),t%5==0&&s.EventManager.instance.emit(m.EBattleEvent.SHOW_BOSS_TIPS),m.battleDataProxy.removeEnemyNode(null)},e.prototype.getIsPassWave=function(){if(m.battleDataProxy.enemyNodes.length<=5)for(var t=0;t<m.battleDataProxy.enemyNodes.length;++t){var e=m.battleDataProxy.enemyNodes[t];e&&e.isValid||m.battleDataProxy.enemyNodes.splice(t--,1)}if(m.battleDataProxy.enemyNodes.length<=0){for(t=0;t<this._enemyDatas.length;++t){var a=this._enemyDatas[t];if(a.createNum<a.maxNum)return console.log("\u602a\u7269\u8fd8\u6ca1\u5237\u5b8c"),!1}return!0}return!1},e.prototype.removeEnemy=function(t){if(this.getIsPassWave()){if(m.battleDataProxy.isEndless){var e=m.battleDataProxy.endlessCurWave;e++,m.battleDataProxy.endlessCurWave=e;var a=Object.keys(d.DataManager.instance.eData.dataendlessstage);return void(e>=d.DataManager.instance.eData.dataendlessstage[a[a.length-1]].wave?(console.log("\u8fc7\u5173\u4e86"),this.scheduleOnce(function(){_.gameUIMgr.showEndlessOverPopup()},1)):this.addPassSunshineNum(t,e))}if(m.battleDataProxy.weatherType!=p.WeatherType.NONE){var i=f.userDataProxy.userData.curWeatherWave;return i++,f.userDataProxy.userData.curWeatherWave=i,void(20<i?(console.log("\u8fc7\u5173\u4e86"),this.scheduleOnce(function(){_.gameUIMgr.showGameWinPopup()},1)):this.addPassSunshineNum(t,i))}var o=f.userDataProxy.userData.curChapter,n=m.battleDataProxy.getStageRewardCfg(o),r=f.userDataProxy.userData.curWave;m.battleDataProxy.pushSuccessLv(),r++,f.userDataProxy.userData.curWave=r,r>f.userDataProxy.userData.passWave&&(f.userDataProxy.userData.passWave=r,f.userDataProxy.saveData()),Number(n.wave)<r?(console.log("\u8fc7\u5173\u4e86"),this.scheduleOnce(function(){_.gameUIMgr.showGameWinPopup()},1)):this.addPassSunshineNum(t,r)}},e.prototype.addPassSunshineNum=function(t,e){m.battleDataProxy.isStartFight=!1;var a=m.battleDataProxy.getWaveSunshineNum(e),i=m.battleDataProxy.sunshineNum;i+=a,m.battleDataProxy.sunshineNum=i,this.scheduleOnce(function(){r.AudioManager.instance.playBattleEffect("sounds/getSunshine",h.Bundles.RES)},.5);var o=m.battleDataProxy.sunshineRoot,n=this.node.convertToNodeSpaceAR(o.parent.convertToWorldSpaceAR(o.position)),c=m.battleDataProxy.gameCamera;y.default.instance.showAwardAni({id:8,num:a},this.node,t,0,n.addSelf(c.position)),this.scheduleOnce(function(){s.EventManager.instance.emit(m.EBattleEvent.PASS_WAVE)},2)},e.prototype.createEnemy=function(t,e){var a=this,i=d.DataManager.instance.eData.datamonster[t];this.getEnemyPrefab(i,function(i){var o=cc.instantiate(i);if(a.node.addChild(o),o.getComponent(P.default).weatherData=e,o.getComponent(P.default).initEnemy(t),m.battleDataProxy.enemyNodes.push(o),4005==t)for(var n=0;n<6;++n)a.createBoy(o,n,function(t){o.getComponent(g.default).pushBoyNode(t)})}),""!=i.des&&m.battleDataProxy.enemyDetailsIds.indexOf(t)<0&&(m.battleDataProxy.enemyDetailsIds.push(t),m.battleDataProxy.saveEnemyDetailsIds(),_.gameUIMgr.showEnemyDetailsPopup(t))},e.prototype.getEnemyPrefab=function(t,e){2==t.type?c.ResUtil.loadAsset({path:"prefabs/monster/EnemyBoss"+t.id,type:cc.Prefab,bundleName:h.Bundles.GAME}).then(function(t){e&&e(t)}).catch(function(t){console.log("error:",t)}):4==t.type?c.ResUtil.loadAsset({path:"prefabs/monster/Enemy"+t.id,type:cc.Prefab,bundleName:h.Bundles.GAME}).then(function(t){e&&e(t)}).catch(function(t){console.log("error:",t)}):e&&e(this.mEnemyNormalPb)},e.prototype.createEndlessEnemy=function(t){var e=this,a=t.armyId,i=d.DataManager.instance.eData.datamonster[a];this.getEnemyPrefab(i,function(a){for(var i=3==t.seat?2:1,o=1==t.seat,n=0;n<i;++n){var r=cc.instantiate(a);e.node.addChild(r),o=2!=t.seat&&(1==t.seat||0==n),r.getComponent(P.default).initEndlessEnemy(t,o),m.battleDataProxy.enemyNodes.push(r)}})},e.prototype.createBoy=function(t,e,a){var i=this;c.ResUtil.loadAsset({path:"prefabs/monster/Enemy4006",type:cc.Prefab,bundleName:h.Bundles.GAME}).then(function(o){var n=cc.instantiate(o);i.node.addChild(n),n.getComponent(P.default).initEnemy(4006),m.battleDataProxy.enemyNodes.push(n),n.getComponent(v.default).setFollowData(t,e),a&&a(n)}).catch(function(t){console.log("error:",t)})},__decorate([S(cc.Prefab)],e.prototype,"mEnemyNormalPb",void 0),__decorate([S(cc.Prefab)],e.prototype,"mEnemyBossPb",void 0),__decorate([D],e)}(cc.Component);n.default=C,cc._RF.pop(),cc._RF.pop()},{}],BgFit:[function(t,e,a){"use strict";cc._RF.push(e,"6cbffoQnEhCIoXvsOFhfwXM","BgFit");var i=t,o=e,n=a;cc._RF.push(o,"794dfgffD1Cmo/roaq3lTTr","BgFit"),Object.defineProperty(n,"__esModule",{value:!0}),n.BgFit=n.ZSFullFitType=void 0;var r,s=i("ComponentBase"),c=cc._decorator,l=c.ccclass,u=c.property,p=c.menu;(function(t){t[t.ALL=0]="ALL",t[t.WIDTH=1]="WIDTH",t[t.HEIGHT=2]="HEIGHT"})(r=n.ZSFullFitType||(n.ZSFullFitType={}));var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.fitType=r.ALL,e.fit=!0,e}return __extends(e,t),e.prototype.onLoad=function(){var t=cc.winSize,e=1,a=1;r.WIDTH!==this.fitType&&r.ALL!==this.fitType||(e=t.width/this.node.width),r.HEIGHT!==this.fitType&&r.ALL!==this.fitType||(a=t.height/this.node.height),this.fit?this.node.scale=Math.max(e,a):(this.node.scaleX=e,this.node.scaleY=a)},__decorate([u({type:cc.Enum(r),tooltip:"\u9002\u914d\u6a21\u5f0f"})],e.prototype,"fitType",void 0),__decorate([u({tooltip:"\u662f\u5426\u7b49\u6bd4\u7f29\u653e"})],e.prototype,"fit",void 0),__decorate([l,p("\u81ea\u5b9a\u4e49\u7ec4\u4ef6/\u80cc\u666f\u9002\u914d")],e)}(s.ComponentBase);n.BgFit=h,cc._RF.pop(),cc._RF.pop()},{}],BigBoxShopLayer:[function(t,e,a){"use strict";cc._RF.push(e,"4a808NbpiRJA54Xgm76m19C","BigBoxShopLayer");var i=t,o=e,n=a;cc._RF.push(o,"37994TQdX9Dsq2V1HQpWWkd","BigBoxShopLayer"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("EventManager"),c=i("ResUtil"),l=i("AdsMgr"),u=i("HomeEnum"),p=i("DataManager"),h=i("UserDataProxy"),d=i("Util"),m=i("GameUIManager"),f=cc._decorator,_=f.ccclass,y=f.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bigBox=null,e.bigbigBox=null,e.levelLabel=null,e.progressBar=null,e.progressLabel=null,e._bigBoxConfig=null,e._buyType1=1,e._buyPrice1=0,e._buyType2=1,e._buyPrice2=0,e}return __extends(e,t),e.prototype.init=function(){s.EventManager.instance.on(h.EUserDataEvent.DIAMOD_UPDATE,this.updateDiamond,this);var t=h.userDataProxy.userData.boxData,e=Math.min(t.level,10);this._bigBoxConfig=p.DataManager.instance.eData.datashopbox[e],t.exp>=this._bigBoxConfig.exp?this.upgradeBox(t):(this.updateDisplay(t),this.handleCooldown(t),this.enableButtons(t))},e.prototype.onDestroy=function(){s.EventManager.instance.off(h.EUserDataEvent.DIAMOD_UPDATE,this.updateDiamond,this)},e.prototype.upgradeBox=function(t){t.exp-=this._bigBoxConfig.exp,t.level+=1,h.userDataProxy.saveData(),this.init()},e.prototype.updateDisplay=function(t){this.levelLabel.string="Lv."+t.level,this.progressBar.progress=t.exp/this._bigBoxConfig.exp,this.progressLabel.string=t.exp+"/"+this._bigBoxConfig.exp},e.prototype.updateDiamond=function(){var t=this._bigBoxConfig.cost.split("_"),e=Number(t[1]),a=this.bigBox.getChildByName("buyBtn").getChildByName("label").getComponent(cc.Label);h.userDataProxy.userData.diamond>=e?a.node.color=cc.Color.WHITE:a.node.color=cc.Color.RED,t=this._bigBoxConfig.bigCost.split("_");var i=Number(t[1]),o=this.bigbigBox.getChildByName("BtnBuy").getChildByName("label").getComponent(cc.Label);h.userDataProxy.userData.diamond>=i?o.node.color=cc.Color.WHITE:o.node.color=cc.Color.RED;var n=this.bigbigBox.getChildByName("buyBtn").getChildByName("label").getComponent(cc.Label);h.userDataProxy.userData.diamond>=i?n.node.color=cc.Color.WHITE:n.node.color=cc.Color.RED},e.prototype.handleCooldown=function(t){var e=this;this.unscheduleAllCallbacks();var a=this.bigBox.getChildByName("timerCd");if(a.active=t.cdTime>0,t.cdTime>0){var i=t.cdTime-Date.now(),o=a.getComponent(cc.Label);o.string=d.default.formatTimeMS(i,3),this.schedule(function(){i-=1e3,o.string=d.default.formatTimeMS(i,3),i<=0&&(e.unscheduleAllCallbacks(),e.resetCdTimer())},1)}},e.prototype.resetCdTimer=function(){h.userDataProxy.userData.boxData.cdTime=0,h.userDataProxy.saveData(),this.init(),s.EventManager.instance.emit(u.EHomeEvent.UPDATE_HOME_REDDOT,[u.HOME_REDDOT.SHOPRED])},e.prototype.enableButtons=function(t){var e,a=!t.cdTime;this.bigBox.getChildByName("mianfeiBtn").active=a,this.bigBox.getChildByName("buyBtn").active=!a,t.cdTime&&(e=this._bigBoxConfig.cost.split("_"),this._buyType1=Number(e[0]),this._buyPrice1=Number(e[1])),e=this._bigBoxConfig.bigCost.split("_"),this._buyType2=Number(e[0]),this._buyPrice2=Number(e[1]),this.updateBuyButton(this.bigBox.getChildByName("buyBtn"),this._buyType1,this._buyPrice1);var i=this.bigbigBox.getChildByName("buyBtn");this.updateBuyButton(i,this._buyType2,this._buyPrice2),this.bigbigBox.getChildByName("videoBtn").active=!t.bigState;var o=this.bigbigBox.getChildByName("BtnBuy");i.active=!t.bigState,o.active=t.bigState,this.updateBuyButton(o,this._buyType2,this._buyPrice2)},e.prototype.updateBuyButton=function(t,e,a){var i=t.getChildByName("icon").getComponent(cc.Sprite),o=t.getChildByName("label").getComponent(cc.Label);1==e?(c.ResUtil.loadAsset({path:"textures/item/icon_1",type:cc.SpriteFrame,bundleName:u.Bundles.GAME}).then(function(t){i.spriteFrame=t}).catch(function(t){console.log("error:",t)}),h.userDataProxy.userData.gold>=a?o.node.color=cc.Color.WHITE:o.node.color=cc.Color.RED):(c.ResUtil.loadAsset({path:"textures/item/icon_2",type:cc.SpriteFrame,bundleName:u.Bundles.GAME}).then(function(t){i.spriteFrame=t}).catch(function(t){console.log("error:",t)}),h.userDataProxy.userData.diamond>=a?o.node.color=cc.Color.WHITE:o.node.color=cc.Color.RED),o.string=a.toString()},e.prototype.getBigBoxProp=function(t){var e=1==t?"reward":"bigReward",a=1==t?"gainExp":"bigGainExp";h.userDataProxy.userData.boxData.exp+=Number(this._bigBoxConfig[a]);var i=this._bigBoxConfig[e].split("|").map(function(t){return t.split("_")}).reduce(function(t,e){var a=__read(e,2),i=a[0],o=a[1];return t.push({id:Number(i),num:Number(o)}),t},[]);2==t&&this._bigBoxConfig.bigGainGold&&i.push({id:1,num:this._bigBoxConfig.bigGainGold}),m.gameUIMgr.showCongratsGettingPopup({list:i,type:t+1}),h.userDataProxy.saveData(),this.init()},e.prototype.bigOneGetClick=function(t,e){r.AudioManager.instance.playEffectPath("sounds/click",u.Bundles.RES),1==e?(h.userDataProxy.userData.boxData.cdTime=Date.now()+36e5*Number(this._bigBoxConfig.freeTime),this.getBigBoxProp(1),s.EventManager.instance.emit(u.EHomeEvent.UPDATE_HOME_REDDOT,[u.HOME_REDDOT.SHOPRED])):this.purchaseBox(this._buyType1,this._buyPrice1,1)},e.prototype.bigTwoGetClick=function(t,e){var a=this;r.AudioManager.instance.playEffectPath("sounds/click",u.Bundles.RES),1==e?l.default.showVideoAds({id:1,eventId:"shop_bigBox_ad",success:function(){h.userDataProxy.userData.boxData.bigState=1,a.bigbigBox.getChildByName("timerCd").active=!0,a.getBigBoxProp(2)},fail:function(t){return console.log(t)},error:function(t){return console.log(t)}},!0):this.purchaseBox(this._buyType2,this._buyPrice2,2)},e.prototype.purchaseBox=function(t,e,a){if(1==t&&h.userDataProxy.userData.gold>=e)h.userDataProxy.changeGold(-e);else{if(!(2==t&&h.userDataProxy.userData.diamond>=e))return m.gameUIMgr.showTips(1==t?"\u91d1\u5e01\u4e0d\u591f\uff01":"\u94bb\u77f3\u4e0d\u591f\uff01"),void(1!=t&&s.EventManager.instance.emit(u.EHomeEvent.SHOW_VIDEO_DIAMOMND_POPUP));h.userDataProxy.changeDiamond(-e)}this.getBigBoxProp(a)},__decorate([y(cc.Node)],e.prototype,"bigBox",void 0),__decorate([y(cc.Node)],e.prototype,"bigbigBox",void 0),__decorate([y(cc.Label)],e.prototype,"levelLabel",void 0),__decorate([y(cc.ProgressBar)],e.prototype,"progressBar",void 0),__decorate([y(cc.Label)],e.prototype,"progressLabel",void 0),__decorate([_],e)}(cc.Component);n.default=g,cc._RF.pop(),cc._RF.pop()},{}],BlockInputManager:[function(t,e,a){"use strict";cc._RF.push(e,"8b755HzdMBKc6BsHPkI8WVe","BlockInputManager");var i=t,o=e,n=a;cc._RF.push(o,"38336l7PNdIFKGRKxM8czx4","BlockInputManager"),Object.defineProperty(n,"__esModule",{value:!0}),n.BlockInputManager=void 0;var r=i("AppBase"),s=function(){function t(){this.blockInputInit=!1,this._blockInputNode=null,this._popupBlockInputNum=0,this._netBlockInputNum=0}return Object.defineProperty(t,"instance",{get:function(){return null==this._instance&&(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"popupBlockInputNum",{get:function(){return this._popupBlockInputNum},set:function(t){this._popupBlockInputNum=t,null!=this._blockInputNode&&(this._blockInputNode.active=this._popupBlockInputNum+this._netBlockInputNum>0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"netBlockInputNum",{get:function(){return this._netBlockInputNum},set:function(t){var e=this;this._netBlockInputNum=t,null!=this._blockInputNode&&(this._popupBlockInputNum+this._netBlockInputNum===0?setTimeout(function(){e._popupBlockInputNum+e._netBlockInputNum===0&&(e._blockInputNode.active=!1)},100):this._blockInputNode.active=!0)},enumerable:!1,configurable:!0}),t.prototype.init=function(){if(!this.blockInputInit){var t=this._blockInputNode=new cc.Node("BlockInputNode");t.width=r.rootNode.width,t.height=r.rootNode.height,t.addComponent(cc.BlockInputEvents),t.parent=r.rootNode,t.zIndex=9,t.active=!1,this.blockInputInit=!0}},t._instance=null,t}();n.BlockInputManager=s,cc._RF.pop(),cc._RF.pop()},{}],BossBall:[function(t,e,a){"use strict";cc._RF.push(e,"d86d1qnCelCp5JgrmuK+J50","BossBall");var i=t,o=e,n=a;cc._RF.push(o,"7757227foVJk4TTpM2xftZx","BossBall"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("GameEnum"),s=i("BattleDataProxy"),c=i("Util"),l=i("BossSkill6"),u=i("BossSkillBase"),p=cc._decorator,h=p.ccclass,d=p.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mBossSkillPb=null,e._moveNormalize=null,e}return __extends(e,t),e.prototype.initBossBall=function(){var t=this,e=this.getEmptyGrids(),a=cc.v3(-222,-268);if(e.length>0){var i=e[Math.floor(1e4*Math.random())%e.length];a=c.default.convertToTargetNodeSpace(i,this.node)}this._moveNormalize=a.clone().sub(this.node.position.clone()).normalize(),this.bezierTo(cc.v2(this.node.position),this.getC2(cc.v2(this.node.position),cc.v2(a)),cc.v2(a),2,!0,function(){t.addBossSkill()}),cc.tween(this.node).to(2,{angle:1800}).start()},e.prototype.addBossSkill=function(){var t=cc.instantiate(this.mBossSkillPb);this.node.parent.addChild(t),t.position=this.node.position,t.getComponent(l.default).initMoveNormalize(this._moveNormalize),s.battleDataProxy.bossSkillBall.push(t),this.node.destroy(),this.node.removeFromParent()},e.prototype.update=function(){s.battleDataProxy.gameState==r.GameState.PLAYING||s.battleDataProxy.gameState==r.GameState.READY?this._isPauseGame&&(this._isPauseGame=!1,this.node.resumeAllActions()):this._isPauseGame||(this._isPauseGame=!0,this.node.pauseAllActions())},__decorate([d(cc.Prefab)],e.prototype,"mBossSkillPb",void 0),__decorate([h],e)}(u.default);n.default=m,cc._RF.pop(),cc._RF.pop()},{}],BossSkilMark:[function(t,e,a){"use strict";cc._RF.push(e,"464c06J3RNPra65o3VaG9SY","BossSkilMark");var i=e,o=a;cc._RF.push(i,"3d3e5kxLS5DRL60b4pdFpyt","BossSkilMark"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,r=n.ccclass,s=(n.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.play=function(t){void 0===t&&(t=1),this.node.scale=t,cc.Tween.stopAllByTarget(this.node);var e=cc.tween(this.node).to(.3,{scale:t+.3}).to(.3,{scale:t});cc.tween(this.node).repeatForever(e).start()},__decorate([r],e)}(cc.Component));o.default=s,cc._RF.pop(),cc._RF.pop()},{}],BossSkill1:[function(t,e,a){"use strict";cc._RF.push(e,"c4e15vG575Bg6gYlW0/3KJl","BossSkill1");var i=t,o=e,n=a;cc._RF.push(o,"b5814IwJBlES4us0QBjXhOl","BossSkill1"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("ResUtil"),s=i("HomeEnum"),c=i("DataManager"),l=i("BattleDataProxy"),u=i("BossSkillCourse"),p=i("EquipmentItem"),h=i("BossSkillBase"),d=cc._decorator,m=d.ccclass,f=d.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mSkillSp=null,e}return __extends(e,t),e.prototype.onLoad=function(){var e=this;t.prototype.onLoad.call(this),this.mSkillSp.setCompleteListener(function(){e.node.destroy(),e.node.removeFromParent()}),this.mSkillSp.setEventListener(function(t,a){a.data.name;for(var i,o,n=[],r=c.DataManager.instance.eData.data_bossskill[1],s=0;s<(null===(o=null===(i=l.battleDataProxy.equipRoot)||void 0===i?void 0:i.children)||void 0===o?void 0:o.length);++s)(h=l.battleDataProxy.equipRoot.children[s]).getComponent(p.default).isPurchased&&(h.getComponent(p.default).isIce||n.push(h));var u=!1;for(s=0;s<r.num&&!(n.length<=0);++s){var h,d=Math.floor(1e3*Math.random())%n.length;(h=n[d])&&h.isValid&&(h.getComponent(p.default).ice(r.click),n.splice(d,1),h.getComponent(p.default).bossSkillCourse||u||(u=!0,e.addBossSkillCourse(h)))}})},e.prototype.play=function(){this.mSkillSp.setAnimation(0,"skill",!1)},e.prototype.addBossSkillCourse=function(t){l.battleDataProxy.bossSkillCourseIds.indexOf(1)>=0||r.ResUtil.loadAsset({path:"prefabs/effect/BossSkillCourse",type:cc.Prefab,bundleName:s.Bundles.GAME}).then(function(e){var a=cc.instantiate(e);l.battleDataProxy.top1.addChild(a),a.getComponent(u.default).play([t]),t.getComponent(p.default).bossSkillCourse=a}).catch(function(t){console.log("error:",t)})},__decorate([f(sp.Skeleton)],e.prototype,"mSkillSp",void 0),__decorate([m],e)}(h.default);n.default=_,cc._RF.pop(),cc._RF.pop()},{}],BossSkill2:[function(t,e,a){"use strict";cc._RF.push(e,"429d0BmPp1EOL/sZYGZs6Nc","BossSkill2");var i=t,o=e,n=a;cc._RF.push(o,"d2cffaTUldHA5HyVRXVPxWH","BossSkill2"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("EventManager"),c=i("ResUtil"),l=i("GameEnum"),u=i("HomeEnum"),p=i("DataManager"),h=i("NodePoolManager"),d=i("BattleDataProxy"),m=i("Util"),f=i("BulletBoom"),_=i("BossSkillCourse"),y=i("EquipmentItem"),g=i("MapGridItem"),v=i("BossSkillBase"),P=i("BossSkillSmoke"),b=i("BossSkilMark"),D=cc._decorator,S=D.ccclass,C=D.property,E=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mSmokePb=null,e.mMarkPb=null,e.mBoomPb=null,e.mTail=null,e.mBoomSpr=null,e._markPlant=null,e._markPlantPos=null,e.mLastPos=null,e._smokeTime=0,e._boomHoldGrid="",e._clickNum=0,e._skillData=null,e._bossSkillCourse=null,e}return __extends(e,t),e.prototype.play=function(){var t,e,a=this;this.node.on(cc.Node.EventType.TOUCH_START,this.touchBegin,this);for(var i=[],o=0;o<(null===(e=null===(t=d.battleDataProxy.equipRoot)||void 0===t?void 0:t.children)||void 0===e?void 0:e.length);++o){var n=d.battleDataProxy.equipRoot.children[o];n.getComponent(y.default).mIsFixedPlant||i.push(n)}if(i.length<=0)return this.removeBossSkillCourse(),this.node.destroy(),void this.node.removeFromParent();this._skillData=p.DataManager.instance.eData.data_bossskill[2];var r=Math.floor(1e3*Math.random())%i.length;this._markPlant=i[r];var s=this._markPlant.getComponent(y.default).holdGrids,c=Math.floor(1e3*Math.random())%s.length;this._boomHoldGrid=s[c];var l=d.battleDataProxy.gridsMap.get(this._boomHoldGrid);this._markPlantPos=m.default.convertToTargetNodeSpace(l,this.node);var u=this._skillData.keepTime;this.bezierTo(cc.v2(this.node.position),this.getC2(cc.v2(this.node.position),cc.v2(this._markPlantPos)),cc.v2(this._markPlantPos),u,!0,function(){a.addBoom()}),this.addMark(),this.addBossSkillCourse()},e.prototype.removeBossSkillCourse=function(){this._bossSkillCourse&&this._bossSkillCourse.isValid&&(d.battleDataProxy.bossSkillCourseIds.push(2),d.battleDataProxy.saveBossSkillCourseIds(),this._bossSkillCourse.destroy(),this._bossSkillCourse.removeFromParent(),this._bossSkillCourse=null)},e.prototype.addBossSkillCourse=function(){var t=this;d.battleDataProxy.bossSkillCourseIds.indexOf(2)>=0||c.ResUtil.loadAsset({path:"prefabs/effect/BossSkillCourse",type:cc.Prefab,bundleName:u.Bundles.GAME}).then(function(e){t._bossSkillCourse=cc.instantiate(e),t.node.addChild(t._bossSkillCourse),t._bossSkillCourse.getComponent(_.default).play([t.node],!1)}).catch(function(t){console.log("error:",t)})},e.prototype.onDestroy=function(){this.node.off(cc.Node.EventType.TOUCH_START,this.touchBegin,this)},e.prototype.touchBegin=function(t){if(d.battleDataProxy.gameState==l.GameState.PLAYING||d.battleDataProxy.gameState==l.GameState.READY){var e=t.getLocation(),a=d.battleDataProxy.gameCamera;e.addSelf(cc.v2(a.position)),this.node.getBoundingBoxToWorld().contains(e)&&(this._clickNum++,this._clickNum>=this._skillData.click?this.addBoom(!1):(this.mBoomSpr.scale=1,cc.Tween.stopAllByTarget(this.mBoomSpr),cc.tween(this.mBoomSpr).to(.15,{scale:.8}).to(.15,{scale:1}).start()))}},e.prototype.addMark=function(){this._markNode=cc.instantiate(this.mMarkPb),d.battleDataProxy.battleView.addChild(this._markNode),this._markNode.position=this._markPlantPos,this._markNode.getComponent(b.default).play()},e.prototype.addBoom=function(t){if(void 0===t&&(t=!0),d.battleDataProxy.battleView&&d.battleDataProxy.battleView.isValid){cc.Tween.stopAllByTarget(this.node);var e=cc.instantiate(this.mBoomPb);if(d.battleDataProxy.battleView.addChild(e),e.position=this.node.position,e.getComponent(f.default).initBulletBoom(),r.AudioManager.instance.playEffectPath("sounds/plant12",u.Bundles.RES),t){for(var a=this._boomHoldGrid.split("-").map(Number),i=a[0],o=a[1],n=[],c=i-1;c<=i+1;++c)for(var l=o-1;l<=o+1;++l){var p=c+"-"+l,h=d.battleDataProxy.gridsMap.get(p);if(h){var m=h.getComponent(g.default).belongTo;m&&(m.getComponent(y.default).mIsFixedPlant||n.indexOf(m)<0&&n.push(m))}}for(c=0;c<n.length;++c){var _=n[c];_.getComponent(y.default).holdGrids.forEach(function(t){d.battleDataProxy.gridsMap.get(t).getComponent(g.default).belongTo=null}),_.destroy(),_.removeFromParent()}n.length>0&&s.EventManager.instance.emit(d.EBattleEvent.UPDATE_SUPER_PLANT_NUM)}this.removeBossSkillCourse(),this.removeSelf()}},e.prototype.update=function(t){d.battleDataProxy.gameState==l.GameState.PLAYING||d.battleDataProxy.gameState==l.GameState.READY?d.battleDataProxy.isStartFight?(this._isPauseGame&&(this._isPauseGame=!1,this.node.resumeAllActions()),this._markPlantPos&&(this._smokeTime+=t,this._smokeTime>=.3&&(this._smokeTime=0,this.addSmoke()),this.setAngle())):this.removeSelf():this._isPauseGame||(this._isPauseGame=!0,this.node.pauseAllActions())},e.prototype.addSmoke=function(){var t=h.default.instance.getNode(this.mSmokePb);d.battleDataProxy.battleView.addChild(t);var e=m.default.convertToTargetNodeSpace(this.mTail,t);t.position=e,t.getComponent(P.default).play()},e.prototype.setAngle=function(){var t=this.node.position;if(this.mLastPos){var e=-1e4;if(t!=this.mLastPos){var a=t.sub(this.mLastPos),i=cc.v2(a),o=cc.v2(1,0),n=i.magSqr(),r=o.magSqr();if(0==n||0==r)return;var s=i.signAngle(o),c=Math.floor(cc.misc.radiansToDegrees(s));e=c,c=-c,this.node.angle=c,this.mLastPos=t}return e}this.mLastPos=t},__decorate([C(cc.Prefab)],e.prototype,"mSmokePb",void 0),__decorate([C(cc.Prefab)],e.prototype,"mMarkPb",void 0),__decorate([C(cc.Prefab)],e.prototype,"mBoomPb",void 0),__decorate([C(cc.Node)],e.prototype,"mTail",void 0),__decorate([C(cc.Node)],e.prototype,"mBoomSpr",void 0),__decorate([S],e)}(v.default);n.default=E,cc._RF.pop(),cc._RF.pop()},{}],BossSkill3:[function(t,e,a){"use strict";cc._RF.push(e,"427f7gE/xVO05arP4jUc3xi","BossSkill3");var i=t,o=e,n=a;cc._RF.push(o,"5e12ePkiadJwZZI0mjVU0lp","BossSkill3"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("ResUtil"),c=i("GameEnum"),l=i("HomeEnum"),u=i("DataManager"),p=i("BattleDataProxy"),h=i("Util"),d=i("BossSkillCourse"),m=i("GameUI"),f=i("EquipmentItem"),_=i("MapGridItem"),y=i("BossSkillBase"),g=i("EnemyThiefMark"),v=cc._decorator,P=v.ccclass,b=v.property,D=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mSkillSp=null,e.mMarkPb=null,e._markPlant=null,e._markHoldGrid="",e._markTime=0,e._skillData=null,e._isCapture=!1,e}return __extends(e,t),e.prototype.play=function(){var t,e,a=this;this.mSkillSp.setCompleteListener(function(){a.node.destroy(),a.node.removeFromParent()}),this.mSkillSp.setEventListener(function(t,e){var i=e.data.name;console.log("eventName:",i);var o=p.battleDataProxy.gridsMap.get(a._markHoldGrid);if(a._markNode.destroy(),a._markNode.removeFromParent(),o){var n=o.getComponent(_.default).belongTo;n&&n.getComponent(f.default).beCapture(a.node)}}),this.mSkillSp.node.active=!1,r.AudioManager.instance.playEffectPath("sounds/bossSkill3",l.Bundles.RES);for(var i=[],o=0;o<(null===(e=null===(t=p.battleDataProxy.equipRoot)||void 0===t?void 0:t.children)||void 0===e?void 0:e.length);++o){var n=p.battleDataProxy.equipRoot.children[o];n.getComponent(f.default).mIsFixedPlant||i.push(n)}if(i.length<=0)return this.node.destroy(),void this.node.removeFromParent();this._skillData=u.DataManager.instance.eData.data_bossskill[3];var s=Math.floor(1e3*Math.random())%i.length;this._markPlant=i[s];var c=this._markPlant.getComponent(f.default).holdGrids,d=Math.floor(1e3*Math.random())%c.length;this._markHoldGrid=c[d];var y=p.battleDataProxy.gridsMap.get(this._markHoldGrid),g=h.default.convertToTargetNodeSpace(y,this.node);this.node.position=g;var v=y.getComponent(_.default).belongTo,P=[y];if(v){var b=this.getEmptyGrids();if(b.length>0){var D=Math.floor(100*Math.random())%b.length;P.push(b[D])}else{var S=Math.floor(100*Math.random())%m.ROW_MAX+"-"+Math.floor(100*Math.random())%m.COL_MAX,C=p.battleDataProxy.gridsMap.get(S);P.push(C)}}this.addMark(g,v,P)},e.prototype.addMark=function(t,e,a){var i=this;this._markNode=cc.instantiate(this.mMarkPb),p.battleDataProxy.battleView.addChild(this._markNode),this._markNode.position=cc.v3(t.x,t.y+cc.winSize.height),this._markNode.getComponent(g.default).play(t,function(){i.addBossSkillCourse(e,a)})},e.prototype.addBossSkillCourse=function(t,e){p.battleDataProxy.bossSkillCourseIds.indexOf(3)>=0||t&&t.isValid&&e.length>0&&s.ResUtil.loadAsset({path:"prefabs/effect/BossSkillCourse",type:cc.Prefab,bundleName:l.Bundles.GAME}).then(function(a){var i=cc.instantiate(a);p.battleDataProxy.top1.addChild(i),i.getComponent(d.default).play(e),t.getComponent(f.default).bossSkillCourse=i}).catch(function(t){console.log("error:",t)})},e.prototype.update=function(t){p.battleDataProxy.gameState!=c.GameState.PLAYING&&p.battleDataProxy.gameState!=c.GameState.READY||(p.battleDataProxy.isStartFight?this._isCapture||(this._markTime+=t,this._markTime>=this._skillData.keepTime&&(this.mSkillSp.node.active=!0,this._isCapture=!0,this.mSkillSp.setAnimation(0,"atk",!1))):this.removeSelf())},__decorate([b(sp.Skeleton)],e.prototype,"mSkillSp",void 0),__decorate([b(cc.Prefab)],e.prototype,"mMarkPb",void 0),__decorate([P],e)}(y.default);n.default=D,cc._RF.pop(),cc._RF.pop()},{}],BossSkill4:[function(t,e,a){"use strict";cc._RF.push(e,"13731WQEExNf53zRZ7a+kxF","BossSkill4");var i=t,o=e,n=a;cc._RF.push(o,"38491z017lDFa/w/4HPBdvG","BossSkill4"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("SimplyCircleCollider"),s=i("SimplyCollisionDetector"),c=i("GameEnum"),l=i("DataManager"),u=i("BattleDataProxy"),p=i("BulletBall"),h=i("MapGridItem"),d=i("BossSkillBase"),m=cc._decorator,f=m.ccclass,_=m.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mSkillSp=null,e.mBlackHole=null,e._continueTime=0,e._skillData=null,e._gridItem=null,e}return __extends(e,t),e.prototype.play=function(){var t=this;this.mSkillSp.setCompleteListener(function(){t.mBlackHole.active=!0,t.mSkillSp.node.active=!1,u.battleDataProxy.blackHoleNodes.push(t.node)}),this._skillData=l.DataManager.instance.eData.data_bossskill[4];var e=this.getEmptyGrids();if(e.length<=0){var a=u.battleDataProxy.blackHoleNodes.indexOf(this.node);return a>=0&&u.battleDataProxy.blackHoleNodes.splice(a,1),this.node.destroy(),void this.node.removeFromParent()}var i=Math.floor(1e4*Math.random())%e.length;this._gridItem=e[i],this._gridItem.getComponent(h.default).isBlackHole=!0,this.node.parent=u.battleDataProxy.blackHoleView,this.node.position=this._gridItem.position},e.prototype.update=function(t){if(u.battleDataProxy.gameState==c.GameState.PLAYING||u.battleDataProxy.gameState==c.GameState.READY)if(this._continueTime+=t,this._continueTime>=this._skillData.keepTime){this._gridItem.getComponent(h.default).isBlackHole=!1;var e=u.battleDataProxy.blackHoleNodes.indexOf(this.node);e>=0&&u.battleDataProxy.blackHoleNodes.splice(e,1),this.node.destroy(),this.node.removeFromParent()}else this.ballColliderCheck()},e.prototype.ballColliderCheck=function(){if(this.mBlackHole.active)for(var t=this.node.getComponent(r.default),e=u.battleDataProxy.bulletBalls.slice(),a=0;a<e.length;++a){var i=e[a];if(t){var o=i.getComponent(r.default);if(o&&s.default.isCollisionCircleToCircle(o.circle,t.circle)){var n=u.battleDataProxy.bulletBalls.indexOf(i);n>=0&&u.battleDataProxy.bulletBalls.splice(n,1),i.getComponent(p.default).blackHole(this.node);break}}}},__decorate([_(sp.Skeleton)],e.prototype,"mSkillSp",void 0),__decorate([_(cc.Node)],e.prototype,"mBlackHole",void 0),__decorate([f],e)}(d.default);n.default=y,cc._RF.pop(),cc._RF.pop()},{}],BossSkill5:[function(t,e,a){"use strict";cc._RF.push(e,"1ba15NNUY1KvbPC9OjaGlA9","BossSkill5");var i=t,o=e,n=a;cc._RF.push(o,"c7066YIGUpCYYMC8mVPOX1B","BossSkill5"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("MathUtil"),c=i("SimplyRectCollider"),l=i("SimplyCollisionDetector"),u=i("GameEnum"),p=i("HomeEnum"),h=i("BattleDataProxy"),d=i("Util"),m=i("BulletBoom"),f=i("EquipmentItem"),_=i("EnemyBase"),y=cc._decorator,g=y.ccclass,v=y.property,P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mSkillSp=null,e.mWater=null,e.mCollision=null,e.mHitEffect=null,e.mBoomEffectPb=null,e._endPos=null,e._isStartMove=!1,e}return __extends(e,t),e.prototype.initEnemy=function(e){var a,i,o=this;t.prototype.initEnemy.call(this,e),this.mWater.width=cc.winSize.width,this.node.position=cc.v3(-302,628).addSelf(cc.v3(0,-this.node.height/2)),this._endPos=cc.v3(-292,-374).addSelf(cc.v3(0,-this.node.height/2)),this.mSkillSp.setAnimation(0,"luodi",!1),this._isSpdAdd=!1,this.mWater.active=!1,this.mHitEffect.active=!1,this.mSkillSp.setCompleteListener(function(t){"luodi"==(t.animation?t.animation.name:"")&&(o.mSkillSp.setAnimation(0,"move",!0),o.mWater.active=!0,o.mWater.width=cc.winSize.width,o._isStartMove=!0)}),r.AudioManager.instance.playBgmPath("sounds/wateringCart",p.Bundles.RES);for(var n=0;n<(null===(i=null===(a=h.battleDataProxy.equipRoot)||void 0===a?void 0:a.children)||void 0===i?void 0:i.length);++n)h.battleDataProxy.equipRoot.children[n].getComponent(f.default).isCanDemotion=!0},e.prototype.loadAnimation=function(){this._isAnimReady=!0},e.prototype.addRushEffect=function(){},e.prototype.addBoom=function(){if(h.battleDataProxy.battleView&&h.battleDataProxy.battleView.isValid){var t=cc.instantiate(this.mBoomEffectPb);h.battleDataProxy.battleView.addChild(t,this.node.zIndex),t.position=this.node.position.addSelf(cc.v3(0,this.node.height/2)),t.getComponent(m.default).initBulletBoom(),t.scale=2,r.AudioManager.instance.playEffectPath("sounds/plant2",p.Bundles.RES),r.AudioManager.instance.playBgmPath("sounds/battleBGM",p.Bundles.RES),h.battleDataProxy.wateringCart=null,h.battleDataProxy.removeEnemyNode(this.node),this.removeHpProgress(),this.node.destroy(),this.node.removeFromParent()}},e.prototype.beAttack=function(t,e,a,i){return!(h.battleDataProxy.battleData.houseHp<=0||this._nowHp<=0||this._monsterCfg&&this._amimState!=u.RoleState.Dead&&(this.subHp(t.num),i&&this.showHurtLab(t.num,t.isCrit),this.updateHp(),r.AudioManager.instance.playEffectPath("sounds/enemyHit",p.Bundles.RES),!(this._nowHp<=0)||(this._amimState=u.RoleState.Dead,this.addBoom(),0)))},e.prototype.move=function(t){if(this._isStartMove){var e=this.getMoveSpd(!1,t),a=this.node.position.clone().sub(this._endPos.clone()).normalize();this.node.x-=e*a.x,this.node.y-=e*a.y,this.node.zIndex=-this.node.y,s.MathUtil.distance(this.node.position,this._endPos)<=e&&this.addBoom()}},e.prototype.update=function(e){if(h.battleDataProxy.gameState==u.GameState.PLAYING&&this._amimState!=u.RoleState.Dead){if(!h.battleDataProxy.isStartFight)return this.node.destroy(),void this.node.removeFromParent();t.prototype.update.call(this,e),this.plantColliderCheck()}},e.prototype.plantColliderCheck=function(){for(var t,e,a,i=this.mCollision.getComponent(c.default),o=!1,n=[],r=0;r<(null===(e=null===(t=h.battleDataProxy.equipRoot)||void 0===t?void 0:t.children)||void 0===e?void 0:e.length);++r){var u=h.battleDataProxy.equipRoot.children[r];if(i){var p=(null===(a=u.getChildByName("root"))||void 0===a?void 0:a.getChildByName("collisions"))||null;if(p)for(var m=function(t){var e=p.children[t],a=e.getComponent(c.default);a&&l.default.isCollisionRectToRect(i.rect,a.rect)&&(o=!0,n.findIndex(function(t){return t.collision==e})<0&&n.push({equipItem:u,collision:e}))},_=0;_<p.childrenCount;++_)m(_)}}var y=null,g=null;if(n.length>1){y=n[0].collision;var v=0,P=d.default.convertToTargetNodeSpace(y,this.mWater),b=s.MathUtil.distance(P,this.mWater.position);for(r=1;r<n.length;++r){var D=n[r].collision,S=d.default.convertToTargetNodeSpace(D,this.mWater);(C=s.MathUtil.distance(S,this.mWater.position))<b&&(b=C,y=n[r].collision,v=r)}g=n[v].equipItem,y=n[v].collision}else 1==n.length&&(g=n[0].equipItem,y=n[0].collision);if(g&&(g.getComponent(f.default).mIsFixedPlant||g.getComponent(f.default).beWashedAway()),y){S=d.default.convertToTargetNodeSpace(y,this.mWater);var C=s.MathUtil.distance(S,this.mWater.position);this.mWater.width=C-y.width/2,this.mHitEffect.active=!0,this.mHitEffect.x=this.mWater.x+this.mWater.width}this.mHitEffect.active=o,o||(this.mWater.width=cc.winSize.width)},e.prototype.getMovePosByTime=function(t){var e=Math.floor(30*t);if(this._isStartAtk)return cc.v3(this._simulationPos.x,this._simulationPos.y+this.node.height);for(var a=0;a<e;++a){var i=2*this.getMoveSpd(!1,1/60),o=s.MathUtil.distance(this._endPos,this._simulationPos),n=this._simulationPos.clone().sub(this._endPos.clone()).normalize();this._simulationPos.x-=i*n.x,this._simulationPos.y-=i*n.y,o<=i&&(this._simulationPos=this._endPos)}return cc.v3(this._simulationPos.x,this._simulationPos.y+this.node.height)},__decorate([v(sp.Skeleton)],e.prototype,"mSkillSp",void 0),__decorate([v(cc.Node)],e.prototype,"mWater",void 0),__decorate([v(cc.Node)],e.prototype,"mCollision",void 0),__decorate([v(cc.Node)],e.prototype,"mHitEffect",void 0),__decorate([v(cc.Prefab)],e.prototype,"mBoomEffectPb",void 0),__decorate([g],e)}(_.default);n.default=P,cc._RF.pop(),cc._RF.pop()},{}],BossSkill6:[function(t,e,a){"use strict";cc._RF.push(e,"013b2Cx5eVEGZrNhF2u0i3b","BossSkill6");var i=t,o=e,n=a;cc._RF.push(o,"33320JVIK9K3IVsnyqVGEZe","BossSkill6"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("EventManager"),s=i("GameEnum"),c=i("DataManager"),l=i("NodePoolManager"),u=i("BattleDataProxy"),p=i("BallCollisionEffect"),h=i("EquipmentItem"),d=i("BossSkillBase"),m=cc._decorator,f=m.ccclass,_=m.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mRigidBody=null,e.mCollisionEffectPb=null,e._baseTargetSpeed=0,e._lastPos=null,e._isCheck=!1,e._checkTime=0,e._continueTime=0,e._skillInfo=null,e}return __extends(e,t),e.prototype.play=function(){},e.prototype.initMoveNormalize=function(t){this._skillInfo=c.DataManager.instance.eData.data_bossskill[6],this.mRigidBody.linearVelocity=this.getLinearVelocity(t),this._baseTargetSpeed=this.mRigidBody.linearVelocity.lengthSqr()},e.prototype.onBeginContact=function(t,e,a){var i;null===(i=a.node.getComponent(h.default))||void 0===i||i.bossBallCollisionEnter(),-1!=a.node.name.indexOf("wall")&&(t.disabled=!1);var o=t.getWorldManifold().points,n=l.default.instance.getNode(this.mCollisionEffectPb);this.node.parent.addChild(n);var r=this.node.parent.convertToNodeSpaceAR(cc.v3(o[0]));n.position=r,n.getComponent(p.default).play()},e.prototype.lateUpdate=function(t){if(u.battleDataProxy.gameState==s.GameState.PLAYING||u.battleDataProxy.gameState==s.GameState.READY){var e=this.mRigidBody.linearVelocity,a=e.lengthSqr();if(Math.abs(a-this._baseTargetSpeed)>.1){var i=e.clone().normalize().multiplyScalar(Math.sqrt(this._baseTargetSpeed));this.mRigidBody.linearVelocity=i,console.log("\u901f\u5ea6\u66f4\u65b0\uff1a"+i)}var o=this.setAngle();if(this.getIsCheck(o)?this._isCheck=!0:(this._isCheck=!1,this._checkTime=0),this._isCheck&&(this._checkTime+=t,this._checkTime>=.3&&(this._isCheck=!1,this._checkTime=0,console.log("\u5782\u76f4\u6216\u8005\u6c34\u5e73\u4e86\uff0c\u91cd\u65b0\u8bbe\u7f6e\u65b9\u5411"),this.setLinearVelocity())),this._continueTime+=t,this._continueTime>=this._skillInfo.keepTime){var n=u.battleDataProxy.bossSkillBall.indexOf(this.node);n>=0&&u.battleDataProxy.bossSkillBall.splice(n,1),r.EventManager.instance.emit(u.EBattleEvent.CLEAN_BOSS_BALL),this.node.destroy(),this.node.removeFromParent()}}},e.prototype.setLinearVelocity=function(){this.mRigidBody.linearVelocity=this.getLinearVelocity()},e.prototype.getLinearVelocity=function(t){return t||(t=cc.v3(1,1)),cc.v2(s.EGameEnum.BOSS_BALL_SPEED*t.x,s.EGameEnum.BOSS_BALL_SPEED*t.y)},e.prototype.getIsCheck=function(t){var e=Math.abs(t%360);return e<=2.5||e>=87.5&&e<=92.5||e>=177.5&&e<=182.5||e>=267.5&&e<=272.5},e.prototype.setAngle=function(){var t=this.node.position;if(this._lastPos){var e=-1e4;if(t!=this._lastPos){var a=t.sub(this._lastPos),i=cc.v2(a),o=cc.v2(1,0),n=i.magSqr(),r=o.magSqr();if(0==n||0==r)return;var s=i.signAngle(o);e=Math.floor(cc.misc.radiansToDegrees(s)),this._lastPos=t}return e}this._lastPos=t},__decorate([_(cc.RigidBody)],e.prototype,"mRigidBody",void 0),__decorate([_(cc.Prefab)],e.prototype,"mCollisionEffectPb",void 0),__decorate([f],e)}(d.default);n.default=y,cc._RF.pop(),cc._RF.pop()},{}],BossSkill7:[function(t,e,a){"use strict";cc._RF.push(e,"7a85dBKrs5Blbe4RFDQazj4","BossSkill7");var i=t,o=e,n=a;cc._RF.push(o,"e04c5poZXhHf7gNYUcg8xsf","BossSkill7"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("DataManager"),s=i("BattleDataProxy"),c=i("EquipmentItem"),l=i("BossSkillBase"),u=cc._decorator,p=u.ccclass,h=u.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mSkillSp=null,e}return __extends(e,t),e.prototype.onLoad=function(){var e=this;t.prototype.onLoad.call(this),this.mSkillSp.setCompleteListener(function(){e.node.destroy(),e.node.removeFromParent()}),this.mSkillSp.setEventListener(function(t,e){e.data.name;for(var a,i,o=[],n=r.DataManager.instance.eData.data_bossskill[7],l=0;l<(null===(i=null===(a=s.battleDataProxy.equipRoot)||void 0===a?void 0:a.children)||void 0===i?void 0:i.length);++l)(u=s.battleDataProxy.equipRoot.children[l]).getComponent(c.default).mIsFixedPlant||o.push(u);for(l=0;l<n.num&&!(o.length<=0);++l){var u,p=Math.floor(1e3*Math.random())%o.length;(u=o[p])&&u.isValid&&(u.getComponent(c.default).charm(n.keepTime),o.splice(p,1))}})},e.prototype.play=function(){this.mSkillSp.setAnimation(0,"skill",!1)},__decorate([h(sp.Skeleton)],e.prototype,"mSkillSp",void 0),__decorate([p],e)}(l.default);n.default=d,cc._RF.pop(),cc._RF.pop()},{}],BossSkillBase:[function(t,e,a){"use strict";cc._RF.push(e,"a6ae9nDrtNNpbLNuYwxX3RV","BossSkillBase");var i=t,o=e,n=a;cc._RF.push(o,"d79e8AlEj9IdY1NhZAZHgRD","BossSkillBase"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("MathUtil"),s=i("BattleDataProxy"),c=i("GameUI"),l=i("MapGridItem"),u=cc._decorator,p=u.ccclass,h=(u.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._isPauseGame=!1,e._markNode=null,e}return __extends(e,t),e.prototype.onLoad=function(){},e.prototype.play=function(){},e.prototype.getEmptyGrids=function(){for(var t=[],e=0;e<c.ROW_MAX*c.COL_MAX;++e){var a=Math.floor(e/c.COL_MAX)+"-"+e%c.COL_MAX,i=s.battleDataProxy.gridsMap.get(a),o=i.getComponent(l.default).isBlackHole,n=i.getComponent(l.default).belongTo,r=i.getComponent(l.default).bValid;o||n||!r||t.push(i)}return t},e.prototype.bezierTo=function(t,e,a,i,o,n,s,c){void 0===s&&(s=""),void 0===c&&(c=null),cc.Tween.stopAllByTarget(this.node),r.MathUtil.bezierTo(this.node,i,t,e,a,function(t,e){c&&c(t,e)},s).call(function(){n&&n()}).start()},e.prototype.getC2=function(t,e){var a=Math.abs(t.x-e.x),i=t.x>e.x?t.x-a/2:t.x+a/2,o=250*Math.random()+250;return t.y>e.y?cc.v2(i,t.y+o):cc.v2(i,e.y+o)},e.prototype.removeSelf=function(){this._markNode&&this._markNode.isValid&&(this._markNode.destroy(),this._markNode.removeFromParent()),this.node.destroy(),this.node.removeFromParent()},__decorate([p],e)}(cc.Component));n.default=h,cc._RF.pop(),cc._RF.pop()},{}],BossSkillCharm:[function(t,e,a){"use strict";cc._RF.push(e,"82503h5x9FHWLjQi9eB0med","BossSkillCharm");var i=e,o=a;cc._RF.push(i,"27e6bzv0YJETKKjLY+0evM3","BossSkillCharm"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,r=n.ccclass,s=n.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mSpine=null,e.mSpine2=null,e}return __extends(e,t),e.prototype.play=function(){this.mSpine.setAnimation(0,"stand",!0),this.mSpine2.setAnimation(0,"animation",!0)},__decorate([s(sp.Skeleton)],e.prototype,"mSpine",void 0),__decorate([s(sp.Skeleton)],e.prototype,"mSpine2",void 0),__decorate([r],e)}(cc.Component);o.default=c,cc._RF.pop(),cc._RF.pop()},{}],BossSkillCourse:[function(t,e,a){"use strict";cc._RF.push(e,"c0d53SHwLJHjoUyHqBwR2Zq","BossSkillCourse");var i=t,o=e,n=a;cc._RF.push(o,"b4f9f3RHzxB+JwXFSeBlYnC","BossSkillCourse"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("Util"),s=cc._decorator,c=s.ccclass,l=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mFinger=null,e._originPos=null,e}return __extends(e,t),e.prototype.play=function(t,e){var a=this;if(void 0===e&&(e=!0),e){var i=t[0];this._originPos=r.default.convertToTargetNodeSpace(i,this.node),this.node.position=this._originPos}else this.node.position=cc.v3(0,0,0);if(t.length>1)if(t[1]&&t[1].isValid){this.mFinger.setAnimation(0,"Drag",!0);var o=r.default.convertToTargetNodeSpace(t[1],this.node),n=cc.tween(this.node).to(1,{position:o}).call(function(){a.node.position=a._originPos});cc.tween(this.node).repeatForever(n).start()}else this.mFinger.setAnimation(0,"Click",!0);else this.mFinger.setAnimation(0,"Click",!0)},__decorate([l(sp.Skeleton)],e.prototype,"mFinger",void 0),__decorate([c],e)}(cc.Component);n.default=u,cc._RF.pop(),cc._RF.pop()},{}],BossSkillSmoke:[function(t,e,a){"use strict";cc._RF.push(e,"e0e408VTN1OVZ0i2bPC5V2i","BossSkillSmoke");var i=t,o=e,n=a;cc._RF.push(o,"8ef00K7q79LeYUDkS5UZBOX","BossSkillSmoke"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("NodePoolManager"),s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.play=function(){var t=this;this.node.scale=1,cc.Tween.stopAllByTarget(this.node),cc.tween(this.node).to(.5,{scale:1.3}).call(function(){r.default.instance.putNode(t.node)}).start()},__decorate([c],e)}(cc.Component));n.default=l,cc._RF.pop(),cc._RF.pop()},{}],BoxIceClick:[function(t,e,a){"use strict";cc._RF.push(e,"ec2c0tY8X5JE4eP87s0D1Ty","BoxIceClick");var i=t,o=e,n=a;cc._RF.push(o,"afc93YJG0xFrY114evLULlG","BoxIceClick"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("NodePoolManager"),s=cc._decorator,c=s.ccclass,l=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mClickSp=null,e}return __extends(e,t),e.prototype.initBoxIceClick=function(){var t=this;this.mClickSp.setCompleteListener(function(){r.default.instance.putNode(t.node)}),this.mClickSp.setAnimation(0,"click",!1)},__decorate([l(sp.Skeleton)],e.prototype,"mClickSp",void 0),__decorate([c],e)}(cc.Component);n.default=u,cc._RF.pop(),cc._RF.pop()},{}],BoxIceCrush:[function(t,e,a){"use strict";cc._RF.push(e,"6fc10Y3DUNGQLxXgIGcFyHo","BoxIceCrush");var i=t,o=e,n=a;cc._RF.push(o,"6a152Dgut9H27vpDTf72z3Q","BoxIceCrush"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("NodePoolManager"),s=cc._decorator,c=s.ccclass,l=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mCrushSp=null,e}return __extends(e,t),e.prototype.initBoxIceCrush=function(){var t=this;this.mCrushSp.setCompleteListener(function(){r.default.instance.putNode(t.node)}),this.mCrushSp.setAnimation(0,"broken",!1)},__decorate([l(sp.Skeleton)],e.prototype,"mCrushSp",void 0),__decorate([c],e)}(cc.Component);n.default=u,cc._RF.pop(),cc._RF.pop()},{}],BuildBase:[function(t,e,a){"use strict";cc._RF.push(e,"a9518J2POZAPYANeIyt7ISg","BuildBase");var i=t,o=e,n=a;cc._RF.push(o,"92a5bZ0K41DiIYV7Q+8d7YG","BuildBase"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("EventManager"),c=i("ResUtil"),l=i("ShimmerWhite"),u=i("GameEnum"),p=i("HomeEnum"),h=i("DataManager"),d=i("BattleDataProxy"),m=i("Util"),f=i("EnemyBase"),_=cc._decorator,y=_.ccclass,g=_.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mBaseSpr=null,e.mHpBar=null,e._dadTime=0,e}return __extends(e,t),e.prototype.update=function(t){d.battleDataProxy.gameState!=u.GameState.PLAYING&&d.battleDataProxy.gameState!=u.GameState.READY||this._dadTime>0&&(this._dadTime-=t,this._dadTime<=0&&(this._dadTime=0,d.battleDataProxy.isDad=!1))},e.prototype.onLoad=function(){s.EventManager.instance.on(d.EBattleEvent.UPDATE_HOUSE_HP,this.updateHouseHp,this),s.EventManager.instance.on(d.EBattleEvent.RESURGENCE,this.resurgence,this)},e.prototype.initBuildBase=function(){var t=this;this._monsterCfg=h.DataManager.instance.eData.datamonster[1e3],this.updateHouseHp(0),d.battleDataProxy.isEndless&&(this.node.position=cc.v3(-280,130),this.mBaseSpr.node.scaleX=-1,this.node.parent=d.battleDataProxy.battleView,this.node.zIndex=-this.node.y);var e="";d.battleDataProxy.weatherType==u.WeatherType.Night?e="textures/weather/pic_fangzi_tianqi3":d.battleDataProxy.weatherType==u.WeatherType.SandWind?e="textures/weather/pic_fangzi_tianqi4":d.battleDataProxy.weatherType==u.WeatherType.IceAndSnow&&(e="textures/weather/pic_fangzi_tianqi5"),""!=e&&c.ResUtil.loadAsset({path:e,type:cc.SpriteFrame,bundleName:p.Bundles.GAME}).then(function(e){t.mBaseSpr.spriteFrame=e}).catch(function(t){console.log("error:",t)})},e.prototype.onDestroy=function(){s.EventManager.instance.off(d.EBattleEvent.UPDATE_HOUSE_HP,this.updateHouseHp,this),s.EventManager.instance.off(d.EBattleEvent.RESURGENCE,this.resurgence,this)},e.prototype.resurgence=function(){this._dadTime=3,d.battleDataProxy.isDad=!0,d.battleDataProxy.battleData.houseHp=d.battleDataProxy.battleData.houseMaxHp,this.mHpBar.fillRange=d.battleDataProxy.battleData.houseHp/d.battleDataProxy.battleData.houseMaxHp;for(var t=d.battleDataProxy.enemyNodes.slice(),e=0;e<t.length;++e){var a=t[e];a&&a.isValid&&(a.destroy(),a.removeFromParent())}var i=d.battleDataProxy.enemyAirship.slice();for(e=0;e<i.length;++e){var o=i[e];o&&o.isValid&&(o.destroy(),o.removeFromParent())}d.battleDataProxy.pathPointView.children.forEach(function(t){t&&t.isValid&&(t.PathIce=null)}),r.AudioManager.instance.playBgmPath("sounds/battleBGM",p.Bundles.RES),d.battleDataProxy.wateringCart=null,d.battleDataProxy.enemyNodes=[],d.battleDataProxy.enemyAirship=[],d.battleDataProxy.airshipSoldier=[],d.battleDataProxy.priestZombie=[],d.battleDataProxy.enemyPathIce.forEach(function(t){t&&t.isValid&&(t.destroy(),t.removeFromParent())}),d.battleDataProxy.enemyPathIce=[]},e.prototype.updateHouseHp=function(t){this.showHurtLab(t),this.mHpBar.fillRange=d.battleDataProxy.battleData.houseHp/d.battleDataProxy.battleData.houseMaxHp,t<0&&this.mBaseSpr.getComponent(l.default).show()},e.prototype.showHurtLab=function(t){if(0!=t){var e=this.node.position;e.y+=this.node.height/2,m.default.showHurt(Math.ceil(t),t>0?m.HurtType.RECOVERY:m.HurtType.NORMAL,e,this,d.battleDataProxy.numberView)}},e.prototype.beAttack=function(){var t=Number(h.DataManager.instance.eData.datapara[68].num);return d.battleDataProxy.updateHouseHp({isCirt:!1,num:-t}),!1},e.prototype.dizziness=function(t){void 0===t&&(t=2)},e.prototype.ice=function(t){void 0===t&&(t=3)},e.prototype.iceSpeedCut=function(){},e.prototype.flaser=function(){},e.prototype.initSimulationData=function(){},e.prototype.getMovePosByTime=function(){return this.node.position},e.prototype.getIsAllowAstrictMove=function(){return!1},__decorate([g(cc.Sprite)],e.prototype,"mBaseSpr",void 0),__decorate([g(cc.Sprite)],e.prototype,"mHpBar",void 0),__decorate([y],e)}(f.default);n.default=v,cc._RF.pop(),cc._RF.pop()},{}],BulletBall:[function(t,e,a){"use strict";cc._RF.push(e,"1a13awk4QlKIJ9L0QV5gdCu","BulletBall");var i=t,o=e,n=a;cc._RF.push(o,"d4fe1fmRBxCapyV6k2x5X+L","BulletBall"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("EventManager"),c=i("ResUtil"),l=i("GameEnum"),u=i("HomeEnum"),p=i("DataManager"),h=i("NodePoolManager"),d=i("BattleDataProxy"),m=i("Util"),f=i("SkillDataMgr"),_=i("ComboBase"),y=i("BallCollisionEffect"),g=i("EquipmentItem"),v=i("MapBlockItem"),P=cc._decorator,b=P.ccclass,D=P.property,S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mRigidBody=null,e.mCollisionEffectPb=null,e.mFrenzySp=null,e.mTuowei=null,e._moveSpd=200,e._velocity=cc.v2(1,1),e._bulletIdx=0,e._collisionEnter=[],e._isCanCollision=!0,e._colliderWallCount=0,e._colliderBlockCount=0,e._topColliderPos=null,e._topColliderBlockPos=null,e._linearDirections=[cc.v2(1,1),cc.v2(-1,-1),cc.v2(1,-1),cc.v2(-1,1)],e._collisionPlantNum=0,e._lastVelocitys=[],e._maxCollisionNum=0,e._baseTargetSpeed=0,e._lastPos=null,e._lastAngle=0,e._collisionNum=0,e._checkTime=0,e._isCheck=!1,e._isBlackHole=!1,e._isCanActiveFrenzy=!0,e._addSpdTime=0,e._isEndFrenzy=!0,e._collisionEffectTime=0,e._collisionNodes=[],e._collisionWater=[],e}return __extends(e,t),e.prototype.initBulletBall=function(t){this._bulletIdx=t,this._maxCollisionNum=Number(p.DataManager.instance.eData.datapara[66].num),this.mRigidBody.linearVelocity=this.getLinearVelocity(),this._baseTargetSpeed=this.mRigidBody.linearVelocity.lengthSqr(),s.EventManager.instance.on(d.EBattleEvent.SELECT_SKILL,this.selectSkill,this)},e.prototype.initCollisionPlantNum=function(){this._collisionPlantNum=0},e.prototype.onDestroy=function(){s.EventManager.instance.off(d.EBattleEvent.SELECT_SKILL,this.selectSkill,this)},e.prototype.selectSkill=function(t){if(9001==t||9002==t||9003==t){var e=p.DataManager.instance.eData.dataskill[t],a=this.mRigidBody.linearVelocity.clone(),i=e.attribute.split("_").map(Number),o=cc.v2(a.x*(1+i[1]),a.y*(1+i[1]));this._baseTargetSpeed=this.getLinearVelocity().lengthSqr(),this.mRigidBody.linearVelocity=o}},e.prototype.update=function(){if(d.battleDataProxy.gameState==l.GameState.PLAYING||d.battleDataProxy.gameState==l.GameState.READY){if(!this._isBlackHole){this.resume();var t=this.mRigidBody.linearVelocity;0==t.x&&0==t.y&&this.setLinearVelocity()}}else this.pause()},e.prototype.getLinearVelocity=function(t){var e=f.default.instance.getSkillProperty(39,0),a=this._linearDirections[this._bulletIdx];t?a=this.mRigidBody.linearVelocity.clone().normalizeSelf():(a=this._linearDirections[this._bulletIdx])||(a=this._linearDirections[0]);var i=this._addSpdTime>0?1:0,o=1;return this._addSpdTime<=0&&(o=this._collisionWater.length>0?.3:1),cc.v2(l.EGameEnum.BALL_SPEED*(1+e+i)*a.x*o,l.EGameEnum.BALL_SPEED*(1+e+i)*a.y*o)},e.prototype.clearCollisionPlantNum=function(){this._collisionPlantNum=0,this._isCanActiveFrenzy=!0,this._isEndFrenzy||(this._isEndFrenzy=this._addSpdTime<=0,this._isEndFrenzy&&this.initAddSpdTime())},e.prototype.onBeginContact=function(t,e,a){var i,o,n,s=a.node,c=a.node.name,l=t.getWorldManifold().points;if(-1!=c.indexOf("MapBlockItem"))return null===(i=s.getComponent(v.default))||void 0===i||i.ballCollisionEnter(l[0]),t.disabled=!1,this.clearCollisionPlantNum(),this._colliderBlockCount++,this._colliderBlockCount>=6&&(this._colliderBlockCount=0,Math.floor(this._topColliderBlockPos.x)!=Math.floor(this.node.x)&&Math.floor(this._topColliderBlockPos.y)!=Math.floor(this.node.y)||this.setLinearVelocity()),void(this._topColliderBlockPos=this.node.position);var p=!1;if(-1!=c.indexOf("wall"))p=!0;else{if(!(this._collisionNodes.indexOf(s)<0))return void((this._addSpdTime>0||!this._isEndFrenzy)&&(t.disabled=!0));this._collisionNodes.push(s)}if(this._addSpdTime>0?null===(o=s.getComponent(g.default))||void 0===o||o.frenzyCollisionEnter():null===(n=s.getComponent(g.default))||void 0===n||n.ballCollisionEnterEx(),this._isBlackHole)t.disabled=!0;else if(p?(this._colliderBlockCount=0,this._colliderWallCount++,this._colliderWallCount>=4&&(this._colliderWallCount=0,Math.floor(this._topColliderPos.x)!=Math.floor(this.node.x)&&Math.floor(this._topColliderPos.y)!=Math.floor(this.node.y)||this.setLinearVelocity()),t.disabled=!1,this.clearCollisionPlantNum()):(this._colliderBlockCount=0,this._colliderWallCount=0,this._addSpdTime<=0&&this._isEndFrenzy?this._collisionPlantNum++:this._collisionPlantNum=0,this._isCanActiveFrenzy&&this._addSpdTime<=0&&this.addComboEffect(cc.v3(l[0])),r.AudioManager.instance.playEffectPath("sounds/ballHit",u.Bundles.RES),(this._collisionPlantNum>=this._maxCollisionNum||this._addSpdTime>0||!this._isEndFrenzy)&&(t.disabled=!0)),this._topColliderPos=this.node.position,this._collisionEffectTime<=0){this._collisionEffectTime=.2;var d=this.node.parent.convertToNodeSpaceAR(cc.v3(l[0])),m=h.default.instance.getNode(this.mCollisionEffectPb);this.node.parent.addChild(m),m.position=d,m.getComponent(y.default).play()}},e.prototype.onEndContact=function(t,e,a){var i=a.node,o=this._collisionNodes.indexOf(i);o>=0&&this._collisionNodes.splice(o,1)},e.prototype.lateUpdate=function(t){if((d.battleDataProxy.gameState==l.GameState.PLAYING||d.battleDataProxy.gameState==l.GameState.READY)&&!this._isBlackHole){this._addSpdTime>0&&(this._addSpdTime-=t),this._collisionEffectTime>0&&(this._collisionEffectTime-=t,this._collisionEffectTime<0&&(this._collisionEffectTime=0));var e=this.mRigidBody.linearVelocity,a=e.lengthSqr();if(Math.abs(a-this._baseTargetSpeed)>.1){var i=e.clone().normalize().multiplyScalar(Math.sqrt(this._baseTargetSpeed));this.mRigidBody.linearVelocity=i}var o=this.setAngle();this.getIsCheck(o)?this._isCheck=!0:(this._isCheck=!1,this._checkTime=0),this._isCheck&&(this._checkTime+=t,this._checkTime>=.3&&(this._isCheck=!1,this._checkTime=0,this.setLinearVelocity()))}},e.prototype.initAddSpdTime=function(){this._addSpdTime=0,this.mFrenzySp.active=!1,this.mTuowei.active=!1,this.setLinearVelocity()},e.prototype.getIsCheck=function(t){var e=Math.abs(t%360);return e<=2.5||e>=87.5&&e<=92.5||e>=177.5&&e<=182.5||e>=267.5&&e<=272.5},e.prototype.setAngle=function(){var t=this.node.position;if(this._lastPos){var e=-1e4;if(t!=this._lastPos){var a=t.sub(this._lastPos),i=cc.v2(a),o=cc.v2(1,0),n=i.magSqr(),r=o.magSqr();if(0==n||0==r)return;var s=i.signAngle(o);e=Math.floor(cc.misc.radiansToDegrees(s)),this._lastPos=t}return e}this._lastPos=t},e.prototype.setLinearVelocity=function(t){this.mRigidBody.linearVelocity=this.getLinearVelocity(t),this._baseTargetSpeed=this.getLinearVelocity().lengthSqr()},e.prototype.pause=function(){this.mRigidBody.type!=cc.RigidBodyType.Static&&(this.mRigidBody.type=cc.RigidBodyType.Static)},e.prototype.resume=function(){this._isBlackHole||this.mRigidBody.type!=cc.RigidBodyType.Dynamic&&(this.mRigidBody.type=cc.RigidBodyType.Dynamic)},e.prototype.blackHole=function(t){var e=this;if(!(this._addSpdTime>0)&&this._isEndFrenzy){this._isBlackHole=!0,this.pause();var a=m.default.convertToTargetNodeSpace(t,this.node);cc.Tween.stopAllByTarget(this.node),cc.tween(this.node).to(.5,{scale:0,position:a}).call(function(){e.node.destroy(),e.node.removeFromParent()}).start(),s.EventManager.instance.emit(d.EBattleEvent.RESUME_BALL)}},e.prototype.addComboEffect=function(t){var e=this;if(d.battleDataProxy.isStartFight){var a=this.node.parent,i=a.convertToNodeSpaceAR(t.clone()),o="prefabs/effect/ComboNormal";if(this._collisionPlantNum>=this._maxCollisionNum)o="prefabs/effect/Combo50",this._isCanActiveFrenzy=!1,this._addSpdTime=l.EGameEnum.FRENZY_TIME,this.mFrenzySp.active=!0,this.mTuowei.active=!0,this._isEndFrenzy=!1,this.setLinearVelocity();else if([10,20,30,40].indexOf(this._collisionPlantNum)<0)return;c.ResUtil.loadAsset({path:o,type:cc.Prefab,bundleName:u.Bundles.GAME}).then(function(t){var o=cc.instantiate(t);a.addChild(o),o.position=i,o.getComponent(_.default).play(e._collisionPlantNum)}).catch(function(t){console.log("error:",t)})}},e.prototype.pushCollisionWater=function(t){if(this._collisionWater.indexOf(t)<0){var e=this._collisionWater.length;this._collisionWater.push(t),e<=0&&this.setLinearVelocity(!0)}},e.prototype.removeCollisionWater=function(t){var e=this._collisionWater.indexOf(t);e>=0&&(this._collisionWater.splice(e,1),this._collisionWater.length<=0&&this.setLinearVelocity(!0))},__decorate([D(cc.RigidBody)],e.prototype,"mRigidBody",void 0),__decorate([D(cc.Prefab)],e.prototype,"mCollisionEffectPb",void 0),__decorate([D(cc.Node)],e.prototype,"mFrenzySp",void 0),__decorate([D(cc.Node)],e.prototype,"mTuowei",void 0),__decorate([b],e)}(cc.Component);n.default=S,cc._RF.pop(),cc._RF.pop()},{}],BulletBase:[function(t,e,a){"use strict";cc._RF.push(e,"fc834pAJCpKzZOC4+yzDhZq","BulletBase");var i=t,o=e,n=a;cc._RF.push(o,"56efdRnp/pHEJhRN0N+XmLD","BulletBase"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("MathUtil"),s=i("ResUtil"),c=i("SimplyCircleCollider"),l=i("SimplyRectCollider"),u=i("SimplyCollisionDetector"),p=i("MotionTrail"),h=i("GameEnum"),d=i("HomeEnum"),m=i("NodePoolManager"),f=i("BattleDataProxy"),_=i("SkillDataMgr"),y=i("EnemyBase"),g=i("BulletHit"),v=cc._decorator,P=v.ccclass,b=v.property,D=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mIsSpAni=!1,e.mImg=null,e.mBulletHitPb=null,e.mSpAni=null,e._atkTarget=null,e._atkPos=null,e._plantId=0,e._synthesisLv=0,e._moveSpd=15,e.mLastPos=null,e._scaleEquips=[4,7,11],e._atkCount=0,e._moveNormalize=null,e._collisionNodes=[],e._isMoveNormalize=!1,e._catapultNumber=0,e._isCheckCollision=!1,e._oneAtkTargetNum=1,e._atkRate=1,e._isPenetrate=!1,e._superRate=1,e._isNeedAtkTarget=!0,e._isPauseGame=!1,e._idx=0,e._colliderTime=h.EGameEnum.CHECK_COLLIDER_TIME,e._isTop=!1,e._isRage=!1,e}return __extends(e,t),e.prototype.update=function(t){if(f.battleDataProxy.gameState==h.GameState.PLAYING||f.battleDataProxy.gameState==h.GameState.READY){this.setNextAtkTarget();var e=this.getMoveSpd(t),a=null;if(!(a=this._atkTarget&&this._atkTarget.isValid?this._atkTarget.position.clone().addSelf(cc.v3(0,this._atkTarget.height/2)):this._atkPos))return console.log("\u76ee\u6807\u4ee5\u7ecf\u4e22\u5931"),void m.default.instance.putNode(this.node);var i=r.MathUtil.distance(this.node.position,a),o=null;i<=e||this._isMoveNormalize?(this._isMoveNormalize=!0,o=this._moveNormalize):o=this.node.position.clone().sub(a.clone()).normalize(),this.node.x-=e*o.x,this.node.y-=e*o.y,this.setAngle();var n=cc.winSize;this.node.x>n.width||this.node.x<-n.width||this.node.y>n.height||this.node.y<-n.height?m.default.instance.putNode(this.node):this._isCheckCollision?(this._colliderTime-=t,this._colliderTime<=0&&(this._colliderTime=h.EGameEnum.CHECK_COLLIDER_TIME,this.monsterColliderCheck())):i<=e&&this.moveArrive()}},e.prototype.getMoveSpd=function(t){var e=this._moveSpd;return 3==this._plantId?e=.7*this._moveSpd:1==this._plantId?e=1.2*this._moveSpd:8==this._plantId?e=.9*this._moveSpd:13==this._plantId&&(e=.8*this._moveSpd),e*(t/(1/60))},e.prototype.setNextAtkTarget=function(t){if(void 0===t&&(t=0),this._isNeedAtkTarget){if(this.getIsChangeAtkTarget())for(var e=f.battleDataProxy.getPlantAtkTargets(5,this._plantId,!1,this._isTop,!0),a=0;a<e.length;++a){var i=e[a];if(i&&i.isValid&&!i.getComponent(y.default).getIsDie()){if(0==t){this._atkTarget=i,this._atkPos=this._atkTarget.position.clone();break}var o=this._atkTarget&&this._atkTarget.isValid?this._atkTarget:this.node;if(r.MathUtil.distance(o.position,i.position)<=t){this._atkTarget=i,this._atkPos=this._atkTarget.position.clone();break}}}}else this._atkTarget=null},e.prototype.getIsChangeAtkTarget=function(){return!this._atkTarget||!this._atkTarget.isValid||!!this._atkTarget.getComponent(y.default).getIsDie()},Object.defineProperty(e.prototype,"atkRate",{set:function(t){this._atkRate=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"superRate",{set:function(t){this._superRate=t},enumerable:!1,configurable:!0}),e.prototype.setOneAtkTargetNum=function(t){this._oneAtkTargetNum=t},e.prototype.setAtkPos=function(t){this._atkPos=t.clone(),this._atkTarget=null,this._isNeedAtkTarget=!1,this._moveNormalize=this.node.position.clone().sub(this._atkPos.clone()).normalize()},e.prototype.setCatapultNumber=function(t){this._catapultNumber=t},e.prototype.initBullet=function(t,e,a,i,o){var n,r;if(!e||!e.isValid)return m.default.instance.putNode(this.node),void console.log("\u76ee\u6807\u4e22\u5931\uff0c\u65e0\u6548\u5c04\u51fb");this._isRage=o,this._atkTarget=e,this._isTop=null===(n=this._atkTarget.getComponent(y.default))||void 0===n?void 0:n.isTop,this._isNeedAtkTarget=!0,this._atkPos=e.position.clone(),this._atkCount=i,this.mLastPos=null,this._collisionNodes=[],this._atkTarget&&this._atkTarget.isValid&&(this._atkPos=this._atkPos.clone().addSelf(cc.v3(0,this._atkTarget.height/2))),"BuildBase"==e.name||"BossSkill5"==e.name?this._isCheckCollision=!1:this._isCheckCollision=!0,this._isMoveNormalize=!1,this._moveNormalize=this.node.position.clone().sub(this._atkPos.clone()).normalize(),this.node.scale=8==t?1.2:8==t?1.5:1,this._synthesisLv=a,this._plantId=t,this._catapultNumber=f.battleDataProxy.getCatapultNumber(t),cc.Tween.stopAllByTarget(this.node),this.getIsScale(),null===(r=this.getComponent(p.default))||void 0===r||r.initMotionTrail()},e.prototype.setDapTargetNode=function(){if(this._catapultNumber<=0)return!1;if(!this.node||!this.node.isValid||!this.node.parent)return!1;for(var t=f.battleDataProxy.enemyNodes.slice(),e=0;e<t.length;++e){var a=t[e];if(a!=this._atkTarget&&a&&a.isValid){var i=r.MathUtil.distance(this.node.position,a.position);if(i<=500&&i>100)return this._atkTarget=a,this._atkPos=this._atkTarget.position,this._catapultNumber--,this._isMoveNormalize=!1,!0}}return t.length>0&&(this._atkTarget=t[0],this._atkPos=this._atkTarget.position,this._catapultNumber--,this._isMoveNormalize=!1,!0)},e.prototype.moveArrive=function(t){if(t||(t=this._atkTarget),t&&t.isValid){var e=t.getComponent(y.default).monsterCfg,a=f.battleDataProxy.getBulletHarm(e.type,this._plantId,this._synthesisLv,this._atkCount,this._oneAtkTargetNum,this._atkRate,this._superRate),i=0,o=0;if(7==this._plantId){var n=0,r=f.battleDataProxy.checkHasSkill(70001);r&&(n=100*r.skillData.probability);var s=f.battleDataProxy.checkHasSkill(70004);s&&(n=100*s.skillData.probability);var c=!1;Math.floor(1e3*Math.random())%100<n&&(c=!0),c&&(l=_.default.instance.getSkillProperty(13,this._plantId))>0&&(a.num*=l,r&&(i=r.skillData.time,o=.2))}else if(14==this._plantId){var l;1==this._idx&&(l=_.default.instance.getSkillProperty(13,this._plantId))>0&&(a.num*=l)}t.getComponent(y.default).beAttack(a,this._plantId,!1,!0),t.getComponent(y.default).speedCut(i,o)}this.setDapTargetNode()?(this._isCheckCollision=!1,this._isMoveNormalize=!1):this._isPenetrate||m.default.instance.putNode(this.node)},e.prototype.setAngle=function(){var t=this.node.position;if(this.mLastPos){var e=-1e4;if(t!=this.mLastPos){var a=t.sub(this.mLastPos),i=cc.v2(a),o=cc.v2(1,0),n=i.magSqr(),r=o.magSqr();if(0==n||0==r)return;var s=i.signAngle(o),c=Math.floor(cc.misc.radiansToDegrees(s));e=c,c=-c,this.node.angle=c,this.mLastPos=t}return e}this.mLastPos=t},e.prototype.addBulletHit=function(t){var e,a=m.default.instance.getNode(this.mBulletHitPb);f.battleDataProxy.bulletView.addChild(a,this.node.zIndex);var i=null,o=t;if(t&&t.isValid){var n=t.scale;i=t.position.addSelf(cc.v3(0,t.height*n*.7))}else this._atkTarget&&this._atkTarget.isValid?(n=this._atkTarget.scale,i=this._atkTarget.position.addSelf(cc.v3(0,this._atkTarget.height*n*.7)),o=this._atkTarget):i=this.node.position;return o&&o.isValid&&(null===(e=o.getComponent(y.default))||void 0===e||e.updateHitEffectNodes(a,this._plantId)),a.position=i,a.getComponent(g.default).mTargetNode=o,a.getComponent(g.default).initBulletHit(this._plantId,this._synthesisLv,this._isRage),a},e.prototype.getIsScale=function(){for(var t=0;t<this._scaleEquips.length;++t)if(this._plantId==this._scaleEquips[t])return!0;return!1},e.prototype.monsterColliderCheck=function(t){if(f.battleDataProxy.getIsCheckCollision(this.node))for(var e=this.node.getComponent(c.default),a=f.battleDataProxy.enemyNodes.slice(),i=0;i<a.length;++i){var o=a[i];if(e&&o&&o.isValid&&!this.getIsHaveCollisionNode(o)){var n=o.getChildByName("collision").getComponent(l.default);if(n&&u.default.isCollisionRectToCircle(n.rect,e.circle)&&(this.moveArrive(o),!t))break}}},e.prototype.getIsHaveCollisionNode=function(t){return this._collisionNodes.includes(t)},e.prototype.getBulletImgPath=function(){return f.battleDataProxy.getIsSuperPlant(this._plantId)||this._isRage?"CWzidan"+this._plantId:"zidan"+this._plantId},e.prototype.setBulletSpriteFrame=function(){var t=this;s.ResUtil.loadAsset({path:"textures/bulletHit/BulletHit",type:cc.SpriteAtlas,bundleName:d.Bundles.GAME}).then(function(e){t.mImg.spriteFrame=e.getSpriteFrame(t.getBulletImgPath())}).catch(function(t){console.log("error:",t)})},__decorate([b()],e.prototype,"mIsSpAni",void 0),__decorate([b({type:cc.Sprite,tooltip:"\u662f\u5426\u5c55\u793aImg",visible:function(){return!this.mIsSpAni}})],e.prototype,"mImg",void 0),__decorate([b({type:cc.Prefab,tooltip:"\u51fb\u4e2d\u7834\u788e\u52a8\u753b\u9884\u5236\u4f53",visible:function(){return!this.mIsSpAni}})],e.prototype,"mBulletHitPb",void 0),__decorate([b({type:sp.Skeleton,tooltip:"\u662f\u5426\u5c55\u793aspine\u52a8\u753b",visible:function(){return this.mIsSpAni}})],e.prototype,"mSpAni",void 0),__decorate([P],e)}(cc.Component);n.default=D,cc._RF.pop(),cc._RF.pop()},{}],BulletBoom:[function(t,e,a){"use strict";cc._RF.push(e,"4e2b7fCzdpHYrUJShBe5A+c","BulletBoom");var i=t,o=e,n=a;cc._RF.push(o,"c33c7lvAG1Ks4pgTMMjkQgR","BulletBoom"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AnimationCfgMgr"),s=i("AnimationCtrl"),c=cc._decorator,l=c.ccclass,u=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mAnimCtrl=null,e}return __extends(e,t),e.prototype.initBulletBoom=function(t){var e=this;void 0===t&&(t=null),this.mAnimCtrl.loadAtlasAnimation(r.AnimationCfgMgr.instance.getBulletBoom()).then(function(){t&&t(),e.node&&e.node.isValid&&e.mAnimCtrl.playAnim("bulletBoom",!1,function(){e.node.destroy(),e.node.removeFromParent()},null,2)})},__decorate([u({type:s.default})],e.prototype,"mAnimCtrl",void 0),__decorate([l],e)}(cc.Component);n.default=p,cc._RF.pop(),cc._RF.pop()},{}],BulletFire:[function(t,e,a){"use strict";cc._RF.push(e,"f23c4/JuW5KFaS2wEjzBMXa","BulletFire");var i=t,o=e,n=a;cc._RF.push(o,"7fb28YhhqRKorJTaO5hLPil","BulletFire"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("GameEnum"),s=i("BattleDataProxy"),c=i("EnemyBase"),l=cc._decorator,u=l.ccclass,p=(l.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._pathIdx=0,e._leftIdxs=[2,4,6,8],e._rightIdxs=[1,3,5,7],e._showIdx=0,e._frameTime=0,e._continueTime=0,e._isContinue=!1,e._atkNum=0,e._atkRate=0,e._atkEnemyNodes=[],e}return __extends(e,t),e.prototype.initBulletFire=function(t,e,a,i){var o=this;this._pathIdx=t,this._continueTime=a,this._atkNum=e,this._atkRate=i,a>0&&(this._isContinue=!0,this.unschedule(this.continueHurt),this.schedule(this.continueHurt,1));var n=this.node.children;if(1==this._pathIdx){this.node.angle=90;for(var r=0;r<n.length;++r)n[r].angle=-90}this._showIdx=0,n[0].getComponent(sp.Skeleton).setAnimation(0,"fire",!0),n[n.length-1].getComponent(sp.Skeleton).setCompleteListener(function(t){"fire"==(t.animation?t.animation.name:"")&&(o._isContinue||(o.setEnemyBaseIsBeFire(),o.node.destroy(),o.node.removeFromParent()))})},e.prototype.continueHurt=function(){s.battleDataProxy.gameState!=r.GameState.PLAYING&&s.battleDataProxy.gameState!=r.GameState.READY||(this._continueTime--,this.atkEnemy(),this._continueTime<=1&&(this.setEnemyBaseIsBeFire(),this.unschedule(this.continueHurt),this.node.destroy(),this.node.removeFromParent()))},e.prototype.setEnemyBaseIsBeFire=function(){for(var t=0;t<this._atkEnemyNodes.length;++t){var e=this._atkEnemyNodes[t];e&&e.isValid&&(e.getComponent(c.default).isBeFire=!1)}},e.prototype.update=function(t){if((s.battleDataProxy.gameState==r.GameState.PLAYING||s.battleDataProxy.gameState==r.GameState.READY)&&(this._frameTime+=t,this._frameTime>=.1)){this._frameTime=0;var e=this._leftIdxs[this._showIdx],a=this._rightIdxs[this._showIdx],i=this.node.getChildByName("fire"+e),o=this.node.getChildByName("fire"+a);this._showIdx++,i&&(this._showIdx>=this._leftIdxs.length?i.getComponent(sp.Skeleton).setAnimation(0,"fire",this._isContinue):i.getComponent(sp.Skeleton).setAnimation(0,"fire",!0)),o&&(this._showIdx>=this._rightIdxs.length?o.getComponent(sp.Skeleton).setAnimation(0,"fire",this._isContinue):o.getComponent(sp.Skeleton).setAnimation(0,"fire",!0),1==this._showIdx&&this.atkEnemy(!0))}},e.prototype.atkEnemy=function(t){void 0===t&&(t=!1);for(var e=s.battleDataProxy.enemyNodes.slice(),a=0;a<e.length;++a){var i=e[a];if(i&&i.isValid){var o=Math.abs(this.node.x-i.x),n=Math.abs(this.node.y-i.y),r=!1;if(1==this._pathIdx?n<=this.node.width/2&&o<=this.node.height/2&&(r=!0):o<=this.node.width/2&&n<=this.node.height/2&&(r=!0),r){var l=i.getComponent(c.default).monsterCfg,u=s.battleDataProxy.getFixedPlantBulletHarm(this._atkNum,l.atkType,1);this._isContinue&&!t&&(u.num=Math.ceil(u.num*this._atkRate)),i.getComponent(c.default).beAttack(u,102,!0),this._atkEnemyNodes.indexOf(i)<0&&(i.getComponent(c.default).isBeFire=!0,this._atkEnemyNodes.push(i))}}}},__decorate([u],e)}(cc.Component));n.default=p,cc._RF.pop(),cc._RF.pop()},{}],BulletGrape:[function(t,e,a){"use strict";cc._RF.push(e,"786d0Xe7cBGAb8DGBoP/o4W","BulletGrape");var i=t,o=e,n=a;cc._RF.push(o,"803bbLQnANEZqys0KoiFK8n","BulletGrape"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("MathUtil"),s=i("SimplyCircleCollider"),c=i("SimplyRectCollider"),l=i("SimplyCollisionDetector"),u=i("GameEnum"),p=i("BattleDataProxy"),h=i("EnemyBase"),d=cc._decorator,m=d.ccclass,f=d.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mImg=null,e._isStart=!1,e._velocity=cc.v2(1,1),e._moveSpd=2.4*u.EGameEnum.BALL_SPEED,e._colliderTime=0,e._collisionWallNodes=[],e._collisionEnemyNodes=[],e._atkNum=0,e._checkColliderTime=u.EGameEnum.CHECK_COLLIDER_TIME,e}return __extends(e,t),e.prototype.initBullet=function(t,e){this._isStart=!0,this._atkNum=t;var a=e*this.randAngle(),i=r.MathUtil.getRadian(a);this._velocity.x=Math.cos(i),this._velocity.y=Math.sin(i),this._colliderTime=4},e.prototype.randAngle=function(){var t=Math.floor(1e4*Math.random())%360;return t%90==0?t+25:t},e.prototype.update=function(t){this._isStart&&(p.battleDataProxy.gameState!=u.GameState.PLAYING&&p.battleDataProxy.gameState!=u.GameState.READY||(this.pathWallColliderCheck(),this._checkColliderTime-=t,this._checkColliderTime<=0&&(this._checkColliderTime=u.EGameEnum.CHECK_COLLIDER_TIME,this.monsterColliderCheck()),this.move(t),this._colliderTime-=t,this._colliderTime<=0&&(this.node.destroy(),this.node.removeFromParent())))},e.prototype.pathWallColliderCheck=function(){for(var t=this.node.getComponent(s.default),e=p.battleDataProxy.pathWalls.slice(),a=0;a<e.length;++a){var i=e[a];if(t){var o,n=i.getComponent(c.default);n&&(l.default.isCollisionRectToCircle(n.rect,t.circle)?(o=this._collisionWallNodes.indexOf(i))<0&&(this.onWallColliderLogic(i),this._collisionWallNodes.push(i)):(o=this._collisionWallNodes.indexOf(i))>=0&&this._collisionWallNodes.splice(o,1))}}},e.prototype.onWallColliderLogic=function(t){var e=this._velocity.clone(),a=null;switch(t.name){case"left":a=cc.v2(1,0);break;case"right":a=cc.v2(-1,0);break;case"top":a=cc.v2(0,-1);break;case"bottom":a=cc.v2(0,1)}if(a){var i=e.dot(a),o=e.sub(a.mul(2*i));this._velocity=o}else{a=this.node.getPosition().sub(t.getPosition()).normalize();var n=e.dot(a),r=e.sub(a.mul(2*n));this._velocity=r}},e.prototype.move=function(t){if(this.node&&this.node.isValid){var e=this.node.position,a=cc.v3(this._velocity.x*this._moveSpd,this._velocity.y*this._moveSpd);e=e.add(a.mul(t)),this.node.setPosition(e)}},e.prototype.monsterColliderCheck=function(){if(p.battleDataProxy.getIsCheckCollision(this.node))for(var t=this.node.getComponent(s.default),e=p.battleDataProxy.enemyNodes.slice(),a=0;a<e.length;++a){var i=e[a];if(t&&i&&i.isValid){var o,n=i.getChildByName("collision").getComponent(c.default);if(n)if(l.default.isCollisionRectToCircle(n.rect,t.circle)){if((o=this._collisionEnemyNodes.indexOf(i))<0){var r={isCrit:!1,num:Math.ceil(this._atkNum)};i.getComponent(h.default).beAttack(r,104)||this._collisionEnemyNodes.push(i)}}else(o=this._collisionEnemyNodes.indexOf(i))>=0&&this._collisionEnemyNodes.splice(o,1)}}},__decorate([f(cc.Sprite)],e.prototype,"mImg",void 0),__decorate([m],e)}(cc.Component);n.default=_,cc._RF.pop(),cc._RF.pop()},{}],BulletHit6:[function(t,e,a){"use strict";cc._RF.push(e,"0acc8Ow/5pD7ZlTKF/T0rJ5","BulletHit6");var i=t,o=e,n=a;cc._RF.push(o,"01acct7EchF4rm/nZTPKVMy","BulletHit6"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("MathUtil"),c=i("GameEnum"),l=i("HomeEnum"),u=i("BattleDataProxy"),p=i("SkillDataMgr"),h=i("EnemyBase"),d=i("BulletHit"),m=cc._decorator,f=m.ccclass,_=m.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mHitImg=null,e._isBoom=!1,e._boomTime=0,e._atkNum=0,e._synthesisLv=0,e}return __extends(e,t),e.prototype.initBulletHit=function(t,e){var a=this;this._synthesisLv=e,this.mHitSpine.setCompleteListener(function(t){"skill"==(t.animation?t.animation.name:"")&&(a.node.destroy(),a.node.removeFromParent())}),this._boomTime=1,u.battleDataProxy.checkHasSkill(60001)&&(this._isBoom=!0,this._atkNum=5),this.mHitSpine.setEventListener(function(t,e){e.data.name;for(var i=u.battleDataProxy.enemyNodes.slice(),o=0;o<i.length;++o){var n=i[o];if(n&&n.isValid){if(a._atkNum<=0)break;if(s.MathUtil.distance(n.position,a.node.position)<=100){a._atkNum--;var r=n.getComponent(h.default).monsterCfg,c=p.default.instance.getSkillProperty(13,6),l=u.battleDataProxy.getBulletHarm(r.type,6,a._synthesisLv,1,1,1,1);l.num=Math.floor(l.num*c),n.getComponent(h.default).beAttack(l,6,!0)}}}}),this.node.zIndex=-this.node.y,r.AudioManager.instance.playEffectPath("sounds/bulletHit6",l.Bundles.RES)},e.prototype.update=function(t){u.battleDataProxy.gameState==c.GameState.PLAYING||u.battleDataProxy.gameState==c.GameState.READY?(this.mHitSpine.node.active&&(this.mHitSpine.paused=!1),this._boomTime<=0||(this._boomTime-=t,this._boomTime<=0&&(this._isBoom?(this.mHitImg.node.active=!1,this.mHitSpine.node.active=!0,this.mHitSpine.setAnimation(0,"skill",!1)):(this.node.destroy(),this.node.removeFromParent())))):this.mHitSpine.node.active&&(this.mHitSpine.paused=!0)},__decorate([_(cc.Sprite)],e.prototype,"mHitImg",void 0),__decorate([f],e)}(d.default);n.default=y,cc._RF.pop(),cc._RF.pop()},{}],BulletHit:[function(t,e,a){"use strict";cc._RF.push(e,"d40926cdfRIxo9GX5qMQNes","BulletHit");var i=t,o=e,n=a;cc._RF.push(o,"5a2ed3YFbBPIZJMy42xNl6H","BulletHit"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AnimationCfgMgr"),s=i("AnimationCtrl"),c=i("NodePoolManager"),l=i("EnemyBase"),u=cc._decorator,p=u.ccclass,h=u.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mIsSpAni=!1,e.mAnimCtrl=null,e.mHitSpine=null,e.mTargetNode=null,e._bulletId=0,e}return __extends(e,t),e.prototype.initBulletHit=function(t,e,a){var i=this;this._bulletId=t,this.mAnimCtrl.clearAnimEvent(),this.mAnimCtrl.loadAtlasAnimation(r.AnimationCfgMgr.instance.getBulletHitCfg(t,e,a)).then(function(){i.node&&i.node.isValid&&i.mAnimCtrl.playAnim("bulletHit",!1,function(){var t;i.mTargetNode&&i.mTargetNode.isValid&&(null===(t=i.mTargetNode.getComponent(l.default))||void 0===t||t.removeHitEffectNode(i.node,i._bulletId)),c.default.instance.putNode(i.node)},null,3.5)})},__decorate([h()],e.prototype,"mIsSpAni",void 0),__decorate([h({type:s.default,tooltip:"\u662f\u5426\u5c55\u793aImg",visible:function(){return!this.mIsSpAni}})],e.prototype,"mAnimCtrl",void 0),__decorate([h({type:sp.Skeleton,tooltip:"\u662f\u5426\u5c55\u793aspine",visible:function(){return this.mIsSpAni}})],e.prototype,"mHitSpine",void 0),__decorate([p],e)}(cc.Component);n.default=d,cc._RF.pop(),cc._RF.pop()},{}],BulletPlant101:[function(t,e,a){"use strict";cc._RF.push(e,"fceaf5Y1SZI3a5AF6AATABv","BulletPlant101");var i=t,o=e,n=a;cc._RF.push(o,"bfa1d+8Uc1D3qx3YXylpIfs","BulletPlant101"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("SimplyRectCollider"),s=i("SimplyCollisionDetector"),c=i("BattleDataProxy"),l=i("EnemyBase"),u=cc._decorator,p=u.ccclass,h=u.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mSpine=null,e._atkNum=0,e}return __extends(e,t),e.prototype.initBullet=function(t){var e=this;this._atkNum=t,this.mSpine.setEventListener(function(){for(var t,a=c.battleDataProxy.enemyNodes.slice(),i=e.node.getComponent(r.default),o=0;o<a.length;++o){var n=a[o];if(n&&n.isValid){var u=n.getChildByName("collision").getComponent(r.default);if(u&&s.default.isCollisionRectToRect(u.rect,i.rect)){var p=null===(t=n.getComponent(l.default))||void 0===t?void 0:t.monsterCfg;if(!p)continue;var h=c.battleDataProxy.getFixedPlantBulletHarm(e._atkNum,p.atkType,1);n.getComponent(l.default).beAttack(h,101),n.getComponent(l.default).flaser()}}}}),this.mSpine.setCompleteListener(function(){e.node.destroy(),e.node.removeFromParent()}),this.play()},e.prototype.play=function(){this.mSpine.setAnimation(0,"skill",!1)},__decorate([h(sp.Skeleton)],e.prototype,"mSpine",void 0),__decorate([p],e)}(cc.Component);n.default=d,cc._RF.pop(),cc._RF.pop()},{}],BulletPlant106:[function(t,e,a){"use strict";cc._RF.push(e,"91d6cnVwrRK4JIL0C8PqYLZ","BulletPlant106");var i=t,o=e,n=a;cc._RF.push(o,"0fb9fgfKDhJMr4OYQ723mNs","BulletPlant106"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("MathUtil"),c=i("GameEnum"),l=i("HomeEnum"),u=i("BattleDataProxy"),p=i("EnemyBase"),h=i("BulletBoom"),d=cc._decorator,m=d.ccclass,f=d.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mSpine=null,e.mBulletBoomPb=null,e._boomTime=0,e._isMove=!1,e._atkNum=0,e}return __extends(e,t),e.prototype.initFixedPlantBullet=function(t,e){var a=this;if(!e||!e.isValid)return console.log("\u76ee\u6807\u4e22\u5931\uff0c\u8fd9\u6b21\u4e0d\u7b97"),this.node.destroy(),void this.node.removeFromParent();u.battleDataProxy.nutWalNodes.push(this.node),this._atkNum=t,this._boomTime=1,this.node.position=this.getCreatePosition(e),this.mSpine.setCompleteListener(function(t){"atk"==(t.animation?t.animation.name:"")&&(a._isMove=!0,a.mSpine.setAnimation(0,"stand",!0))}),this.mSpine.setAnimation(0,"atk",!1),this._isMove=!1,this.node.zIndex=-this.node.y},e.prototype.getCreatePosition=function(t){if(t.x<=this.node.width/2-275){var e=t.y-100;return e=e>0?e>620?620:e:e<-438?-438:e,cc.v3(-286,e)}return t.y>0?cc.v3(t.x-100,620):cc.v3(t.x+100,-438)},e.prototype.update=function(t){u.battleDataProxy.gameState==c.GameState.PLAYING||u.battleDataProxy.gameState==c.GameState.READY?(this.mSpine.paused=!1,this._isMove&&(this._boomTime-=t,this._boomTime<=0&&(this._isMove=!1,this.addBulletBoom()))):this.mSpine.paused=!0},e.prototype.addBulletBoom=function(){var t=this;r.AudioManager.instance.playEffectPath("sounds/plant12",l.Bundles.RES);var e=cc.instantiate(this.mBulletBoomPb);u.battleDataProxy.bulletView.addChild(e,1e3),e.position=this.node.position.addSelf(cc.v3(0,this.node.height/2)),e.scale=2,e.getComponent(h.default).initBulletBoom(function(){t.startBoom()})},e.prototype.startBoom=function(){for(var t=u.battleDataProxy.enemyNodes.slice(),e=0;e<t.length;++e){var a=t[e];if(a&&a.isValid&&s.MathUtil.distance(a.position,this.node.position)<=200){var i=a.getComponent(p.default).monsterCfg,o=u.battleDataProxy.getFixedPlantBulletHarm(this._atkNum,i.type,1);a.getComponent(p.default).beAttack(o,106,!0)}}var n=u.battleDataProxy.nutWalNodes.indexOf(this.node);n>=0&&u.battleDataProxy.nutWalNodes.splice(n,1),this.node.destroy(),this.node.removeFromParent()},__decorate([f(sp.Skeleton)],e.prototype,"mSpine",void 0),__decorate([f(cc.Prefab)],e.prototype,"mBulletBoomPb",void 0),__decorate([m],e)}(cc.Component);n.default=_,cc._RF.pop(),cc._RF.pop()},{}],BulletPlant10:[function(t,e,a){"use strict";cc._RF.push(e,"190f7fC/ghEt45XUlrS/5zO","BulletPlant10");var i=t,o=e,n=a;cc._RF.push(o,"f0a1fNX8bBJAoUIZ9rNwtJH","BulletPlant10"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("BattleDataProxy"),s=i("SkillDataMgr"),c=i("EnemyBase"),l=i("BulletBase"),u=i("BulletPoison"),p=cc._decorator,h=p.ccclass,d=p.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mBulletPoisonPb=null,e}return __extends(e,t),e.prototype.initBullet=function(e,a,i,o){t.prototype.initBullet.call(this,e,a,i,o),this.setBulletSpriteFrame()},e.prototype.moveArrive=function(e){if(this.getIsChangeAtkTarget()&&(this.setNextAtkTarget(100),e=this._atkTarget),this.addBulletHit(e),e&&e.isValid){var a=r.battleDataProxy.checkHasSkill(100001);if(a){var i=100*a.skillData.probability;if(Math.floor(1e3*Math.random())%100<i){var o=cc.instantiate(this.mBulletPoisonPb);r.battleDataProxy.bulletView.addChild(o,1e3),o.position=this.node.position;var n=s.default.instance.getSkillProperty(13,this._plantId),l=e.getComponent(c.default).monsterCfg,p=r.battleDataProxy.getBulletHarm(l.type,this._plantId,this._synthesisLv,this._atkCount,this._oneAtkTargetNum,this._atkRate,this._superRate),h={isCrit:p.isCrit,num:p.num*n*this._atkRate};o.getComponent(u.default).initBulletPoison(this._plantId,a.skillData.time,h)}}}t.prototype.moveArrive.call(this,e)},__decorate([d(cc.Prefab)],e.prototype,"mBulletPoisonPb",void 0),__decorate([h],e)}(l.default);n.default=m,cc._RF.pop(),cc._RF.pop()},{}],BulletPlant11:[function(t,e,a){"use strict";cc._RF.push(e,"a0758dsBJFIO6XaBRgWh8Km","BulletPlant11");var i=t,o=e,n=a;cc._RF.push(o,"16679YDoR9AXa/PovZerlbB","BulletPlant11"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("MathUtil"),s=i("GameEnum"),c=i("BattleDataProxy"),l=i("SkillDataMgr"),u=i("EnemyBase"),p=i("BulletBase"),h=cc._decorator,d=h.ccclass,m=(h.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initBullet=function(e,a,i,o,n){t.prototype.initBullet.call(this,e,a,i,o,n),this.setBulletSpriteFrame(),this._isCheckCollision=!1},e.prototype.startMove=function(t){var e=this;t.getComponent(u.default).initSimulationData();var a=r.MathUtil.distance(this.node.position,this._atkPos.clone())/(30*this._moveSpd);this._atkPos=t.getComponent(u.default).getMovePosByTime(a);var i=this._atkPos.clone();this.bezierTo(cc.v2(this.node.position),this.getC2(cc.v2(this.node.position),cc.v2(i)),cc.v2(i),a,!0,function(){e.moveArrive()}),cc.tween(this.node).to(a,{angle:1440}).start()},e.prototype.setAtkPos=function(t){this._atkPos=t.clone()},e.prototype.bezierTo=function(t,e,a,i,o,n,s,c){void 0===s&&(s=""),void 0===c&&(c=null),cc.Tween.stopAllByTarget(this.node),r.MathUtil.bezierTo(this.node,i,t,e,a,function(t,e){c&&c(t,e)},s).call(function(){n&&n()}).start()},e.prototype.getC2=function(t,e){var a=Math.abs(t.x-e.x),i=t.x>e.x?t.x-a/2:t.x+a/2,o=250*Math.random()+250;return t.y>e.y?cc.v2(i,t.y+o):cc.v2(i,e.y+o)},e.prototype.moveArrive=function(t){this.getIsChangeAtkTarget()&&(this.setNextAtkTarget(100),t=this._atkTarget),t||(t=this._atkTarget),this.addBulletHit(t);var e=c.battleDataProxy.checkHasSkill(110001),a=!1,i=50;if(e){var o=100*e.skillData.probability;Math.floor(1e3*Math.random())%100<o&&(a=!0,i*=1+(h=l.default.instance.getSkillProperty(17,this._plantId)))}var n={isCrit:!1,num:0};if(t&&t.isValid){var s=t.getComponent(u.default).monsterCfg;n=c.battleDataProxy.getBulletHarm(s.type,this._plantId,this._synthesisLv,this._atkCount,this._oneAtkTargetNum,this._atkRate,this._superRate)}var p=0;if(a){var h=l.default.instance.getSkillProperty(13,this._plantId);p=n.num*h;for(var d=c.battleDataProxy.enemyNodes.slice(),m=0;m<d.length;++m){var f=d[m];if(f&&f.isValid){var _=t&&t.isValid?t.position.clone():this.node.position.clone();if(r.MathUtil.distance(f.position,_)<=i){if(f==t){var y={isCrit:n.isCrit,num:n.num+p};f.getComponent(u.default).beAttack(y,this._plantId)}else y={isCrit:n.isCrit,num:p},f.getComponent(u.default).beAttack(y,this._plantId);c.battleDataProxy.getIsSuperPlant(this._plantId)&&f.getComponent(u.default).iceSpeedCut()}}}}else t&&t.isValid&&(t.getComponent(u.default).beAttack(n,this._plantId),c.battleDataProxy.getIsSuperPlant(this._plantId)&&t.getComponent(u.default).iceSpeedCut());this.setDapTargetNode()?(this._isCheckCollision=!1,this._isMoveNormalize=!1):(this.node.destroy(),this.node.removeFromParent())},e.prototype.update=function(){c.battleDataProxy.gameState==s.GameState.PLAYING||c.battleDataProxy.gameState==s.GameState.READY?this._isPauseGame&&(this._isPauseGame=!1,this.node.resumeAllActions()):this._isPauseGame||(this._isPauseGame=!0,this.node.pauseAllActions())},__decorate([d],e)}(p.default));n.default=m,cc._RF.pop(),cc._RF.pop()},{}],BulletPlant12:[function(t,e,a){"use strict";cc._RF.push(e,"336cfYBibFPYIMc2xFcGuu0","BulletPlant12");var i=t,o=e,n=a;cc._RF.push(o,"19f41PfUONFzZjld3yQAGHb","BulletPlant12"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("EventManager"),c=i("MathUtil"),l=i("GameEnum"),u=i("HomeEnum"),p=i("BattleDataProxy"),h=i("EnemyBase"),d=i("BulletBase"),m=i("BulletSpikerocks"),f=cc._decorator,_=f.ccclass,y=f.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mBulletSpikerocksPb=null,e._moveState=0,e._upMovePos=null,e._atkNum=0,e}return __extends(e,t),e.prototype.update=function(t){if((p.battleDataProxy.gameState==l.GameState.PLAYING||p.battleDataProxy.gameState==l.GameState.READY)&&this._upMovePos){var e=null;if(!(e=0==this._moveState?this._upMovePos:this._atkTarget&&this._atkTarget.isValid?this._atkTarget.position.clone():this._atkPos))return console.log("\u76ee\u6807\u4ee5\u7ecf\u4e22\u5931"),this.node.destroy(),void this.node.removeFromParent();var a=this._upMovePos?1.5:2,i=this._moveSpd*a*(t/(1/60)),o=this.node.position.clone().sub(e.clone()).normalize();if(this.node.x-=i*o.x,this.node.y-=i*o.y,this.setAngle(),c.MathUtil.distance(this.node.position,e)<=i)if(0==this._moveState){this._moveState=1,this._atkTarget&&this._atkTarget.isValid&&(this._atkPos.x=this._atkTarget.x);var n=this._atkPos;this.node.x=n.x,cc.Tween.stopAllByTarget(this.node);var r=c.MathUtil.distance(this._atkPos.clone(),cc.v3(this.node.x,cc.winSize.height/2))/(120*this._moveSpd),s=(300+p.battleDataProxy.gameCamera.y)/(120*this._moveSpd);this.node.scale=2,cc.tween(this.node).delay(s).to(r,{scale:1}).start()}else this.moveArrive()}},e.prototype.initBullet=function(){},e.prototype.initFixedPlantBullet=function(t,e){if(!e||!e.isValid)return console.log("\u76ee\u6807\u4e22\u5931\uff0c\u8fd9\u6b21\u4e0d\u7b97"),this.node.destroy(),void this.node.removeFromParent();this._plantId=12,this._atkNum=t,this._atkTarget=e,this._atkPos=e.position.clone(),this._moveNormalize=this.node.position.clone().sub(this._atkPos.clone()).normalize(),this._moveState=0,this._upMovePos=cc.v3(this.node.x,cc.winSize.height/2+300+p.battleDataProxy.gameCamera.y);var a=c.MathUtil.distance(this._upMovePos.clone(),this.node.position)/(90*this._moveSpd)*.6;cc.tween(this.node).to(a,{scale:2}).start(),this._isCheckCollision=!1},e.prototype.moveArrive=function(){this.addBulletHit(null),s.EventManager.instance.emit(l.EGameEvent.SCREEN_SHAKE),r.AudioManager.instance.playEffectPath("sounds/plant12",u.Bundles.RES);for(var t=p.battleDataProxy.enemyNodes.slice(),e=0;e<t.length;++e)if((n=t[e])&&n.isValid&&c.MathUtil.distance(n.position,this.node.position)<=150){var a=n.getComponent(h.default).monsterCfg,i=p.battleDataProxy.getFixedPlantBulletHarm(this._atkNum,a.type,1);n.getComponent(h.default).beAttack(i,this._plantId,!0)}var o=p.battleDataProxy.enemyAirship.slice();for(e=0;e<o.length;++e){var n;(n=o[e])&&n.isValid&&c.MathUtil.distance(n.position,this.node.position)<=300&&(a=n.getComponent(h.default).monsterCfg,i=p.battleDataProxy.getFixedPlantBulletHarm(this._atkNum,a.type,1),n.getComponent(h.default).beAttack(i,this._plantId,!0))}if(p.battleDataProxy.getIsSuperPlant(this._plantId)){var d=cc.instantiate(this.mBulletSpikerocksPb);p.battleDataProxy.bulletView.addChild(d),d.position=this.node.position,d.getComponent(m.default).initBulletSpikerocks(this._synthesisLv)}this.node.destroy(),this.node.removeFromParent()},__decorate([y(cc.Prefab)],e.prototype,"mBulletSpikerocksPb",void 0),__decorate([_],e)}(d.default);n.default=g,cc._RF.pop(),cc._RF.pop()},{}],BulletPlant13:[function(t,e,a){"use strict";cc._RF.push(e,"2632baRKkRAEbomwSq7iQng","BulletPlant13");var i=t,o=e,n=a;cc._RF.push(o,"d1cd2krEZFByqoLCgSHvDx9","BulletPlant13"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("SimplyRectCollider"),s=i("SimplyCollisionDetector"),c=i("GameEnum"),l=i("BattleDataProxy"),u=i("EnemyBase"),p=i("BulletBase"),h=i("BulletPlantSplit13"),d=cc._decorator,m=d.ccclass,f=d.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mBulletSplitPb=null,e._isBigSkill=!1,e}return __extends(e,t),e.prototype.initBullet=function(t,e,a,i,o){var n=this;this._plantId=t,this._atkTarget=e,this._synthesisLv=a,this._atkCount=i,this._isRage=o,this.mSpAni.setCompleteListener(function(t){t.animation&&t.animation.name,n.node.destroy(),n.node.removeFromParent()}),this.mSpAni.setEventListener(function(){if(!n._isBigSkill)return n.getIsChangeAtkTarget()&&(n.setNextAtkTarget(100),e=n._atkTarget),n.moveArrive(e),void n.addBulletSplit();for(var t=l.battleDataProxy.enemyNodes.slice(),a=n.node.getComponent(r.default),i=0;i<t.length;++i){var o=t[i];if(o&&o.isValid){var c=o.getChildByName("collision").getComponent(r.default);c&&s.default.isCollisionRectToRect(c.rect,a.rect)&&n.moveArrive(o)}}})},e.prototype.play=function(t){this._isBigSkill=t,this._isBigSkill?this.mSpAni.setAnimation(0,"skill",!1):this.mSpAni.setAnimation(0,"atk",!1)},e.prototype.moveArrive=function(t){if(t&&t.isValid){var e=t.getComponent(u.default).monsterCfg,a=l.battleDataProxy.getBulletHarm(e.type,this._plantId,this._synthesisLv,this._atkCount,this._oneAtkTargetNum,this._atkRate,this._superRate);this._isRage&&(a.num*=1.5),t.getComponent(u.default).beAttack(a,this._plantId,!0)}},e.prototype.addBulletSplit=function(){if(l.battleDataProxy.checkHasSkill(130001)){var t=cc.instantiate(this.mBulletSplitPb);this.node.parent.addChild(t,0),t.position=this.node.position,t.getComponent(h.default).initBulletPlantSplit(this._plantId,this._synthesisLv,this._atkTarget,this._isRage)}},e.prototype.update=function(){l.battleDataProxy.gameState==c.GameState.PLAYING||l.battleDataProxy.gameState==c.GameState.READY?this.mSpAni.paused=!1:this.mSpAni.paused=!0},__decorate([f(cc.Prefab)],e.prototype,"mBulletSplitPb",void 0),__decorate([m],e)}(p.default);n.default=_,cc._RF.pop(),cc._RF.pop()},{}],BulletPlant14:[function(t,e,a){"use strict";cc._RF.push(e,"35d9f8VlGBNoYYboO0SjZcR","BulletPlant14");var i=t,o=e,n=a;cc._RF.push(o,"4970aHZkZRICqyF2HgmmPus","BulletPlant14"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("MathUtil"),s=i("GameEnum"),c=i("BattleDataProxy"),l=i("EnemyBase"),u=i("BulletBase"),p=cc._decorator,h=p.ccclass,d=(p.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._mul=0,e._startPos=null,e._duration=0,e}return __extends(e,t),e.prototype.initBullet=function(e,a,i,o){t.prototype.initBullet.call(this,e,a,i,o),this.setBulletSpriteFrame(),this._isCheckCollision=!1},e.prototype.startMove=function(t,e){var a=this;this._idx=e,t.getComponent(l.default).initSimulationData();var i=r.MathUtil.distance(this.node.position,this._atkPos.clone());this._duration=i/(50*this._moveSpd),this._atkPos=t.getComponent(l.default).getMovePosByTime(this._duration);var o=this._atkPos.clone(),n=cc.v2(o.subtract(cc.v3(0,t.height/2)));this._startPos=this.node.getPosition().clone();var s=this._startPos.add(n).mul(.5);c.battleDataProxy.checkHasSkill(140001)?this._mul=0==e?200:-200:this._mul=Math.floor(1e3*Math.random())%2==0?200:-200;var u=r.MathUtil.getPerpendicularVector((n.x>this._startPos.x?n.sub(this._startPos):this._startPos.sub(n)).normalize().mul(this._mul),s);this.bezierTo(cc.v2(this.node.position),u,cc.v2(o),this._duration,!0,function(){a.moveArrive()}),cc.tween(this.node).to(2*this._duration,{angle:2880}).start()},e.prototype.setAtkPos=function(t){this._atkPos=t.clone()},e.prototype.bezierTo=function(t,e,a,i,o,n,s,c){void 0===s&&(s=""),void 0===c&&(c=null),cc.Tween.stopAllByTarget(this.node),r.MathUtil.bezierTo(this.node,i,t,e,a,function(t,e){c&&c(t,e)},s).call(function(){n&&n()}).start()},e.prototype.getC2=function(t,e){var a=Math.abs(t.x-e.x),i=t.x>e.x?t.x-a/2:t.x+a/2,o=250*Math.random()+250;return t.y>e.y?cc.v2(i,t.y+o):cc.v2(i,e.y+o)},e.prototype.moveArrive=function(e){e||(e=this._atkTarget),this.getIsChangeAtkTarget()&&(this.setNextAtkTarget(100),e=this._atkTarget),this.addBulletHit(e),t.prototype.moveArrive.call(this,e)},e.prototype.update=function(){c.battleDataProxy.gameState==s.GameState.PLAYING||c.battleDataProxy.gameState==s.GameState.READY?this._isPauseGame&&(this._isPauseGame=!1,this.node.resumeAllActions()):this._isPauseGame||(this._isPauseGame=!0,this.node.pauseAllActions())},__decorate([h],e)}(u.default));n.default=d,cc._RF.pop(),cc._RF.pop()},{}],BulletPlant15:[function(t,e,a){"use strict";cc._RF.push(e,"42b6f+q2bFHdLplz8gylBLm","BulletPlant15");var i=t,o=e,n=a;cc._RF.push(o,"2c3d2nOEHdAU7k4wLhtEMA9","BulletPlant15"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("NodePoolManager"),s=i("BattleDataProxy"),c=i("BulletBase"),l=i("BulletSoundWave"),u=cc._decorator,p=u.ccclass,h=u.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mBulletSoundWavePb=null,e}return __extends(e,t),e.prototype.initBullet=function(e,a,i,o){t.prototype.initBullet.call(this,e,a,i,o),this.setBulletSpriteFrame(),this._isCheckCollision=!1},e.prototype.moveArrive=function(e){this.addBulletHit(e),t.prototype.moveArrive.call(this,e)},e.prototype.addBulletHit=function(e){var a=0,i=s.battleDataProxy.checkHasSkill(150001);i&&(a=100*i.skillData.probability);var o=s.battleDataProxy.checkHasSkill(150004);o&&(a=100*o.skillData.probability);var n=!1;if(Math.floor(1e3*Math.random())%100<a&&(n=!0),n)if(s.battleDataProxy.soundWaveTime<=0){s.battleDataProxy.soundWaveTime=.5;var c=cc.instantiate(this.mBulletSoundWavePb);s.battleDataProxy.bulletView.addChild(c,1e3),c.position=this.node.position,c.getComponent(l.default).initBulletFire(this._synthesisLv),r.default.instance.putNode(this.node)}else t.prototype.addBulletHit.call(this,e);else t.prototype.addBulletHit.call(this,e)},e.prototype.addBulletHitEx=function(){},__decorate([h(cc.Prefab)],e.prototype,"mBulletSoundWavePb",void 0),__decorate([p],e)}(c.default);n.default=d,cc._RF.pop(),cc._RF.pop()},{}],BulletPlant2:[function(t,e,a){"use strict";cc._RF.push(e,"78901hdtnRONY+h+nbIbJkW","BulletPlant2");var i=t,o=e,n=a;cc._RF.push(o,"d7854fWDTVDlZ2S1SORrizr","BulletPlant2"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("EventManager"),c=i("MathUtil"),l=i("GameEnum"),u=i("HomeEnum"),p=i("BattleDataProxy"),h=i("EnemyBase"),d=i("BulletBase"),m=cc._decorator,f=m.ccclass,_=(m.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._isCanMove=!0,e._bombNum=0,e._bombScope=150,e._atkNum=0,e}return __extends(e,t),e.prototype.initBullet=function(){},e.prototype.initFixedPlantBullet=function(t,e,a){var i=this;if(!e||!e.isValid)return console.log("\u76ee\u6807\u4e22\u5931\uff0c\u8fd9\u6b21\u4e0d\u7b97"),this.node.destroy(),void this.node.removeFromParent();this._plantId=103,this._atkRate=a,this._atkNum=t,this._atkTarget=e,this._atkPos=e.position.clone(),this._moveNormalize=this.node.position.clone().sub(this._atkPos.clone()).normalize(),this.mSpAni.setCompleteListener(function(t){var e=t.animation?t.animation.name:"";"bomb1"!=e&&"bomb2"!=e||(i._bombNum>0?(i._bombNum--,i.playBomb2()):(i.node.destroy(),i.node.removeFromParent()))}),this.mSpAni.setEventListener(function(t,e){e.data.name;var a,o=p.battleDataProxy.enemyNodes.slice();s.EventManager.instance.emit(l.EGameEvent.SCREEN_SHAKE),r.AudioManager.instance.playEffectPath("sounds/plant2",u.Bundles.RES);for(var n=0;n<o.length;++n){var d=o[n];if(d&&d.isValid&&c.MathUtil.distance(d.position,i.node.position)<=i._bombScope){var m=null===(a=d.getComponent(h.default))||void 0===a?void 0:a.monsterCfg;if(!m)continue;var f=p.battleDataProxy.getFixedPlantBulletHarm(i._atkNum,m.type,1);d.getComponent(h.default).beAttack(f,i._plantId,!0)}}}),this.startMove()},e.prototype.playBomb2=function(){this.mSpAni.paused=!1,this.mSpAni.setAnimation(0,"bomb2",!1)},e.prototype.moveArrive=function(){this._isCanMove=!1,this.node.zIndex=-this.node.y,this.mSpAni.paused=!1,this.mSpAni.setAnimation(0,"bomb1",!1)},e.prototype.update=function(){p.battleDataProxy.gameState==l.GameState.PLAYING||p.battleDataProxy.gameState==l.GameState.READY?this._isPauseGame&&(this._isPauseGame=!1,this.mSpAni.paused=!1,this.node.resumeAllActions()):this._isPauseGame||(this._isPauseGame=!0,this.mSpAni.paused=!0,this.node.pauseAllActions())},e.prototype.setAngle=function(){return 0},e.prototype.startMove=function(){var t=this,e=c.MathUtil.distance(this.node.position,this._atkPos.clone())/(30*this._moveSpd),a=this._atkPos.clone();this.bezierTo(cc.v2(this.node.position),this.getC2(cc.v2(this.node.position),cc.v2(a)),cc.v2(a),e,!0,function(){t.moveArrive()})},e.prototype.bezierTo=function(t,e,a,i,o,n,r,s){void 0===r&&(r=""),void 0===s&&(s=null),cc.Tween.stopAllByTarget(this.node),c.MathUtil.bezierTo(this.node,i,t,e,a,function(t,e){s&&s(t,e)},r).call(function(){n&&n()}).start()},e.prototype.getC2=function(t,e){var a=Math.abs(t.x-e.x),i=t.x>e.x?t.x-a/2:t.x+a/2,o=250*Math.random()+250;return t.y>e.y?cc.v2(i,t.y+o):cc.v2(i,e.y+o)},__decorate([f],e)}(d.default));n.default=_,cc._RF.pop(),cc._RF.pop()},{}],BulletPlant4:[function(t,e,a){"use strict";cc._RF.push(e,"8d9caGgjwVHPaz+K2SGji5n","BulletPlant4");var i=t,o=e,n=a;cc._RF.push(o,"05b82cByY5Li6NEY8sZShZY","BulletPlant4"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("MathUtil"),s=i("GameEnum"),c=i("BattleDataProxy"),l=i("EnemyBase"),u=i("BulletBase"),p=cc._decorator,h=p.ccclass,d=(p.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._isRotate=!1,e}return __extends(e,t),e.prototype.initBullet=function(e,a,i,o){t.prototype.initBullet.call(this,e,a,i,o),this.setBulletSpriteFrame(),this._isCheckCollision=!1},e.prototype.startMove=function(t){var e=this;t.getComponent(l.default).initSimulationData();var a=r.MathUtil.distance(this.node.position,this._atkPos.clone())/(30*this._moveSpd);this._atkPos=t.getComponent(l.default).getMovePosByTime(a);var i=this._atkPos.clone();this.bezierTo(cc.v2(this.node.position),this.getC2(cc.v2(this.node.position),cc.v2(i)),cc.v2(i),a,!0,function(){e.moveArrive()}),c.battleDataProxy.getIsSuperPlant(4)||(cc.tween(this.node).to(a,{angle:1440}).start(),this._isRotate=!0)},e.prototype.setAtkPos=function(t){this._atkPos=t.clone()},e.prototype.bezierTo=function(t,e,a,i,o,n,s,c){void 0===s&&(s=""),void 0===c&&(c=null),cc.Tween.stopAllByTarget(this.node),r.MathUtil.bezierTo(this.node,i,t,e,a,function(t,e){c&&c(t,e)},s).call(function(){n&&n()}).start()},e.prototype.getC2=function(t,e){var a=Math.abs(t.x-e.x),i=t.x>e.x?t.x-a/2:t.x+a/2,o=250*Math.random()+250;return t.y>e.y?cc.v2(i,t.y+o):cc.v2(i,e.y+o)},e.prototype.moveArrive=function(e){e||(e=this._atkTarget),this.getIsChangeAtkTarget()&&(this.setNextAtkTarget(100),e=this._atkTarget),this.addBulletHit(e),t.prototype.moveArrive.call(this,e)},e.prototype.update=function(){c.battleDataProxy.gameState==s.GameState.PLAYING||c.battleDataProxy.gameState==s.GameState.READY?(this._isPauseGame&&(this._isPauseGame=!1,this.node.resumeAllActions()),this._isRotate||this.setAngle()):this._isPauseGame||(this._isPauseGame=!0,this.node.pauseAllActions())},__decorate([h],e)}(u.default));n.default=d,cc._RF.pop(),cc._RF.pop()},{}],BulletPlant6:[function(t,e,a){"use strict";cc._RF.push(e,"e4540wfQIhB9LZJYWTv98w1","BulletPlant6");var i=t,o=e,n=a;cc._RF.push(o,"ec9a8JesdZP/qItU2bpT3k/","BulletPlant6"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("MathUtil"),s=i("GameEnum"),c=i("BattleDataProxy"),l=i("EnemyBase"),u=i("BulletBase"),p=cc._decorator,h=p.ccclass,d=(p.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.startMove=function(t){var e=this;t.getComponent(l.default).initSimulationData();var a=r.MathUtil.distance(this.node.position,this._atkPos.clone())/(30*this._moveSpd);this._atkPos=t.getComponent(l.default).getMovePosByTime(a);var i=this._atkPos.clone();this.bezierTo(cc.v2(this.node.position),this.getC2(cc.v2(this.node.position),cc.v2(i)),cc.v2(i),a,!0,function(){e.moveArrive()})},e.prototype.setAtkPos=function(t){this._atkPos=t.clone()},e.prototype.bezierTo=function(t,e,a,i,o,n,s,c){void 0===s&&(s=""),void 0===c&&(c=null),cc.Tween.stopAllByTarget(this.node),r.MathUtil.bezierTo(this.node,i,t,e,a,function(t,e){c&&c(t,e)},s).call(function(){n&&n()}).start()},e.prototype.getC2=function(t,e){var a=Math.abs(t.x-e.x),i=t.x>e.x?t.x-a/2:t.x+a/2,o=250*Math.random()+250;return t.y>e.y?cc.v2(i,t.y+o):cc.v2(i,e.y+o)},e.prototype.moveArrive=function(e){e||(e=this._atkTarget),this.getIsChangeAtkTarget()&&(this.setNextAtkTarget(100),e=this._atkTarget);var a=this.addBulletHit(e);t.prototype.moveArrive.call(this,e),a&&a.isValid&&(a.angle=this.node.angle)},e.prototype.update=function(){c.battleDataProxy.gameState==s.GameState.PLAYING||c.battleDataProxy.gameState==s.GameState.READY?(this._isPauseGame&&(this._isPauseGame=!1,this.node.resumeAllActions()),this.setAngle()):this._isPauseGame||(this._isPauseGame=!0,this.node.pauseAllActions())},e.prototype.initBullet=function(e,a,i,o){t.prototype.initBullet.call(this,e,a,i,o),this._isCheckCollision=!1},e.prototype.initAtkPos=function(){},__decorate([h],e)}(u.default));n.default=d,cc._RF.pop(),cc._RF.pop()},{}],BulletPlant7:[function(t,e,a){"use strict";cc._RF.push(e,"489704fbeBBIKthHoNEXQME","BulletPlant7");var i=t,o=e,n=a;cc._RF.push(o,"323fdDtFmZJKry53jy9/0iB","BulletPlant7"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("BulletPlant4"),s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),__decorate([c],e)}(r.default));n.default=l,cc._RF.pop(),cc._RF.pop()},{}],BulletPlant9:[function(t,e,a){"use strict";cc._RF.push(e,"ef1abJ8C/5FFLDis1fR6D3Y","BulletPlant9");var i=t,o=e,n=a;cc._RF.push(o,"f1a83mtg51Dqbi++2KX0jF9","BulletPlant9"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("MathUtil"),c=i("GameEnum"),l=i("HomeEnum"),u=i("BattleDataProxy"),p=i("SkillDataMgr"),h=i("EnemyBase"),d=i("BulletBase"),m=cc._decorator,f=m.ccclass,_=(m.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._movePaths=[],e._movePathIdx=0,e._atkEnemyNodes=[],e._atkNum=0,e}return __extends(e,t),e.prototype.initBullet=function(){},e.prototype.initFixedPlantBullet=function(t){this._atkNum=t;var e=u.battleDataProxy.enemyMovePaths[1];if(e.length<=0)return console.log("\u76ee\u6807\u4e22\u5931\uff0c\u8fd9\u6b21\u4e0d\u7b97"),this.node.destroy(),void this.node.removeFromParent();for(var a=e.length-1;a>=0;--a)this._movePaths.push(e[a]);this._atkEnemyNodes=[],this._movePathIdx=1,this.node.position=this._movePaths[0].position,this._atkPos=this._movePaths[this._movePathIdx].position,this.node.angle=90,this.mSpAni.setAnimation(0,"roll",!0)},e.prototype.getIsCanAtk=function(t){for(var e=0;e<this._atkEnemyNodes.length;++e)if(this._atkEnemyNodes[e]==t)return!1;return!0},e.prototype.getMoveSpd=function(){return this._moveSpd/2*(1+p.default.instance.getSkillProperty(2,this._plantId))},e.prototype.update=function(t){var e;if(u.battleDataProxy.gameState==c.GameState.PLAYING||u.battleDataProxy.gameState==c.GameState.READY){var a=this.getMoveSpd()*(t/(1/60)),i=this._atkPos,o=this.node.position.clone().sub(i.clone()).normalize();if(this.node.x-=a*o.x,this.node.y-=a*o.y,s.MathUtil.distance(this.node.position,i)<=a){if(this._movePathIdx++,this._atkPos=(null===(e=this._movePaths[this._movePathIdx])||void 0===e?void 0:e.position)||null,!this._atkPos)return this.node.destroy(),void this.node.removeFromParent();2==this._movePathIdx?this.node.angle=0:(this.node.angle=90,this.node.scaleY=-1)}for(var n=u.battleDataProxy.enemyNodes.slice(),p=0;p<n.length;++p){var d=n[p];if(d&&d.isValid&&!(d.x>=cc.winSize.width/2)&&this.getIsCanAtk(d)&&s.MathUtil.distance(d.position,this.node.position)<=this.node.width){var m=d.getComponent(h.default).monsterCfg,f=u.battleDataProxy.getFixedPlantBulletHarm(this._atkNum,m.type,1);d.getComponent(h.default).beAttack(f,105),this._atkEnemyNodes.push(d),r.AudioManager.instance.playEffectPath("sounds/plant9",l.Bundles.RES)}}}},__decorate([f],e)}(d.default));n.default=_,cc._RF.pop(),cc._RF.pop()},{}],BulletPlantNormal13:[function(t,e,a){"use strict";cc._RF.push(e,"99f95ygqSxI9KlLsx9XO/xh","BulletPlantNormal13");var i=t,o=e,n=a;cc._RF.push(o,"92d28Q/eepC2pj7XZIYZQg4","BulletPlantNormal13"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("NodePoolManager"),s=i("BattleDataProxy"),c=i("BulletBase"),l=i("BulletPlantSplit"),u=cc._decorator,p=u.ccclass,h=u.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mBulletSplitPb=null,e}return __extends(e,t),e.prototype.initBullet=function(e,a,i,o){t.prototype.initBullet.call(this,e,a,i,o);var n=cc.tween(this.node).by(.1,{angle:90});cc.tween(this.node).repeatForever(n).start()},e.prototype.moveArrive=function(e){this.addBulletHit(e),this.addBulletSplit(),t.prototype.moveArrive.call(this,e)},e.prototype.addBulletSplit=function(){if(s.battleDataProxy.checkHasSkill(130001))for(var t=Math.floor(1e3*Math.random())%70,e=0;e<5;++e){var a=r.default.instance.getNode(this.mBulletSplitPb);s.battleDataProxy.bulletView.addChild(a,this.node.zIndex),a.position=this.node.position,a.getComponent(l.default).initBulletPlantSplit(t+72*e,this._plantId,this._synthesisLv,this._atkTarget)}},__decorate([h(cc.Prefab)],e.prototype,"mBulletSplitPb",void 0),__decorate([p],e)}(c.default);n.default=d,cc._RF.pop(),cc._RF.pop()},{}],BulletPlantSplit13:[function(t,e,a){"use strict";cc._RF.push(e,"c26f0JVb/BBeobaeYSTinMM","BulletPlantSplit13");var i=t,o=e,n=a;cc._RF.push(o,"83d80AmKpxLLZvg3WKfz6Cb","BulletPlantSplit13"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("SimplyCircleCollider"),s=i("SimplyRectCollider"),c=i("SimplyCollisionDetector"),l=i("GameEnum"),u=i("BattleDataProxy"),p=i("EnemyBase"),h=cc._decorator,d=h.ccclass,m=h.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mSplitSpine=null,e.mCollision=null,e._plantId=0,e._moveSpd=15,e._synthesisLv=0,e._baseAtkNode=null,e._collisionNodes=[],e._colliderTime=0,e._isRage=!1,e}return __extends(e,t),e.prototype.initBulletPlantSplit=function(t,e,a,i){var o=this;this._plantId=t,this._isRage=i,this._synthesisLv=e,this._baseAtkNode=a,this.mSplitSpine.setCompleteListener(function(t){t.animation&&t.animation.name,o.node.destroy(),o.node.removeFromParent()}),this.mSplitSpine.setAnimation(0,"skill2",!1),cc.tween(this.mCollision).to(.5,{scale:2}).start()},e.prototype.moveArrive=function(t){if(t&&t.isValid&&t&&t.isValid){var e=t.getComponent(p.default).monsterCfg,a=u.battleDataProxy.getBulletHarm(e.type,this._plantId,this._synthesisLv,1,1,1,1,!0);this._isRage&&(a.num*=1.5),t.getComponent(p.default).beAttack(a,this._plantId,!0)}},e.prototype.update=function(t){if(u.battleDataProxy.gameState==l.GameState.PLAYING||u.battleDataProxy.gameState==l.GameState.READY){if(this.mSplitSpine.paused=!1,u.battleDataProxy.getIsCheckCollision(this.node)&&(this._colliderTime-=t,this._colliderTime<=0)){this._colliderTime=l.EGameEnum.CHECK_COLLIDER_TIME;for(var e=u.battleDataProxy.enemyNodes.slice(),a=this.mCollision.getComponent(r.default),i=0;i<e.length;++i){var o=e[i];if(o&&o.isValid&&o!=this._baseAtkNode){var n=o.getChildByName("collision").getComponent(s.default);n&&c.default.isCollisionRectToCircle(n.rect,a.circle)&&this._collisionNodes.indexOf(o)<0&&(this._collisionNodes.push(o),this.moveArrive(o))}}}}else this.mSplitSpine.paused=!0},__decorate([m(sp.Skeleton)],e.prototype,"mSplitSpine",void 0),__decorate([m(cc.Node)],e.prototype,"mCollision",void 0),__decorate([d],e)}(cc.Component);n.default=f,cc._RF.pop(),cc._RF.pop()},{}],BulletPlantSplit:[function(t,e,a){"use strict";cc._RF.push(e,"4946b61JA9Aw4NRISBnRTck","BulletPlantSplit");var i=t,o=e,n=a;cc._RF.push(o,"4aa32u/32dM9aaLxCZw0sm/","BulletPlantSplit"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("MathUtil"),s=i("SimplyCircleCollider"),c=i("SimplyRectCollider"),l=i("SimplyCollisionDetector"),u=i("GameEnum"),p=i("NodePoolManager"),h=i("BattleDataProxy"),d=i("EnemyBase"),m=i("BulletHit"),f=cc._decorator,_=f.ccclass,y=f.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mImg=null,e.mBulletHitPb=null,e._plantId=0,e._moveNormalize=null,e._moveSpd=15,e._synthesisLv=0,e._baseAtkNode=null,e._colliderTime=u.EGameEnum.CHECK_COLLIDER_TIME,e}return __extends(e,t),e.prototype.initBulletPlantSplit=function(t,e,a,i){this._plantId=e,this._synthesisLv=a,this._baseAtkNode=i;var o=r.MathUtil.getRadian(t),n=cc.v3(this.node.x+100*Math.cos(o),this.node.y+100*Math.sin(o));this._moveNormalize=this.node.position.clone().sub(n.clone()).normalize()},e.prototype.update=function(t){if((h.battleDataProxy.gameState==u.GameState.PLAYING||h.battleDataProxy.gameState==u.GameState.READY)&&this._moveNormalize){this.node.x-=this._moveSpd*this._moveNormalize.x,this.node.y-=this._moveSpd*this._moveNormalize.y;var e=cc.winSize;this.node.x>e.width||this.node.x<-e.width||this.node.y>e.height||this.node.y<-e.height?p.default.instance.putNode(this.node):(this._colliderTime-=t,this._colliderTime<=0&&(this._colliderTime=u.EGameEnum.CHECK_COLLIDER_TIME,this.monsterColliderCheck()))}},e.prototype.monsterColliderCheck=function(){if(h.battleDataProxy.getIsCheckCollision(this.node))for(var t=this.node.getComponent(s.default),e=h.battleDataProxy.enemyNodes.slice(),a=0;a<e.length;++a){var i=e[a];if(t&&i&&i.isValid&&this._baseAtkNode!=i){var o=i.getChildByName("collision").getComponent(c.default);if(o&&l.default.isCollisionRectToCircle(o.rect,t.circle)){this.moveArrive(i);break}}}},e.prototype.moveArrive=function(t){if(t&&t.isValid){if(t&&t.isValid){var e=t.getComponent(d.default).monsterCfg,a=h.battleDataProxy.getBulletHarm(e.type,this._plantId,this._synthesisLv,1,1,1,1,!0);t.getComponent(d.default).beAttack(a,this._plantId)}p.default.instance.putNode(this.node)}else p.default.instance.putNode(this.node)},e.prototype.addBulletHit=function(t){var e=p.default.instance.getNode(this.mBulletHitPb);h.battleDataProxy.bulletView.addChild(e,this.node.zIndex);var a=null;if(t&&t.isValid){var i=t.scale;a=t.position.addSelf(cc.v3(0,t.height*i*.7))}else a=this.node.position;e.position=a,e.getComponent(m.default).initBulletHit(this._plantId,this._synthesisLv)},__decorate([y(cc.Sprite)],e.prototype,"mImg",void 0),__decorate([y(cc.Prefab)],e.prototype,"mBulletHitPb",void 0),__decorate([_],e)}(cc.Component);n.default=g,cc._RF.pop(),cc._RF.pop()},{}],BulletPlant:[function(t,e,a){"use strict";cc._RF.push(e,"d0bcfLqTvpG6IewkUAcKJf1","BulletPlant");var i=t,o=e,n=a;cc._RF.push(o,"3bbac5K3wZKOorexj22dsMh","BulletPlant"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("BulletBase"),s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initBullet=function(e,a,i,o){t.prototype.initBullet.call(this,e,a,i,o),this.setBulletSpriteFrame()},e.prototype.moveArrive=function(e){this.addBulletHit(e),t.prototype.moveArrive.call(this,e)},__decorate([c],e)}(r.default));n.default=l,cc._RF.pop(),cc._RF.pop()},{}],BulletPoison:[function(t,e,a){"use strict";cc._RF.push(e,"00156Yyu41MOavgPdkD3aAn","BulletPoison");var i=t,o=e,n=a;cc._RF.push(o,"38ee7iWAV1CBZerNQQ7JsxG","BulletPoison"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("MathUtil"),s=i("BattleDataProxy"),c=i("EnemyBase"),l=cc._decorator,u=l.ccclass,p=l.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mPoisonSpine=null,e._hurt=null,e._continueTime=0,e._plantId=0,e}return __extends(e,t),e.prototype.initBulletPoison=function(t,e,a){var i=this;this._hurt=a,this._plantId=t,this._continueTime=e,this.unschedule(this.continueTimer),this.schedule(this.continueTimer,1),this.mPoisonSpine.setAnimation(0,"atk_duwu",!1),this.mPoisonSpine.setCompleteListener(function(t){"atk_duwu"==(t.animation?t.animation.name:"")&&i.mPoisonSpine.setAnimation(0,"duwu_stand",!0)})},e.prototype.continueTimer=function(){this._continueTime--,this.atkEnemy(),this._continueTime<=0&&(this.unschedule(this.continueTimer),this.node.destroy(),this.node.removeFromParent())},e.prototype.atkEnemy=function(){for(var t=s.battleDataProxy.enemyNodes.slice(),e=0;e<t.length;++e){var a=t[e];a&&a.isValid&&r.MathUtil.distance(a.position,this.node.position)<=this.node.width/2&&a.getComponent(c.default).beAttack(this._hurt,this._plantId)}},__decorate([p(sp.Skeleton)],e.prototype,"mPoisonSpine",void 0),__decorate([u],e)}(cc.Component);n.default=h,cc._RF.pop(),cc._RF.pop()},{}],BulletSoundWave:[function(t,e,a){"use strict";cc._RF.push(e,"99c64brvfVH047Emfh1WH6n","BulletSoundWave");var i=t,o=e,n=a;cc._RF.push(o,"727e7wpDFpIPq3kOJ5zVAA9","BulletSoundWave"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("MathUtil"),s=i("BattleDataProxy"),c=i("SkillDataMgr"),l=i("EnemyBase"),u=cc._decorator,p=u.ccclass,h=u.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mSuperSpine=null,e.mNormalSpine=null,e._synthesisLv=0,e._atkMaxNum=0,e}return __extends(e,t),e.prototype.initBulletFire=function(t){var e=this;this._synthesisLv=t,this._atkMaxNum=5,this.mSuperSpine.node.active=s.battleDataProxy.getIsSuperPlant(15),this.mNormalSpine.node.active=!s.battleDataProxy.getIsSuperPlant(15),s.battleDataProxy.getIsSuperPlant(15)?(this.mSuperSpine.node.active=!0,this.mSuperSpine.setEventListener(function(){e.onEventListener()}),this.mSuperSpine.setAnimation(0,"skill",!1),this.mSuperSpine.setCompleteListener(function(){e.node.destroy(),e.node.removeFromParent()})):(this.mNormalSpine.node.active=!0,this.mNormalSpine.setEventListener(function(){e.onEventListener()}),this.mNormalSpine.setAnimation(0,"skill",!1),this.mNormalSpine.setCompleteListener(function(){e.node.destroy(),e.node.removeFromParent()}))},e.prototype.onEventListener=function(){for(var t=s.battleDataProxy.enemyNodes.slice(),e=0;e<t.length;++e){var a=t[e];if(a&&a.isValid&&r.MathUtil.distance(a.position,this.node.position)<=150){this._atkMaxNum--;var i=a.getComponent(l.default).monsterCfg,o=c.default.instance.getSkillProperty(13,15),n=1;o&&(n=o);var u=s.battleDataProxy.getBulletHarm(i.type,15,this._synthesisLv,1,1,n,1);if(a.getComponent(l.default).beAttack(u,15),this._atkMaxNum<=0)break}}},__decorate([h(sp.Skeleton)],e.prototype,"mSuperSpine",void 0),__decorate([h(sp.Skeleton)],e.prototype,"mNormalSpine",void 0),__decorate([p],e)}(cc.Component);n.default=d,cc._RF.pop(),cc._RF.pop()},{}],BulletSpikerocks:[function(t,e,a){"use strict";cc._RF.push(e,"e21e6z/+CVDerAadLPcD20X","BulletSpikerocks");var i=t,o=e,n=a;cc._RF.push(o,"3b8c6Ly33ZHN4qurFzkWRcU","BulletSpikerocks"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("SimplyRectCollider"),s=i("SimplyCollisionDetector"),c=i("GameEnum"),l=i("DataManager"),u=i("BattleDataProxy"),p=i("EnemyBase"),h=cc._decorator,d=h.ccclass,m=h.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mSpine=null,e._atkRate=0,e._synthesisLv=0,e._continueTime=0,e}return __extends(e,t),e.prototype.initBulletSpikerocks=function(t){var e=this;this._synthesisLv=t,this._continueTime=5,this.mSpine.setAnimation(0,"atk",!0),this._atkRate=l.DataManager.instance.eData.datasuperplant[12].damage1,this.mSpine.setEventListener(function(t,a){a.data.name,e.monsterColliderCheck()}),this.node.zIndex=-this.node.y},e.prototype.update=function(t){u.battleDataProxy.gameState!=c.GameState.PLAYING&&u.battleDataProxy.gameState!=c.GameState.READY||(this._continueTime-=t,this._continueTime<=0&&(this.node.destroy(),this.node.removeFromParent()))},e.prototype.monsterColliderCheck=function(){for(var t=this.node.getComponent(r.default),e=u.battleDataProxy.enemyNodes.slice(),a=0;a<e.length;++a){var i=e[a];if(t&&i&&i.isValid){var o=i.getChildByName("collision").getComponent(r.default);if(o&&s.default.isCollisionRectToRect(o.rect,t.rect)){var n=i.getComponent(p.default).monsterCfg,c=u.battleDataProxy.getBulletHarm(n.type,12,this._synthesisLv,1,1,this._atkRate,1);i.getComponent(p.default).beAttack(c,12)}}}},__decorate([m(sp.Skeleton)],e.prototype,"mSpine",void 0),__decorate([d],e)}(cc.Component);n.default=f,cc._RF.pop(),cc._RF.pop()},{}],BulletTornado:[function(t,e,a){"use strict";cc._RF.push(e,"29ee1Pfgg9DqYO7rFGhFWhj","BulletTornado");var i=t,o=e,n=a;cc._RF.push(o,"02630Z/u+1Ilpd7Vchxby+9","BulletTornado"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("MathUtil"),s=i("SimplyRectCollider"),c=i("SimplyCollisionDetector"),l=i("GameEnum"),u=i("BattleDataProxy"),p=i("EnemyBase"),h=cc._decorator,d=h.ccclass,m=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._atkPos=null,e._moveSpd=20,e._isMoveEnd=!1,e._existTime=5,e._checkTime=0,e._synthesisLv=0,e}return __extends(e,t),e.prototype.initBulletTornado=function(t,e){this._synthesisLv=e,this._atkPos=t,this._isMoveEnd=!1},e.prototype.update=function(t){if((u.battleDataProxy.gameState==l.GameState.PLAYING||u.battleDataProxy.gameState==l.GameState.READY)&&this._atkPos){if(this._isMoveEnd)return this._checkTime+=t,this._checkTime>=.5&&(this._checkTime=0,this.monsterColliderCheck()),this._existTime-=t,void(this._existTime<=0&&(this.node.destroy(),this.node.removeFromParent()));if(r.MathUtil.distance(this.node.position,this._atkPos)<=this._moveSpd)return this._isMoveEnd=!0,void this.monsterColliderCheck();var e=this.node.position.clone().sub(this._atkPos.clone()).normalize();this.node.x-=this._moveSpd*e.x,this.node.y-=this._moveSpd*e.y,this.node.zIndex=-this.node.y}},e.prototype.monsterColliderCheck=function(){for(var t=this.node.getComponent(s.default),e=u.battleDataProxy.enemyNodes.slice(),a=0;a<e.length;++a){var i=e[a];if(t&&i&&i.isValid){var o=i.getChildByName("collision").getComponent(s.default);if(o&&c.default.isCollisionRectToRect(o.rect,t.rect)){var n=i.getComponent(p.default).monsterCfg,r=u.battleDataProxy.getBulletHarm(n.type,5,this._synthesisLv,1,1,1,1);r.num*=.2,i.getComponent(p.default).beAttack(r,5,!1,!0)}}}},__decorate([d],e)}(cc.Component));n.default=m,cc._RF.pop(),cc._RF.pop()},{}],ButtonSafe:[function(t,e,a){"use strict";cc._RF.push(e,"93b4bGA0oRCHo7d8VbPzy40","ButtonSafe");var i=e,o=a;cc._RF.push(i,"60af5XOu69HobmjGhkUzFjU","ButtonSafe"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,r=n.ccclass,s=n.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.safeTime=.5,e._clickEvents=[],e}return __extends(e,t),e.prototype.onLoad=function(){var t=this,e=this.getComponent(cc.Button);e&&(this._clickEvents=e.clickEvents,this.node.on("click",function(){e.clickEvents=[],t.scheduleOnce(function(){t&&t.node&&e&&(e.clickEvents=t._clickEvents)},t.safeTime)}))},__decorate([s(cc.Integer)],e.prototype,"safeTime",void 0),__decorate([r],e)}(cc.Component);o.default=c,cc._RF.pop(),cc._RF.pop()},{}],CServerItem:[function(t,e,a){"use strict";cc._RF.push(e,"3dcd8Z9CD1OurY2E3DJbVN0","CServerItem");var i=t,o=e,n=a;cc._RF.push(o,"f2139cqEgZImaD5TxPYzx6t","CServerItem"),Object.defineProperty(n,"__esModule",{value:!0}),n.CServerItem=void 0;var r,s=i("ProtocolGameServer"),c=i("SocketEngine"),l=i("CommonUtil"),u=i("MakeParameters"),p=i("SceneManager"),h=i("UserCenterManager"),d=new Date;(function(t){t[t.ReconnectStatus_NULL=0]="ReconnectStatus_NULL",t[t.ReconnectStatus_DisConnect=1]="ReconnectStatus_DisConnect",t[t.ReconnectStatus_Connecting=2]="ReconnectStatus_Connecting"})(r||(r={}));var m=function(){function t(){var e=this;this._isShowReconnMask=!1,this._sendMsgInfoCache=[],this._name="CServerItem",this._socketEngine=new c.default(this._name),this._socketEngine.setSocketEngineSink(this),this._eInReconnect=r.ReconnectStatus_NULL,this._fHeatTickTime=0,this._fReconnMaskTime=0,this._fReconnTime=0,this._reconnCount=0,d=new Date,setInterval(function(){var a=new Date;""!=e._token?(t.instance.upDataTime((a.getTime()-d.getTime())/1e3),d=a):d=a},500),this._token="",this._sessionId="",this._uid=null}return Object.defineProperty(t,"instance",{get:function(){return null==this._instance&&(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"token",{get:function(){return this._token},set:function(t){this._token=t,l.CommonUtil.print("token",t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sessionId",{get:function(){return this._sessionId},set:function(t){this._sessionId=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uid",{get:function(){return this._uid},set:function(t){this._uid=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"newPlayer",{get:function(){return this._newPlayer},set:function(t){this._newPlayer=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nickName",{get:function(){return this._nickName},set:function(t){this._nickName=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"head",{get:function(){return this._head},set:function(t){this._head=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nameChangeNum",{get:function(){return this._nameChangeNum},set:function(t){this._nameChangeNum=t},enumerable:!1,configurable:!0}),t.prototype.upDataTime=function(e){t.instance&&this._eInReconnect!=r.ReconnectStatus_DisConnect&&(this._eInReconnect===r.ReconnectStatus_NULL?this._fReconnTime+=e:this._eInReconnect===r.ReconnectStatus_Connecting&&(this._fHeatTickTime+=e),this._fHeatTickTime>=10&&this.resetTick(),this._fReconnMaskTime>0&&(this._fReconnMaskTime-=e,this._fReconnMaskTime<0&&!this._isShowReconnMask&&(this._isShowReconnMask=!0,p.SceneManager.instance.showLoading("\u6b63\u5728\u8ffd\u56de\u7f51\u7edc\u4fe1\u53f7\u55b5",120,null,!0))),this._fReconnTime>=5&&(this.resetReconn(),l.CommonUtil.print("\u8d85\u65f6\u91cd\u8fde~"),this.connectServer(),this._reconnCount++,this._reconnCount>=3&&(this._fReconnMaskTime=0,this._socketEngine.disconnect(),this._isShowReconnMask=!1,p.SceneManager.instance.hideLoading(null,!0),this._eInReconnect=r.ReconnectStatus_DisConnect)))},t.prototype.resetTick=function(){this._eInReconnect=r.ReconnectStatus_NULL,this._fHeatTickTime=0},t.prototype.heartTick=function(){this._eInReconnect=r.ReconnectStatus_Connecting,l.CommonUtil.print("\u6536\u5230\u5fc3\u8df3",1),this.resetRecoonMask()},t.prototype.resetReconn=function(){this._fReconnTime=0},t.prototype.connectServer=function(){return this.resetTick(),!!this._socketEngine.connectUrl(h.UserCenterManager.instance.wsUrl)},t.prototype.onMessageSend=function(){this._fReconnMaskTime=2},t.prototype.resetRecoonMask=function(){this._isShowReconnMask&&(this._isShowReconnMask=!1,p.SceneManager.instance.hideLoading(null,!0)),this._fReconnMaskTime=0,this._reconnCount=0},t.prototype.onEventSocketOpen=function(){this._eInReconnect!=r.ReconnectStatus_DisConnect&&(this._eInReconnect=r.ReconnectStatus_Connecting,l.CommonUtil.print(this._name+"::onEventSocketOpen"))},t.prototype.onEventSocketClose=function(t){this._eInReconnect!=r.ReconnectStatus_DisConnect&&(this._eInReconnect=r.ReconnectStatus_NULL,p.SceneManager.instance.showLoading("\u6b63\u5728\u8ffd\u56de\u7f51\u7edc\u4fe1\u53f7\u55b5",120,null,!0),this._isShowReconnMask=!0,l.CommonUtil.print(this._name+"::onEventSocketClose",t))},t.prototype.onEventSocketError=function(t){l.CommonUtil.print(this._name+"::onEventSocketError",JSON.stringify(t))},t.prototype.sendSocketData=function(t,e,a){if(void 0===a&&(a=!0),this._eInReconnect!=r.ReconnectStatus_DisConnect){var i=u.default.make(t,e);a&&l.CommonUtil.print("\u53d1\u9001\u534f\u8bae::"+s.CMD_GameServer_Command[t]+"--"+t,"\u53c2\u6570::"+JSON.stringify(e)),this.send(t,i)}},t.prototype.send=function(){this._eInReconnect!=r.ReconnectStatus_DisConnect&&this.resetTick()},t.prototype.tickOffLine=function(){this.disconnect()},t.prototype.disconnect=function(){this._socketEngine.disconnect(),this._eInReconnect=r.ReconnectStatus_DisConnect},t._instance=null,t}();n.CServerItem=m,cc._RF.pop(),cc._RF.pop()},{}],CaptureUtils:[function(t,e,a){"use strict";cc._RF.push(e,"b1b211XBVdNObVhF4oDsyq3","CaptureUtils");var i=e,o=a;cc._RF.push(i,"1bb09zIwvFOAabUHXe6MkmV","CaptureUtils"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function t(){}return t._capture=function(e,a){var i=t.getCamera(),o=i.node,n=new cc.RenderTexture;return n.initWithSize(a.width,a.height,cc.gfx.RB_FMT_S8),o.setPosition(a.x,a.y),o.parent=e,i.orthoSize=a.height/2,i.targetTexture=n,i.render(e),i.targetTexture=null,o.parent=null,n},t._getNodeInfo=function(e){var a=t._tmpInfo,i=e.getWorldMatrix(t._tmpMat4).getScale(t._tmpVec3);if(a.scaleX=i.x,a.scaleY=i.y,a.scaleZ=i.z,e==cc.director.getScene()){var o=cc.view._visibleRect;a.anchorX=a.anchorY=0,a.width=o.width,a.height=o.height}else a.anchorX=e.anchorX,a.anchorY=e.anchorY,a.width=e.width,a.height=e.height;return a},t.getCamera=function(){var e=t._camera;return e||((e=t._camera=new cc.Node("CaptureUtils").addComponent(cc.Camera)).alignWithScreen=!1,e.ortho=!0,e.nearClip=0),e},t.getCanvas=function(){return t._canvas||(t._canvas=document.createElement("canvas"))},t.capture=function(t,e){var a=new cc.SpriteFrame;return a.setTexture(this.getRenderTexture(t,e)),a.setFlipY(!0),a},t.getImgUrl=function(t,e){return this.toImgUrl(this.getRenderTexture(t,e))},t.getRenderTexture=function(e,a){var i;return void 0===e&&(e=cc.Canvas.instance.node||cc.director.getScene()),void 0===a&&(a={}),i=t._getNodeInfo(e),void 0===a.width&&(a.width=e.width*i.scaleX),void 0===a.height&&(a.height=e.height*i.scaleY),void 0===a.x&&(a.x=(.5-e.anchorX)*e.width),void 0===a.y&&(a.y=(.5-e.anchorY)*e.height),t._capture(e,a)},t.toImgUrl=function(e){var a,i=e.width,o=e.height;if(cc.sys.isNative){var n=e.readPixels(),r=jsb.fileUtils.getWritablePath()+"tmpImg.png";jsb.saveImageData(n,i,o,r),a=r}else{var s=t.getCanvas(),c=s.getContext("2d"),l=s.toTempFilePathSync,u=(n=e.readPixels(),4*i),p=0;for(s.width=i,s.height=o;p<o;){for(var h=o-1-p,d=c.createImageData(i,1),m=h*i*4,f=0;f<u;f++)d.data[f]=n[m+f];c.putImageData(d,0,p++)}a="function"==typeof l?l.call(s,{}):s.toDataURL("image/png"),c.clearRect(0,0,i,o)}return a},t._tmpMat4=cc.mat4(),t._tmpVec3=cc.v3(),t._tmpInfo={},t}();o.default=n,cc._RF.pop(),cc._RF.pop()},{}],CollisionGoldItem:[function(t,e,a){"use strict";cc._RF.push(e,"c1c85+CBFVEH4Pa3Rn9nKuB","CollisionGoldItem");var i=t,o=e,n=a;cc._RF.push(o,"171c3NNcXVHeZYM8rqntqdY","CollisionGoldItem"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("UserDataProxy"),s=i("AnimationMgr"),c=i("HomeCollisionBase"),l=cc._decorator,u=l.ccclass,p=l.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mGoldCount=null,e._goldCount=0,e._maxCount=10,e}return __extends(e,t),e.prototype.onLoad=function(){this.mGoldCount.string="0/10",this._goldCount=0},e.prototype.onCollision=function(){this._goldCount++,this._goldCount>=this._maxCount&&(this._goldCount=0,r.userDataProxy.changeGold(5),s.default.instance.showAwardAni({id:1,num:5},null,this.node)),this.mGoldCount.string=this._goldCount+"/"+this._maxCount},__decorate([p(cc.Label)],e.prototype,"mGoldCount",void 0),__decorate([u],e)}(c.default);n.default=h,cc._RF.pop(),cc._RF.pop()},{}],CollisionPlantItem:[function(t,e,a){"use strict";cc._RF.push(e,"5fde7XyUctM55eNs0iAfQrr","CollisionPlantItem");var i=t,o=e,n=a;cc._RF.push(o,"ea4303gdoZBAIGEk3lBDex0","CollisionPlantItem"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("Util"),s=i("BulletHit"),c=i("HomeCollisionBase"),l=cc._decorator,u=l.ccclass,p=l.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mBulletPlant=null,e.mEnemyNode=null,e.mBulletHit=null,e}return __extends(e,t),e.prototype.onCollision=function(){var t=this,e=cc.instantiate(this.mBulletPlant);this.node.parent.addChild(e),e.active=!0,e.position=r.default.convertToTargetNodeSpace(this.mBulletPlant,e);var a=r.default.convertToTargetNodeSpace(this.mEnemyNode,e);cc.tween(e).to(.5,{position:a}).call(function(){t.addBulletHit(e.position.clone()),e.destroy(),e.removeFromParent()}).start()},e.prototype.addBulletHit=function(t){if(this.node&&this.node.isValid){var e=cc.instantiate(this.mBulletHit);this.node.parent.addChild(e,this.node.zIndex),e.position=t,e.getComponent(s.default).initBulletHit(5,1)}},__decorate([p(cc.Node)],e.prototype,"mBulletPlant",void 0),__decorate([p(cc.Node)],e.prototype,"mEnemyNode",void 0),__decorate([p(cc.Prefab)],e.prototype,"mBulletHit",void 0),__decorate([u],e)}(c.default);n.default=h,cc._RF.pop(),cc._RF.pop()},{}],Combo50:[function(t,e,a){"use strict";cc._RF.push(e,"9df06esyqtJJZ+OQcUkbtul","Combo50");var i=t,o=e,n=a;cc._RF.push(o,"d98d8gkzU5LVZUNRLqFBo0e","Combo50"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("EventManager"),s=i("BattleDataProxy"),c=i("ComboBase"),l=cc._decorator,u=l.ccclass,p=(l.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.play=function(){var t=this;this.node.scale=1,r.EventManager.instance.emit(s.EBattleEvent.ACTIVE_FRENZY),this.node.scale=2.3,cc.tween(this.node).to(.15,{scale:1.3}).delay(.5).call(function(){t.node.destroy(),t.node.removeFromParent()}).start()},__decorate([u],e)}(c.default));n.default=p,cc._RF.pop(),cc._RF.pop()},{}],ComboBase:[function(t,e,a){"use strict";cc._RF.push(e,"b1cb1mV5f1HEoWoFdZudckj","ComboBase");var i=t,o=e,n=a;cc._RF.push(o,"35714Xg2TZN44vZC+aOGfnC","ComboBase"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("ComponentBase"),s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.play=function(){},__decorate([c],e)}(r.ComponentBase));n.default=l,cc._RF.pop(),cc._RF.pop()},{}],ComboEffect:[function(t,e,a){"use strict";cc._RF.push(e,"1e1daUexP5FrosrSzHH+3f1","ComboEffect");var i=e,o=a;cc._RF.push(i,"406ffbANwhFTqlRQu7p82Le","ComboEffect"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,r=n.ccclass,s=n.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mSpine=null,e}return __extends(e,t),e.prototype.play=function(){var t=this;this.mSpine.setAnimation(0,"appear",!1),this.mSpine.setCompleteListener(function(){t.node.destroy(),t.node.removeFromParent()})},__decorate([s(sp.Skeleton)],e.prototype,"mSpine",void 0),__decorate([r],e)}(cc.Component);o.default=c,cc._RF.pop(),cc._RF.pop()},{}],ComboNormal:[function(t,e,a){"use strict";cc._RF.push(e,"3d1c5sXB2lO9LlhWkqqQ0rm","ComboNormal");var i=t,o=e,n=a;cc._RF.push(o,"9d16dr6NBtI1qPX2mVNYR7E","ComboNormal"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("ComboBase"),s=cc._decorator,c=s.ccclass,l=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mComboLab=null,e}return __extends(e,t),e.prototype.play=function(t){var e=this;this.mComboLab.string=""+t,this.node.scale=2,cc.tween(this.node).to(.15,{scale:.9}).delay(.5).call(function(){e.node.destroy(),e.node.removeFromParent()}).start()},__decorate([l(cc.Label)],e.prototype,"mComboLab",void 0),__decorate([c],e)}(r.default);n.default=u,cc._RF.pop(),cc._RF.pop()},{}],CommonRedPoint:[function(t,e,a){"use strict";cc._RF.push(e,"54038QtmgFKi5n/jh1bKIm2","CommonRedPoint");var i=e,o=a;cc._RF.push(i,"e0affGoR71IwpCRbXfyO9qI","CommonRedPoint"),Object.defineProperty(o,"__esModule",{value:!0});var n,r=cc._decorator,s=r.ccclass,c=r.property;(function(t){t[t.BREATHE=0]="BREATHE",t[t.FLOAT=1]="FLOAT"})(n||(n={}));var l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.animType=n.BREATHE,e._initScale=0,e._initY=0,e}return __extends(e,t),e.prototype.onLoad=function(){this._initScale=this.node.scale,this._initY=this.node.y},e.prototype.onEnable=function(){cc.Tween.stopAllByTarget(this.node)},e.prototype.setRedPointState=function(t,e){this.node.active=t,e&&(this.node.getChildByName("Num").active=!0,this.node.getChildByName("Num").getComponent(cc.Label).string=""+e)},__decorate([c({type:cc.Enum(n)})],e.prototype,"animType",void 0),__decorate([s],e)}(cc.Component);o.default=l,cc._RF.pop(),cc._RF.pop()},{}],CommonUtil:[function(t,e,a){"use strict";cc._RF.push(e,"eee532pJOxFpKD+WGWWkf3A","CommonUtil");var i=e,o=a;cc._RF.push(i,"87138TajD1FKYMLjbYbq0Ku","CommonUtil"),Object.defineProperty(o,"__esModule",{value:!0}),o.CommonUtil=void 0;var n=function(){function t(){}return t.print=function(t,e){this.isEmpty(e)?console.log(t):console.log(t,e)},t.zeroVal=function(t,e){this.isEmpty(e[t])&&(e[t]=0)},t.isEmpty=function(t){return null==t||"undefined"===t||""===t},t.isObjEmpty=function(t){return Object.keys(t).length<=0},t}();o.CommonUtil=n,cc._RF.pop(),cc._RF.pop()},{}],Common:[function(t,e,a){"use strict";cc._RF.push(e,"cbc558KZo1KvrxkmtSOmf3T","Common");var i=e,o=a;cc._RF.push(i,"0ea3d2dsrNPLawSXhE9YUZ4","Common"),Object.defineProperty(o,"__esModule",{value:!0}),o.RVOMath=o.KeyValuePair=o.Line=o.Obstacle=o.Vector2=void 0;var n=function(){function t(t,e){this.x=0,this.y=0,this.x=t,this.y=e}return t.prototype.plus=function(e){return new t(this.x+e.x,this.y+e.y)},t.prototype.minus=function(e){return new t(this.x-e.x,this.y-e.y)},t.prototype.multiply=function(t){return this.x*t.x+this.y*t.y},t.prototype.scale=function(e){return new t(this.x*e,this.y*e)},t.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this},t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.substract=function(t,e){return t.x-=e.x,t.y-=e.y,t},t.prototype.lengthSqr=function(){return Math.pow(this.x,2)+Math.pow(this.y,2)},t}();o.Vector2=n,o.Obstacle=function(){},o.Line=function(){},o.KeyValuePair=function(t,e){this.key=t,this.value=e};var r=function(){function t(){}return t.absSq=function(t){return t.multiply(t)},t.normalize=function(e){return e.scale(1/t.abs(e))},t.distSqPointLineSegment=function(e,a,i){var o=i.minus(e),n=a.minus(e),r=o.multiply(n)/t.absSq(n);return r<0?t.absSq(o):r>1?t.absSq(i.minus(a)):t.absSq(i.minus(e.plus(n.scale(r))))},t.sqr=function(t){return t*t},t.det=function(t,e){return t.x*e.y-t.y*e.x},t.abs=function(e){return Math.sqrt(t.absSq(e))},t.leftOf=function(e,a,i){return t.det(e.minus(i),a.minus(e))},t.RVO_EPSILON=0,t}();o.RVOMath=r,cc._RF.pop(),cc._RF.pop()},{}],ComponentBase:[function(t,e,a){"use strict";cc._RF.push(e,"98108pInlhHt7z1RaGd8Qjl","ComponentBase");var i=t,o=e,n=a;cc._RF.push(o,"fb1f3NPCMFK+IKiDSGLskfs","ComponentBase"),Object.defineProperty(n,"__esModule",{value:!0}),n.ComponentBase=void 0;var r=i("Util"),s=i("ResUtil"),c=cc._decorator,l=c.ccclass,u=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._assets=[],e}return __extends(e,t),Object.defineProperty(e.prototype,"assets",{get:function(){return this._assets},enumerable:!1,configurable:!0}),e.prototype.start=function(){},e.prototype.onLoad=function(){},e.prototype.onEnable=function(){},e.prototype.onDisable=function(){},e.prototype.onDestroy=function(){this._assets.forEach(function(t){t.decRef()}),this._assets.length=0,this.unscheduleAllCallbacks()},e.prototype.addRef=function(t){var e;if(null!=t&&!this._assets.includes(t))return(null===(e=this.node)||void 0===e?void 0:e.isValid)?(t.addRef(),void this._assets.push(t)):void(0===t.refCount&&cc.assetManager.releaseAsset(t))},e.prototype.decRef=function(t){var e=this._assets.indexOf(t);e>=0&&(t.refCount>0&&t.decRef(),this._assets.splice(e,1))},e.prototype.clearAssets=function(){this._assets.forEach(function(t){t.decRef()}),this._assets=[]},e.prototype.getAsset=function(t,e){for(var a=0;a<this._assets.length;++a)if(this._assets[a].name==t&&r.default.getClassName(e)===r.default.getClassName(this._assets[a]))return this._assets[a];return null},e.prototype.loadSpriteFrame=function(t){var e=this;s.ResUtil.loadAsset({bundleName:t.bundleName,path:t.path,type:cc.SpriteFrame}).then(function(a){var i=t.sprite;i&&i.isValid?i.spriteFrame!=a&&(i.spriteFrame&&(e.decRef(i.spriteFrame),i.spriteFrame=null),e.addRef(a),i.spriteFrame=a,t.complete&&t.complete()):0==a.refCount&&cc.assetManager.releaseAsset(a)}).catch(function(){})},__decorate([l],e)}(cc.Component));n.ComponentBase=u,cc._RF.pop(),cc._RF.pop()},{}],CongratsGettingPopup:[function(t,e,a){"use strict";cc._RF.push(e,"95fa2kYbh9Hjag3Oxe8DfTG","CongratsGettingPopup");var i=t,o=e,n=a;cc._RF.push(o,"1263dWkgStFqb8EnBAfeMcl","CongratsGettingPopup"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("ResUtil"),s=i("PopupBase"),c=i("HomeEnum"),l=i("DataManager"),u=i("UserDataProxy"),p=i("AnimationMgr"),h=cc._decorator,d=h.ccclass,m=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._awardsList=[],e._contant=null,e._data=null,e}return __extends(e,t),e.prototype.init=function(t){var e=this;this._data=t.args,this.scheduleOnce(function(){e.initView()})},e.prototype.initView=function(){var t=this;this.node.getChildByName("getBtn").active=!1;var e=this.node.getChildByName("contant"),a=this.node.getChildByName("aniLayer");this._awardsList=u.userDataProxy.checkBoxRetrunAwards(this._data.list);var i=this._data.type,o=cc.v3(0,0);this._awardsList.length>4?(o.x=-260,o.y=300):o.x=82.5-82.5*this._awardsList.length;var n=0;if(1!=i){this.node.getChildByName("pic_huode_title_di").active=!1,n=1;var s=this.node.getChildByName("shop_summon").getComponent(sp.Skeleton);s.node.active=!0,s.setSkin("baoxiang"+(i-1)),this.scheduleOnce(function(){s.clearTracks(),s.setAnimation(0,"open",!1),s.setCompleteListener(function(i){i.animation&&i.animation.name,t.node.getChildByName("pic_huode_title_di").active=!0,s.node.active=!1;for(var n=function(i){var n=cc.instantiate(t.node.getChildByName("shop_summon_card"));n.parent=a;var r=cc.v3(o.x+i%4*168,o.y-(210*Math.floor(i/4)-25));n.setPosition(r),n.active=!0,n.getComponent(sp.Skeleton).setAnimation(0,"Knapsack_1",!1),n.getComponent(sp.Skeleton).setCompleteListener(function(){e.children[i].active=!0})},r=0,c=t._awardsList.length;r<c;r++)n(r)})})}e.active=!0,e.children.forEach(function(t){return t.active=!1}),this._contant=e,this.scheduleOnce(function(){for(var a=function(a,n){t.scheduleOnce(function(){var s=l.DataManager.instance.eData.dataitem[t._awardsList[a].id];if(s){var p=e.children[a];p||((p=cc.instantiate(e.children[0])).parent=e);var h=p.getChildByName("qimg").getComponent(cc.Sprite);r.ResUtil.loadAsset({path:"textures/public/item_bg"+s.qulity,type:cc.SpriteFrame,bundleName:c.Bundles.GAME}).then(function(t){h.spriteFrame=t}).catch(function(t){console.log("error:",t)});var d=p.getChildByName("icon").getComponent(cc.Sprite);r.ResUtil.loadAsset({path:"textures/item/"+s.icon,type:cc.SpriteFrame,bundleName:c.Bundles.GAME}).then(function(t){d.spriteFrame=t}).catch(function(t){console.log("error:",t)}),p.getChildByName("numLabel").getComponent(cc.Label).string="x"+t._awardsList[a].num,p.getChildByName("nameLabel").getComponent(cc.Label).string=s.name,p.active=1==i,t._awardsList[a].noSave||u.userDataProxy.addProp(t._awardsList[a].id,t._awardsList[a].num,a+1==n);var m=cc.v3(o.x+a%4*168,o.y-210*Math.floor(a/4));p.setPosition(m)}else cc.error("\u65e0\u6b64\u9053\u5177id",t._awardsList[a].id)})},n=0,s=t._awardsList.length;n<s;n++)a(n,s)},2*n),this.scheduleOnce(function(){t._awardsList.length>1?t.node.getChildByName("getBtn").active=!0:t.scheduleOnce(function(){t.onGetAwardList()},.5)},4*n)},e.prototype.onGetAwardList=function(){var t=this;this.node.getChildByName("getBtn").active=!1;var e=0;this._contant.getComponent(cc.Layout).enabled=!1,this._contant.children.forEach(function(a){var i=t._awardsList[e];t.scheduleOnce(function(){i&&(a.active=!1,p.default.instance.showAwardAni(i,null,a))},.1*e),e++}),this.scheduleOnce(function(){t.removeUI()},.1*e+.3)},__decorate([d],e)}(s.PopupBase));n.default=m,cc._RF.pop(),cc._RF.pop()},{}],ContinueGamePopup:[function(t,e,a){"use strict";cc._RF.push(e,"393adWdrX5JzKKCuxvsymjp","ContinueGamePopup");var i=t,o=e,n=a;cc._RF.push(o,"1864aOMbu9Jj4eJ8up9U7cs","ContinueGamePopup"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("PopupBase"),s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mCloseFunc=null,e}return __extends(e,t),e.prototype.init=function(t){this.mCloseFunc=t.callBack},e.prototype.onBtnAgain=function(){this.mCloseFunc&&this.mCloseFunc(!0),this.removeUI()},e.prototype.onBtnClose=function(){this.mCloseFunc&&this.mCloseFunc(!1),this.removeUI()},__decorate([c],e)}(r.PopupBase));n.default=l,cc._RF.pop(),cc._RF.pop()},{}],CorruptMark:[function(t,e,a){"use strict";cc._RF.push(e,"d776c8PKzNMlpDPocr1R6Px","CorruptMark");var i=e,o=a;cc._RF.push(i,"bd584lLZiVNp5ZEUnFuLIC9","CorruptMark"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,r=n.ccclass,s=(n.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.updateMark=function(t){for(var e=this.node.children,a=0;a<t;++a){var i=e[a];if(!i)break;i.getChildByName("mark").active=!0}var o=e[t-1];o&&(cc.Tween.stopAllByTarget(o),o.active=!0,o.scale=7,o.opacity=100,cc.tween(o).to(.2,{scale:1,opacity:255}).start())},__decorate([r],e)}(cc.Component));o.default=s,cc._RF.pop(),cc._RF.pop()},{}],CourseView:[function(t,e,a){"use strict";cc._RF.push(e,"61d5bJYVK9HyacZZ6OwNRyJ","CourseView");var i=t,o=e,n=a;cc._RF.push(o,"7c0a8e1DUJDO71TuiESQWc9","CourseView"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("EventManager"),c=i("PopupBase"),l=i("GameEnum"),u=i("HomeEnum"),p=i("DataManager"),h=i("BattleDataProxy"),d=i("UserDataProxy"),m=cc._decorator,f=m.ccclass,_=m.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mBlackMask=null,e.mHoleMask=null,e.mContent=null,e.mTxt=null,e.mNpcSpine=null,e.mFinger=null,e._dialogueTexts=[],e._dialogueIdx=0,e._dialogueTextIdx=0,e._plotIsOver=!1,e._courseId=0,e._isUpdate=!1,e._courseData=null,e._oldGameState=l.GameState.PLAYING,e._soundId=0,e}return __extends(e,t),e.prototype.onLoad=function(){s.EventManager.instance.on(h.EBattleEvent.LOSE_COURSE_VIEW,this.removeSelf,this)},e.prototype.touchStart=function(){this._plotIsOver||this.showFullDialogue()},e.prototype.onDisable=function(){this._courseData.isGame&&(h.battleDataProxy.gameState=this._oldGameState),s.EventManager.instance.off(h.EBattleEvent.LOSE_COURSE_VIEW,this.removeSelf,this)},e.prototype.init=function(t){this._courseId!=t.args.courseId?(this._courseData=t.args,this._isUpdate=!0,this._courseId=t.args.courseId,mm.platform.umaTrackEvent("guide",{userA:"guide"+this._courseId}),this._courseData.isGame&&(this._oldGameState=h.battleDataProxy.gameState,h.battleDataProxy.gameState=l.GameState.PAUSE)):this._isUpdate=!1},e.prototype.changeDes=function(){},e.prototype.initDialogueData=function(){this._dialogueIdx=0,this._dialogueTexts.length=0,this._dialogueTextIdx=0,this._plotIsOver=!1},e.prototype.showTalk=function(){var t=this,e=p.DataManager.instance.eData.datagameguid[this._courseId];if(this.mNpcSpine.setAnimation(0,"talk",!0),this.mContent.active=!0,this.initDialogueData(),r.AudioManager.instance.playCourseSound("sounds/"+e.voice,u.Bundles.RES,function(e){t._soundId=e}),this._isUpdate){this.mHoleMask.active=!1,this.mBlackMask.active=!0,this.mFinger.active=!1,this.mFinger.children[0].getComponent(sp.Skeleton).paused=!1,this.mContent.active=e.boradType>0,this.mTxt.string="";var a=e.des.replace("\\n","\n");this._dialogueTexts.push(a),this._dialogueTexts.length>0&&this.schedule(this.dialogueSchedule,.075);var i=this.mContent.getChildByName("guangbiao");cc.Tween.stopAllByTarget(i);var o=cc.tween(i).by(.25,{position:cc.v3(0,-10)}).by(.25,{position:cc.v3(0,10)}).delay(.25);cc.tween(i).repeatForever(o).start();var n=this.node.getChildByName("touchNode");n.targetOff(this),n.on(cc.Node.EventType.TOUCH_START,function(e){t.touchStart(e)},this)}else this.setTouchEvent()},e.prototype.onShow=function(){var t=this,e=p.DataManager.instance.eData.datagameguid[this._courseId];10==e.id||8==e.id?this.mContent.y=500:2==e.id?this.mContent.y=600:5==e.id?this.mContent.y=-270:this.mContent.y=e.desy,this.mNpcSpine.node.y=this.mContent.y-288,1==e.falsh||3==e.falsh?(this.mContent.active=!1,this.mNpcSpine.node.x=cc.winSize.width/2+300,cc.Tween.stopAllByTarget(this.mNpcSpine.node),this.mNpcSpine.setAnimation(0,"jinru",!1),cc.tween(this.mNpcSpine.node).to(5/30,{position:cc.v3(210,this.mNpcSpine.node.y)}).call(function(){t.showTalk()}).start()):this.showTalk()},e.prototype.setTouchEvent=function(){var t=this,e=p.DataManager.instance.eData.datagameguid[this._courseId];switch(this.mHoleMask.active=!1,this.mBlackMask.active=!0,this.mFinger.active=2==e.showType,cc.Tween.stopAllByTarget(this.mFinger),this.mFinger.children[0].getComponent(sp.Skeleton).paused=!1,this.mContent.active=e.boradType>0,this.changeDes(),e.showType){case 2:this.mHoleMask.active=!0,this.mBlackMask.active=!1,this.mHoleMask.getChildByName("bg").targetOff(this),this.mHoleMask.targetOff(this);break;default:11!=e.id&&(this.mBlackMask.active=!0,this.mBlackMask.targetOff(this),this.mBlackMask.on(cc.Node.EventType.TOUCH_END,function(){t.removeSelf()},this))}if(cc.Tween.stopAllByTarget(this.mFinger),this._courseData.targetNode){this.mHoleMask.active=!0,this.mBlackMask.active=!1,this.mHoleMask.width=this._courseData.targetNode.width,this.mHoleMask.height=this._courseData.targetNode.height;var a=this._courseData.targetNode.convertToWorldSpaceAR(cc.v3()),i=this._courseData.targetNode.anchorY,o=this.node.convertToNodeSpaceAR(a).add(cc.v3(0,(.5-i)*this._courseData.targetNode.height));this.mHoleMask.position=o.clone(),this.mFinger.position=o.clone(),this.mFinger.children[0].getComponent(sp.Skeleton).setAnimation(0,"Click",!0)}else this._courseData.targetNode1&&this._courseData.targetNode2&&this.updateMoveTargetNode(this._courseData.targetNode1,this._courseData.targetNode2);switch(3==e.finishType?this.mHoleMask.active?(this.mHoleMask.getChildByName("bg").targetOff(this),this.mHoleMask.getChildByName("bg").on(cc.Node.EventType.TOUCH_END,function(){t.mHoleMask.getChildByName("bg").targetOff(t),t.removeSelf()},this)):this.mBlackMask.active?(this.mBlackMask.targetOff(this),this.mBlackMask.on(cc.Node.EventType.TOUCH_END,function(){t.removeSelf()},this)):(this.node.targetOff(this),this.node.on(cc.Node.EventType.TOUCH_END,function(){t.removeSelf()},this)):this.mHoleMask.getChildByName("bg").targetOff(this),e.id){case 2:this.mHoleMask.active=!1,this.mBlackMask.active=!1}cc.audioEngine.stopEffect(this._soundId),this.mNpcSpine.setAnimation(0,"stand",!0)},e.prototype.updateMoveTargetNode=function(t,e){var a=this,i=t.convertToWorldSpaceAR(cc.v3()),o=e.convertToWorldSpaceAR(cc.v3()),n=this.node.convertToNodeSpaceAR(i),r=this.node.convertToNodeSpaceAR(o);cc.Tween.stopAllByTarget(this.mFinger);var s=cc.tween(this.mFinger).call(function(){a.mFinger.children[0].getComponent(sp.Skeleton).setAnimation(0,"Drag",!1),a.mFinger.position=n.clone()}).delay(20/30).to(1,{position:r}).delay(25/30);cc.tween(this.mFinger).repeatForever(s).start()},e.prototype.removeSelf=function(t){var e=this;t&&(this._oldGameState=t);var a=p.DataManager.instance.eData.datagameguid[this._courseId];2==a.falsh||3==a.falsh?(cc.Tween.stopAllByTarget(this.mNpcSpine.node),this.mNpcSpine.setAnimation(0,"tuichu",!1),cc.tween(this.mNpcSpine.node).to(5/30,{position:cc.v3(cc.winSize.width/2+300,this.mNpcSpine.node.y)}).call(function(){e.removeUI(),d.userDataProxy.completeCourse(e._courseId)}).start()):(this.removeUI(),d.userDataProxy.completeCourse(this._courseId))},e.prototype.setFingerIsShow=function(t){this.mFinger.active=t},e.prototype.dialogueSchedule=function(){this._dialogueIdx>=this._dialogueTexts.length?this.showFullDialogue():(this.mTxt.node.active=!0,this.mTxt.string=this.getText(0))},e.prototype.showFullDialogue=function(){this._plotIsOver=!0,this.unschedule(this.dialogueSchedule),this._dialogueIdx=this._dialogueTexts.length,this.mTxt.node.active=!0,this.mTxt.string=this.getText(0),this.node.getChildByName("touchNode").targetOff(this),this.setTouchEvent()},e.prototype.getText=function(t){var e=this._dialogueTexts[t];if(!e)return"";if(this._dialogueIdx>t)return e;if(this._dialogueIdx<t)return"";for(var a="",i=0;i<this._dialogueTextIdx;++i)a+=e[i];return a.length>=e.length?(this._dialogueIdx++,this._dialogueTextIdx=0):this._dialogueTextIdx++,a},__decorate([_({type:cc.Node,displayName:"\u7eaf\u9ed1\u906e\u7f69"})],e.prototype,"mBlackMask",void 0),__decorate([_({type:cc.Node,displayName:"\u62a0\u6d1e\u906e\u7f69"})],e.prototype,"mHoleMask",void 0),__decorate([_({type:cc.Node,displayName:"\u6587\u5b57\u7a97\u53e3"})],e.prototype,"mContent",void 0),__decorate([_({type:cc.Label,displayName:"\u6587\u5b57"})],e.prototype,"mTxt",void 0),__decorate([_({type:sp.Skeleton,displayName:"\u4eba\u7269spine"})],e.prototype,"mNpcSpine",void 0),__decorate([_(cc.Node)],e.prototype,"mFinger",void 0),__decorate([f],e)}(c.PopupBase);n.default=y,cc._RF.pop(),cc._RF.pop()},{}],CsvHelper:[function(t,e,a){"use strict";cc._RF.push(e,"4d1fcf7azRLvaSAgos89rbY","CsvHelper");var i=t,o=e,n=a;cc._RF.push(o,"df2782n/2tOyaHWu7aV3V9Z","CsvHelper"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("HomeEnum"),s={NewFieldStart:1,NonQuotesField:2,QuotesField:3,FieldSeparator:4,QuoteInQuotesField:5,RowSeparator:6,Error:7},c=function(){this.m_header=[],this.m_values=[],this.push_back=function(t){this.m_values.push(t)},this.setHeader=function(t){this.m_header=t},this.getSize=function(){return this.m_values.length},this.getValueByKey=function(t){for(var e=0;e<this.m_header.length;++e)if(this.m_header[e]===t)return this.m_values[e];return null}},l=function(){function t(){this.m_content=[],this.m_header=[],this.Fields=null,this.strField="",this.mStateType=s.NewFieldStart}return t.prototype.loadCsv=function(t,e,a){void 0===a&&(a=r.Bundles.RES);var i=this;i.m_content.length=0,i.m_header.length=0,i.Fields=new c,i.strField="",i.mStateType=s.NewFieldStart,cc.assetManager.loadBundle(a,function(a,o){o.load(t,function(t,a){if(t)return console.log(" ----------------- \u52a0\u8f7dcsv\u6587\u4ef6\u5931\u8d25\uff0c\u8bf7\u68c0\u67e5\u8def\u5f84\u662f\u5426\u6b63\u786e!"),void cc.error(t.message,t);-1===(a=a.text).indexOf("\r\n")&&(a=a.replace(/\n/g,"\r\n"));for(var o=0,n=a.length;o<n;++o){var r=a[o];switch(i.mStateType){case s.NewFieldStart:'"'==r?i.mStateType=s.QuotesField:","==r?(i.Fields.push_back(""),i.mStateType=s.FieldSeparator):"\r"==r||"\n"==r?(console.log("\u8bed\u6cd5\u9519\u8bef\uff1a\u6709\u7a7a\u884c"),i.mStateType=s.Error):(i.strField+=r,i.mStateType=s.NonQuotesField);break;case s.NonQuotesField:","==r?(i.Fields.push_back(i.strField),i.strField="",i.mStateType=s.FieldSeparator):"\r"==r?(i.Fields.push_back(i.strField),i.mStateType=s.RowSeparator):i.strField+=r;break;case s.QuotesField:'"'==r?i.mStateType=s.QuoteInQuotesField:i.strField+=r;break;case s.FieldSeparator:","==r?i.Fields.push_back(""):'"'==r?(i.strField="",i.mStateType=s.QuotesField):"\r"==r?(i.Fields.push_back(""),i.mStateType=s.RowSeparator):(i.strField+=r,i.mStateType=s.NonQuotesField);break;case s.QuoteInQuotesField:","==r?(i.Fields.push_back(i.strField),i.strField="",i.mStateType=s.FieldSeparator):"\r"==r?(i.Fields.push_back(i.strField),i.mStateType=s.RowSeparator):'"'==r?(i.strField+=r,i.mStateType=s.QuotesField):(console.log('\u8bed\u6cd5\u9519\u8bef\uff1a \u8f6c\u4e49\u5b57\u7b26 " \u4e0d\u80fd\u5b8c\u6210\u8f6c\u4e49 \u6216 \u5f15\u53f7\u5b57\u6bb5\u7ed3\u5c3e\u5f15\u53f7\u6ca1\u6709\u7d27\u8d34\u5b57\u6bb5\u5206\u9694\u7b26'),i.mStateType=s.Error);break;case s.RowSeparator:"\n"==r?(i.m_content.push(i.Fields),i.Fields=new c,i.strField="",i.mStateType=s.NewFieldStart):(console.log("\u8bed\u6cd5\u9519\u8bef\uff1a \u884c\u5206\u9694\u7528\u4e86\u56de\u8f66 \\r\u3002\u4f46\u672a\u4f7f\u7528\u56de\u8f66\u6362\u884c \\r\\n "),i.mStateType=s.Error);break;case s.Error:}}switch(i.mStateType){case s.NewFieldStart:break;case s.NonQuotesField:i.Fields.push_back(i.strField),i.m_content.push(i.Fields);break;case s.QuotesField:console.log("\u8bed\u6cd5\u9519\u8bef\uff1a \u5f15\u53f7\u5b57\u6bb5\u672a\u95ed\u5408");break;case s.FieldSeparator:i.Fields.push_back(""),i.m_content.push(i.Fields);break;case s.QuoteInQuotesField:i.Fields.push_back(i.strField),i.m_content.push(i.Fields);break;case s.RowSeparator:case s.Error:}i.setHeader(),i.m_content=i.contentToJson(i.m_content),e(i.m_content)})})},t.prototype.contentToJson=function(t){for(var e=[],a=1;a<t.length;++a){for(var i={},o=t[a].m_header,n=t[a].m_values,r=0;r<o.length;++r){for(var s=n[r];s.indexOf("\\n")>=0;)s=s.replace("\\n","\n");i[o[r]]=s}e.push(i)}return e},t.prototype.setHeader=function(){this.m_header.length=0;for(var t=0;t<this.m_content[0].m_values.length;t++)this.m_header.push(this.m_content[0].m_values[t]);for(t=0;t<this.m_content.length;t++)this.m_content[t].setHeader(this.m_header)},t}();n.default=l,cc._RF.pop(),cc._RF.pop()},{}],CustomButton:[function(t,e,a){"use strict";cc._RF.push(e,"0099dSyqE5EQa183sY51P6e","CustomButton");var i=t,o=e,n=a;cc._RF.push(o,"310e1725bpIU7RtzxjZ9Mp9","CustomButton"),Object.defineProperty(n,"__esModule",{value:!0}),n.CustomButton=void 0;var r=i("AudioManager"),s=i("ComponentBase"),c=i("EventManager"),l=i("AppProxy"),u=cc._decorator,p=u.ccclass,h=u.property,d=u.menu,m=u.requireComponent,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnAudio=!0,e.lastEvent=!0,e.clip=null,e}return __extends(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this.node.on("click",this.onClick,this)},e.prototype.onClick=function(){this.btnAudio&&(null!=this.clip?r.AudioManager.instance.playEffect(this.clip):c.EventManager.instance.emit(l.AppEvent.AUDIO_CLICK))},__decorate([h()],e.prototype,"btnAudio",void 0),__decorate([h()],e.prototype,"lastEvent",void 0),__decorate([h({type:cc.AudioClip,tooltip:"\u70b9\u51fb\u97f3\u6548",visible:function(){return this.btnAudio}})],e.prototype,"clip",void 0),__decorate([p,d("\u81ea\u5b9a\u4e49\u7ec4\u4ef6/\u6309\u94ae"),m(cc.Button)],e)}(s.ComponentBase);n.CustomButton=f,cc._RF.pop(),cc._RF.pop()},{}],CustomScrollViewEx:[function(t,e,a){"use strict";cc._RF.push(e,"f6570kEHdFLDqzwq2+ZCpeQ","CustomScrollViewEx");var i=t,o=e,n=a;cc._RF.push(o,"f0026CHcDVHQpTIsFE5h9yh","CustomScrollViewEx"),Object.defineProperty(n,"__esModule",{value:!0}),n.CustomScrollViewEx=n.ScrollViewCustomProperty=void 0;var r,s=i("NodePoolManager"),c=i("ComponentBase"),l=i("CommonUtil"),u=cc._decorator,p=u.ccclass,h=u.property,d=u.menu,m=u.requireComponent;(r=n.ScrollViewCustomProperty||(n.ScrollViewCustomProperty={})).ItemIndex="ItemIndex";var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mScrollView=null,e.mContent=null,e._usefulList=[],e._itemAmount=0,e._initLen=0,e._itemHeight=0,e._checkSize=0,e._extra=null,e._titleHeight=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"children",{get:function(){return this.mContent.children},enumerable:!1,configurable:!0}),e.prototype.initScrollView=function(t,e,a){this._extra=a,this._extra.startItemIndex=this._extra.startItemIndex||0,this._extra.updateItemInfo=this._extra.updateItemInfo||null,this.mScrollView.scrollToTop();var i=this._extra.startItemIndex||0;i>0&&i>t-e&&(i=t-e),this._extra.startItemIndex=i;var o=new cc.Component.EventHandler;o.component="CustomScrollViewEx",o.handler="onScrolling",o.target=this.node,o.customEventData="",this.mScrollView.scrollEvents.splice(0,this.mScrollView.scrollEvents.length),this.mScrollView.scrollEvents.push(o),this.recycle(),this._usefulList=[],this._itemAmount=t,this._initLen=e;var n=s.default.instance.getNode(this._extra.prefab);this._itemHeight=n.height;var r=s.default.instance.getNode(this._extra.titlePrefab);this._titleHeight=r.height,this._checkSize=this._itemHeight*this._initLen,this.mContent.height=this._itemHeight*this._itemAmount+this._titleHeight*this._extra.titleIdx.length,this.mContent.y=this._itemHeight*this._extra.startItemIndex+this.mScrollView.node.height/2,s.default.instance.putNode(n),s.default.instance.putNode(r);for(var c=0;c<this._extra.titleIdx.length;++c)this.addTitle(c);for(c=0;c<this._initLen;++c)this.addItem(c)},e.prototype.recycle=function(){for(var t=this.mContent.children.length,e=0;e<t;++e){if(this.mContent.children[0].name==this._extra.prefab.name)for(var a=this.mContent.children[0].children.length,i=0;i<a;++i)s.default.instance.putNode(this.mContent.children[0].children[0]);s.default.instance.putNode(this.mContent.children[0])}},e.prototype.getChildren=function(){return this._usefulList},e.prototype.addTitle=function(t){var e=s.default.instance.getNode(this._extra.titlePrefab),a=cc.v3(0,0,0);if(0==t)a=cc.v3(e.position.x,-this._titleHeight/2);else{var i=this._extra.titleIdx[t]-this._extra.titleIdx[t-1];a=cc.v3(e.position.x,-(this._titleHeight/2+this._itemHeight*i+this._titleHeight*t))}this.mContent.addChild(e),e.position=a,this._extra.updateTitleInfo&&this._extra.updateTitleInfo.call(this._extra.target,e,t)},e.prototype.addItem=function(t){for(var e=s.default.instance.getNode(this._extra.prefab),a=cc.v3(0,0,0),i=this._extra.startItemIndex+t,o=0,n=this._extra.titleIdx.length-1;n>=0;--n)if(t>=this._extra.titleIdx[n]){o=n+1;break}return a=cc.v3(e.position.x,-(this._itemHeight/2+this._itemHeight*i+this._titleHeight*o),0),this._usefulList.push(e),this.mContent.addChild(e),e.position=a,e[r.ItemIndex]=i,this.updateItemInfo(e,i+o,i),e},e.prototype.moveItem=function(t){var e=null,a=null,i=null,o=null;if("down"==t){if((c=(e=this._usefulList[this._initLen-1])[r.ItemIndex])>=this._itemAmount-1)return;a=this._usefulList[0];for(var n=!1,s=this._extra.titleIdx.length-1;s>=0;--s)if(c==this._extra.titleIdx[s]-1){n=!0;break}i=cc.v3(a.position.x,e.position.y-this._itemHeight-(n?this._titleHeight:0)),o=e[r.ItemIndex]+1,this._usefulList.splice(0,1),this._usefulList.push(a),a[r.ItemIndex]=o}else if("up"==t){var c;if((c=(e=this._usefulList[0])[r.ItemIndex])<=0)return;for(a=this._usefulList[this._initLen-1],n=!1,s=this._extra.titleIdx.length-1;s>=0;--s)if(c==this._extra.titleIdx[s]-1){n=!0;break}i=cc.v3(a.position.x,e.position.y+this._itemHeight+(n?this._titleHeight:0)),o=e[r.ItemIndex]-1,this._usefulList.splice(this._initLen-1,1),this._usefulList.splice(0,0,a),a[r.ItemIndex]=o}if(a){a.position=i,a[r.ItemIndex]=o;var l=0;for(s=this._extra.titleIdx.length-1;s>=0;--s)if(o>=this._extra.titleIdx[s]){l=s+1;break}this.updateItemInfo(a,o+l,o)}},e.prototype.updateItemInfo=function(t,e,a){this._extra.updateItemInfo&&this._extra.updateItemInfo.call(this._extra.target,t,e,a)},e.prototype.onScrolling=function(){if(this.mScrollView&&this.mContent)for(var t=0;t<this._usefulList.length;++t){var e=this._usefulList[t].convertToWorldSpaceAR(cc.v3(0,0,0)),a=this.node.convertToNodeSpaceAR(e);if(a.y-this._itemHeight/2>this._checkSize/2){this.moveItem("down");break}if(a.y+this._itemHeight/2<-this._checkSize/2){this.moveItem("up");break}}else l.CommonUtil.print("\u8bf7\u521d\u59cb\u5316 scrollView \u6216 content")},__decorate([h(cc.ScrollView)],e.prototype,"mScrollView",void 0),__decorate([h(cc.Node)],e.prototype,"mContent",void 0),__decorate([p,d("\u81ea\u5b9a\u4e49\u7ec4\u4ef6/\u6eda\u52a8\u89c6\u56feEx"),m(cc.ScrollView)],e)}(c.ComponentBase);n.CustomScrollViewEx=f,cc._RF.pop(),cc._RF.pop()},{}],CustomScrollView:[function(t,e,a){"use strict";cc._RF.push(e,"12c2aTwwENHhq1C7Wg1gtfG","CustomScrollView");var i=t,o=e,n=a;cc._RF.push(o,"b6101xWKmVKJJeLw3ePVfpw","CustomScrollView"),Object.defineProperty(n,"__esModule",{value:!0}),n.CustomScrollView=n.ScrollDirection=n.ScrollViewCustomProperty=void 0;var r,s,c=i("NodePoolManager"),l=i("ComponentBase"),u=i("CommonUtil"),p=cc._decorator,h=p.ccclass,d=p.property,m=p.menu,f=p.requireComponent;(r=n.ScrollViewCustomProperty||(n.ScrollViewCustomProperty={})).ItemIndex="ItemIndex",function(t){t[t.horizontal=0]="horizontal",t[t.vertical=1]="vertical"}(s=n.ScrollDirection||(n.ScrollDirection={}));var _=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mScrollView=null,e.mContent=null,e.mDir=s.horizontal,e._itemAmount=0,e._initLen=0,e._itemHeight=0,e._itemWidth=0,e._checkSize=0,e._extra=null,e}return __extends(e,t),Object.defineProperty(e.prototype,"children",{get:function(){return this.mContent.children},enumerable:!1,configurable:!0}),e.prototype.initScrollView=function(t,e,a){this._extra=a,this._extra.paddingLeft=this._extra.paddingLeft||0,this._extra.paddingTop=this._extra.paddingTop||0,this._extra.startItemIndex=this._extra.startItemIndex||0,this._extra.updateItemInfo=this._extra.updateItemInfo||null,this.mDir==s.horizontal?this.mScrollView.scrollToLeft():this.mDir==s.vertical&&this.mScrollView.scrollToTop();var i=this._extra.startItemIndex||0;i>0&&i>t-e&&(i=t-e),this._extra.startItemIndex=i;var o=new cc.Component.EventHandler;o.component="CustomScrollView",o.handler="onScrolling",o.target=this.node,o.customEventData="",this.mScrollView.scrollEvents.splice(0,this.mScrollView.scrollEvents.length),this.mScrollView.scrollEvents.push(o),this.recycle(a.bPutChild),this._itemAmount=t,this._initLen=e;var n=c.default.instance.getNode(this._extra.prefab);this._itemWidth=n.width,this._itemHeight=n.height,this.mDir==s.horizontal?(this._checkSize=this._itemWidth*this._initLen,this.mContent.width=this._itemWidth*this._itemAmount+this._extra.paddingLeft,this.mContent.x=this._itemWidth*this._extra.startItemIndex-this.mScrollView.node.width/2):this.mDir==s.vertical&&(this._checkSize=this._itemHeight*this._initLen,this.mContent.height=this._itemHeight*this._itemAmount+this._extra.paddingTop,this.mContent.y=this._itemHeight*this._extra.startItemIndex+this.mScrollView.node.height/2),c.default.instance.putNode(n);for(var r=0;r<this._initLen;++r)this.addItem(r)},e.prototype.recycle=function(t){for(var e=this.mContent.children.length,a=0;a<e;++a){if(t)for(var i=this.mContent.children[0].children.length,o=0;o<i;++o)c.default.instance.putNode(this.mContent.children[0].children[0]);c.default.instance.putNode(this.mContent.children[0])}},e.prototype.setEnable=function(t){this.mScrollView.enabled=t},e.prototype.getChildren=function(){return this.mContent.children},e.prototype.addNewItem=function(t,e){this._itemAmount<t&&(this._initLen++,this._checkSize=this._itemWidth*this._initLen,this.addItem(this._initLen-1)),this._itemAmount++,this.mScrollView.stopAutoScroll(),this.mDir==s.horizontal?(this.mContent.width=this._itemWidth*this._itemAmount+this._extra.paddingLeft,e&&this.mScrollView.scrollToRight(.2)):this.mDir==s.vertical&&(this.mContent.height=this._itemHeight*this._itemAmount+this._extra.paddingTop,e&&this.mScrollView.scrollToBottom(.2))},e.prototype.addItem=function(t){var e=c.default.instance.getNode(this._extra.prefab),a=cc.v3(0,0,0),i=this._extra.startItemIndex+t;return 0==i?this.mDir==s.horizontal?a=cc.v3(this._itemWidth/2+this._extra.paddingLeft,0,0):this.mDir==s.vertical&&(a=cc.v3(e.position.x,-this._itemHeight/2-this._extra.paddingTop,0)):this.mDir==s.horizontal?a=cc.v3(this._itemWidth/2+this._itemWidth*i+this._extra.paddingLeft,0,0):this.mDir==s.vertical&&(a=cc.v3(e.position.x,-(this._itemHeight/2+this._itemHeight*i)-this._extra.paddingTop,0)),this.mContent.addChild(e),e.position=a,e.setSiblingIndex(i),e[r.ItemIndex]=i,this.updateItemInfo(e,i),e},e.prototype.moveItem=function(t){var e=null,a=null,i=null,o=null,n=null;if("down"==t){if((e=this.mContent.children[this._initLen-1])[r.ItemIndex]>=this._itemAmount-1)return;a=this.mContent.children[0],i=cc.v3(a.position.x,e.position.y-this._itemHeight),o=e.getSiblingIndex()+1,n=e[r.ItemIndex]+1}else if("up"==t){if((e=this.mContent.children[0])[r.ItemIndex]<=0)return;a=this.mContent.children[this._initLen-1],i=cc.v3(a.position.x,e.position.y+this._itemHeight),o=0,n=e[r.ItemIndex]-1}else if("right"==t){if((e=this.mContent.children[this._initLen-1])[r.ItemIndex]>=this._itemAmount-1)return;a=this.mContent.children[0],i=cc.v3(e.position.x+this._itemWidth,0),o=e.getSiblingIndex()+1,n=e[r.ItemIndex]+1}else if("left"==t){if((e=this.mContent.children[0])[r.ItemIndex]<=0)return;a=this.mContent.children[this._initLen-1],i=cc.v3(e.position.x-this._itemWidth,0),o=0,n=e[r.ItemIndex]-1}a&&(a.position=i,a.setSiblingIndex(o),a[r.ItemIndex]=n,this.updateItemInfo(a,n))},e.prototype.updateItemInfo=function(t,e){this._extra.updateItemInfo&&this._extra.updateItemInfo.call(this._extra.target,t,e)},e.prototype.onScrolling=function(){if(this.mScrollView&&this.mContent){if(this.mDir==s.horizontal)for(var t=0;t<this.mContent.children.length;++t){var e=this.mContent.children[t].convertToWorldSpaceAR(cc.v3(0,0,0));if((a=this.node.convertToNodeSpaceAR(e)).x-this._itemWidth/2>this._checkSize/2){this.moveItem("left");break}if(a.x+this._itemWidth/2<-this._checkSize/2){this.moveItem("right");break}}else if(this.mDir==s.vertical)for(t=0;t<this.mContent.children.length;++t){var a;if(e=this.mContent.children[t].convertToWorldSpaceAR(cc.v3(0,0,0)),(a=this.node.convertToNodeSpaceAR(e)).y-this._itemHeight/2>this._checkSize/2){this.moveItem("down");break}if(a.y+this._itemHeight/2<-this._checkSize/2){this.moveItem("up");break}}}else u.CommonUtil.print("\u8bf7\u521d\u59cb\u5316 scrollView \u6216 content")},__decorate([d(cc.ScrollView)],e.prototype,"mScrollView",void 0),__decorate([d(cc.Node)],e.prototype,"mContent",void 0),__decorate([d({type:cc.Enum(s)})],e.prototype,"mDir",void 0),__decorate([h,m("\u81ea\u5b9a\u4e49\u7ec4\u4ef6/\u6eda\u52a8\u89c6\u56fe"),f(cc.ScrollView)],e)}(l.ComponentBase);n.CustomScrollView=_,cc._RF.pop(),cc._RF.pop()},{}],CustomToggle:[function(t,e,a){"use strict";cc._RF.push(e,"0ef0eC600BIYoTkeecLu6b5","CustomToggle");var i=t,o=e,n=a;cc._RF.push(o,"38c84spZFFFqJQjw2k/e8li","CustomToggle"),Object.defineProperty(n,"__esModule",{value:!0}),n.CustomToggle=void 0,function(){if(cc.Toggle){var t=cc.Toggle.prototype._updateCheckMark;cc.Toggle.prototype._updateCheckMark=function(){var e;t.call(this);var a=null===(e=this.node)||void 0===e?void 0:e.getComponent("CustomToggle");a&&a.updateCheckMark(this)}}}();var r=i("ComponentBase"),s=cc._decorator,c=s.ccclass,l=s.property,u=s.menu,p=s.requireComponent,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.unCheckMark=null,e}return __extends(e,t),e.prototype.updateCheckMark=function(t){this.unCheckMark&&(this.unCheckMark.active=!t.isChecked)},__decorate([l({type:cc.Node})],e.prototype,"unCheckMark",void 0),__decorate([c,p(cc.Toggle),u("\u81ea\u5b9a\u4e49\u7ec4\u4ef6/Toggle")],e)}(r.ComponentBase);n.CustomToggle=h,cc._RF.pop(),cc._RF.pop()},{}],CustomWidget:[function(t,e,a){"use strict";cc._RF.push(e,"c87e6PBhwNEpJyW8czU3QyS","CustomWidget");var i=t,o=e,n=a;cc._RF.push(o,"2a125ZYjI1MjIm9CR9s8MTG","CustomWidget"),Object.defineProperty(n,"__esModule",{value:!0}),n.CustomWidget=void 0;var r=i("AppBase"),s=i("ComponentBase"),c=cc._decorator,l=c.ccclass,u=c.property,p=c.menu,h=c.requireComponent,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bar=!1,e.customMargin=!1,e.margin=0,e.delay=!1,e.delayTime=1,e._borderMargin=0,e}return __extends(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this);var e=cc.view.getFrameSize(),a=this.node.getComponent(cc.Widget),i=e.height/e.width;if(this._borderMargin=i>1?a.top:a.left,this.bar&&(i>2||i<.5)){var o=r.AppBase.getSystemInfoSync(),n=o.safeArea,s=o.statusBarHeight;0===s&&n&&(s=n.top||n.left);var c,l=cc.winSize;c=i>1?s/e.height*l.height:s/e.width*l.width,this.customMargin?this._borderMargin=this.margin+c:this._borderMargin+=c,this.setWidget()}else this.bar=!1},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this.bar&&(this.delay?this.scheduleOnce(this.setWidget,this.delayTime):this.setWidget())},e.prototype.setWidget=function(){var t=this.node.getComponent(cc.Widget),e=cc.view.getFrameSize();e.height/e.width>1?t.top=this._borderMargin:t.left=this._borderMargin,t.updateAlignment()},__decorate([u({tooltip:"\u662f\u5426\u5f00\u542f\u5218\u6d77\u5c4f\u9002\u914d"})],e.prototype,"bar",void 0),__decorate([u({tooltip:"\u81ea\u5b9a\u4e49\u9876\u8fb9\u8ddd"})],e.prototype,"customMargin",void 0),__decorate([u({tooltip:"\u81ea\u5b9a\u4e49\u5b9a\u8fb9\u8ddd\u7684\u8ddd\u79bb",visible:function(){return this.customMargin}})],e.prototype,"margin",void 0),__decorate([u({tooltip:"\u662f\u5426\u5ef6\u8fdf\u9002\u914d"})],e.prototype,"delay",void 0),__decorate([u({type:cc.Float,tooltip:"\u5ef6\u8fdf\u9002\u914d\u7684\u65f6\u95f4",visible:function(){return this.delay}})],e.prototype,"delayTime",void 0),__decorate([l,h(cc.Widget),p("\u81ea\u5b9a\u4e49\u7ec4\u4ef6/widget")],e)}(s.ComponentBase);n.CustomWidget=d,cc._RF.pop(),cc._RF.pop()},{}],DataAD:[function(t,e,a){"use strict";cc._RF.push(e,"1c9d22kls5I9LzaeTZsct+6","DataAD");var i=e,o=a;cc._RF.push(i,"98b1csCnjNDGJ+k9fRRsbDE","DataAD"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(){this.id=0,this.cd=0,this.des="",this.type=0,this.num1=0,this.num2=0},cc._RF.pop(),cc._RF.pop()},{}],DataAtt:[function(t,e,a){"use strict";cc._RF.push(e,"975514apPxJoI0ZIQhFVDVV","DataAtt");var i=e,o=a;cc._RF.push(i,"bdcc3/EzwVOo5Mwu0YaGaA1","DataAtt"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(){this.id=0,this.des="",this.icon="",this.showType=0,this.num=0},cc._RF.pop(),cc._RF.pop()},{}],DataBox:[function(t,e,a){"use strict";cc._RF.push(e,"90dd46wuvtFY4ByG7azYdfe","DataBox");var i=e,o=a;cc._RF.push(i,"883cfdQmp5CDJixptCAuuKW","DataBox"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(){this.id=0,this.itemID=0,this.type=0,this.reward="",this.weight="",this.num=0},cc._RF.pop(),cc._RF.pop()},{}],DataBuyGold:[function(t,e,a){"use strict";cc._RF.push(e,"54a61pcvU1FbJjWsu1itZGB","DataBuyGold");var i=e,o=a;cc._RF.push(i,"aea4d4lb6pFfJUIdIUZgcKJ","DataBuyGold"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(){this.id=0,this.buyType=0,this.showPic="",this.reward="",this.cost="",this.buyNum=0,this.freeNum=0},cc._RF.pop(),cc._RF.pop()},{}],DataDailyShop:[function(t,e,a){"use strict";cc._RF.push(e,"2d946QJArtI3bJ3a/zB/pCQ","DataDailyShop");var i=e,o=a;cc._RF.push(i,"d648dqFnptJJ4JKfA/Eak1Y","DataDailyShop"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(){this.id=0,this.buyType=0,this.showType=0,this.reward="",this.buyNum=0,this.freeNum=0,this.videoRefresh=0},cc._RF.pop(),cc._RF.pop()},{}],DataEndlessStage:[function(t,e,a){"use strict";cc._RF.push(e,"a2ffc2Ai8BJTbVAnRP/ZaAW","DataEndlessStage");var i=e,o=a;cc._RF.push(i,"75ffeeS6ZJLAo8NR4RyrNe+","DataEndlessStage"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(){this.id=0,this.wave=0,this.startTime=0,this.armyId=0,this.armyName="",this.num=0,this.time=0,this.endTime=0,this.atk=0,this.hp=0,this.seat=0},cc._RF.pop(),cc._RF.pop()},{}],DataGameGuid:[function(t,e,a){"use strict";cc._RF.push(e,"744abCtEc5DcKmgpivd5cxe","DataGameGuid");var i=e,o=a;cc._RF.push(i,"f0135Qq9nRByL5ihM6lYKMs","DataGameGuid"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(){this.id=0,this.mainTrig=0,this.finishType=0,this.type=0,this.showType=0,this.path="",this.boradType=0,this.des="",this.desy=0,this.fingerArrow=0,this.endTrig=0,this.falsh=0,this.voice=""},cc._RF.pop(),cc._RF.pop()},{}],DataItem:[function(t,e,a){"use strict";cc._RF.push(e,"c66d1Af3ehJYaeUBTF6sccF","DataItem");var i=e,o=a;cc._RF.push(i,"e32d1IfzklJcrpZEq5mP8/L","DataItem"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(){this.id=0,this.name="",this.type=0,this.des="",this.qulity=0,this.icon="",this.stage=0},cc._RF.pop(),cc._RF.pop()},{}],DataLevel:[function(t,e,a){"use strict";cc._RF.push(e,"a7cf1P3ef9MtLB/0PQXXKM0","DataLevel");var i=e,o=a;cc._RF.push(i,"a2077wjxFNDq4em2u//2tC/","DataLevel"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(){this.id=0,this.exp=0},cc._RF.pop(),cc._RF.pop()},{}],DataManager:[function(t,e,a){"use strict";cc._RF.push(e,"85d1bvBWzpG6puL2UuHhin8","DataManager");var i=t,o=e,n=a;cc._RF.push(o,"a6195L0Tq5LfpRhpmC9GieQ","DataManager"),Object.defineProperty(n,"__esModule",{value:!0}),n.DataManager=void 0;var r=i("HttpRequest"),s=i("CommonUtil"),c=i("ResUtil"),l=i("SqlUtil"),u=i("StroageMgr"),p=i("TimeUtil"),h=i("PopupManager"),d=i("SceneManager"),m=i("EData"),f=i("GameSave"),_=i("Gutil"),y=i("HomeEnum"),g=i("ProxyManager"),v=i("RelicsDataProxy"),P=i("UserDataProxy"),b=i("UserSetDataProxy"),D=function(){function t(){this._intervalId=null,this.mNikeName="",this.mHead="",this.userVersion="a",this.bTestLv=!1,this.isFirstInGame=!1,this.bFirstInHome=!0,this.allSwitch=!1,this.isNewDay=!1,this.canSaveData=!1,this.mTTchannelId=null,this.mIsNewPlayer=!0,this.mCreateTime=0,this.mIsInitData=!0,this.miniGames=[],this._isInit=!1,this._edata=new m.default,this._saveData=new f.GameSave,this.FileName="ch_bdkp_gameSave_1",this._sendData={},this._isCanSend=!0}return t.prototype.isSubGameOpen=function(t){return!(this.miniGames.length<=0)&&(this.miniGames.indexOf(t)>=0||void 0)},Object.defineProperty(t.prototype,"eData",{get:function(){return this._edata},enumerable:!1,configurable:!0}),Object.defineProperty(t,"instance",{get:function(){return null==this._instance&&(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t.prototype.log=function(t,e){s.CommonUtil.print("DataManager --\x3e "+t+":",e)},t.prototype.error=function(t,e){s.CommonUtil.print("DataManager --\x3e error!!! "+t+":",e)},t.prototype.init=function(){this._intervalId&&this.clear(),this._intervalId=setInterval(this.updateSecond.bind(this),1e3)},t.prototype.updateSecond=function(){b.userSetDataProxy.updateSecond()},t.prototype.initConfig=function(t){var e=this;this._isInit?t&&t():(this._isInit=!0,c.ResUtil.loadBundle({bundleName:y.Bundles.RES_JSON}).then(function(a){a.load("json"+e.userVersion+"/EData",cc.TextAsset,function(a,i){a||(e._edata=JSON.parse(decodeURIComponent(_.Gutil.base64decode(i.text))),s.CommonUtil.print("\u672c\u5730\u914d\u7f6e:",e._edata),t&&t())})}).catch(function(t){s.CommonUtil.print("\u52a0\u8f7d\u914d\u7f6e\u9519\u8bef",t)}))},t.prototype.switchConfig=function(){var t=this;c.ResUtil.loadBundle({bundleName:y.Bundles.RES_JSON}).then(function(e){e.load("json"+t.userVersion+"/EData",cc.TextAsset,function(e,a){e||(t._edata=JSON.parse(decodeURIComponent(_.Gutil.base64decode(a.text))),s.CommonUtil.print("\u672c\u5730\u914d\u7f6e:",t._edata))})}).catch(function(t){s.CommonUtil.print("\u52a0\u8f7d\u914d\u7f6e\u9519\u8bef",t)})},t.prototype.clear=function(){clearInterval(this._intervalId),this._intervalId=null},t.prototype.writeGameDataBase=function(t,e,a){this.canSaveData&&(this._saveData.customData[t]=e,this.saveGame(),this.sendGameDataBase(t,e,!1,a))},t.prototype.cleanGameDataBase=function(){d.SceneManager.instance.showLoading();var t=function(){cc.sys.platform==cc.sys.BYTEDANCE_GAME||cc.sys.platform==cc.sys.WECHAT_GAME?mm.platform.restartMiniProgramSync():(d.SceneManager.instance.hideLoading(),h.PopupManager.instance.removeAll(h.PopupCacheMode.CACHE),cc.director.loadScene("Load"))};r.HttpRequest.inst.request("POST","/player/props/clear",{}).then(function(e){s.CommonUtil.print("player/props/clear \u8fd4\u56de\u7ed3\u679c",e),200==e.code&&(v.relicsDataProxy.resetData(),P.userDataProxy.resetData(t))})},t.prototype.readGameDataBase=function(t){s.CommonUtil.print("\u670d\u52a1\u5668\u6570\u636e::",t),this.canSaveData=!0;var e={};for(var a in t)e[a]=JSON.parse(t[a]);s.CommonUtil.print("\u8f6c\u6210json::",e);var i=null;if(e&&Object.keys(e).length>0){var o=cc.sys.localStorage.getItem(this.FileName,"");o&&""!=o&&(this._saveData=JSON.parse(o),this._saveData.customData.UserData&&e.UserData&&(i=this._saveData.customData.UserData.passChapter>e.UserData.passChapter?this._saveData.customData:this._saveData.customData.UserData.passChapter>=e.UserData.passChapter?this._saveData.customData:e))}i?Object.keys(i).forEach(function(t){g.ProxyManager.instance.readGameDataBase(t,i[t])}):e&&Object.keys(e).length>0?Object.keys(e).forEach(function(t){g.ProxyManager.instance.readGameDataBase(t,e[t])}):this.saveLocality();var n=p.TimeUtil.getTime(),r=Number(l.SqlUtil.getLocalUserData(y.SqlKey.TODAY_TIME,0));p.TimeUtil.isSameDay(n,r)||(this.isNewDay=!0,l.SqlUtil.setLocalUserData(y.SqlKey.TODAY_TIME,n),v.relicsDataProxy.newDataReset(),P.userDataProxy.newDataReset(),this.setIsCanRefreshGoodSkill(!0))},t.prototype.saveLocality=function(){var t=this,e=cc.sys.localStorage.getItem(this.FileName,"");e&&""!=e&&(this._saveData=JSON.parse(e),s.CommonUtil.print("\u672c\u5730\u6570\u636e",this._saveData.customData),Object.keys(this._saveData.customData).forEach(function(e){g.ProxyManager.instance.readGameDataBase(e,t._saveData.customData[e])}),s.CommonUtil.print("\u4fdd\u5b58\u672c\u5730\u6570\u636e::"),P.userDataProxy.saveData())},t.prototype.saveGame=function(){var t=JSON.stringify(this._saveData);cc.sys.localStorage.setItem(this.FileName,t)},t.prototype.getTTchannelId=function(){return l.SqlUtil.getLocalUserData("TTchannelId","0")},t.prototype.setTTchannelId=function(t){l.SqlUtil.setLocalUserData("TTchannelId",t)},t.prototype.getIsCanRefreshGoodSkill=function(){var t=l.SqlUtil.getLocalUserData("CanRefreshGoodSkill","true");return"true"==t||!t},t.prototype.setIsCanRefreshGoodSkill=function(t){l.SqlUtil.setLocalUserData("CanRefreshGoodSkill",String(t))},t.prototype.platformLogin=function(){var t=this;if(cc.sys.platform==cc.sys.WECHAT_GAME||cc.sys.platform==cc.sys.BYTEDANCE_GAME)mm.platform.login(function(e,a){e?(t.loginGameServer(a.code),u.StroageMgr.Inst.setValue({k:y.StroageKey.GameCode,v:"default"},a.code)):s.CommonUtil.print("\u767b\u5f55\u5931\u8d25")});else{var e=u.StroageMgr.Inst.getString({k:y.StroageKey.GameCode,v:"default"});"default"==e&&(e=Date.now().toString()+Math.floor(1e3*Math.random()),u.StroageMgr.Inst.setValue({k:y.StroageKey.GameCode,v:"default"},e)),this.loginGameServer(e)}},t.prototype.loginGameServer=function(e){var a=0;cc.sys.platform==cc.sys.WECHAT_GAME?a=401:cc.sys.platform==cc.sys.BYTEDANCE_GAME&&(a=501);var i={channel:a,openId:e,projectName:"TUNV"},o=JSON.stringify({params:r.HttpRequest.inst.encryptStr(JSON.stringify(i))});s.CommonUtil.print("\u8bf7\u6c42\u767b\u9646\uff1a",i),s.CommonUtil.print("\u8bf7\u6c42\u767b\u9646\uff1a",o),r.HttpRequest.inst.request("POST","/account/sdklogin",o).then(function(e){s.CommonUtil.print("\u767b\u9646\u6210\u529f\uff1a",e),t.token=e.data.token,t.playerId=e.data.playerId}).catch(function(t){console.error("\u767b\u9646\u5931\u8d25\uff1a",t)})},t.prototype.sendGameDataBase=function(){},t.prototype.initGameDataBase=function(e){if(e){t.token=e.token;var a=e.props;this.readGameDataBase(a)}else this.readGameDataBase()},t.prototype.getIsZbRank=function(){return!!P.userDataProxy.userData.startGameRights||!(cc.sys.platform==cc.sys.BYTEDANCE_GAME||cc.sys.platform==cc.sys.WECHAT_GAME)},t.prototype.isOpenShake=function(){return b.userSetDataProxy.setData.isOpenShake},t._instance=null,t.token="",t.playerId="",t.playerName="",t.isSidebarCardInGameForTT=!1,t}();n.DataManager=D,cc._RF.pop(),cc._RF.pop()},{}],DataMonster:[function(t,e,a){"use strict";cc._RF.push(e,"7c277lafTFPtoxDdnZvtbxJ","DataMonster");var i=e,o=a;cc._RF.push(i,"2a3118+IyRIm6rmc+A6kSYa","DataMonster"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(){this.id=0,this.name="",this.modeName="",this.type=0,this.atk=0,this.hp=0,this.speed=0,this.exp=0,this.size=0,this.frame="",this.range=0,this.atkSpeed=0,this.atkFrame="",this.atkType=0,this.bossSkillId=0,this.des="",this.fixedPlantId=""},cc._RF.pop(),cc._RF.pop()},{}],DataPara:[function(t,e,a){"use strict";cc._RF.push(e,"6d2f4zi9UJPu7ILG7kUa3Wo","DataPara");var i=e,o=a;cc._RF.push(i,"991ca9saLVE0KWp/Ncgjw+3","DataPara"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(){this.id=0,this.des="",this.num=""},cc._RF.pop(),cc._RF.pop()},{}],DataPlant:[function(t,e,a){"use strict";cc._RF.push(e,"fc1e0TWRrZMGadhYDvqNZ7o","DataPlant");var i=e,o=a;cc._RF.push(i,"12065adLbBJM7kyib2pdgl9","DataPlant"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(){this.id=0,this.name="",this.icon="",this.qulity=0,this.type1=0,this.triggerNum=0,this.maxLevel=0,this.atack="",this.growup="",this.shape="",this.needItem=0,this.needNum="",this.needGold="",this.skillId="",this.unlockLv="",this.stageID=0,this.prefabKey="",this.cost=0,this.use=0,this.gridNum=0},cc._RF.pop(),cc._RF.pop()},{}],DataRefresh:[function(t,e,a){"use strict";cc._RF.push(e,"6c520YHyCNG4qYE+I730JWQ","DataRefresh");var i=e,o=a;cc._RF.push(i,"7caecoxLy1JGJmPCot/tfZl","DataRefresh"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(){this.id=0,this.name="",this.firstDrawPower=0,this.drawPower=0},cc._RF.pop(),cc._RF.pop()},{}],DataSettlement:[function(t,e,a){"use strict";cc._RF.push(e,"8e5dcXOuY5OAIiTmXy8bGeH","DataSettlement");var i=e,o=a;cc._RF.push(i,"11387mPZ5dOMogdJv2JjtH6","DataSettlement"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(){this.id=0,this.type=0,this.des1="",this.des2="",this.des3=""},cc._RF.pop(),cc._RF.pop()},{}],DataShopBox:[function(t,e,a){"use strict";cc._RF.push(e,"d39e8AXWCxAgKs2UVTR3Tip","DataShopBox");var i=e,o=a;cc._RF.push(i,"ef35eNgvIpGgZLT1klv9gmV","DataShopBox"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(){this.id=0,this.level=0,this.exp=0,this.reward="",this.cost="",this.gainExp=0,this.freeTime=0,this.bigReward="",this.bigCost="",this.bigGainExp=0,this.refreshTime="",this.bigGainGold=0},cc._RF.pop(),cc._RF.pop()},{}],DataSkill:[function(t,e,a){"use strict";cc._RF.push(e,"21416jmZWNHk5zsgcLeL2Vy","DataSkill");var i=e,o=a;cc._RF.push(i,"4ce51OInvlHy5yPdUUfBbAi","DataSkill"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(){this.id=0,this.icon="",this.des="",this.repeat=0,this.frontSkill=0,this.type="",this.quality=0,this.type=0,this.attribute="",this.needTime=0,this.time=0,this.probability=0,this.equipId=0,this.equipLevel=0,this.maxNum=0,this.Weight=0,this.use=0},cc._RF.pop(),cc._RF.pop()},{}],DataStage1:[function(t,e,a){"use strict";cc._RF.push(e,"cc341WAE6ZKY7WGvy3qcngR","DataStage1");var i=e,o=a;cc._RF.push(i,"4075ddQwIRPNaRiFWC3RaMY","DataStage1"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(){this.id=0,this.wave=0,this.startTime=0,this.armyId=0,this.armyName="",this.num=0,this.time=0,this.endTime=0},cc._RF.pop(),cc._RF.pop()},{}],DataStage2:[function(t,e,a){"use strict";cc._RF.push(e,"53c86oJz3tKC6Ycr8JuQu7k","DataStage2");var i=e,o=a;cc._RF.push(i,"d41d7ZL2BtMEogbNYaf/qZq","DataStage2"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(){this.id=0,this.wave=0,this.startTime=0,this.armyId=0,this.armyName="",this.num=0,this.time=0,this.endTime=0},cc._RF.pop(),cc._RF.pop()},{}],DataStage3:[function(t,e,a){"use strict";cc._RF.push(e,"d7e06/o7+xNBpZ0gZqE8WuR","DataStage3");var i=e,o=a;cc._RF.push(i,"9d69aoCVpNOqqSdc42stK/R","DataStage3"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(){this.id=0,this.wave=0,this.startTime=0,this.armyId=0,this.armyName="",this.num=0,this.time=0,this.endTime=0},cc._RF.pop(),cc._RF.pop()},{}],DataStage4:[function(t,e,a){"use strict";cc._RF.push(e,"ae757hRtFRDuL2EFWv3EL60","DataStage4");var i=e,o=a;cc._RF.push(i,"8c408dGXXBJ36zAKfX9sX3v","DataStage4"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(){this.id=0,this.wave=0,this.startTime=0,this.armyId=0,this.armyName="",this.num=0,this.time=0,this.endTime=0},cc._RF.pop(),cc._RF.pop()},{}],DataStage5:[function(t,e,a){"use strict";cc._RF.push(e,"96e24m8udZCMaTuQtZxmSFs","DataStage5");var i=e,o=a;cc._RF.push(i,"8223alS9shJtqxnSSw1+xWR","DataStage5"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(){this.id=0,this.wave=0,this.startTime=0,this.armyId=0,this.armyName="",this.num=0,this.time=0,this.endTime=0},cc._RF.pop(),cc._RF.pop()},{}],DataStage6:[function(t,e,a){"use strict";cc._RF.push(e,"c2f10giNjFCMJ5xUKMjXBsT","DataStage6");var i=e,o=a;cc._RF.push(i,"a070a5Ll1hGDoAQ7V7EvYVX","DataStage6"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(){this.id=0,this.wave=0,this.startTime=0,this.armyId=0,this.armyName="",this.num=0,this.time=0,this.endTime=0},cc._RF.pop(),cc._RF.pop()},{}],DataStage7:[function(t,e,a){"use strict";cc._RF.push(e,"bf74eN1yrZDdrrVfW8fT5Bh","DataStage7");var i=e,o=a;cc._RF.push(i,"65764SWq+lKoJFXkosTbfiG","DataStage7"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(){this.id=0,this.wave=0,this.startTime=0,this.armyId=0,this.armyName="",this.num=0,this.time=0,this.endTime=0},cc._RF.pop(),cc._RF.pop()},{}],DataStageReward:[function(t,e,a){"use strict";cc._RF.push(e,"d40f7ktkFBGdLPD5dPHOySD","DataStageReward");var i=e,o=a;cc._RF.push(i,"ecf8a7f7vNAwapcbJtDhigS","DataStageReward"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(){this.id=0,this.name="",this.banner="",this.monsterList="",this.round=0,this.wave="",this.stone="",this.boxWave="",this.boxReward1="",this.boxReward2="",this.boxReward3="",this.winReward="",this.roundReward="",this.icon="",this.des="",this.Attribute="",this.plant="",this.plantPosition="",this.stoneHp=0,this.stoneSun=0,this.AllSun=0},cc._RF.pop(),cc._RF.pop()},{}],DataStage:[function(t,e,a){"use strict";cc._RF.push(e,"cf1cfagtJpL9okme6preekT","DataStage");var i=e,o=a;cc._RF.push(i,"5328eHFC0xLxZzlqpnxl1nN","DataStage"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(){this.id=0,this.stage=0,this.wave=0,this.atk=0,this.hp=0,this.boss=0,this.bossId=0,this.refreshRate=0,this.time=0,this.refresh="",this.refreshCD=""},cc._RF.pop(),cc._RF.pop()},{}],DataSuperPlant:[function(t,e,a){"use strict";cc._RF.push(e,"d5fd7PZ4LFPz51FXqSGl9b7","DataSuperPlant");var i=e,o=a;cc._RF.push(i,"0b428vpIulIW7tWjLOE7yxe","DataSuperPlant"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(){this.id=0,this.name="",this.superNum=0,this.chargeNum=0,this.refreshLevel1="",this.refreshLevel2="",this.refreshWeight="",this.level1="",this.level2="",this.level3="",this.skillDes="",this.damage=0,this.CD=0,this.damage1=0,this.num="",this.needNum=0,this.use=0},cc._RF.pop(),cc._RF.pop()},{}],Data_BagStage:[function(t,e,a){"use strict";cc._RF.push(e,"67082ktB81OYaxA8OGdplzJ","Data_BagStage");var i=e,o=a;cc._RF.push(i,"eee37hr05xI1IbkhLRWKqam","Data_BagStage"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(){this.id=0,this.monster=0,this.atk=0,this.def=0,this.hp=0,this.speed=0,this.att1=0,this.att2=0,this.att3=0,this.att4=0,this.att5=0,this.att6=0,this.att7=0,this.levelWeight="",this.numWeight=""},cc._RF.pop(),cc._RF.pop()},{}],Data_BagWeapon:[function(t,e,a){"use strict";cc._RF.push(e,"3cf57cgsnxNSK0TUpHRThqh","Data_BagWeapon");var i=e,o=a;cc._RF.push(i,"96940ScjlZAb7K+TGUFBcVe","Data_BagWeapon"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(){this.id=0,this.name="",this.icon="",this.type=0,this.shape="",this.level=0,this.atk=0,this.def=0,this.hp=0,this.speed=0,this.att1=0,this.att2=0,this.att3=0,this.att4=0,this.att5=0,this.att6=0,this.att7=0,this.refresh=""},cc._RF.pop(),cc._RF.pop()},{}],Data_BossSkill:[function(t,e,a){"use strict";cc._RF.push(e,"7830221xbVE9ZR+17Tv5EGM","Data_BossSkill");var i=e,o=a;cc._RF.push(i,"bfd97JrjmtBSKq1fWygkn6v","Data_BossSkill"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(){this.id=0,this.name="",this.des="",this.cd=0,this.keepTime=0,this.click=0,this.num=0},cc._RF.pop(),cc._RF.pop()},{}],Data_BridgeObstacle:[function(t,e,a){"use strict";cc._RF.push(e,"ae45eoLeEFInL6U2shCG6Ii","Data_BridgeObstacle");var i=e,o=a;cc._RF.push(i,"2a2871TtHNFWI5SuS8gvnLZ","Data_BridgeObstacle"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(){this.id=0,this.stage=0,this.hp=0,this.name="",this.icon="",this.role=0,this.atk=0,this.speed=0,this.penetrate=0,this.atkNum=0,this.skin="",this.bullet="",this.skillDes="",this.parm="",this.des=""},cc._RF.pop(),cc._RF.pop()},{}],Data_BridgeStage:[function(t,e,a){"use strict";cc._RF.push(e,"efd77LHJdNFzKaaFwQB1pst","Data_BridgeStage");var i=e,o=a;cc._RF.push(i,"fbc6fonN8BCNKg4JZLbA+4H","Data_BridgeStage"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(){this.id=0,this.stage=0,this.speed=0,this.time=0,this.buffType=0,this.type=0,this.num1=0,this.num2=0,this.num3=0,this.monsterId=0,this.hp=0,this.row=0,this.column=0,this.cd=0,this.reward="",this.boss=0},cc._RF.pop(),cc._RF.pop()},{}],Data_FixedPlant:[function(t,e,a){"use strict";cc._RF.push(e,"d9ceckVYlZHi4RzDFCtmAO6","Data_FixedPlant");var i=e,o=a;cc._RF.push(i,"8219eBh++9HJauCtbrtgwjr","Data_FixedPlant"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(){this.id=0,this.name="",this.triggerNum=0,this.skillDes="",this.atk=0,this.atkLevelup=0,this.time=0,this.num=""},cc._RF.pop(),cc._RF.pop()},{}],Data_JarMonster:[function(t,e,a){"use strict";cc._RF.push(e,"490c2OiV5FHpIh8YFbtsmNW","Data_JarMonster");var i=e,o=a;cc._RF.push(i,"ceb09gT9XtAL4aesGGlvQiT","Data_JarMonster"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(){this.id=0,this.name="",this.type=0,this.res="",this.atk=0,this.speed=0,this.num=0,this.hp=0,this.move=0,this.wood=0,this.des="",this.parm=""},cc._RF.pop(),cc._RF.pop()},{}],Data_JarStage:[function(t,e,a){"use strict";cc._RF.push(e,"59739ds6TdFGYtYRd+ubTQp","Data_JarStage");var i=e,o=a;cc._RF.push(i,"53b38YwG9hG3aYyrvEO1cRn","Data_JarStage"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(){this.id=0,this.name="",this.atk=0,this.hp=0,this.jar="",this.num=""},cc._RF.pop(),cc._RF.pop()},{}],Data_JarTreasure:[function(t,e,a){"use strict";cc._RF.push(e,"178e6hd761DObJXc+zvMFkY","Data_JarTreasure");var i=e,o=a;cc._RF.push(i,"20237J1X55JrakX3xetGP4i","Data_JarTreasure"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(){this.id=0,this.name="",this.wood=0,this.des="",this.parm="",this.cd=0},cc._RF.pop(),cc._RF.pop()},{}],Data_SpecialRefresh:[function(t,e,a){"use strict";cc._RF.push(e,"4aae0qSmfNOFKIRpLzVkhSM","Data_SpecialRefresh");var i=e,o=a;cc._RF.push(i,"b79feBI3cZBeLNJhdSqH5VL","Data_SpecialRefresh"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(){this.id=0,this.refresh=0,this.wave=0,this.type=0,this.condition=0,this.num="",this.level="",this.AD=""},cc._RF.pop(),cc._RF.pop()},{}],Data_WeatherData:[function(t,e,a){"use strict";cc._RF.push(e,"f4fefWLxI5GzqAchR+3WrMK","Data_WeatherData");var i=e,o=a;cc._RF.push(i,"6b688AI0CBM1JvoC1tIEnZR","Data_WeatherData"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(){this.id=0,this.stageId=0,this.wave=0,this.startTime=0,this.armyId=0,this.armyName="",this.num=0,this.time=0,this.endTime=0,this.atk=0,this.hp=0},cc._RF.pop(),cc._RF.pop()},{}],Data_Weather:[function(t,e,a){"use strict";cc._RF.push(e,"b506cXgS0RIdqdBgjahGHaG","Data_Weather");var i=e,o=a;cc._RF.push(i,"6f6df+3NgZG/JQROCGdc76W","Data_Weather"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(){this.id=0,this.stage=0,this.atkRate=0,this.hpRate=0,this.gold=0,this.waveGold=0,this.unlock=0,this.weather=0,this.firstReward="",this.reward="",this.stageName=""},cc._RF.pop(),cc._RF.pop()},{}],Data_ZombieMonster:[function(t,e,a){"use strict";cc._RF.push(e,"d00daJU6u1PzYO6BWwG6YAI","Data_ZombieMonster");var i=e,o=a;cc._RF.push(i,"579d35l8vxKP6tIbUPTgOMA","Data_ZombieMonster"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(){this.id=0,this.name="",this.atk=0,this.hp=0,this.speed=0,this.maxlevel=0,this.hp=0,this.super=""},cc._RF.pop(),cc._RF.pop()},{}],Data_ZombiePlant:[function(t,e,a){"use strict";cc._RF.push(e,"a8180SkYDRPl5kwO9M+6/zd","Data_ZombiePlant");var i=e,o=a;cc._RF.push(i,"f9aa7oeBVtFUI3M8OVCi1Ts","Data_ZombiePlant"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(){this.id=0,this.name="",this.icon="",this.icon2="",this.type="",this.sunshine=0,this.atk=0,this.speed=0,this.levelup=0,this.maxlevel=0,this.hp=0,this.super=0,this.des="",this.parm=""},cc._RF.pop(),cc._RF.pop()},{}],Data_ZombieStage:[function(t,e,a){"use strict";cc._RF.push(e,"c0956Hz7z5PYIprQHiNU/dz","Data_ZombieStage");var i=e,o=a;cc._RF.push(i,"74f01ZrW+RJVLYj0Pwq5MSJ","Data_ZombieStage"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(){this.id=0,this.wave=0,this.startTime=0,this.line=0,this.armyId=0,this.armyName="",this.num=0,this.time=0,this.endTime=0,this.hp=0,this.atk=0},cc._RF.pop(),cc._RF.pop()},{}],DestroyAllBlockEffect:[function(t,e,a){"use strict";cc._RF.push(e,"74381D2OcZFAJf05XuMW0VN","DestroyAllBlockEffect");var i=e,o=a;cc._RF.push(i,"4ec30rlN2hNyp2REbPSqwHU","DestroyAllBlockEffect"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,r=n.ccclass,s=n.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mSpine=null,e}return __extends(e,t),e.prototype.onLoad=function(){var t=this;this.mSpine.setCompleteListener(function(){t.node.destroy(),t.node.removeFromParent()})},e.prototype.play=function(){this.mSpine.setAnimation(0,"chuxian",!1)},__decorate([s(sp.Skeleton)],e.prototype,"mSpine",void 0),__decorate([r],e)}(cc.Component);o.default=c,cc._RF.pop(),cc._RF.pop()},{}],DizzinessEffect:[function(t,e,a){"use strict";cc._RF.push(e,"62924RrAnZJHLwBLjBBU/GC","DizzinessEffect");var i=t,o=e,n=a;cc._RF.push(o,"87627XijspCeZC1WkquBwDQ","DizzinessEffect"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AnimationCfgMgr"),s=i("AnimationCtrl"),c=cc._decorator,l=c.ccclass,u=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mAnimCtrl=null,e}return __extends(e,t),e.prototype.play=function(){var t=this;this.mAnimCtrl.loadAnimation(r.AnimationCfgMgr.instance.getDizzinessEffect()).then(function(){t.node&&t.node.isValid&&t.mAnimCtrl.playAnim("dizziness",!0)})},__decorate([u({type:s.default})],e.prototype,"mAnimCtrl",void 0),__decorate([l],e)}(cc.Component);n.default=p,cc._RF.pop(),cc._RF.pop()},{}],EData:[function(t,e,a){"use strict";cc._RF.push(e,"bd5cc6QKQxD6J5Hx9mAYm8A","EData");var i=e,o=a;cc._RF.push(i,"124899kXFhA+pDFmsmZT/2c","EData"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(){this.version=0,this.createTime="",this.databox={},this.datapara={},this.datasuperplant={},this.datalevel={},this.datamonster={},this.datastage={},this.datastagereward={},this.dataad={},this.dataskill={},this.datashopbox={},this.databuygold={},this.datadailyshop={},this.dataatt={},this.dataitem={},this.datagameguid={},this.dataplant={},this.datastage1={},this.datastage2={},this.datastage3={},this.datastage4={},this.datastage5={},this.datastage6={},this.datastage7={},this.datarefresh={},this.datasettlement={},this.data_fixedplant={},this.data_bossskill={},this.data_specialrefresh={},this.dataendlessstage={},this.data_bagweapon={},this.data_bagstage={},this.data_bridgeobstacle={},this.data_bridgestage={},this.data_weather={},this.data_weatherdata={},this.data_jarmonster={},this.data_jartreasure={},this.data_jarstage={},this.data_zombieplant={},this.data_zombiemonster={},this.data_zombiestage={}},cc._RF.pop(),cc._RF.pop()},{}],E_AttrType:[function(t,e,a){"use strict";cc._RF.push(e,"3874f1qutlPDYcd2YAliH/3","E_AttrType");var i=e,o=a;cc._RF.push(i,"c6767fvSwJH/IoPrvRPJuHO","E_AttrType"),Object.defineProperty(o,"__esModule",{value:!0}),o.E_AttrType=void 0,function(t){t[t.ATK=1]="ATK",t[t.DEF=2]="DEF",t[t.HP=3]="HP",t[t.SPD=4]="SPD",t[t.DODGE=5]="DODGE",t[t.STUN=6]="STUN",t[t.REBATE=7]="REBATE",t[t.COMBO=8]="COMBO",t[t.BLOOD=9]="BLOOD",t[t.CRIT=10]="CRIT",t[t.RECOVER=11]="RECOVER"}(o.E_AttrType||(o.E_AttrType={})),cc._RF.pop(),cc._RF.pop()},{}],EarthSoilEffect:[function(t,e,a){"use strict";cc._RF.push(e,"de866NaGQ5KWr1xEmHKZQL2","EarthSoilEffect");var i=t,o=e,n=a;cc._RF.push(o,"488d08EJWtMF5CVEtGXQaCI","EarthSoilEffect"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("ComponentBase"),s=i("AnimationCtrl"),c=cc._decorator,l=c.ccclass,u=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mAnimCtrl=null,e}return __extends(e,t),__decorate([u({type:s.default})],e.prototype,"mAnimCtrl",void 0),__decorate([l],e)}(r.ComponentBase);n.default=p,cc._RF.pop(),cc._RF.pop()},{}],EndlessOverPopup:[function(t,e,a){"use strict";cc._RF.push(e,"eecefXE3qdFdZ1IT/9EqeHj","EndlessOverPopup");var i=t,o=e,n=a;cc._RF.push(o,"cc739lytV9Gfq/h/BHcECHM","EndlessOverPopup"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("ResUtil"),c=i("PopupBase"),l=i("SceneManager"),u=i("AdsMgr"),p=i("GameEnum"),h=i("HomeEnum"),d=i("DataManager"),m=i("BattleDataProxy"),f=i("UserDataProxy"),_=i("AnimationMgr"),y=cc._decorator,g=y.ccclass,v=y.property,P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mTips1=null,e.mTips2=null,e.mWaveNum=null,e.mMaxWave=null,e.mItemLayout=null,e._isCanClick=!0,e._reawards=[],e._double=1,e}return __extends(e,t),e.prototype.init=function(e){t.prototype.init.call(this,e),r.AudioManager.instance.stopBgm(),r.AudioManager.instance.playEffectPath("sounds/lose",h.Bundles.RES),this.mWaveNum.string="\u672c\u6b21\u6ce2\u6b21:"+m.battleDataProxy.endlessCurWave;var a=this.node.getChildByName("pic_xinjilu");m.battleDataProxy.endlessCurWave>f.userDataProxy.userData.endlessData.maxWave?(f.userDataProxy.userData.endlessData.maxWave=m.battleDataProxy.endlessCurWave,a.active=!0):a.active=!1,this.mMaxWave.string="\u4eca\u65e5\u6700\u9ad8\u6ce2\u6b21\uff1a"+f.userDataProxy.userData.endlessData.maxWave,this.endlessOver(),this.updateVideoCardNum(),m.battleDataProxy.gameState=p.GameState.OVER;var i=Math.floor(1e3*Math.random())%3+1;this.mTips2.string=d.DataManager.instance.eData.datasettlement[2]["des"+i],m.battleDataProxy.clearData()},e.prototype.updateVideoCardNum=function(){var t=this.node.getChildByName("BtnDouble").getChildByName("pic_AD_green");m.battleDataProxy.setVideoCardIcon(t,2,1.5)},e.prototype.endlessOver=function(){for(var t=d.DataManager.instance.eData.datapara[1005].num,e=d.DataManager.instance.eData.datapara[1006].num,a=Math.ceil(m.battleDataProxy.endlessCurWave/5),i=[],o=0,n=t.split("|"),r=e.split("|"),s=0,c=n.length;s<c;s++){var l=n[s].split("_");(o=Math.floor(1*Number(l[1])))>0&&i.push({id:Number(l[0]),num:o})}var u=function(t){var e=r[t].split("_");if((o=Math.floor(1*Number(e[1]))*a)>0){var n=i.findIndex(function(t){return t.id==Number(e[0])});n>=0?i[n].num+=o:i.push({id:Number(e[0]),num:o})}};for(s=0,c=r.length;s<c;s++)u(s);this.setRewardItems(i),this._reawards=i,f.userDataProxy.userData.endlessData.maxWave<m.battleDataProxy.endlessCurWave&&(f.userDataProxy.userData.endlessData.maxWave=m.battleDataProxy.endlessCurWave,f.userDataProxy.saveData()),m.battleDataProxy.uploadEndlessResult(function(){m.battleDataProxy.getEndlessRankDatas(function(){})})},e.prototype.setRewardItems=function(t){t=f.userDataProxy.checkBoxRetrunAwards(t);for(var e=function(e){var i=d.DataManager.instance.eData.dataitem[t[e].id],o=a.mItemLayout.children[e];o||((o=cc.instantiate(a.mItemLayout.children[0])).parent=a.mItemLayout),o.active=!0;var n=o.getChildByName("itemBg").getComponent(cc.Sprite);s.ResUtil.loadAsset({path:"textures/public/item_bg"+i.qulity,type:cc.SpriteFrame,bundleName:h.Bundles.GAME}).then(function(t){n.spriteFrame=t}).catch(function(t){console.log("error:",t)});var r=o.getChildByName("itemImg").getComponent(cc.Sprite);s.ResUtil.loadAsset({path:"textures/item/"+i.icon,type:cc.SpriteFrame,bundleName:h.Bundles.GAME}).then(function(t){r.spriteFrame=t}).catch(function(t){console.log("error:",t)}),o.getChildByName("itemNum").getComponent(cc.Label).string="x"+t[e].num},a=this,i=0,o=t.length;i<o;i++)e(i)},e.prototype.onBtnReceive=function(){this._isCanClick&&(this._double=1,this.toHome())},e.prototype.onBtnDouble=function(){var t=this;if(this._isCanClick){if(f.userDataProxy.getProp(4)>0)return f.userDataProxy.addProp(4,-1),this._double=2,void this.toHome();u.default.showVideoAds({id:1,eventId:"endless_over_double_ad",success:function(){t._double=2,t.toHome()},fail:function(t){return console.log(t)},error:function(t){return console.log(t)}},!0)}},e.prototype.toHome=function(){var t=this;this._isCanClick=!1;for(var e=this.node.getChildByName("layout"),a=0,i=this._reawards.length,o=i>0?2:0,n=function(o){var n=e.children[o];if(!n.active)return"continue";var s=r._reawards[a];r.scheduleOnce(function(){s&&(n.active=!1,_.default.instance.showAwardAni(s,t.node,n,0,cc.v3(-250,s.id>6?-850:850)),f.userDataProxy.addProp(s.id,s.num*t._double,a+1==i))},.1*a),a++},r=this,s=0;s<e.children.length;++s)n(s);this.scheduleOnce(function(){l.SceneManager.instance.runScene("Home",""),t.removeUI()},.1*a+o)},__decorate([v(cc.Label)],e.prototype,"mTips1",void 0),__decorate([v(cc.Label)],e.prototype,"mTips2",void 0),__decorate([v(cc.Label)],e.prototype,"mWaveNum",void 0),__decorate([v(cc.Label)],e.prototype,"mMaxWave",void 0),__decorate([v(cc.Node)],e.prototype,"mItemLayout",void 0),__decorate([g],e)}(c.PopupBase);n.default=P,cc._RF.pop(),cc._RF.pop()},{}],EndlessRewardPopup:[function(t,e,a){"use strict";cc._RF.push(e,"2aff4vIw3RBpYjPkoqazAHV","EndlessRewardPopup");var i=t,o=e,n=a;cc._RF.push(o,"53a85Ti9dhKVqh/95/3COo4","EndlessRewardPopup"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("List"),s=i("EventManager"),c=i("ResUtil"),l=i("PopupBase"),u=i("HomeEnum"),p=i("DataManager"),h=i("UserDataProxy"),d=i("GameUIManager"),m=cc._decorator,f=m.ccclass,_=m.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mMyList=null,e.mMaxWave=null,e._myRank=0,e._rewardData=[],e._rankStr=[],e}return __extends(e,t),e.prototype.init=function(){this._myRank=h.userDataProxy.mYesterdayRank;var t=this.node.getChildByName("BtnReceive"),e=h.userDataProxy.userData.endlessData;t.getComponent(cc.Button).interactable=h.userDataProxy.mYesterdayRank>0&&0==e.isReceive&&this._myRank>0,h.userDataProxy.mYesterdayRank>0?this.mMaxWave.string=""+h.userDataProxy.mYesterdayRank:this.mMaxWave.string="\u672a\u4e0a\u699c",this.node.getChildByName("BtnClose").y-=20,1==e.isReceive?t.getChildByName("lab").getComponent(cc.Label).string="\u5df2\u9886\u53d6":t.getChildByName("lab").getComponent(cc.Label).string="\u9886\u53d6";for(var a=1008;a<1015;++a){var i=p.DataManager.instance.eData.datapara[a].num;this._rewardData.push(i)}this._rankStr=["1","2","3","4-10","11-20","21-50","50+"]},e.prototype.onShow=function(){this.mMyList.numItems=this._rewardData.length},e.prototype.onUpdateItem=function(t,e){var a=t.getChildByName("rankNum"),i=t.getChildByName("greenBg"),o=t.getChildByName("yellowBg");o?(o.active=e<=2,i.active=!o.active):i.active=!0,a.getComponent(cc.Label).string=this._rankStr[e];for(var n=0;n<3;++n)t.getChildByName("pic_"+(n+1)).active=e==n;a.active=e>2;var r=this._rewardData[e].split("|"),s=t.getChildByName("layout");s.children.forEach(function(t){t.active=!1});var l=function(t){var e=r[t].split("_").map(Number),a=e[0],i=e[1],o=p.DataManager.instance.eData.dataitem[a];if(!o)return console.log("\u6ca1\u6709\u8fd9\u4e2a\u7269\u54c1:",a),"continue";var n=s.children[t];n||(n=cc.instantiate(s.children[0]),s.addChild(n)),n.active=!0;var l=n.getChildByName("gradeIcon");c.ResUtil.loadAsset({path:"textures/public/item_bg"+o.qulity,type:cc.SpriteFrame,bundleName:u.Bundles.GAME}).then(function(t){l.getComponent(cc.Sprite).spriteFrame=t}).catch(function(t){console.log("error:",t)});var h=n.getChildByName("rewardIcon").getComponent(cc.Sprite);c.ResUtil.loadAsset({path:"textures/item/"+o.icon,type:cc.SpriteFrame,bundleName:u.Bundles.GAME}).then(function(t){h.spriteFrame=t}).catch(function(t){console.log("error:",t)}),n.getChildByName("num").getComponent(cc.Label).string="x"+i};for(n=0;n<r.length;++n)l(n)},e.prototype.onBtnReceive=function(){if(1!=h.userDataProxy.userData.endlessData.isReceive){var t=1014;1==this._myRank?t=1008:2==this._myRank?t=1009:3==this._myRank?t=1010:this._myRank>=4&&this._myRank<=10?t=1011:this._myRank>=11&&this._myRank<=20?t=1012:this._myRank>=21&&this._myRank<=50&&(t=1013);for(var e=p.DataManager.instance.eData.datapara[t].num.split("|"),a=[],i=0;i<e.length;++i){var o=e[i].split("_"),n=Math.floor(Number(o[1]));n>0&&a.push({id:Number(o[0]),num:n})}var r=this.node.getChildByName("BtnReceive");r.getComponent(cc.Button).interactable=!1,r.getChildByName("lab").getComponent(cc.Label).string="\u5df2\u9886\u53d6",h.userDataProxy.userData.endlessData.isReceive=1,h.userDataProxy.saveData(),a=h.userDataProxy.checkBoxRetrunAwards(a),d.gameUIMgr.showCongratsGettingPopup({list:a,type:1}),s.EventManager.instance.emit(u.EHomeEvent.RECEIVE_ENDLESS_RWWARDS)}else d.gameUIMgr.showTips("\u4eca\u65e5\u5956\u52b1\u5df2\u7ecf\u9886\u53d6")},__decorate([_(r.default)],e.prototype,"mMyList",void 0),__decorate([_(cc.Label)],e.prototype,"mMaxWave",void 0),__decorate([f],e)}(l.PopupBase);n.default=y,cc._RF.pop(),cc._RF.pop()},{}],EndlessStartPopup:[function(t,e,a){"use strict";cc._RF.push(e,"6be7b2h9BVNLqEy7lkboxjo","EndlessStartPopup");var i=t,o=e,n=a;cc._RF.push(o,"c034eahMGVFC4Vtiib2VzaP","EndlessStartPopup"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("List"),s=i("EventManager"),c=i("ResUtil"),l=i("PopupBase"),u=i("SceneManager"),p=i("AdsMgr"),h=i("GameEnum"),d=i("HomeEnum"),m=i("DataManager"),f=i("BattleDataProxy"),_=i("UserDataProxy"),y=i("GameUIManager"),g=cc._decorator,v=g.ccclass,P=g.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mMaxWave=null,e.mMyList=null,e.mMyRankItem=null,e._listData=null,e._myRank=0,e}return __extends(e,t),e.prototype.init=function(){var t=this;s.EventManager.instance.on(d.EHomeEvent.RECEIVE_ENDLESS_RWWARDS,this.onReceiveEndlessRewards,this),_.userDataProxy.userData.endlessData||(_.userDataProxy.userData.endlessData.maxWave=0,_.userDataProxy.userData.endlessData.isReceive=0),this.mMaxWave.string=_.userDataProxy.userData.endlessData.maxWave+"";var e=this.node.getChildByName("BtnBox").getChildByName("redDot");_.userDataProxy.mYesterdayRank>0&&1!=_.userDataProxy.userData.endlessData.isReceive?e.active=!0:e.active=!1,this.node.getChildByName("BtnClose").y-=20,f.battleDataProxy.getEndlessRankDatas(function(e){if(200==e.code){t._listData=e.data.list,t._listData&&(t.mMyList.numItems=t._listData.length);var a=e.data.myRank;a?(t._myRank=a.rank,t.setRankItem(t.mMyRankItem,a)):t.setRankItem(t.mMyRankItem,{nickName:m.DataManager.instance.mNikeName,head:m.DataManager.instance.mHead,playerld:"",rank:-1,value:_.userDataProxy.userData.endlessData.maxWave})}else t.setRankItem(t.mMyRankItem,{nickName:m.DataManager.instance.mNikeName,head:m.DataManager.instance.mHead,playerld:"",rank:-1,value:_.userDataProxy.userData.endlessData.maxWave})});var a=this.node.getChildByName("BtnStart"),i=a.getChildByName("videoIcon"),o=a.getChildByName("lab");console.log("userDataProxy.userData.endlessData:",_.userDataProxy.userData.endlessData),_.userDataProxy.userData.endlessData.playNum||0==_.userDataProxy.userData.endlessData.playNum||(_.userDataProxy.userData.endlessData.playNum=Number(m.DataManager.instance.eData.datapara[1001].num)),_.userDataProxy.userData.endlessData.playNum>0?i.active=!1:(i.active=!0,o.x=42)},e.prototype.onDestroy=function(){s.EventManager.instance.off(d.EHomeEvent.RECEIVE_ENDLESS_RWWARDS,this.onReceiveEndlessRewards,this)},e.prototype.onReceiveEndlessRewards=function(){this.node.getChildByName("BtnBox").getChildByName("redDot").active=!1},e.prototype.onShow=function(){},e.prototype.setRankItem=function(t,e){t.active=!0;var a=t.getChildByName("waveNum"),i=t.getChildByName("head"),o=t.getChildByName("nikeName"),n=t.getChildByName("rankNum"),r=t.getChildByName("greenBg"),s=t.getChildByName("yellowBg");s?(s.active=e.rank>=1&&e.rank<=3,r.active=!s.active):r.active=!0,e.rank<=0?(n.getComponent(cc.Label).string="\u672a\u4e0a\u699c",n.scale=1):n.getComponent(cc.Label).string=e.rank+"";for(var l=0;l<3;++l)t.getChildByName("pic_"+(l+1)).active=e.rank==l+1;if(n.active=e.rank>3||e.rank<=0,e.nickName&&""!=e.nickName?o.getComponent(cc.Label).string=e.nickName:o.getComponent(cc.Label).string="\u795e\u79d8\u73a9\u5bb6",e.head&&""!=e.head){var u=!0;cc.sys.platform==cc.sys.WECHAT_GAME&&(u=e.head.indexOf("https://thirdwx.qlogo.cn")>=0),u&&c.ResUtil.loadRemote({url:e.head,option:{ext:".png"}}).then(function(t){(null==i?void 0:i.isValid)&&(i.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t))}).catch(function(){})}a.getComponent(cc.Label).string=e.value+""},e.prototype.onUpdateItem=function(t,e){var a=this._listData[e];this.setRankItem(t,a)},e.prototype.onBtnBox=function(){y.gameUIMgr.showEndlessRewardPopup(this._myRank)},e.prototype.onBtnStart=function(){for(var t=this,e=0;e<4;++e)if(_.userDataProxy.getWearItemIsUnlock(e).isUnlock&&!_.userDataProxy.userData.combatEqus[e])return void y.gameUIMgr.showTips("\u643a\u5e26\u690d\u7269\u4e0d\u8db3\uff01");if(cc.sys.isBrowser&&yzll.gameConfig.isZB&&!_.userDataProxy.userData.startGameRights)y.gameUIMgr.showTips("\u8bf7\u5148\u4f7f\u7528\u5151\u6362\u7801\u6fc0\u6d3b\u6e38\u620f~");else{var a=_.userDataProxy.userData.endlessData.playNum;a<=0?p.default.showVideoAds({id:1,eventId:"play_endless_ad",success:function(){t.goNextScene()},fail:function(){},error:function(t){cc.log(t)}},!0):(a--,_.userDataProxy.userData.endlessData.playNum=a,_.userDataProxy.saveData(),this.goNextScene())}},e.prototype.goNextScene=function(){f.battleDataProxy.clearData(),f.battleDataProxy.isEndless=!0,f.battleDataProxy.weatherType=h.WeatherType.NONE,s.EventManager.instance.emit(d.EHomeEvent.STAET_FIGHT),u.SceneManager.instance.runScene("Game","",function(){}),this.removeUI()},__decorate([P(cc.Label)],e.prototype,"mMaxWave",void 0),__decorate([P(r.default)],e.prototype,"mMyList",void 0),__decorate([P(cc.Node)],e.prototype,"mMyRankItem",void 0),__decorate([v],e)}(l.PopupBase);n.default=b,cc._RF.pop(),cc._RF.pop()},{}],Enemy4001:[function(t,e,a){"use strict";cc._RF.push(e,"24ea8yUt95NcZW6WHF+8WHl","Enemy4001");var i=t,o=e,n=a;cc._RF.push(o,"dad06Q4sj9EH7SYEj7UPBvn","Enemy4001"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("GameEnum"),c=i("HomeEnum"),l=i("BattleDataProxy"),u=i("EnemyBase"),p=cc._decorator,h=p.ccclass,d=p.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mEarthSoilEffectPb=null,e._isMoveUp=!1,e._isUnderground=!0,e._isMove=!1,e}return __extends(e,t),e.prototype.onLoad=function(){var t=this;this.mIsSpAni&&(this.mAnimSp.setCompleteListener(function(e){var a=e.animation?e.animation.name:"";a.indexOf("die")>=0?(t.node.destroy(),t.node.removeFromParent()):a.indexOf("atk")>=0?t.playMove():"stop"==a&&(t._isUnderground=!1,t._isMove?t.playMove():t.playAtk())}),this.mAnimSp.setEventListener(function(){r.AudioManager.instance.playEffectPath("sounds/enemyAtk",c.Bundles.RES),l.battleDataProxy.updateHouseHp({isCirt:!1,num:-t._atkNum})}))},e.prototype.playMove=function(t){void 0===t&&(t=5),this._amimState!=s.RoleState.Dead&&this._isAnimReady&&(this._amimState=s.RoleState.Move,this._isUnderground?this.mAnimSp.setAnimation(0,"move_zuandi",!0):this.mAnimSp.setAnimation(0,"move",!0),this.mAnimSp.timeScale=t/5)},e.prototype.addRushEffect=function(){},e.prototype.loadAnimation=function(){this._isAnimReady=!0,this.playMove(10)},e.prototype.beAttack=function(e,a,i,o){return!this._isUnderground&&t.prototype.beAttack.call(this,e,a,i,o)},e.prototype.getIsCanChoose=function(t){return 106==t||!this._isUnderground},e.prototype.moveToHouse=function(){this.playStop(!1)},e.prototype.playAtk=function(){this._amimState!=s.RoleState.Dead&&this._isAnimReady&&(this._atkSpd=this.monsterCfg.atkSpeed,this._amimState=s.RoleState.Attack,this._canAtk=!1,this._isStartAtk=!0,this.mAnimSp.setAnimation(0,"atk",!1))},e.prototype.move=function(e){t.prototype.move.call(this,e),this._isUnderground||this._target||this._canAtk&&this.playAtk()},e.prototype.getMoveSpd=function(e){var a=t.prototype.getMoveSpd.call(this,e,1/60);return this._isUnderground&&(a*=1.5),a},e.prototype.beResist=function(){this.playStop(!0)},e.prototype.playStop=function(t){this._isMoveUp||(this._isMoveUp=!0,this._isMove=t,this.mAnimSp.setAnimation(0,"stop",!1))},e.prototype.playStand=function(){this._amimState!=s.RoleState.Dead&&this._isAnimReady&&(this._amimState=s.RoleState.Move,this._isAtkFinish=!0,this.mAnimSp.setAnimation(0,"move",!0))},__decorate([d(cc.Prefab)],e.prototype,"mEarthSoilEffectPb",void 0),__decorate([h],e)}(u.default);n.default=m,cc._RF.pop(),cc._RF.pop()},{}],Enemy4002:[function(t,e,a){"use strict";cc._RF.push(e,"571c4tuc9dMsLNMVLqcRoLC","Enemy4002");var i=t,o=e,n=a;cc._RF.push(o,"be87d+oDf5GMLyv1HehcZSc","Enemy4002"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("GameEnum"),c=i("HomeEnum"),l=i("BattleDataProxy"),u=i("EnemyBase"),p=cc._decorator,h=p.ccclass,d=(p.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._isCloaking=!1,e._isChangeState=!1,e._stateCd=5,e._isDye=!1,e}return __extends(e,t),e.prototype.playMove=function(t){void 0===t&&(t=5),this._amimState!=s.RoleState.Dead&&this._isAnimReady&&(this._amimState=s.RoleState.Move,this._isDye?this.mAnimSp.setAnimation(0,"move_ranse",!0):this._isCloaking?this.mAnimSp.setAnimation(0,"move_xuhua",!0):this.mAnimSp.setAnimation(0,"move_shiti",!0),this.mAnimSp.timeScale=t/5)},e.prototype.onLoad=function(){var t=this;this.mIsSpAni&&this.mAnimSp.setCompleteListener(function(e){var a=e.animation?e.animation.name:"";a.indexOf("die")>=0?(t.node.destroy(),t.node.removeFromParent()):a.indexOf("atk")>=0?t.playMove():"move_xianxing"==a?t._isDye||(t._isCloaking=!1,t._isChangeState=!1,t.playMove()):"move_yinshen"==a&&(t._isDye||(t._isCloaking=!0,t._isChangeState=!1,t.playMove()))}),this.mAnimSp.setEventListener(function(){r.AudioManager.instance.playEffectPath("sounds/enemyAtk",c.Bundles.RES),l.battleDataProxy.updateHouseHp({isCirt:!1,num:-t._atkNum})})},e.prototype.loadAnimation=function(){this._isAnimReady=!0,this.playMove(10),r.AudioManager.instance.playEffectPath("sounds/enemy4002",c.Bundles.RES)},e.prototype.getIsCanChoose=function(t){return 104==t||!this._isCloaking},e.prototype.beAttack=function(e,a,i,o){if(this._isCloaking){if(104!=a)return!1;this._isDye=!0,this._isCloaking=!1,this.playMove()}return 104==a&&(this._isDye=!0,this._isCloaking=!1,this.playMove()),t.prototype.beAttack.call(this,e,a,i,o)},e.prototype.moveToHouse=function(){this.playAtk()},e.prototype.getMoveSpd=function(e,a){var i=t.prototype.getMoveSpd.call(this,e,a);return this._isCloaking&&(i*=1.5),i},e.prototype.playAtk=function(){if(this._amimState!=s.RoleState.Dead&&this._isAnimReady){this._atkSpd=this.monsterCfg.atkSpeed,this._amimState=s.RoleState.Attack,this._canAtk=!1,this._isStartAtk=!0;var t="atk";this._isDye?t="atk_ranse":this._isCloaking&&(t="atk_yinshen"),this.mAnimSp.setAnimation(0,t,!1)}},e.prototype.playShow=function(){this._amimState!=s.RoleState.Dead&&this._isAnimReady&&this.mAnimSp.setAnimation(0,"move_xianxing",!1)},e.prototype.playHide=function(){this._amimState!=s.RoleState.Dead&&this._isAnimReady&&this.mAnimSp.setAnimation(0,"move_yinshen",!1)},e.prototype.playDieAnim=function(){this.mAnimSp.paused=!1,this._isDye?this.mAnimSp.setAnimation(0,"die_ranse",!1):this.mAnimSp.setAnimation(0,"die",!1)},e.prototype.update=function(e){l.battleDataProxy.gameState==s.GameState.PLAYING&&this._amimState!=s.RoleState.Dead&&this._isAnimReady&&(this._isChangeState||t.prototype.update.call(this,e),this._isSpdAdd||this._amimState!=s.RoleState.Attack&&(this._isDye||(this._stateCd-=e,this._stateCd<=0&&(this._stateCd=5,this._isChangeState=!0,this._isCloaking?this.playShow():this.playHide())),this._isChangeState||this._target||this._canAtk&&this.playAtk()))},__decorate([h],e)}(u.default));n.default=d,cc._RF.pop(),cc._RF.pop()},{}],Enemy4003:[function(t,e,a){"use strict";cc._RF.push(e,"7815e6BGiJLVbykIL4sNUqK","Enemy4003");var i=t,o=e,n=a;cc._RF.push(o,"9a962q8jH9F7rRVOx/IV8Ib","Enemy4003"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("GameEnum"),c=i("HomeEnum"),l=i("BattleDataProxy"),u=i("EnemyBase"),p=cc._decorator,h=p.ccclass,d=(p.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._isOnHorse=!0,e._isChangeState=!1,e}return __extends(e,t),e.prototype.playMove=function(t){void 0===t&&(t=5),this._amimState!=s.RoleState.Dead&&this._isAnimReady&&(this._amimState=s.RoleState.Move,this._isOnHorse?this.mAnimSp.setAnimation(0,"move_tiaotiao",!0):this.mAnimSp.setAnimation(0,"move",!0),this.mAnimSp.timeScale=t/5)},e.prototype.onLoad=function(){var t=this;this.mIsSpAni&&this.mAnimSp.setCompleteListener(function(e){var a=e.animation?e.animation.name:"";a.indexOf("die")>=0?(t.node.destroy(),t.node.removeFromParent()):a.indexOf("atk")>=0?t.playMove():"hit"==a&&(t._isOnHorse=!1,t._isChangeState=!1,t.playMove())}),this.mAnimSp.setEventListener(function(){r.AudioManager.instance.playEffectPath("sounds/enemyAtk",c.Bundles.RES),l.battleDataProxy.updateHouseHp({isCirt:!1,num:-t._atkNum})})},e.prototype.beAttack=function(e,a,i,o){return this._isOnHorse&&105==a&&(this._isChangeState||(this._isChangeState=!0,this.playVehiclesDestroy())),t.prototype.beAttack.call(this,e,a,i,o)},e.prototype.playVehiclesDestroy=function(){this.mAnimSp.setAnimation(0,"hit",!1)},e.prototype.loadAnimation=function(){this._isAnimReady=!0,this.playMove(10),r.AudioManager.instance.playEffectPath("sounds/enemy4003",c.Bundles.RES)},e.prototype.getMoveSpd=function(e,a){var i=t.prototype.getMoveSpd.call(this,e,a);return this._isOnHorse||(i*=.25),i},e.prototype.moveToHouse=function(){this.playAtk()},e.prototype.playAtk=function(){if(this._amimState!=s.RoleState.Dead&&this._isAnimReady){this._atkSpd=this.monsterCfg.atkSpeed,this._amimState=s.RoleState.Attack,this._canAtk=!1,this._isStartAtk=!0;var t="atk";this._isOnHorse&&(t="atk_tiaotiao"),this.mAnimSp.setAnimation(0,t,!1)}},e.prototype.updateHpProgressPos=function(){if(this._isOnHorse){if(!this._hpProgress)return;this._hpProgress.position=this.node.position.clone().add(cc.v3(0,this.node.height*this.node.scale+50))}else t.prototype.updateHpProgressPos.call(this)},e.prototype.update=function(e){this._isChangeState||(t.prototype.update.call(this,e),this._isChangeState||this._target||this._canAtk&&this.playAtk())},__decorate([h],e)}(u.default));n.default=d,cc._RF.pop(),cc._RF.pop()},{}],Enemy4004:[function(t,e,a){"use strict";cc._RF.push(e,"8d3e9HyO2JOI4/Rq4eZqNMP","Enemy4004");var i=t,o=e,n=a;cc._RF.push(o,"5d4e70k7nNB3a7lgYbiQ/xw","Enemy4004"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("GameEnum"),c=i("HomeEnum"),l=i("BattleDataProxy"),u=i("EquipmentItem"),p=i("EnemyBase"),h=i("EnemyCrucifix"),d=cc._decorator,m=d.ccclass,f=d.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mCrucifix=null,e._isChangeState=!1,e._reviveNum=0,e._isHaveCrucifix=!0,e._isCheckMagnet=!1,e._checkMagnetTime=0,e}return __extends(e,t),e.prototype.playMove=function(t){void 0===t&&(t=5),this._amimState!=s.RoleState.Dead&&this._isAnimReady&&(this._amimState=s.RoleState.Move,!this._isHaveCrucifix&&this._reviveNum>0?this.mAnimSp.setAnimation(0,"meiwuqi_move",!0):this._reviveNum>=1?this.mAnimSp.setAnimation(0,"move",!0):this.mAnimSp.setAnimation(0,"fuhuo_move",!0),this.mAnimSp.timeScale=t/5)},e.prototype.playAttract=function(){this.mAnimSp.setAnimation(0,"move_xi",!1),this._isCheckMagnet=!1},e.prototype.onLoad=function(){var t=this;this._reviveNum=2,this.mIsSpAni&&this.mAnimSp.setCompleteListener(function(e){var a,i=e.animation?e.animation.name:"";if("die"==i)2==t._reviveNum?t.mAnimSp.setAnimation(0,"fuhuozhong1",!1):1==t._reviveNum&&t.mAnimSp.setAnimation(0,"fuhuozhong2",!1),t._reviveNum--;else if(i.indexOf("atk")>=0)t.playMove();else if("fuhuo_die"==i||"meiwuqi_die"==i)t.node.destroy(),t.node.removeFromParent();else if("fuhuozhong2"==i)t.mAnimSp.setAnimation(0,"fuhuo2",!1);else if("fuhuo2"==i||"fuhuo1"==i){if("fuhuo2"==i){t._isHaveCrucifix=!1;var o=l.battleDataProxy.priestZombie.indexOf(t.node);o>=0&&l.battleDataProxy.priestZombie.splice(o,1)}t._isChangeState=!1,t._nowHp=t._maxHp,t.updateHp(),t.playMove()}else"fuhuozhong1"==i?t.mAnimSp.setAnimation(0,"fuhuo1",!1):"move_xi"==i?(t._isAtkFinish=!1,t._amimState=s.RoleState.Breath,t.mAnimSp.setAnimation(0,"xizou",!1),t._isHaveCrucifix=!1,t.mCrucifix.active=!0,null===(a=t.mCrucifix.getComponent(h.default))||void 0===a||a.attractCrucifix(t.node)):"xizou"==i&&(t._isAtkFinish=!0,t.playMove())}),this.mAnimSp.setEventListener(function(){r.AudioManager.instance.playEffectPath("sounds/enemyAtk",c.Bundles.RES),l.battleDataProxy.updateHouseHp({isCirt:!1,num:-t._atkNum})})},e.prototype.removeRushEffect=function(){t.prototype.removeRushEffect.call(this),l.battleDataProxy.priestZombie.push(this.node),this._isCheckMagnet=!0},e.prototype.loadAnimation=function(){this._isAnimReady=!0,this.playMove(10),r.AudioManager.instance.playEffectPath("sounds/enemy4004",c.Bundles.RES)},e.prototype.beAttack=function(e,a,i,o){return!!this._isChangeState||t.prototype.beAttack.call(this,e,a,i,o)},e.prototype.getIsCanChoose=function(){return!this._isChangeState},e.prototype.moveToHouse=function(){this.playAtk()},e.prototype.playAtk=function(){if(this._amimState!=s.RoleState.Dead&&this._isAnimReady){this._atkSpd=this.monsterCfg.atkSpeed,this._amimState=s.RoleState.Attack,this._canAtk=!1,this._isStartAtk=!0;var t="atk";!this._isHaveCrucifix&&this._reviveNum>0?t="meiwuqi_atk":this._reviveNum<1&&(t="fuhuo_atk"),this.mAnimSp.setAnimation(0,t,!1)}},e.prototype.playDie=function(e,a){void 0===e&&(e=!0),void 0===a&&(a=!1),this._amimState!=s.RoleState.Dead&&this._isAnimReady&&((this._isHaveCrucifix||this._reviveNum>0)&&(a=!1),console.log("\u6709\u6ca1\u6709\u5341\u5b57\u67b6\uff1a",this._isHaveCrucifix),!this._isHaveCrucifix||a?t.prototype.playDie.call(this,e,a):(this._isChangeState=!0,this._hpProgress.active=!1,this.mAnimSp.setAnimation(0,"die",!1)))},e.prototype.playDieAnim=function(){this.mAnimSp.paused=!1,!this._isHaveCrucifix&&this._reviveNum>0?this.mAnimSp.setAnimation(0,"meiwuqi_die",!1):this.mAnimSp.setAnimation(0,"fuhuo_die",!1);var t=l.battleDataProxy.priestZombie.indexOf(this.node);t>=0&&l.battleDataProxy.priestZombie.splice(t,1)},e.prototype.getMoveSpd=function(e,a){var i=t.prototype.getMoveSpd.call(this,e,a);return 0==this._reviveNum&&(i*=2),i},e.prototype.update=function(e){var a,i;if(l.battleDataProxy.gameState==s.GameState.PLAYING&&this._amimState!=s.RoleState.Dead&&!this._isChangeState&&(t.prototype.update.call(this,e),this._isChangeState||this._target||this._canAtk&&this.playAtk(),this._isCheckMagnet&&(this._checkMagnetTime+=e,this._checkMagnetTime>=1))){this._checkMagnetTime=0;var o=null===(a=l.battleDataProxy.equipRoot)||void 0===a?void 0:a.children,n=null==o?void 0:o.findIndex(function(t){var e;return 101==(null===(e=t.getComponent(u.default))||void 0===e?void 0:e.equipId)});if(n>=0){var r=o[n];if(!r||!r.isValid)return;(null===(i=r.getComponent(u.default))||void 0===i?void 0:i.isPurchased)&&this.playAttract()}}},__decorate([f(cc.Node)],e.prototype,"mCrucifix",void 0),__decorate([m],e)}(p.default);n.default=_,cc._RF.pop(),cc._RF.pop()},{}],Enemy4005:[function(t,e,a){"use strict";cc._RF.push(e,"6f21eTecXNH27V8aseL9g3l","Enemy4005");var i=t,o=e,n=a;cc._RF.push(o,"b941cF2f71Moq98S8aUHaqM","Enemy4005"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("GameEnum"),s=i("Enemy4006"),c=i("EnemyBase"),l=cc._decorator,u=l.ccclass,p=(l.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._moveAniIdx=0,e._changeMoveAniTime=0,e._boyNodes=[],e}return __extends(e,t),e.prototype.playMove=function(t){if(void 0===t&&(t=5),this._amimState!=r.RoleState.Dead&&this._isAnimReady){this._amimState=r.RoleState.Move,this._moveAniIdx++,this._moveAniIdx%2==0?this.mAnimCtrl.playAnim("move",!0,null,null,3):this.mAnimCtrl.playAnim("move2",!0,null,null,3);for(var e=0;e<this._boyNodes.length;++e)this._boyNodes[e].getComponent(s.default).playFollowMove(this._moveAniIdx)}},e.prototype.pushBoyNode=function(t){this._boyNodes.push(t),t.getComponent(s.default).playFollowMove(this._moveAniIdx)},e.prototype.playDie=function(e,a){t.prototype.playDie.call(this,e,a);for(var i=0;i<this._boyNodes.length;++i){var o=this._boyNodes[i];o&&o.isValid&&o.getComponent(s.default).playDie()}},e.prototype.update=function(e){t.prototype.update.call(this,e),this.getIsDie()||this._amimState==r.RoleState.Attack||(this._changeMoveAniTime+=e,this._changeMoveAniTime>=2&&(this._changeMoveAniTime=0,this.playMove()))},e.prototype.boyEnemyDie=function(t){var e=this._boyNodes.indexOf(t);e>=0&&this._boyNodes.splice(e,1)},__decorate([u],e)}(c.default));n.default=p,cc._RF.pop(),cc._RF.pop()},{}],Enemy4006:[function(t,e,a){"use strict";cc._RF.push(e,"31114gr86tMJJl/Z8cOcrdW","Enemy4006");var i=t,o=e,n=a;cc._RF.push(o,"de8c7uAFh5GcaP8LXjdFtI4","Enemy4006"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("MathUtil"),s=i("GameEnum"),c=i("Enemy4005"),l=i("EnemyBase"),u=cc._decorator,p=u.ccclass,h=(u.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._followNode=null,e._idx=0,e._baseRadian=0,e}return __extends(e,t),e.prototype.playMove=function(t){void 0===t&&(t=5)},e.prototype.setFollowData=function(t,e){this._followNode=t,this._idx=e;var a=60*e;this._baseRadian=r.MathUtil.getRadian(a);var i=this._followNode.x+70*Math.cos(this._baseRadian),o=this._followNode.y+70*Math.sin(this._baseRadian);this.node.position=cc.v3(i,o),this.node.zIndex=-this.node.y},e.prototype.playFollowMove=function(t){this._amimState!=s.RoleState.Dead&&this._isAnimReady&&(this._amimState=s.RoleState.Move,t%2==0?this.mAnimCtrl.playAnim("move",!0,null,null,3):this.mAnimCtrl.playAnim("move2",!0,null,null,3))},e.prototype.addRushEffect=function(){},e.prototype.addHpProgress=function(){},e.prototype.move=function(){var t=this._followNode.x+70*Math.cos(this._baseRadian),e=this._followNode.y+70*Math.sin(this._baseRadian),a=cc.v3(t,e);this.node.position=a,this.node.zIndex=-this.node.y;var i=this._followNode.getComponent(l.default).mAnimCtrl.node.scaleX;this.mAnimCtrl.node.scaleX=i},e.prototype.beAttack=function(e,a,i,o){101==a&&(e.num=this._maxHp,o=!1);var n=t.prototype.beAttack.call(this,e,a,i,o);return n&&this._followNode.getComponent(c.default).boyEnemyDie(this.node),n},__decorate([p],e)}(l.default));n.default=h,cc._RF.pop(),cc._RF.pop()},{}],Enemy4007:[function(t,e,a){"use strict";cc._RF.push(e,"05826FBSDVNGbtSTmokyzuc","Enemy4007");var i=t,o=e,n=a;cc._RF.push(o,"8aa94kHjKpGBJl6rxGByh+I","Enemy4007"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("MathUtil"),c=i("GameEnum"),l=i("HomeEnum"),u=i("BattleDataProxy"),p=i("EnemyBase"),h=cc._decorator,d=h.ccclass,m=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._isIgnite=!1,e._isPlayAtk=!1,e}return __extends(e,t),e.prototype.playMove=function(t){void 0===t&&(t=5),this._amimState!=c.RoleState.Dead&&this._isAnimReady&&(this._amimState=c.RoleState.Move,this._isIgnite?this.mAnimSp.setAnimation(0,"move_yinran",!1):this.mAnimSp.setAnimation(0,"move",!0),this.mAnimSp.timeScale=t/5)},e.prototype.onLoad=function(){var t=this;this.mIsSpAni&&this.mAnimSp.setCompleteListener(function(e){var a=e.animation?e.animation.name:"";"die"==a||"die2"==a?(u.battleDataProxy.removeEnemyNode(t.node),t.node.destroy(),t.node.removeFromParent()):"move_yinran"==a?t.mAnimSp.setAnimation(0,"boom1",!1):"boom1"==a||"boom2"==a?(u.battleDataProxy.removeEnemyNode(t.node),t.node.destroy(),t.node.removeFromParent()):"atk"==a&&t.mAnimSp.setAnimation(0,"boom2",!1)}),this.mAnimSp.setEventListener(function(){if(t._isPlayAtk)u.battleDataProxy.updateHouseHp({isCirt:!1,num:-t._atkNum});else for(var e=u.battleDataProxy.enemyNodes.slice(),a=0;a<e.length;++a){var i=e[a];if(i&&i.isValid&&i!=t.node&&s.MathUtil.distance(i.position,t.node.position)<=150){var o={isCrit:!1,num:Math.ceil(t._atkNum)};i.getComponent(p.default).beAttack(o,0,!0,!0)}}})},e.prototype.loadAnimation=function(){this._isAnimReady=!0,this.playMove(10),r.AudioManager.instance.playEffectPath("sounds/enemy4007",l.Bundles.RES)},e.prototype.beAttack=function(e,a,i,o){var n=t.prototype.beAttack.call(this,e,a,i,o);return n||103!=a||this._isIgnite||(this._isIgnite=!0,this.playMove()),n},e.prototype.getIsCanChoose=function(){return!0},e.prototype.moveToHouse=function(){this.playAtk()},e.prototype.playAtk=function(){this._amimState!=c.RoleState.Dead&&this._isAnimReady&&(this._atkSpd=this.monsterCfg.atkSpeed,this._amimState=c.RoleState.Attack,this._canAtk=!1,this._isStartAtk=!0,this._isPlayAtk=!0,this.mAnimSp.setAnimation(0,"atk",!1))},e.prototype.playDie=function(e,a){void 0===e&&(e=!0),void 0===a&&(a=!1),this._amimState!=c.RoleState.Dead&&this._isAnimReady&&(a?t.prototype.playDie.call(this,e,a):(this._amimState=c.RoleState.Dead,this.mAnimSp.paused=!1,this._hpProgress.active=!1,this._isPlayAtk?this.mAnimSp.setAnimation(0,"die2",!1):this.mAnimSp.setAnimation(0,"die",!1)))},__decorate([d],e)}(p.default));n.default=m,cc._RF.pop(),cc._RF.pop()},{}],Enemy4008:[function(t,e,a){"use strict";cc._RF.push(e,"405cd5m5o1Ml7DlenQkqOB7","Enemy4008");var i=t,o=e,n=a;cc._RF.push(o,"813f1mBLRhBv5PC1kB8QSZD","Enemy4008"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("EventManager"),c=i("MathUtil"),l=i("GameEnum"),u=i("HomeEnum"),p=i("BattleDataProxy"),h=i("Util"),d=i("SkillDataMgr"),m=i("Enemy4009"),f=i("EnemyBase"),_=cc._decorator,y=_.ccclass,g=_.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mSoldierPb=null,e._isDischarge=!1,e._isDischargeFinish=!1,e._soldierNodes=[],e._soldierIdx=0,e._landingTime=0,e._targetPos=cc.v3(-268,-300),e}return __extends(e,t),e.prototype.playMove=function(t){void 0===t&&(t=5),this._amimState!=l.RoleState.Dead&&this._isAnimReady&&(this._amimState=l.RoleState.Move,this._isDischarge?this.mAnimSp.setAnimation(0,"move2",!0):this.mAnimSp.setAnimation(0,"move",!0),this.mAnimSp.timeScale=t/5)},e.prototype.onLoad=function(){var t=this;this.mIsSpAni&&this.mAnimSp.setCompleteListener(function(e){"die"==(e.animation?e.animation.name:"")&&(t.node.destroy(),t.node.removeFromParent())});var e=this.node.getChildByName("shadow"),a=cc.tween(e).to(.3,{scale:.9}).to(.3,{scale:1});cc.tween(e).repeatForever(a).start()},e.prototype.addRushEffect=function(){},e.prototype.loadAnimation=function(){this._isAnimReady=!0,this.playMove(10),p.battleDataProxy.enemyAirship.push(this.node),r.AudioManager.instance.playEffectPath("sounds/enemy4008",u.Bundles.RES)},e.prototype.beAttack=function(e,a,i,o){return t.prototype.beAttack.call(this,e,a,i,o)},e.prototype.getIsCanChoose=function(t){return 103==t},e.prototype.playDie=function(t,e){if(void 0===t&&(t=!0),void 0===e&&(e=!1),this._amimState!=l.RoleState.Dead&&this._isAnimReady){if(this._amimState=l.RoleState.Dead,t){var a=this._monsterCfg.exp,i=d.default.instance.getSkillProperty(37,0);a=Math.floor(a*(1+i)),s.EventManager.instance.emit(p.EBattleEvent.UPDATE_EXP,a)}this.removeHpProgress(),this.mAnimSp.paused=!1,this.mAnimSp.setAnimation(0,"die",!1),p.battleDataProxy.removeEnemyNode(this.node);var o=p.battleDataProxy.enemyAirship.indexOf(this.node);if(o>=0&&p.battleDataProxy.enemyAirship.splice(o,1),this._soldierNodes.length>0){for(var n=0;n<this._soldierNodes.length;++n){var r=this._soldierNodes[n];r.destroy(),r.removeFromParent()}this._soldierNodes=[]}}},e.prototype.playDieAnim=function(){},e.prototype.move=function(t){if(this.node&&this.node.isValid){var e=this.getMoveSpd(this._isSpdAdd,t);if(this._amimState!=l.RoleState.Dead&&this._amimState!=l.RoleState.Attack&&this._amimState!=l.RoleState.BeBack)if(c.MathUtil.distance(this._targetPos.clone(),this.node.position)<=e){if(this._isDischargeFinish)return this.node.destroy(),this.node.removeFromParent(),void console.log("\u5220\u6389\u98de\u8247");if(!this._isDischarge){this.mAnimSp.setAnimation(0,"stand",!0);for(var a=0;a<5;++a){var i=cc.instantiate(this.mSoldierPb);p.battleDataProxy.battleView.addChild(i),this._soldierNodes.push(i),i.getComponent(f.default).initEnemy(4009);var o=h.default.convertToTargetNodeSpace(this.node.getChildByName("enemy"+(a+1)),this.node);i.position=o}this._isDischarge=!0}}else{var n=this.node.position.clone().sub(this._targetPos.clone()).normalize();this.node.x-=e*n.x,this.node.y-=e*n.y,this.node.zIndex=-this.node.y}}},e.prototype.update=function(e){if(p.battleDataProxy.gameState==l.GameState.PLAYING&&this._amimState!=l.RoleState.Dead&&(t.prototype.update.call(this,e),!this._isDischargeFinish&&this._soldierNodes.length>0&&this._isDischarge&&(this._landingTime-=e,this._landingTime<=0))){this._landingTime=.3;var a=this._soldierNodes[0];if(a&&a.isValid){a.getComponent(m.default).playLanding(this._soldierIdx),a.zIndex=this.node.zIndex+1,this._soldierNodes.splice(0,1),p.battleDataProxy.airshipSoldier.push(a),p.battleDataProxy.enemyNodes.push(a);var i=p.battleDataProxy.waveEnemyNum;if(i++,p.battleDataProxy.waveEnemyNum=i,this._soldierIdx++,this._soldierIdx>=5){this._isDischargeFinish=!0,p.battleDataProxy.removeEnemyNode(this.node),this._targetPos=cc.v3(this.node.x-cc.winSize.width/2,this.node.y);var o=p.battleDataProxy.enemyAirship.indexOf(this.node);o>=0&&p.battleDataProxy.enemyAirship.splice(o,1)}}}},__decorate([g(cc.Prefab)],e.prototype,"mSoldierPb",void 0),__decorate([y],e)}(f.default);n.default=v,cc._RF.pop(),cc._RF.pop()},{}],Enemy4009:[function(t,e,a){"use strict";cc._RF.push(e,"516a7F4QytNVI9j0zqIRSZZ","Enemy4009");var i=t,o=e,n=a;cc._RF.push(o,"ecf6d2Fm2pMeIONiVNHLHWe","Enemy4009"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("MathUtil"),c=i("GameEnum"),l=i("HomeEnum"),u=i("BattleDataProxy"),p=i("EnemyBase"),h=cc._decorator,d=h.ccclass,m=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._isLanding=!1,e._targetPos=null,e}return __extends(e,t),e.prototype.playMove=function(t){void 0===t&&(t=5),this._amimState!=c.RoleState.Dead&&this._isAnimReady&&(this._amimState=c.RoleState.Move,this.mAnimSp.setAnimation(0,"move",!0),this.mAnimSp.timeScale=t/5)},e.prototype.onLoad=function(){var t=this;this.mIsSpAni&&this.mAnimSp.setCompleteListener(function(e){var a=e.animation?e.animation.name:"";"jiangluo"==a?(t.playMove(),t._isLanding=!0):a.indexOf("atk")>=0?t.playMove():"die"==a&&(t.node.destroy(),t.node.removeFromParent())}),this.mAnimSp.setEventListener(function(e,a){"atk"==a.data.name&&(r.AudioManager.instance.playEffectPath("sounds/enemyAtk",l.Bundles.RES),u.battleDataProxy.updateHouseHp({isCirt:!1,num:-t._atkNum}))})},e.prototype.loadAnimation=function(){this._isAnimReady=!0,this.playMove(10)},e.prototype.beAttack=function(e,a,i,o){return!!this._isLanding&&t.prototype.beAttack.call(this,e,a,i,o)},e.prototype.getIsCanChoose=function(){return this._isLanding},e.prototype.addRushEffect=function(){},e.prototype.moveToHouse=function(){this.playAtk()},e.prototype.playLanding=function(){var t=this;this._amimState=c.RoleState.Breath,this.mAnimSp.setAnimation(0,"jiangluo",!1);var e=cc.v3(this.node.x,this.node.y-140);cc.tween(this.node).to(10/30,{position:e}).call(function(){t._targetPos=cc.v3(u.battleDataProxy.house.x-100,t.node.y)}).start()},e.prototype.playAtk=function(){this._amimState!=c.RoleState.Dead&&this._isAnimReady&&(this._atkSpd=this.monsterCfg.atkSpeed,this._amimState=c.RoleState.Attack,this._isStartAtk=!0,this._canAtk=!1,this.mAnimSp.setAnimation(0,"atk",!1))},e.prototype.playDieAnim=function(){this.mAnimSp.setAnimation(0,"die",!1);var t=u.battleDataProxy.airshipSoldier.indexOf(this.node);t>=0&&u.battleDataProxy.airshipSoldier.splice(t,1)},e.prototype.update=function(e){u.battleDataProxy.gameState==c.GameState.PLAYING&&this._amimState!=c.RoleState.Dead&&t.prototype.update.call(this,e)},e.prototype.move=function(t){if(this.node&&this.node.isValid&&this._isLanding&&this._targetPos){var e=this.getMoveSpd(this._isSpdAdd,t);if(this._amimState!=c.RoleState.Dead&&this._amimState!=c.RoleState.Attack&&this._amimState!=c.RoleState.BeBack)if(s.MathUtil.distance(this._targetPos.clone(),this.node.position)<=e)this._canAtk&&(this._canAtk=!1,this._atkSpd=this.monsterCfg.atkSpeed,this.mAnimSp.setAnimation(0,"atk",!1));else{var a=this.node.position.clone().sub(this._targetPos.clone()).normalize();this.node.x-=e*a.x,this.node.y-=e*a.y;var i=Math.abs(this.mAnimSp.node.scale);this.mAnimSp.node.scaleX=a.x<=0?i:-i,this.node.zIndex=-this.node.y}}},e.prototype.getMovePosByTime=function(t){var e=Math.floor(30*t);if(this._isStartAtk)return cc.v3(this._simulationPos.x,this._simulationPos.y+this.node.height);if(!this._targetPos)return this.node.position;for(var a=0;a<e;++a){var i=2*this.getMoveSpd(this._simulationIsSpdAdd,1/60),o=s.MathUtil.distance(this._targetPos,this._simulationPos),n=this.node.position.clone().sub(this._targetPos.clone()).normalize();if(this._simulationPos.x-=i*n.x,this._simulationPos.y-=i*n.y,o<=i)break}return cc.v3(this._simulationPos.x,this._simulationPos.y+this.node.height)},__decorate([d],e)}(p.default));n.default=m,cc._RF.pop(),cc._RF.pop()},{}],Enemy4010:[function(t,e,a){"use strict";cc._RF.push(e,"8e9b3HX8+9Lh5gl2ZD9v+07","Enemy4010");var i=t,o=e,n=a;cc._RF.push(o,"d15cchxx6BK1a/7xe2eu337","Enemy4010"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("MathUtil"),c=i("GameEnum"),l=i("HomeEnum"),u=i("BattleDataProxy"),p=i("EnemyBase"),h=i("EnemyPathIce"),d=cc._decorator,m=d.ccclass,f=d.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mEnemyPathIcePb=null,e._pathNodes=[],e._icePathIdx=0,e}return __extends(e,t),e.prototype.playMove=function(t){void 0===t&&(t=5),this._amimState!=c.RoleState.Dead&&this._isAnimReady&&(this._amimState=c.RoleState.Move,this.mAnimSp.setAnimation(0,"move",!0),this.mAnimSp.timeScale=t/5)},e.prototype.onLoad=function(){var t=this;this.mIsSpAni&&this.mAnimSp.setCompleteListener(function(e){var a=e.animation?e.animation.name:"";a.indexOf("atk")>=0?t.playMove():"die"==a&&(t.node.destroy(),t.node.removeFromParent())}),this.mAnimSp.setEventListener(function(e,a){"atk"==a.data.name&&(r.AudioManager.instance.playEffectPath("sounds/enemyAtk",l.Bundles.RES),u.battleDataProxy.updateHouseHp({isCirt:!1,num:-t._atkNum}))}),this._pathNodes=u.battleDataProxy.pathPointView.children},e.prototype.loadAnimation=function(){this._isAnimReady=!0,this.playMove(10),r.AudioManager.instance.playEffectPath("sounds/enemy4010",l.Bundles.RES)},e.prototype.getIsCanChoose=function(){return!0},e.prototype.moveToHouse=function(){this.playAtk()},e.prototype.playAtk=function(){this._amimState!=c.RoleState.Dead&&this._isAnimReady&&(this._atkSpd=this.monsterCfg.atkSpeed,this._amimState=c.RoleState.Attack,this._canAtk=!1,this._isStartAtk=!0,this.mAnimSp.setAnimation(0,"atk",!1))},e.prototype.update=function(e){if(u.battleDataProxy.gameState==c.GameState.PLAYING&&this._amimState!=c.RoleState.Dead&&this._isAnimReady&&(t.prototype.update.call(this,e),this._amimState!=c.RoleState.Attack))if(this._target&&this._target.isValid){var a=3;u.battleDataProxy.isEndless&&(a=2),this._enemyPathIdx==a&&s.MathUtil.distance(this._target.position,this.node.position)<=this.monsterCfg.range&&this._canAtk&&(this._target=null,this.playAtk())}else this._canAtk&&this.playAtk()},e.prototype.move=function(e){t.prototype.move.call(this,e);var a=this._pathNodes[this._icePathIdx];if(a&&a.isValid&&(this._icePathIdx>=5&&this._icePathIdx<=13?Math.abs(a.y-this.node.y):Math.abs(a.x-this.node.x))<=this.getMoveSpd(this._isSpdAdd,e)){var i=this._icePathIdx;if(this._icePathIdx++,this._beFireNum>0)return;var o=a.PathIce;if(o&&o.isValid)return;var n=cc.instantiate(this.mEnemyPathIcePb);u.battleDataProxy.iceView.addChild(n),n.position=a.position,a.PathIce=n,u.battleDataProxy.enemyPathIce.push(n),n.getComponent(h.default).initEnemyPathIce(a,i)}},__decorate([f(cc.Prefab)],e.prototype,"mEnemyPathIcePb",void 0),__decorate([m],e)}(p.default);n.default=_,cc._RF.pop(),cc._RF.pop()},{}],EnemyBase:[function(t,e,a){"use strict";cc._RF.push(e,"13d2c8nEllDFq7nDrjLNA/x","EnemyBase");var i=t,o=e,n=a;cc._RF.push(o,"6a101GAjG9HeJe9XsJYYY4H","EnemyBase"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("ComponentBase"),c=i("EventManager"),l=i("MathUtil"),u=i("ResUtil"),p=i("SimplyRectCollider"),h=i("SimplyCollisionDetector"),d=i("AnimationCfgMgr"),m=i("AnimationCtrl"),f=i("ShimmerWhite"),_=i("GameEnum"),y=i("HomeEnum"),g=i("DataManager"),v=i("NodePoolManager"),P=i("BattleDataProxy"),b=i("UserDataProxy"),D=i("Util"),S=i("SkillDataMgr"),C=i("EnemyBulletBase"),E=i("DizzinessEffect"),B=i("IceEffect"),A=i("RushEffect"),x=i("WeatherHeavyFog"),M=i("EnemyBoomDie"),N=cc._decorator,R=N.ccclass,T=N.property,I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mBody=null,e.mIsSpAni=!1,e.mAnimCtrl=null,e.mAnimSp=null,e.mIsShoot=!0,e.mEnemyBulletPb=null,e._isAnimReady=!1,e.mMonsterId=0,e._target=null,e._amimState=_.RoleState.Default,e._monsterCfg=null,e._enemyPathIdx=0,e._maxHp=0,e._nowHp=0,e._enemyMovePaths=[],e._pathIdx=0,e._moveDis=0,e._dizzinessTime=0,e._speedCutTime=0,e._speedCutNum=0,e._isBeTemptation=!1,e._temptationTime=0,e._iceTime=0,e._atkNum=0,e._dizzinessEffect=null,e._iceEffect=null,e._iceSpeedCut=0,e._beFireNum=0,e._hpProgress=null,e._isSpdAdd=!1,e._rushEffect=null,e._atkAnimFrameNums=[],e._canAtk=!0,e._atkSpd=0,e._simulationPos=null,e._simulationTarget=null,e._simulationPathIdx=0,e._simulationIsSpdAdd=!1,e._isStartAtk=!1,e._isAtkFinish=!0,e._survivalTime=0,e._hurtItemNodes=[],e._hitEffectNodes=[],e._isTop=!1,e._isFlaser=!1,e._flaserTime=0,e._weatherData=null,e.mDamageNumberObjects=[],e}return __extends(e,t),Object.defineProperty(e.prototype,"weatherData",{set:function(t){this._weatherData=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isTop",{get:function(){return this._isTop},enumerable:!1,configurable:!0}),e.prototype.getIsAllowAstrictMove=function(){return 1==this.monsterCfg.type&&4006!=this.monsterCfg.id&&!this.getIsDie()},Object.defineProperty(e.prototype,"isBeTemptation",{set:function(t){this.getIsAllowAstrictMove()&&(this._isBeTemptation=t,this._temptationTime=1,this.setEnemyColor())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isBeFire",{set:function(t){2!=this.monsterCfg.type&&(t?this._beFireNum++:this._beFireNum--,this.setEnemyColor())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isSpdAdd",{get:function(){return this._isSpdAdd},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"moveDis",{get:function(){return this._moveDis},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pathIdx",{get:function(){return this._pathIdx},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"enemyPathIdx",{get:function(){return this._enemyPathIdx},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"monsterCfg",{get:function(){return this._monsterCfg},enumerable:!1,configurable:!0}),e.prototype.update=function(t){if(P.battleDataProxy.gameState==_.GameState.PLAYING&&this._amimState!=_.RoleState.Dead&&this._amimState!=_.RoleState.BeBack){if(this._dizzinessTime>0&&(this._dizzinessTime-=t,this._dizzinessTime<=0&&(this._dizzinessTime=0,this._iceTime<=0&&(this.mIsSpAni?this.mAnimSp.paused=!1:this.mAnimCtrl.getComponent(cc.Animation).resume(),this._dizzinessEffect&&this._dizzinessEffect.isValid&&(this._dizzinessEffect.destroy(),this._dizzinessEffect.removeFromParent(),this._dizzinessEffect=null)),this.setEnemyColor())),this._iceTime>0&&(this._iceTime-=t,this._iceTime<=0&&(this._iceTime=0,this._dizzinessTime<=0&&(this.mIsSpAni?this.mAnimSp.paused=!1:this.mAnimCtrl.getComponent(cc.Animation).resume(),this._iceEffect&&this._iceEffect.isValid&&(this._iceEffect.destroy(),this._iceEffect.removeFromParent(),this._iceEffect=null),this.setEnemyColor()))),this._isBeTemptation&&(this._temptationTime-=t,this._temptationTime<0&&(this._temptationTime=0,this._isBeTemptation=!1,this.setEnemyColor())),this._speedCutTime>0&&(this._speedCutTime-=t,this._speedCutTime<=0&&(this._speedCutTime=0,this._speedCutNum=0,this.setEnemyColor())),this._isFlaser&&(this._flaserTime-=t,this._flaserTime<=0)){this._isFlaser=!1,cc.Tween.stopAllByTarget(this.mAnimCtrl.node);var e=this.mAnimCtrl.node.scaleX>0?1:-1;cc.tween(this.mAnimCtrl.node).to(.1,{scaleX:1.4*e}).to(.2,{scaleX:1*e}).start()}this._survivalTime+=t,this._survivalTime>=10&&4008!=this._monsterCfg.id&&(this.node.x>390||this.node.x<-390||this.node.y<-cc.winSize.height/2||this.node.y>cc.winSize.height)?this.playDie(!1):this._iceTime>0||this._dizzinessTime>0||this._isBeTemptation||(this.getIsBeResist()?(this._canAtk||(this._atkSpd-=t,this._atkSpd<=0&&(this._canAtk=!0)),this._isAnimReady&&(this.move(t),this.moveByRvo(t)),this.updateHpProgressPos()):this.beResist())}},e.prototype.playStand=function(){},e.prototype.getIsBeResist=function(){for(var t=0;t<P.battleDataProxy.nutWalNodes.length;++t){var e=P.battleDataProxy.nutWalNodes[t];if(l.MathUtil.distance(e.position,this.node.position)<=100)return!1}return!0},e.prototype.beResist=function(){},e.prototype.getIsCanMove=function(){return!0},e.prototype.onDestroy=function(){this.removeHpProgress()},e.prototype.removeHpProgress=function(){this._hpProgress&&this._hpProgress.isValid&&(this._hpProgress.destroy(),this._hpProgress.removeFromParent(),this._hpProgress=null)},e.prototype.initEndlessEnemy=function(t,e){this.mMonsterId=t.armyId,this._isTop=e,this._monsterCfg=g.DataManager.instance.eData.datamonster[this.mMonsterId],this._isSpdAdd=!0,this._atkNum=Math.floor(t.atk*this._monsterCfg.atk),this._nowHp=this._maxHp=Math.floor(t.hp*this._monsterCfg.hp),this.loadAnimation(),this.addRushEffect();var a=P.battleDataProxy.getEndlessEnemyMovePaths(e,this._monsterCfg.type);this._enemyMovePaths=a.movePath,this._pathIdx=a.idx,this._atkAnimFrameNums="0"==this._monsterCfg.atkFrame?[]:this._monsterCfg.atkFrame.split("|").map(Number),this._enemyPathIdx=1,this.node.position=this._enemyMovePaths[0].position,this.node.x=475,this._target=this._enemyMovePaths[this._enemyPathIdx],this.addHpProgress(),4008!=this._monsterCfg.id&&(this.node.scale=this.getScale())},e.prototype.initEnemy=function(t){this.mMonsterId=t;var e=this.mMonsterId;this._monsterCfg=g.DataManager.instance.eData.datamonster[e],this._survivalTime=0;var a=P.battleDataProxy.getEnemyMovePaths(this._monsterCfg.type);if(this._enemyMovePaths=a.movePath,this._pathIdx=a.idx,this.node.position=this._enemyMovePaths[0].position,this.node.x=475,this._isSpdAdd=!0,this._enemyPathIdx=1,this._target=this._enemyMovePaths[this._enemyPathIdx],P.battleDataProxy.weatherType!=_.WeatherType.NONE)this._nowHp=this._maxHp=Math.floor(P.battleDataProxy.weatherStageInfo.hpRate*this._weatherData.hp*this._monsterCfg.hp),this._atkNum=Math.floor(P.battleDataProxy.weatherStageInfo.atkRate*this._weatherData.atk*this._monsterCfg.atk);else{this._nowHp=this._maxHp=Math.floor(P.battleDataProxy.stageInfo.hp*this._monsterCfg.hp);for(var i=P.battleDataProxy.getStageRewardCfg().Attribute.split("|"),o=0;o<i.length;++o){var n=i[o].split("_").map(Number);2==n[0]?this._atkNum=Math.floor(this._atkNum*(1+n[1])):4==n[0]&&(this._maxHp=Math.floor(this._maxHp*(1+n[1])))}this._nowHp=this._maxHp,this._atkNum=Math.floor(P.battleDataProxy.stageInfo.atk*this._monsterCfg.atk),1==b.userDataProxy.userData.curChapter&&(this._atkNum=1)}this._atkAnimFrameNums="0"==this._monsterCfg.atkFrame?[]:this._monsterCfg.atkFrame.split("|").map(Number),this.loadAnimation(),this.addRushEffect(),this.addHpProgress(),4008!=this._monsterCfg.id&&(this.node.scale=this.getScale())},e.prototype.addRushEffect=function(){var t=this;u.ResUtil.loadAsset({path:"prefabs/item/RushEffect",type:cc.Prefab,bundleName:y.Bundles.GAME}).then(function(e){t.node&&t.node.isValid&&(t._rushEffect=cc.instantiate(e),t.node.addChild(t._rushEffect,1),t._rushEffect.position=cc.v3(0,0),t._rushEffect.getComponent(A.default).play())}).catch(function(t){console.log("error:",t)})},e.prototype.loadAnimation=function(){var t=this;this.mAnimCtrl.loadAtlasAnimation(d.AnimationCfgMgr.instance.getAnimationCfg(this._monsterCfg)).then(function(){t.node&&t.node.isValid&&(t._isAnimReady=!0,4005==t.monsterCfg.id&&r.AudioManager.instance.playEffectPath("sounds/enemy4005",y.Bundles.RES),t.playMove(10))})},e.prototype.getScale=function(){return 2==this.monsterCfg.type?1.8:3==this.monsterCfg.type?1.45:1},e.prototype.addHpProgress=function(){var t=this;1!=this.monsterCfg.type&&u.ResUtil.loadAsset({bundleName:y.Bundles.GAME,path:"prefabs/item/HpProgress",type:cc.Prefab}).then(function(e){t.node&&t.node.isValid&&(t._hpProgress=cc.instantiate(e),P.battleDataProxy.top1.addChild(t._hpProgress),t.updateHpProgressPos(),t.updateHp())})},e.prototype.updateHpProgressPos=function(){this._hpProgress&&(this._hpProgress.position=this.node.position.clone().add(cc.v3(0,this.node.height*this.node.scaleY+10)))},e.prototype.updateHp=function(){if(this._hpProgress){var t=this._nowHp/this._maxHp;this._hpProgress.active=t<1,this._hpProgress.getChildByName("Bar").getComponent(cc.Sprite).fillRange=t}},e.prototype.getIsDie=function(){return this._amimState==_.RoleState.Dead},e.prototype.playMove=function(t){void 0===t&&(t=5),this._amimState!=_.RoleState.Dead&&this._isAnimReady&&(this._amimState=_.RoleState.Move,this._isAtkFinish=!0,this.mAnimCtrl.playAnim("move",!0,null,null,t))},e.prototype.playDie=function(t,e){var a=this;if(void 0===t&&(t=!0),void 0===e&&(e=!1),this._amimState!=_.RoleState.Dead&&this._isAnimReady){if(this._amimState=_.RoleState.Dead,this.mIsSpAni){var i=this.mAnimSp.node.scaleX>0?1:-1;this.mAnimSp.node.scaleX=i,cc.Tween.stopAllByTarget(this.mAnimSp.node),this.mAnimSp.node.color=cc.color(255,255,255)}else i=this.mAnimCtrl.node.scaleX>0?1:-1,this.mAnimCtrl.node.scaleX=i,cc.Tween.stopAllByTarget(this.mAnimCtrl.node),this.mAnimCtrl.node.color=cc.color(255,255,255);if(P.battleDataProxy.removeEnemyNode(this.node),t){var o=this._monsterCfg.exp,n=S.default.instance.getSkillProperty(37,0);o=Math.floor(o*(1+n)),c.EventManager.instance.emit(P.EBattleEvent.UPDATE_EXP,o)}if(4009==this._monsterCfg.id){var r=P.battleDataProxy.airshipSoldier.indexOf(this.node);r>=0&&P.battleDataProxy.airshipSoldier.splice(r,1)}this.removeHpProgress(),e?u.ResUtil.loadAsset({path:"prefabs/monster/EnemyBoomDie",type:cc.Prefab,bundleName:y.Bundles.GAME}).then(function(t){if(a.node&&a.node.isValid){var e=cc.instantiate(t);a.node.parent.addChild(e,a.node.zIndex),e.position=a.node.position,e.scaleX=-1*a.node.scaleX,e.scaleY=a.node.scaleY,e.getComponent(M.default).initEnemyBoomDie(),a.node.destroy(),a.node.removeFromParent()}}).catch(function(t){console.log("error:",t)}):this.playDieAnim()}},e.prototype.playDieAnim=function(){var t=this;if(this.mIsSpAni)return this.mAnimSp.paused=!1,void this.mAnimSp.setAnimation(0,"die",!1);this.mAnimCtrl.getComponent(cc.Animation).resume(),this.mAnimCtrl.playAnim("die",!1,function(){t.node.destroy(),t.node.removeFromParent()},null,2)},e.prototype.playAtk=function(){var t=this;if(this._amimState!=_.RoleState.Dead&&this._isAnimReady){this._amimState=_.RoleState.Attack,this._isStartAtk=!0;var e="atk",a=this._atkAnimFrameNums[0];if(this._atkAnimFrameNums.length>1){var i=Math.floor(1e3*Math.random())%this._atkAnimFrameNums.length;e="atk"+i,a=this._atkAnimFrameNums[i]}this.mAnimCtrl.playAnim(e,!1,function(){t.playMove()},null,5),this.scheduleOnce(function(){t.openFire()},a/2*.01)}},e.prototype.openFire=function(){if(!this.getIsDie())if(1==this.monsterCfg.atkType)r.AudioManager.instance.playEffectPath("sounds/enemyAtk",y.Bundles.RES),P.battleDataProxy.updateHouseHp({isCirt:!1,num:-this._atkNum});else{var t,e=cc.instantiate(this.mEnemyBulletPb);P.battleDataProxy.battleView.addChild(e,1e3),t=this.mIsSpAni?this.mAnimSp.node.getChildByName("fireNode"):this.mAnimCtrl.node.getChildByName("fireNode");var a=D.default.convertToTargetNodeSpace(t,e);e.position=a,e.getComponent(C.default).initBullet(this._monsterCfg,this._atkNum,this._target.position.clone())}},e.prototype.getMoveSpd=function(t,e){e||(e=1/60);var a=this._monsterCfg.speed/120,i=S.default.instance.getSkillProperty(30,0);if((a*=1-this._speedCutNum-i-this._iceSpeedCut)<0&&(a=0),t&&(a*=5),4010!=this._monsterCfg.id&&!t){for(var o=P.battleDataProxy.enemyPathIce,n=!1,r=0;r<o.length;++r)if(o[r].getBoundingBox().contains(this.node.getPosition())){n=!0;break}n&&(a*=1.5)}return this._isFlaser&&(a*=.5),a*(e/(1/60))},e.prototype.move=function(t){var e,a;if(this._target&&this._target.isValid){if(this.node&&this.node.isValid&&this._isAtkFinish&&this._amimState!=_.RoleState.Dead&&this._amimState!=_.RoleState.Attack&&this._amimState!=_.RoleState.BeBack){var i=l.MathUtil.distance(this._target.position,this.node.position),o=3;if(P.battleDataProxy.isEndless&&(o=2),this._enemyPathIdx==o&&(null===(e=this._atkAnimFrameNums)||void 0===e?void 0:e.length)>0&&i<=this.monsterCfg.range)this._canAtk&&(this._canAtk=!1,this._atkSpd=this.monsterCfg.atkSpeed,this.playAtk());else{var n=this.getMoveSpd(this._isSpdAdd,t),r=this.node.position.clone().sub(this._target.position.clone()).normalize();if(this.node.x-=n*r.x,this.node.y-=n*r.y,this.mIsSpAni){var s=Math.abs(this.mAnimSp.node.scaleX);this.mAnimSp.node.scaleX=r.x<=0?s:-s}else s=Math.abs(this.mAnimCtrl.node.scaleX),this.mAnimCtrl.node.scaleX=r.x<=0?s:-s;this.node.zIndex=-this.node.y,i<=n&&(this._enemyPathIdx++,this._target=this._enemyMovePaths[this._enemyPathIdx],this._target||this.moveToHouse()),this._isSpdAdd&&this.node.x<=(null===(a=this.node.parent)||void 0===a?void 0:a.width)/2-100&&this.removeRushEffect(),this._moveDis+=n}}}else this._target=null},e.prototype.removeRushEffect=function(){this._isSpdAdd=!1,this.mIsSpAni?this.mAnimSp.timeScale=1:this.mAnimCtrl.setSpeed(5),this._rushEffect&&this._rushEffect.isValid&&(this._rushEffect.destroy(),this._rushEffect.removeFromParent(),this._rushEffect=null)},e.prototype.moveToHouse=function(){r.AudioManager.instance.playEffectPath("sounds/enemyAtk",y.Bundles.RES),P.battleDataProxy.updateHouseHp({isCirt:!1,num:-this._atkNum}),this.playDie(!1)},e.prototype.moveByRvo=function(){},e.prototype.getIsMiss=function(t){var e,a;if(P.battleDataProxy.weatherType==_.WeatherType.HeavyFog&&15!=t&&14!=t){var i,o=!1;i=this.node.y>=150?(null===(e=P.battleDataProxy.weatherHeavyFog.getComponent(x.default))||void 0===e?void 0:e.mCheckTopHeavyFogs)||[]:(null===(a=P.battleDataProxy.weatherHeavyFog.getComponent(x.default))||void 0===a?void 0:a.mCheckDownHeavyFogs)||[];for(var n=this.node.getChildByName("collision").getComponent(p.default),r=0;r<i.length;++r){var s=i[r],c=null==s?void 0:s.getComponent(p.default);if(c&&h.default.isCollisionRectToRect(n.rect,c.rect)){o=!0;break}}if(o&&Math.floor(1e3*Math.random())%100<50)return!0}return!1},e.prototype.beAttack=function(t,e,a,i){var o,n;return void 0===a&&(a=!1),void 0===i&&(i=!0),!(P.battleDataProxy.battleData.houseHp<=0||this._monsterCfg&&this._amimState!=_.RoleState.Dead&&(this.getIsMiss(e)?(this.showMiss(),1):(4010==this._monsterCfg.id&&102==e&&(t.num*=5),this.subHp(t.num),i&&this.showHurtLab(t.num,t.isCrit),this.updateHp(),r.AudioManager.instance.playEffectPath("sounds/enemyHit",y.Bundles.RES),this._nowHp<=0?(this.playDie(!0,a),0):(this.mAnimCtrl&&(null===(o=this.mAnimCtrl.getComponent(f.default))||void 0===o||o.show()),this.mAnimSp&&(null===(n=this.mAnimSp.getComponent(f.default))||void 0===n||n.show()),1))))},e.prototype.subHp=function(t){isNaN(t)&&(t=1),this._nowHp-=t,isNaN(this._nowHp)&&(this._nowHp=10),this._nowHp<0&&(this._nowHp=0)},e.prototype.showHurtLab=function(t,e){var a=this.node.position;a.y+=this.mBody?this.mBody.height+30:this.node.height+30,D.default.showHurt(Math.ceil(t),e?D.HurtType.CRIT:D.HurtType.NORMAL,a,this,P.battleDataProxy.numberView,this.node)},e.prototype.showMiss=function(){var t=this.node.position;t.y+=this.mBody?this.mBody.height+30:this.node.height+30,D.default.showMiss(t,this,P.battleDataProxy.numberView,this.node)},e.prototype.dizziness=function(t){var e=this;if(void 0===t&&(t=2),this.getIsAllowAstrictMove()&&!this._isSpdAdd&&(this._dizzinessTime=t,t>0)){if(this.mIsSpAni?this.mAnimSp.paused=!0:this.mAnimCtrl.getComponent(cc.Animation).pause(),this._dizzinessEffect)return;u.ResUtil.loadAsset({path:"prefabs/item/DizzinessEffect",type:cc.Prefab,bundleName:y.Bundles.GAME}).then(function(t){e.node&&e.node.isValid&&(e._dizzinessEffect||(e._dizzinessEffect=cc.instantiate(t),e.node.addChild(e._dizzinessEffect,1),e._dizzinessEffect.position=cc.v3(0,e.node.height),e._dizzinessEffect.getComponent(E.default).play()))}).catch(function(t){console.log("error:",t)})}},e.prototype.speedCut=function(t,e){1==this.monsterCfg.type&&(t<=0||(this._speedCutTime=t,this._speedCutNum=e,this.setEnemyColor()))},e.prototype.ice=function(t){var e=this;if(void 0===t&&(t=3),this.getIsAllowAstrictMove()&&!this._isSpdAdd&&(this._iceTime=t,t>0)){if(this.mIsSpAni?this.mAnimSp.paused=!0:this.mAnimCtrl.getComponent(cc.Animation).pause(),this._iceEffect)return;u.ResUtil.loadAsset({path:"prefabs/item/IceEffect",type:cc.Prefab,bundleName:y.Bundles.GAME}).then(function(t){e.node&&e.node.isValid&&(e._iceEffect||(e._iceEffect=cc.instantiate(t),e.node.addChild(e._iceEffect,1),e._iceEffect.position=cc.v3(0,0),e._iceEffect.getComponent(B.default).play()))}).catch(function(t){console.log("error:",t)})}},e.prototype.iceSpeedCut=function(){1==this.monsterCfg.type&&(this._iceSpeedCut=.2,this.setEnemyColor())},e.prototype.pushDamageNumberObject=function(t){this.mDamageNumberObjects&&(this.damageNumberObjectActive(),this.mDamageNumberObjects.push(t))},e.prototype.removeDamageNumberObject=function(t){if(this.mDamageNumberObjects)for(var e=0;e<this.mDamageNumberObjects.length;++e)if(this.mDamageNumberObjects[e]==t){this.mDamageNumberObjects.splice(e,1);break}},e.prototype.damageNumberObjectActive=function(){if(this.mDamageNumberObjects)for(var t=0;t<this.mDamageNumberObjects.length;++t){var e=this.mDamageNumberObjects[t],a=cc.moveBy(.1,cc.v2(0,30));e&&e.isValid&&e.node.runAction(a)}},e.prototype.updateHurtItemNode=function(t){if(this._hurtItemNodes.push(t),this._hurtItemNodes.length>3){var e=this._hurtItemNodes[0];e&&e.isValid&&(cc.Tween.stopAllByTarget(e),v.default.instance.putNode(e),this._hurtItemNodes.splice(0,1))}},e.prototype.removeHurtItemNode=function(t){for(var e=0;e<this._hurtItemNodes.length;++e)if(t==this._hurtItemNodes[e]){this._hurtItemNodes.splice(e,1);break}},e.prototype.updateHitEffectNodes=function(t,e){var a=this._hitEffectNodes.findIndex(function(t){return t.plantId==e});if(a<0)this._hitEffectNodes.push({plantId:e,hitNodes:[t]});else if(this._hitEffectNodes[a].hitNodes.push(t),this._hitEffectNodes[a].hitNodes.length>3){var i=this._hitEffectNodes[a].hitNodes[0];i&&i.isValid&&(cc.Tween.stopAllByTarget(i),i.destroy(),i.removeFromParent(),this._hitEffectNodes[a].hitNodes.splice(0,1))}},e.prototype.removeHitEffectNode=function(t,e){var a=this._hitEffectNodes.findIndex(function(t){return t.plantId==e});if(a>=0){var i=this._hitEffectNodes[a].hitNodes.indexOf(t);i>=0&&this._hitEffectNodes[a].hitNodes.splice(i,1)}},e.prototype.setEnemyColor=function(){if(!this.getIsDie()){var t=this.mIsSpAni?this.mAnimSp:this.mAnimCtrl;(null==t?void 0:t.node)&&(null==t?void 0:t.node.isValid)&&(this._isBeTemptation?t.node.color=cc.color("#FB35E7"):this._iceSpeedCut>0||this._speedCutTime>0?t.node.color=cc.color("#469BFF"):this._beFireNum>0?t.node.color=cc.color("#FF004C"):t.node.color=cc.color(255,255,255))}},e.prototype.flaser=function(){this.getIsDie()||1==this.monsterCfg.type&&(this._isFlaser=!0,this.mIsSpAni?(this.mAnimSp.node.scaleY=.2,cc.Tween.stopAllByTarget(this.mAnimSp.node),cc.tween(this.mAnimSp.node).to(.5,{scaleY:1}).start()):(this.mAnimCtrl.node.scaleX=.2,this._flaserTime=1,cc.Tween.stopAllByTarget(this.mAnimCtrl.node)))},e.prototype.getIsCanChoose=function(){return!0},e.prototype.initSimulationData=function(){this._simulationPos=this.node.position,this._simulationTarget=this._target,this._simulationPathIdx=this._enemyPathIdx,this._simulationIsSpdAdd=this.isSpdAdd},e.prototype.getMovePosByTime=function(t){var e=Math.floor(30*t);if(this._isStartAtk)return cc.v3(this._simulationPos.x,this._simulationPos.y+this.node.height);if(!this._simulationTarget)return this.node.position;for(var a=0;a<e;++a){var i=2*this.getMoveSpd(this._simulationIsSpdAdd,1/60),o=l.MathUtil.distance(this._simulationTarget.position,this._simulationPos),n=this._simulationPos.clone().sub(this._simulationTarget.position.clone()).normalize();if(this._simulationPos.x-=i*n.x,this._simulationPos.y-=i*n.y,this._simulationIsSpdAdd&&this._simulationPos.x<=this.node.parent.width/2-100&&(this._simulationIsSpdAdd=!1),o<=i&&(this._simulationPathIdx++,this._simulationTarget=this._enemyMovePaths[this._simulationPathIdx],!this._simulationTarget))break}return cc.v3(this._simulationPos.x,this._simulationPos.y+this.node.height)},__decorate([T(cc.Node)],e.prototype,"mBody",void 0),__decorate([T()],e.prototype,"mIsSpAni",void 0),__decorate([T({type:m.default,tooltip:"\u662f\u5426\u5c55\u793aImg",visible:function(){return!this.mIsSpAni}})],e.prototype,"mAnimCtrl",void 0),__decorate([T({type:sp.Skeleton,tooltip:"\u662f\u5426\u5c55\u793aspine",visible:function(){return this.mIsSpAni}})],e.prototype,"mAnimSp",void 0),__decorate([T()],e.prototype,"mIsShoot",void 0),__decorate([T({type:cc.Prefab,tooltip:"\u662f\u5426\u6709\u5b50\u5f39\u9884\u5236\u4f53",visible:function(){return this.mIsShoot}})],e.prototype,"mEnemyBulletPb",void 0),__decorate([R],e)}(s.ComponentBase);n.default=I,cc._RF.pop(),cc._RF.pop()},{}],EnemyBoomDie:[function(t,e,a){"use strict";cc._RF.push(e,"979b7ymaHtM6IMCrwsynXbo","EnemyBoomDie");var i=t,o=e,n=a;cc._RF.push(o,"190ae2o4dVLwJH4jwKVfHZE","EnemyBoomDie"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AnimationCfgMgr"),s=i("AnimationCtrl"),c=cc._decorator,l=c.ccclass,u=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mAnimCtrl=null,e}return __extends(e,t),e.prototype.initEnemyBoomDie=function(){var t=this;this.mAnimCtrl.loadAnimation(r.AnimationCfgMgr.instance.getEnemyBoomDie()).then(function(){t.node&&t.node.isValid&&t.mAnimCtrl.playAnim("boomDie",!1,function(){t.node.destroy(),t.node.removeFromParent()},null,2)})},__decorate([u({type:s.default})],e.prototype,"mAnimCtrl",void 0),__decorate([l],e)}(cc.Component);n.default=p,cc._RF.pop(),cc._RF.pop()},{}],EnemyBoss2001:[function(t,e,a){"use strict";cc._RF.push(e,"7c684CECtNLtKMCY+OGKnCn","EnemyBoss2001");var i=t,o=e,n=a;cc._RF.push(o,"4fcbaL8OgZPMrLySTRL0vlR","EnemyBoss2001"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("EnemyBoss"),s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),__decorate([c],e)}(r.default));n.default=l,cc._RF.pop(),cc._RF.pop()},{}],EnemyBoss2002:[function(t,e,a){"use strict";cc._RF.push(e,"0e9d1gGChxBmZ44ZcW3G5a9","EnemyBoss2002");var i=t,o=e,n=a;cc._RF.push(o,"47aba2b/+9OfJR9X9hmlRHs","EnemyBoss2002"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("EnemyBoss"),s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),__decorate([c],e)}(r.default));n.default=l,cc._RF.pop(),cc._RF.pop()},{}],EnemyBoss2003:[function(t,e,a){"use strict";cc._RF.push(e,"8e785JwENxOOIKVYrPi+jr5","EnemyBoss2003");var i=t,o=e,n=a;cc._RF.push(o,"a763eOR07ZEzbvcorYg8TrU","EnemyBoss2003"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("EnemyBoss"),s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),__decorate([c],e)}(r.default));n.default=l,cc._RF.pop(),cc._RF.pop()},{}],EnemyBoss2004:[function(t,e,a){"use strict";cc._RF.push(e,"56ceacX9xZKqZE6rF5ANBqF","EnemyBoss2004");var i=t,o=e,n=a;cc._RF.push(o,"26337m+6NdGfJig4StBCnMj","EnemyBoss2004"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("EnemyBoss"),s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),__decorate([c],e)}(r.default));n.default=l,cc._RF.pop(),cc._RF.pop()},{}],EnemyBoss2005:[function(t,e,a){"use strict";cc._RF.push(e,"23e49SUQzNML5Tb7kuPuBzO","EnemyBoss2005");var i=t,o=e,n=a;cc._RF.push(o,"ca9c9HJQ7RMj4RPvrbTM4D2","EnemyBoss2005"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("EnemyBoss"),s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),__decorate([c],e)}(r.default));n.default=l,cc._RF.pop(),cc._RF.pop()},{}],EnemyBoss2006:[function(t,e,a){"use strict";cc._RF.push(e,"d0011jLwzBCNqyz9SeMCVhj","EnemyBoss2006");var i=t,o=e,n=a;cc._RF.push(o,"604c8p+ZEtM7oSTS6NzzgZY","EnemyBoss2006"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("EnemyBoss"),s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),__decorate([c],e)}(r.default));n.default=l,cc._RF.pop(),cc._RF.pop()},{}],EnemyBoss2007:[function(t,e,a){"use strict";cc._RF.push(e,"89ff04OkhpOCo1sheEmrRwR","EnemyBoss2007");var i=t,o=e,n=a;cc._RF.push(o,"9c5946PWPJGWYlSM42N5fgb","EnemyBoss2007"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("EnemyBoss"),s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),__decorate([c],e)}(r.default));n.default=l,cc._RF.pop(),cc._RF.pop()},{}],EnemyBoss2008:[function(t,e,a){"use strict";cc._RF.push(e,"1c88dXj9MlM8JyzZ4Hb9kCx","EnemyBoss2008");var i=t,o=e,n=a;cc._RF.push(o,"eabc9mUxFhOJYjOsAZZKG14","EnemyBoss2008"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("EnemyBoss"),s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),__decorate([c],e)}(r.default));n.default=l,cc._RF.pop(),cc._RF.pop()},{}],EnemyBoss2009:[function(t,e,a){"use strict";cc._RF.push(e,"7f739rpuxJJRanmNLec1nBy","EnemyBoss2009");var i=t,o=e,n=a;cc._RF.push(o,"d8a69497r5BXKbh18tLIsTW","EnemyBoss2009"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("EnemyBoss"),s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),__decorate([c],e)}(r.default));n.default=l,cc._RF.pop(),cc._RF.pop()},{}],EnemyBoss:[function(t,e,a){"use strict";cc._RF.push(e,"9a6f4x8TxJM16ZewFGVNMC1","EnemyBoss");var i=t,o=e,n=a;cc._RF.push(o,"6ccf8tK5mxG7Y2ptMFsEIpn","EnemyBoss"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("ResUtil"),s=i("GameEnum"),c=i("HomeEnum"),l=i("DataManager"),u=i("BattleDataProxy"),p=i("Util"),h=i("BossBall"),d=i("BossSkillBase"),m=i("EnemyBase"),f=cc._decorator,_=f.ccclass,y=(f.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._skillInfo=null,e._skillCd=0,e._isFirstUseSkill=!0,e._isUseSkill=!1,e}return __extends(e,t),e.prototype.initEnemy=function(e){t.prototype.initEnemy.call(this,e),this.initBossSkill()},e.prototype.onLoad=function(){var t=this;this.mAnimSp.setCompleteListener(function(e){var a=e.animation?e.animation.name:"";a.indexOf("die")>=0?(t.node.destroy(),t.node.removeFromParent()):a.indexOf("atk")>=0&&t.playStand()}),this.mAnimSp.setEventListener(function(){if(t._isUseSkill){t._isUseSkill=!1;var e=1;4==t._skillInfo.id&&(e=t._skillInfo.num);for(var a=0;a<e;++a)t.addSkillNode()}else t.openFire()})},e.prototype.initBossSkill=function(){var t=this.monsterCfg.bossSkillId;t&&(this._skillInfo=l.DataManager.instance.eData.data_bossskill[t]),console.log("Boss\u7684atk:",this._atkNum),console.log("Boss\u7684Hp:",this._maxHp),this.node.height=this.getBossHeight()},e.prototype.initEndlessEnemy=function(e,a){t.prototype.initEndlessEnemy.call(this,e,a),this.initBossSkill()},e.prototype.getBossHeight=function(){return 2001==this.monsterCfg.id?118:2002==this.monsterCfg.id?87:2003==this.monsterCfg.id?104:2004==this.monsterCfg.id?114:2005==this.monsterCfg.id?85:2006==this.monsterCfg.id?86:2007==this.monsterCfg.id?94:2008==this.monsterCfg.id?86:2009==this.monsterCfg.id?119:100},e.prototype.update=function(e){if(u.battleDataProxy.gameState==s.GameState.PLAYING&&this._amimState!=s.RoleState.Dead&&(t.prototype.update.call(this,e),!(this._iceTime>0||this._dizzinessTime>0||this._isBeTemptation)&&this._skillInfo)){this._skillCd+=e;var a=this._skillInfo.cd;this._isFirstUseSkill&&(a/=2),this._skillCd>=a&&(this._isFirstUseSkill=!1,this._skillCd=0,this.useSkill())}},e.prototype.useSkill=function(){if(this._amimState!=s.RoleState.Dead&&this._isAnimReady){this._amimState=s.RoleState.Attack,this._isAtkFinish=!1;var t="atk";this._atkAnimFrameNums.length>1&&(t="atk"+(Math.floor(1e3*Math.random())%this._atkAnimFrameNums.length+1)),this.mAnimSp.setAnimation(0,t,!1),this._isUseSkill=!0}},e.prototype.addSkillNode=function(){var t=this;this._amimState!=s.RoleState.Dead&&(6!=this.monsterCfg.bossSkillId?r.ResUtil.loadAsset({bundleName:c.Bundles.GAME,path:"prefabs/bossSkill/BossSkill"+this._skillInfo.id,type:cc.Prefab}).then(function(e){if(t.node&&t.node.isValid)if(5==t.monsterCfg.bossSkillId){var a=cc.instantiate(e);t.node.parent.addChild(a),a.getComponent(m.default).initEnemy(5001),u.battleDataProxy.enemyNodes.push(a),u.battleDataProxy.wateringCart=a}else{var i=cc.instantiate(e);if(u.battleDataProxy.battleView.addChild(i,t.node.zIndex-1),2==t.monsterCfg.bossSkillId){var o=t.mAnimSp.node.getChildByName("fireNode"),n=p.default.convertToTargetNodeSpace(o,i);i.position=n,i.zIndex=1e3}else i.position=t.node.position;i.getComponent(d.default).play()}}):r.ResUtil.loadAsset({bundleName:c.Bundles.GAME,path:"prefabs/bossSkill/BossBall",type:cc.Prefab}).then(function(e){if(t.node&&t.node.isValid){var a=cc.instantiate(e);u.battleDataProxy.battleView.addChild(a);var i=t.mAnimSp.node.getChildByName("fireNode"),o=p.default.convertToTargetNodeSpace(i,a);a.position=o,a.getComponent(h.default).initBossBall()}}))},e.prototype.loadAnimation=function(){this._isAnimReady=!0,this.playMove(10)},e.prototype.playMove=function(t){this._amimState!=s.RoleState.Dead&&this._isAnimReady&&(this._amimState=s.RoleState.Move,this._isAtkFinish=!0,this.mAnimSp.setAnimation(0,"move",!0),this.mAnimSp.timeScale=10==t?2:1)},e.prototype.playDieAnim=function(){this.mAnimSp.paused=!1,this.mAnimSp.setAnimation(0,"die",!1)},e.prototype.playAtk=function(){if(this._amimState!=s.RoleState.Dead&&this._isAnimReady){this._amimState=s.RoleState.Attack,this._isStartAtk=!0;var t="atk";this._atkAnimFrameNums.length>1&&(t="atk"+(Math.floor(1e3*Math.random())%this._atkAnimFrameNums.length+1)),this.mAnimSp.setAnimation(0,t,!1)}},e.prototype.playStand=function(){this._amimState!=s.RoleState.Dead&&this._isAnimReady&&(this._amimState=s.RoleState.Move,this._isAtkFinish=!0,this.mAnimSp.setAnimation(0,"move",!0))},__decorate([_],e)}(m.default));n.default=y,cc._RF.pop(),cc._RF.pop()},{}],EnemyBulletBase:[function(t,e,a){"use strict";cc._RF.push(e,"e2e62euLApI/4qxJf/mxPNW","EnemyBulletBase");var i=t,o=e,n=a;cc._RF.push(o,"68b54Wt+9FE5bBmKhVOoTBj","EnemyBulletBase"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("MathUtil"),c=i("ResUtil"),l=i("GameEnum"),u=i("HomeEnum"),p=i("BattleDataProxy"),h=cc._decorator,d=h.ccclass,m=h.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mBulletImg=null,e._atkNum=0,e._atkPos=null,e._moveSpd=20,e.mLastPos=null,e}return __extends(e,t),e.prototype.initBullet=function(t,e,a){var i=this;this._atkNum=e,this._atkPos=a,c.ResUtil.loadAsset({path:"textures/enemyBullet/"+t.modeName+"_zidan",type:cc.SpriteFrame,bundleName:u.Bundles.GAME}).then(function(t){i.mBulletImg.spriteFrame=t}).catch(function(t){console.log("error:",t)})},e.prototype.update=function(t){if(p.battleDataProxy.gameState==l.GameState.PLAYING||p.battleDataProxy.gameState==l.GameState.READY){var e=this._moveSpd*(t/(1/60)),a=this._atkPos,i=s.MathUtil.distance(this.node.position,a),o=this.node.position.clone().sub(a.clone()).normalize();if(this.node.x-=e*o.x,this.node.y-=e*o.y,i<=e)return this.node.destroy(),this.node.removeFromParent(),r.AudioManager.instance.playEffectPath("sounds/enemyAtk",u.Bundles.RES),void p.battleDataProxy.updateHouseHp({isCirt:!1,num:-this._atkNum});this.setAngle()}},e.prototype.setAngle=function(){var t=this.node.position;if(this.mLastPos){var e=-1e4;if(t!=this.mLastPos){var a=t.sub(this.mLastPos),i=cc.v2(a),o=cc.v2(1,0),n=i.magSqr(),r=o.magSqr();if(0==n||0==r)return;var s=i.signAngle(o),c=Math.floor(cc.misc.radiansToDegrees(s));e=c,c=-c,this.node.angle=c,this.mLastPos=t}return e}this.mLastPos=t},__decorate([m(cc.Sprite)],e.prototype,"mBulletImg",void 0),__decorate([d],e)}(cc.Component);n.default=f,cc._RF.pop(),cc._RF.pop()},{}],EnemyCrucifix:[function(t,e,a){"use strict";cc._RF.push(e,"4dc0bt2wLRNo7lrLyOo/b52","EnemyCrucifix");var i=t,o=e,n=a;cc._RF.push(o,"fb914xvdetL/4cTjFkRx2Tg","EnemyCrucifix"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("BattleDataProxy"),s=i("EquipmentItem"),c=cc._decorator,l=c.ccclass,u=(c.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.attractCrucifix=function(t){var e=this,a=r.battleDataProxy.equipRoot.children,i=a.findIndex(function(t){var e;return 101==(null===(e=t.getComponent(s.default))||void 0===e?void 0:e.equipId)});if(i>=0){var o=a[i];if(!o||!o.isValid)return;var n=this.node.convertToWorldSpaceAR(cc.v2(0,0)),c=r.battleDataProxy.battleView.convertToNodeSpaceAR(n);this.node.parent=r.battleDataProxy.battleView,this.node.position=cc.v3(c),this.node.zIndex=1e4;var l=o.convertToWorldSpaceAR(cc.v2(0,0)),u=r.battleDataProxy.battleView.convertToNodeSpaceAR(l),p=Math.floor(1e4*Math.random())%360;cc.tween(this.node).to(.5,{position:cc.v3(u.addSelf(cc.v2(0,o.height/2))),angle:720+p}).call(function(){var e=r.battleDataProxy.priestZombie.indexOf(t);e>=0&&r.battleDataProxy.priestZombie.splice(e,1)}).delay(2).call(function(){e.node.destroy(),e.node.removeFromParent()}).start()}},__decorate([l],e)}(cc.Component));n.default=u,cc._RF.pop(),cc._RF.pop()},{}],EnemyDetailsPopup:[function(t,e,a){"use strict";cc._RF.push(e,"6eacdzTathGA6D+tiWM0fJm","EnemyDetailsPopup");var i=t,o=e,n=a;cc._RF.push(o,"5cbfcnSN1FNCZpuHSCQgnFB","EnemyDetailsPopup"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("ResUtil"),s=i("PopupBase"),c=i("GameEnum"),l=i("HomeEnum"),u=i("DataManager"),p=i("BattleDataProxy"),h=cc._decorator,d=h.ccclass,m=h.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mAnimCtrl=null,e.mRotateBg=null,e.mEnemyName=null,e.mRestrain=null,e.mDetails=null,e}return __extends(e,t),e.prototype.init=function(e){var a=this;t.prototype.init.call(this,e);var i=e.enemyId,o=u.DataManager.instance.eData.datamonster[i];this.mDetails.string=o.des,this.mEnemyName.string=o.name;var n=cc.tween(this.mRotateBg).by(.3,{angle:60});cc.tween(this.mRotateBg).repeatForever(n).start(),r.ResUtil.loadAsset({path:"textures/monster/zombieSp/"+o.modeName+"_atk_0",type:cc.SpriteFrame,bundleName:l.Bundles.GAME}).then(function(t){a.mAnimCtrl.spriteFrame=t}).catch(function(t){console.log("error:",t)});for(var s=o.fixedPlantId.split("|").map(Number),c=function(t){var e=s[t],a=cc.instantiate(p.mRestrain.children[1]);p.mRestrain.addChild(a),a.active=!0,r.ResUtil.loadAsset({path:"textures/botanyIcon/pic_plant"+e,type:cc.SpriteFrame,bundleName:l.Bundles.GAME}).then(function(t){a.getComponent(cc.Sprite).spriteFrame=t}).catch(function(t){console.log("error:",t)})},p=this,h=0;h<s.length;++h)c(h)},e.prototype.onDestroy=function(){p.battleDataProxy.gameState=c.GameState.PLAYING},e.prototype.onShow=function(){p.battleDataProxy.gameState=c.GameState.PAUSE},__decorate([m(cc.Sprite)],e.prototype,"mAnimCtrl",void 0),__decorate([m(cc.Node)],e.prototype,"mRotateBg",void 0),__decorate([m(cc.Label)],e.prototype,"mEnemyName",void 0),__decorate([m(cc.Node)],e.prototype,"mRestrain",void 0),__decorate([m(cc.Label)],e.prototype,"mDetails",void 0),__decorate([d],e)}(s.PopupBase);n.default=f,cc._RF.pop(),cc._RF.pop()},{}],EnemyNormal:[function(t,e,a){"use strict";cc._RF.push(e,"44be2IT3FZO35gccc7LkC0O","EnemyNormal");var i=t,o=e,n=a;cc._RF.push(o,"f9e96KjTylPIKhLn9ihnwK3","EnemyNormal"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("EnemyBase"),s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initEnemy=function(e){t.prototype.initEnemy.call(this,e),3==this.monsterCfg.type&&(this.node.height=this.getEliteHeight(),this.node.getChildByName("collision").height=this.node.height)},e.prototype.getEliteHeight=function(){return 3001==this.monsterCfg.id?105:3002==this.monsterCfg.id?89:3003==this.monsterCfg.id?83:3004==this.monsterCfg.id?80:3005==this.monsterCfg.id?121:3006==this.monsterCfg.id?96:3007==this.monsterCfg.id?118:3008==this.monsterCfg.id?91:3009==this.monsterCfg.id?97:100},__decorate([c],e)}(r.default));n.default=l,cc._RF.pop(),cc._RF.pop()},{}],EnemyPathIce:[function(t,e,a){"use strict";cc._RF.push(e,"24748ef0UJO1o496+YCzpRq","EnemyPathIce");var i=t,o=e,n=a;cc._RF.push(o,"1c1f3IgxTZCPbGPxbYnvRh1","EnemyPathIce"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("ResUtil"),s=i("HomeEnum"),c=i("BattleDataProxy"),l=cc._decorator,u=l.ccclass,p=l.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mIceSp=null,e.mIceSprite=null,e._pathNode=null,e}return __extends(e,t),e.prototype.initEnemyPathIce=function(t,e){var a=this;this._pathNode=t;var i="textures/monster/zombieSp/pic_bingkuai1";5==e?(i="textures/monster/zombieSp/pic_bingkuai2",this.mIceSprite.node.y=6):13==e?(i="textures/monster/zombieSp/pic_bingkuai4",this.mIceSprite.node.y=-19):e>5&&e<13&&(i="textures/monster/zombieSp/pic_bingkuai3"),r.ResUtil.loadAsset({path:i,type:cc.SpriteFrame,bundleName:s.Bundles.GAME}).then(function(t){a.node&&a.node.isValid&&(a.mIceSprite.spriteFrame=t)}).catch(function(t){console.log("error:",t)}),this.mIceSp.setCompleteListener(function(){a._pathNode.PathIce=null;var t=c.battleDataProxy.enemyPathIce.indexOf(a.node);t>=0&&c.battleDataProxy.enemyPathIce.splice(t,0),a.node.destroy(),a.node.removeFromParent()})},e.prototype.playIceSp=function(){this.mIceSprite.node.active=!1,this.mIceSp.node.active=!0,this.mIceSp.setAnimation(0,"songhua",!1)},__decorate([p(sp.Skeleton)],e.prototype,"mIceSp",void 0),__decorate([p(cc.Sprite)],e.prototype,"mIceSprite",void 0),__decorate([u],e)}(cc.Component);n.default=h,cc._RF.pop(),cc._RF.pop()},{}],EnemyThiefMark:[function(t,e,a){"use strict";cc._RF.push(e,"1f62cM1x+xOr6TS+iOkb5AC","EnemyThiefMark");var i=e,o=a;cc._RF.push(i,"b8c641qszdIY784lj5ua7/m","EnemyThiefMark"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,r=n.ccclass,s=(n.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.play=function(t,e){cc.Tween.stopAllByTarget(this.node),this.node.scale=3,cc.tween(this.node).to(.5,{position:t,scale:1}).call(function(){e&&e()}).start()},__decorate([r],e)}(cc.Component));o.default=s,cc._RF.pop(),cc._RF.pop()},{}],EngineExUtils:[function(t,e,a){"use strict";cc._RF.push(e,"ed1d5goCe9Dw5+27qU6pG1/","EngineExUtils");var i=e,o=a;cc._RF.push(i,"362d44d47hDy509lx59PTWG","EngineExUtils"),Object.defineProperty(o,"__esModule",{value:!0}),o.EngineExUtils=o.headImgExt=void 0,o.headImgExt=".head",function(t){function e(){cc.assetManager.downloader.register(o.headImgExt,function(t,e,a){a(null,t)}),cc.assetManager.parser.register(o.headImgExt,i),cc.assetManager.factory.register(o.headImgExt,a)}function a(t,e,a,i){var o=null,n=null;try{(o=new cc.Texture2D)._uuid=t,o._nativeUrl=t,o._nativeAsset=e}catch(r){n=r}i&&i(n,o)}function i(t,e,a){var i=new Image;function o(){i.removeEventListener("load",o),i.removeEventListener("error",n),a&&a(null,i)}function n(){i.removeEventListener("load",o),i.removeEventListener("error",n),a&&a(new Error(t))}return"file:"!==window.location.protocol&&(i.crossOrigin="anonymous"),i.addEventListener("load",o),i.addEventListener("error",n),i.src=t,i}t.all=function(){e()},t.registerHeadImgLoader=e}(o.EngineExUtils||(o.EngineExUtils={})),cc._RF.pop(),cc._RF.pop()},{}],EquipmentFragmentsPopup:[function(t,e,a){"use strict";cc._RF.push(e,"2c5a9eUx+JH570jEruVcAGF","EquipmentFragmentsPopup");var i=t,o=e,n=a;cc._RF.push(o,"d2f44bNQ15H7pcz+VvQ84ha","EquipmentFragmentsPopup"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("ResUtil"),s=i("PopupBase"),c=i("HomeEnum"),l=i("DataManager"),u=i("UserDataProxy"),p=cc._decorator,h=p.ccclass,d=(p.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._curLevel=1,e}return __extends(e,t),e.prototype.init=function(){this._curLevel=u.userDataProxy.userData.boxData.level,this._curLevel<1?this._curLevel=1:this._curLevel>10&&(this._curLevel=10),this.initView()},e.prototype.initView=function(){var t=l.DataManager.instance.eData.datashopbox[this._curLevel];this.node.getChildByName("levelLabel").getComponent(cc.Label).string="Lv."+this._curLevel;var e=t.reward.split("|");this.updateAwardList(e,"contant1");var a=t.bigReward.split("|");this.updateAwardList(a,"contant2"),this.node.getChildByName("leftBtn").active=this._curLevel>1,this.node.getChildByName("rightBtn").active=this._curLevel<10},e.prototype.updateAwardList=function(t,e){var a=this.node.getChildByName(e);a.children.forEach(function(t){return t.active=!1});for(var i=function(e){var i=t[e].split("_"),o=l.DataManager.instance.eData.dataitem[i[0]];if(2==i.length){var n=a.children[e];n||((n=cc.instantiate(a.children[0])).parent=a);var s=n.getChildByName("icon").getComponent(cc.Sprite);r.ResUtil.loadAsset({path:"textures/item/"+o.icon,type:cc.SpriteFrame,bundleName:c.Bundles.GAME}).then(function(t){s.spriteFrame=t}).catch(function(t){console.log("error:",t)}),n.getChildByName("numLabel").getComponent(cc.Label).string="x"+i[1],n.active=!0}},o=0,n=t.length;o<n;o++)i(o)},e.prototype.onClickLeftBtn=function(){this._curLevel-=1,this._curLevel<1&&(this._curLevel=1),this.initView()},e.prototype.onClickRightBtn=function(){this._curLevel+=1,this._curLevel>10&&(this._curLevel=10),this.initView()},__decorate([h],e)}(s.PopupBase));n.default=d,cc._RF.pop(),cc._RF.pop()},{}],EquipmentItem:[function(t,e,a){"use strict";cc._RF.push(e,"3dd39ZAskxBgYTV8PU+nNTL","EquipmentItem");var i=t,o=e,n=a;cc._RF.push(o,"c19f56W8rlF1qSeTbBoIEP2","EquipmentItem"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("EventManager"),c=i("MathUtil"),l=i("ResUtil"),u=i("SimplyCircleCollider"),p=i("SimplyRectCollider"),h=i("SimplyCollisionDetector"),d=i("GameEnum"),m=i("HomeEnum"),f=i("DataManager"),_=i("NodePoolManager"),y=i("BattleDataProxy"),g=i("UserDataProxy"),v=i("Util"),P=i("SkillDataMgr"),b=i("BossSkillCharm"),D=i("CorruptMark"),S=i("BulletBase"),C=i("BulletBoom"),E=i("BoxIceClick"),B=i("BoxIceCrush"),A=i("PlantIceEffect"),x=i("WeatherIceBroken"),M=i("WeatherIceEffect"),N=i("WeatherNightLight"),R=i("MapGridItem"),T=i("SuperPlantActive"),I=cc._decorator,w=I.ccclass,k=I.property,F=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mGridsLayout=null,e.mDataFormIdx=d.EquipmentFormIdx.FORM_0,e.mLvLab=null,e.mBulletPb=null,e.mFireNode=null,e.mBoxWhite=null,e.mCounterBar=null,e.mIsFixedPlant=!1,e.mPriceLab=null,e.mTriggerBar=null,e.mEquipId=0,e._idx=0,e._originPosition=null,e._level=0,e._bAnim=!1,e._equipmentData=[],e._holdGrids=[],e._triggerNum=0,e._triggerCounter=0,e._superTriggerNum=0,e._superTriggerCounter=0,e._isCheckActive=!1,e._colliderCd=0,e._atkCount=0,e._continuouFireNum=0,e._continuouFireTime=0,e._atkTarget=null,e._oneAtkTargetNum=0,e._lastAtkTarget=null,e._isShukuchi=!1,e._checkSdTime=0,e._plantPrice=0,e._isPurchased=!1,e._atkTargets=[],e._atkTargetNum=0,e._superPlantData=null,e._superIsAtkFinish=!0,e._isIce=!1,e._isMark=!1,e._plantIceEffect=null,e._iceBreakerCount=0,e._iceBreakerMaxCount=0,e._bossBallNum=0,e._isBossBallMark=!1,e._corruptMark=null,e._isTakeEffect=!0,e._bossColliderCd=0,e._charmTime=0,e._isCharm=!1,e._charmNode=null,e._isCanDemotion=!1,e._bossSkillCourse=null,e._frenzyBulletNum=0,e._frenzyTime=0,e._adNode=null,e._itemIcon2=null,e._itemIcon=null,e._star=null,e._root=null,e._lightningStrokeEffect=null,e._lightningDizzinessTime=0,e._isLightningStroke=!1,e._isRage=!1,e._isBeWindUp=!1,e._beWindUpTime=0,e._tornadoEffect=null,e._weatherIceCount=0,e._isWeatherIce=!1,e._weatherIceNodes=[],e}return __extends(e,t),Object.defineProperty(e.prototype,"idx",{get:function(){return this._idx},set:function(t){this._idx=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bossSkillCourse",{get:function(){return this._bossSkillCourse},set:function(t){this._bossSkillCourse=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dataFormIdx",{get:function(){return this.mDataFormIdx},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"grids",{get:function(){return this.mGridsLayout.children},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isIce",{get:function(){return this._isIce},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isMark",{get:function(){return this._isMark},set:function(t){this._isMark=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isLightningStroke",{get:function(){return this._isLightningStroke},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isTakeEffect",{get:function(){return this._isTakeEffect},set:function(t){this._isTakeEffect=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isBeWindUp",{get:function(){return this._isBeWindUp},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"holdGrids",{get:function(){return this._holdGrids},set:function(t){this._holdGrids=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"adFlag",{get:function(){return this._adNode.active},set:function(t){this._adNode.active=t,this.updateVideoIconFrame()},enumerable:!1,configurable:!0}),e.prototype.updateVideoIconFrame=function(){if(this._adNode.active){var t=this._adNode.getChildByName("icon");y.battleDataProxy.setVideoCardIcon(t,3),this.mIsFixedPlant||(this.mPriceLab.node.parent.active=!1)}},Object.defineProperty(e.prototype,"root",{get:function(){return this._root},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"level",{get:function(){return this._level},set:function(t){if(this._level=t,this.mLvLab.string=""+this._level,!this.mIsFixedPlant){var e=this._root.getChildByName("levelIcon");if(e){var a=e.getComponent(cc.Sprite).spriteFrame.name,i=a.substring(0,a.length-1),o=this._level>5?5:this._level;l.ResUtil.loadAsset({path:"textures/botanyGird/"+i+o,type:cc.SpriteFrame,bundleName:m.Bundles.GAME}).then(function(t){e.getComponent(cc.Sprite).spriteFrame=t}).catch(function(t){console.log("error:",t)})}this.isPurchased?this.mPriceLab.node.active=!1:(this._plantPrice=y.battleDataProxy.getPlantPrice(this.equipId,t),this.mPriceLab.string=""+this._plantPrice,this.updatesunshineNum()),this.setSuperPlantIcon()}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"plantPrice",{get:function(){return this._plantPrice},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"equipId",{get:function(){return this.mEquipId},set:function(t){this.mEquipId=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bAnim",{set:function(t){this._bAnim=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canClick",{get:function(){return!this._bAnim},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isPurchased",{get:function(){return this._isPurchased},set:function(t){this._isPurchased=t,t&&(this.mPriceLab.node.parent.active=!1,this._adNode.active=!1,this._star.active=!1,this.addSleep())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isCanDemotion",{set:function(t){this._isCanDemotion=t},enumerable:!1,configurable:!0}),e.prototype.addSleep=function(){var t=this;y.battleDataProxy.weatherType==d.WeatherType.Night&&(3!=this.equipId&&10!=this.equipId?l.ResUtil.loadAsset({path:"prefabs/weather/WeatherSleep",type:cc.Prefab,bundleName:m.Bundles.GAME}).then(function(e){var a=cc.instantiate(e);t._root.addChild(a),a.position=cc.v3(0,0,0)}).catch(function(t){console.log("error:",t)}):this.addWeatherNightLight())},e.prototype.addWeatherNightLight=function(){var t=this;l.ResUtil.loadAsset({path:"prefabs/weather/WeatherNightLight",type:cc.Prefab,bundleName:m.Bundles.GAME}).then(function(e){var a=t._root.getChildByName("lightRoot"),i=cc.instantiate(e);a.addChild(i,-1),i.position=cc.v3(0,0,0),i.getComponent(N.default).show()}).catch(function(t){console.log("error:",t)})},e.prototype.cleanBossBall=function(){this._bossBallNum=0,this._isBossBallMark=!1,this._corruptMark&&this._corruptMark.isValid&&(this._corruptMark.destroy(),this._corruptMark.removeFromParent(),this._corruptMark=null)},e.prototype.updatesunshineNum=function(){var t=y.battleDataProxy.sunshineNum;this._plantPrice>t?this.mPriceLab.node.color=cc.color(255,75,25):this.mPriceLab.node.color=cc.color(255,255,255)},e.prototype.update=function(t){var e,a=this;if(this._isTakeEffect){if(y.battleDataProxy.gameState!=d.GameState.PLAYING&&y.battleDataProxy.gameState!=d.GameState.READY||(this._colliderCd>0&&(this._colliderCd-=t),this._bossColliderCd>0&&(this._bossColliderCd-=t),this._charmTime>0&&(this._charmTime-=t,this._charmTime<=0&&(this._isCharm=!1,this._charmNode&&this._charmNode.isValid&&(this._charmNode.destroy(),this._charmNode.removeFromParent(),this._charmNode=null))),this._frenzyBulletNum>0&&(this._frenzyTime+=t,this._frenzyTime>=.1&&(this._frenzyTime=0,this._frenzyBulletNum--,this.initAtkTargets(),this.addFrenzyBullet())),this._isLightningStroke&&(this._lightningDizzinessTime-=t,this._lightningDizzinessTime<=0&&(this._isLightningStroke=!1,this._lightningStrokeEffect&&this._lightningStrokeEffect.isValid&&(this._lightningStrokeEffect.destroy(),this._lightningStrokeEffect.removeFromParent(),this._lightningStrokeEffect=null)))),this._isBeWindUp&&(this._beWindUpTime-=t,this._beWindUpTime<=0&&(this._beWindUpTime=5,cc.Tween.stopAllByTarget(this._root),this._root.angle=0,this._tornadoEffect&&this._tornadoEffect.isValid&&(this._tornadoEffect.active=!1),cc.tween(this._root).to(.1,{position:cc.v3(0,0,0)}).call(function(){a._isCheckActive=!0,a._isBeWindUp=!1}).start())),10==this.equipId&&!y.battleDataProxy.isEndless&&y.battleDataProxy.weatherType!=d.WeatherType.Night)if(y.battleDataProxy.getIsSuperPlant(this.equipId))this._isShukuchi&&(this._isShukuchi=!1,this._itemIcon.active=!this._isShukuchi,this._itemIcon2.active=this._isShukuchi);else if(this._checkSdTime+=t,this._checkSdTime>=.5){this._checkSdTime=0;for(var i=!1,o=y.battleDataProxy.enemyNodes.slice(),n=null,r=0;r<o.length;++r){var s=o[r];if(s&&s.isValid&&(n||(n=v.default.convertToTargetNodeSpace(this.node,s)),s.y<n.y)){i=!0;break}}this._isShukuchi!=i&&(this._isShukuchi=i,this._itemIcon.active=!this._isShukuchi,this._itemIcon2.active=this._isShukuchi)}if(this._isCheckActive){var c=!0,l=y.battleDataProxy.bulletBalls;for(r=0;r<l.length;++r)for(var m=l[r].getComponent(u.default),f=null===(e=this._root)||void 0===e?void 0:e.getChildByName("collisions"),_=0;_<f.childrenCount;++_){var g=f.children[_].getComponent(p.default);if(g&&h.default.isCollisionRectToCircle(g.rect,m.circle)){c=!1;break}}c&&(this._isCheckActive=!1,this.setIsCollider(!0))}}},e.prototype.onLoad=function(){this._level=1,this._equipmentData=d.EquipmentData["form"+this.mDataFormIdx].data,this._root=this.node.getChildByName("root"),this._adNode=this._root.getChildByName("Ad"),this.mCounterBar=this._root.getChildByName("barBg").getChildByName("bar").getComponent(cc.Sprite),this._itemIcon2=this._root.getChildByName("itemIcon2"),this._itemIcon=this._root.getChildByName("itemIcon"),this._star=this._root.getChildByName("star"),this.mCounterBar.node.parent.active=!1,this._triggerNum=f.DataManager.instance.eData.dataplant[this.equipId].triggerNum,this._superPlantData=f.DataManager.instance.eData.datasuperplant[this.equipId],this._superTriggerNum=this._superPlantData.needNum,this._triggerCounter=0,this._isPurchased=!1,this.mTriggerBar.fillRange=0,this.mTriggerBar.node.opacity=125,this.mTriggerBar.fillStart=1,this.mBoxWhite=this._root.getChildByName("boxWhite"),this.mBoxWhite&&(this.mBoxWhite.active=!1),this._isCanDemotion=!0,s.EventManager.instance.on(g.EUserDataEvent.UPDATE_VIDEO_CARD,this.updateVideoIconFrame,this),s.EventManager.instance.on(y.EBattleEvent.UPDATE_SUPER_STATE,this.setSuperPlantIcon,this),s.EventManager.instance.on(y.EBattleEvent.SELECT_SUPER_PLANT,this.selectSuperPlant,this),this._star.active=this.mEquipId==y.battleDataProxy.battleData.superPlantId},e.prototype.setSuperPlantIcon=function(){var t,e=this,a=y.battleDataProxy.getIsSuperPlant(this.mEquipId);if(t=a||this._isRage?"textures/botanyIcon/pic_CWplant"+this.mEquipId:"textures/botanyIcon/pic_plant"+this.mEquipId,l.ResUtil.loadAsset({path:t,type:cc.SpriteFrame,bundleName:m.Bundles.GAME}).then(function(t){e._itemIcon.getComponent(cc.Sprite).spriteFrame=t,e.mTriggerBar.spriteFrame=t}).catch(function(t){console.log("error:",t)}),(a||this._isRage)&&this.isPurchased){if(this.mCounterBar.node.parent.active=this._superTriggerNum>1,this.mCounterBar.fillRange=this._superTriggerCounter/this._superTriggerNum,4==this.mEquipId)for(var i=0;i<this._weatherIceNodes.length;++i)for(var o=this._weatherIceNodes[i],n=0;n<o.iceNodes.length;++n){var r=o.iceNodes[n];r&&r.isValid&&(r.active=!1)}}else this.mCounterBar.node.parent.active=!1;2!=this.mEquipId&&6!=this.mEquipId&&10!=this.mEquipId&&12!=this.mEquipId||y.battleDataProxy.getIsSuperPlant(this.mEquipId)&&(this.mTriggerBar.node.active=!1)},e.prototype.onDestroy=function(){s.EventManager.instance.off(g.EUserDataEvent.UPDATE_VIDEO_CARD,this.updateVideoIconFrame,this),s.EventManager.instance.off(y.EBattleEvent.UPDATE_SUPER_STATE,this.setSuperPlantIcon,this),s.EventManager.instance.off(y.EBattleEvent.SELECT_SUPER_PLANT,this.selectSuperPlant,this)},e.prototype.selectSuperPlant=function(){this._star.active=this.mEquipId==y.battleDataProxy.battleData.superPlantId},e.prototype.setCounterIsShow=function(t){t&&y.battleDataProxy.getIsSuperPlant(this.mEquipId)&&this.isPurchased?(this.mCounterBar.node.parent.active=this._superTriggerNum>1,this._superTriggerNum>1&&(this.mCounterBar.fillRange=this._superTriggerCounter/this._superTriggerNum)):this.mCounterBar.node.parent.active=!1},e.prototype.setOriginPosition=function(t){this._originPosition=t},e.prototype.backOrgin=function(){this.node.position=this._originPosition.clone()},e.prototype.getIsHaveBeLinkedGrid=function(t,e){for(var a=0;a<t.length;++a)if(t[a].mapGridKey==e)return!0;return!1},e.prototype.checkGridIsBeLinked=function(t,e){for(var a=[],i=-1,o=0,n=0,r=0;r<t.length;++r){for(var s=t[r],c=s.node.getComponent(R.default).rowCol.split("-").map(Number),l=0,u=null,p=null,h=0;h<this._equipmentData.length;++h)for(var m=0;m<this._equipmentData[h].length;++m)this._equipmentData[h][m]>0&&l++;for(h=0;h<this._equipmentData.length;++h){var f=function(r){var m=c[0]+h+"-"+(c[1]+r-d.EquipmentData["form"+_.mDataFormIdx].colOffset);if(!_.getIsHaveBeLinkedGrid(t,m))return u=null,p=null,"continue";var f=e.get(m);if(_._equipmentData[h][r]>0){if(!f)return u=null,p=null,"continue";if(u||(u=[]),p||(p=[]),u.push(m),p.push(s),u.length>=l){a.push(u);var y=0;p.forEach(function(t){y+=t.area}),y>o&&(i=n,o=y),n++}}},_=this;for(m=0;m<this._equipmentData[h].length;++m)f(m)}}return a[i]},e.prototype.addFrenzyBullet=function(){y.battleDataProxy.isActiveSuperPlant&&13==this.equipId?this.openFireEx():this.openFire()},e.prototype.openFireEx=function(){},e.prototype.openFire=function(){if(!(this._atkTargets.length<=0)){this._atkCount++;var t=y.battleDataProxy.getBulletNum(this._atkCount,this.equipId);if(this._continuouFireNum=y.battleDataProxy.getFireNum(this.equipId),t>1)for(var e=this.getTargetRadian(this._atkTargets[0]),a=Math.floor(cc.misc.radiansToDegrees(e+Math.PI)),i=0;i<t;++i){var o=this.addBulletNode(this._atkTargets[0]);if(o){var n=this.getBulletStartAngle(t,i,a);o.angle=n;var r=c.MathUtil.getRadian(n),s=v.default.convertToTargetNodeSpace(this.node,o),l=s.x+cc.winSize.height*Math.cos(r),u=s.y+cc.winSize.height*Math.sin(r);o.getComponent(S.default).setAtkPos(cc.v3(l,u))}}else if(this._atkTargetNum>1)for(i=0;i<this._atkTargetNum;++i){var p=this._atkTargets[i];p&&p.isValid&&this.addBulletNode(p)}else this._continuouFireNum>1?(this._atkTarget=this._atkTargets[0],this._continuouFireTime=0,this.addBulletNode(this._atkTarget)):this.addBulletNode(this._atkTargets[0])}},e.prototype.bossBallCollisionEnter=function(){var t=this;this.mIsFixedPlant||this._bossColliderCd>0||this._isTakeEffect&&(this._bossColliderCd=.2,this._bossBallNum++,this._isBossBallMark?this._corruptMark&&this._corruptMark.isValid&&this._corruptMark.getComponent(D.default).updateMark(this._bossBallNum):l.ResUtil.loadAsset({path:"prefabs/bossSkill/CorruptMark",type:cc.Prefab,bundleName:m.Bundles.GAME}).then(function(e){t._corruptMark=cc.instantiate(e),t.node.addChild(t._corruptMark),t._corruptMark.position=t.getCorruptMarkPos(),t._corruptMark.getComponent(D.default).updateMark(t._bossBallNum)}).catch(function(t){console.log("error:",t)}),this._bossBallNum>=3&&(this._isTakeEffect=!1,cc.Tween.stopAllByTarget(this._root),cc.tween(this._root).to(.05,{angle:-10}).to(.05,{angle:0}).to(.05,{angle:10}).to(.05,{angle:0}).to(.3,{scale:1.3}).call(function(){t.addBoom(),t.holdGrids.forEach(function(t){y.battleDataProxy.gridsMap.get(t).getComponent(R.default).belongTo=null}),t.node.destroy(),t.node.removeFromParent(),s.EventManager.instance.emit(y.EBattleEvent.UPDATE_SUPER_PLANT_NUM)}).start()),this._isBossBallMark=!0)},e.prototype.addBoom=function(){var t=this.node.convertToWorldSpaceAR(cc.v3(0,0)),e=y.battleDataProxy.battleView.convertToNodeSpaceAR(t);l.ResUtil.loadAsset({path:"prefabs/bullet/BulletBoom",type:cc.Prefab,bundleName:m.Bundles.GAME}).then(function(t){if(y.battleDataProxy.battleView&&y.battleDataProxy.battleView.isValid){var a=cc.instantiate(t);y.battleDataProxy.bulletView.addChild(a),a.position=e,a.getComponent(C.default).initBulletBoom()}}).catch(function(t){console.log("error:",t)})},e.prototype.getCorruptMarkPos=function(){if(4==this.mEquipId)return cc.v3(-this.node.width/2,-this.node.height/4);var t=30*(this.node.height/60-1);return cc.v3(-this.node.width/2,t)},e.prototype.frenzyCollisionEnter=function(){if(this.getCollisionIsValid()){this._root.scale=1,cc.Tween.stopAllByTarget(this._root);var t=cc.tween(this._root).to(.1,{scale:1.2}).to(.1,{scale:1});if(cc.tween(this._root).repeat(3,t).start(),this.mIsFixedPlant)this._frenzyBulletNum=0;else{var e=f.DataManager.instance.eData.dataplant[this.mEquipId].gridNum,a=f.DataManager.instance.eData.datapara[44].num.split("|").map(Number)[e-1];a||(a=2);var i=Number(f.DataManager.instance.eData.datapara[45].num),o=a;this._frenzyBulletNum=o<=i?o:i}}else this._frenzyBulletNum=0},e.prototype.initAtkTargets=function(){this._atkTargetNum=y.battleDataProxy.getAtkTargetNum(this.equipId),this._atkTargets=y.battleDataProxy.getPlantAtkTargets(this._atkTargetNum,this.mEquipId,this._isCharm),this._atkTarget=this._atkTargets[0]},e.prototype.ballCollisionEnterEx=function(){if(y.battleDataProxy.gameState==d.GameState.PLAYING){if(this._colliderCd>0)return this._atkTargetNum=0,void(this._atkTargets=[]);if(this.mIsFixedPlant)this.ballCollisionEnter();else{if(y.battleDataProxy.weatherType==d.WeatherType.IceAndSnow)if(4==this.mEquipId){if(!y.battleDataProxy.getIsSuperPlant(this.mEquipId)&&(this.startWeatherIce(),this._isWeatherIce))return}else if(11!=this.mEquipId){if(this.startWeatherIce(),this._isWeatherIce)return}else if(11==y.battleDataProxy.battleData.superPlantId&&!this._isRage)if(this._weatherIceCount++,this._weatherIceCount>5){this._isRage=!0,this.setSuperPlantIcon(),y.battleDataProxy.getIsSuperPlant(11)||r.AudioManager.instance.playEffectPath("sounds/getPlant",m.Bundles.RES);for(var t=0;t<this._weatherIceNodes.length;++t)for(var e=this._weatherIceNodes[t],a=0;a<e.iceNodes.length;++a){var i=e.iceNodes[a];i&&i.isValid&&(i.active=!1)}}else this.addWeatherIceEffect();this.ballCollisionEnter()}}},e.prototype.startWeatherIce=function(){if(this._isWeatherIce?this._weatherIceCount--:this._weatherIceCount++,this.addWeatherIceEffect(),this._weatherIceCount<0){this._isWeatherIce=!1;for(var t=4;t>this._weatherIceCount;--t)for(var e=this._weatherIceNodes[t],a=0;a<e.iceNodes.length;++a)e.iceNodes[a].active=!1;this._weatherIceCount=0}else this._weatherIceCount>=5&&(this._isWeatherIce=!0)},e.prototype.addWeatherIceEffect=function(){var t=this;if(this._isWeatherIce)this._weatherIceCount<0?this.addWeatherIceBroken():this.addBoxIceClick();else{var e="",a=!1;this._weatherIceCount>=5?(e="prefabs/effect/PlantIceEffect",a=!0):e="prefabs/weather/WeatherIceEffect";var i=this._weatherIceNodes.findIndex(function(e){return e.iceCount==t._weatherIceCount});if(i>=0)for(var o=this._weatherIceNodes[i],n=0;n<o.iceNodes.length;++n){var r=o.iceNodes[n];r&&r.isValid&&(r.active=!0)}else{var s=this._weatherIceCount;l.ResUtil.loadAsset({path:e,type:cc.Prefab,bundleName:m.Bundles.GAME}).then(function(e){if(!t._isRage)if(a){var i=cc.instantiate(e);t._root.addChild(i),i.getComponent(A.default).initPlantIceEffect(t.getIceFrameData()),i.getComponent(A.default).updateState(1),t._weatherIceNodes.push({iceCount:s,iceNodes:[i]})}else{for(var o=t.mGridsLayout.children,n=[],r=0;r<o.length;++r){var c=cc.instantiate(e);t._root.addChild(c),c.getComponent(M.default).initWeatherIceEffect(o[r]),n.push(c)}t._weatherIceNodes.push({iceCount:s,iceNodes:n})}}).catch(function(t){console.log("error:",t)})}}},e.prototype.addWeatherIceBroken=function(){var t=this;l.ResUtil.loadAsset({path:"prefabs/weather/WeatherIceBroken",type:cc.Prefab,bundleName:m.Bundles.GAME}).then(function(e){for(var a=t.mGridsLayout.children,i=0;i<a.length;++i){var o=cc.instantiate(e);t._root.addChild(o),o.getComponent(x.default).show(a[i])}}).catch(function(t){console.log("error:",t)})},e.prototype.ballCollisionEnter=function(){!this._isTakeEffect||(this.initAtkTargets(),this._atkTargets.length<=0)||(this._colliderCd=d.EGameEnum.COLLIDER_BASE_TIME,cc.Tween.stopAllByTarget(this._root),this._root.scale=1,this.mBoxWhite&&(this.mBoxWhite.active=!0,this.mBoxWhite.opacity=0,cc.Tween.stopAllByTarget(this.mBoxWhite),cc.tween(this.mBoxWhite).to(.1,{opacity:220}).to(.1,{opacity:0}).start()),cc.tween(this._root).to(.1,{scale:1.2}).to(.1,{scale:1}).start(),this._atkTargets.length>0&&(this._atkTarget=this._atkTargets[0]))},e.prototype.addSuperTriggerCounter=function(){if(!this._isTakeEffect)return!1;if(this._isCharm)return!1;if(!this._atkTarget||!this._atkTarget.isValid)return!1;var t=!1;return(y.battleDataProxy.getIsSuperPlant(this.mEquipId)&&this._atkTargets.length>0||this._isRage)&&(this._superTriggerCounter++,this._superTriggerCounter>=this._superTriggerNum&&(this._superTriggerCounter=0,t=!0,this.addSuperPlantActive()),this._superTriggerNum>1&&(this.mCounterBar.fillRange=this._superTriggerCounter/this._superTriggerNum)),t},e.prototype.addTriggerCounter=function(){if(!this._isTakeEffect)return!1;var t=!1;return this._atkTargets.length>0&&(this._triggerCounter++,this._triggerCounter>=this._triggerNum&&(this._triggerCounter=0,t=!0),this.setTriggerBarFillRange(t)),t},e.prototype.setTriggerBarFillRange=function(t){if(this.mTriggerBar.node.active=!0,cc.Tween.stopAllByTarget(this.mTriggerBar),this._triggerNum>1)if(t)cc.tween(this.mTriggerBar).to(.15,{fillRange:0}).to(.15,{fillRange:-1}).start();else{var e=-1*(1-this._triggerCounter/this._triggerNum);cc.tween(this.mTriggerBar).to(.3,{fillRange:e}).start()}else this.mTriggerBar.fillRange=0},e.prototype.hideTriggerBar=function(){this.mIsFixedPlant||(this.mTriggerBar.node.active=!1,this._superTriggerCounter=0,this._triggerCounter=0,this._triggerNum>1?this.mTriggerBar.fillRange=-1:this.mTriggerBar.fillRange=0,this.mCounterBar.fillRange=this._superTriggerCounter/this._superTriggerNum)},e.prototype.addBulletNode=function(t,e,a){if(!(t&&t.isValid||(t=y.battleDataProxy.getPlantAtkTargets(1,this.mEquipId,this._isCharm)[0])))return null;e||(e=this.getAtkRate());var i=1;a&&(i=this._superPlantData.damage1),this._lastAtkTarget!=t?(this._oneAtkTargetNum=1,this._lastAtkTarget=t):this._oneAtkTargetNum++,this._continuouFireNum--;var o=_.default.instance.getNode(this.mBulletPb);y.battleDataProxy.bulletView.addChild(o,1e3);var n=v.default.convertToTargetNodeSpace(this.mFireNode,o);return o.position=n,o.getComponent(S.default).atkRate=e,o.getComponent(S.default).superRate=i,o.getComponent(S.default).setOneAtkTargetNum(this._oneAtkTargetNum),o.getComponent(S.default).initBullet(this.mEquipId,t,this._level,this._atkCount),o},e.prototype.getAtkRate=function(){return y.battleDataProxy.getIsSuperPlant(this.mEquipId)?this._superPlantData.damage:10==this.equipId&&this._isShukuchi?P.default.instance.getSkillProperty(13,this.equipId):1},e.prototype.getTargetRadian=function(t){var e=0;if(!this.node||!this.node.isValid)return e;if(t&&t.isValid&&t.position){var a=t.position,i=v.default.convertToTargetNodeSpace(this.node,t);e=c.MathUtil.getDoublPointRadian(i,a)}return e},e.prototype.getBulletStartAngle=function(t,e,a){var i=45/t;return y.battleDataProxy.enemyNodes.length<=1?a+Math.floor(t/2)*i-i*e:a-i*e},e.prototype.setIsCollider=function(t){this.getComponent(cc.RigidBody).active=t;var e=this.getComponent(cc.PhysicsPolygonCollider),a=this.getComponent(cc.PhysicsBoxCollider);a&&(a.enabled=t,a.apply()),e&&(e.enabled=t,e.apply()),t||(this._isCheckActive=!1)},e.prototype.checkIsActive=function(){this._isCheckActive=!0,r.AudioManager.instance.playEffectPath("sounds/placePlant",m.Bundles.RES),this._root.scale=.8,cc.Tween.stopAllByTarget(this._root),cc.tween(this._root).to(.15,{scale:1.1}).to(.15,{scale:1}).start(),this._isCanDemotion=!0},e.prototype.purchasePlant=function(){var t=y.battleDataProxy.sunshineNum;return!(t<this._plantPrice||(this.mPriceLab.node.parent.active=!1,t-=this._plantPrice,y.battleDataProxy.sunshineNum=t,this._isPurchased=!0,this._colliderCd=d.EGameEnum.COLLIDER_BASE_TIME,this._star.active=!1,this.addSleep(),0))},e.prototype.setPriceLabIsShow=function(t){this.isPurchased?this.mPriceLab.node.parent.active=!1:this.adFlag||(this.mPriceLab.node.parent.active=t)},e.prototype.addSuperPlantActive=function(){var t=this;l.ResUtil.loadAsset({path:"prefabs/item/SuperPlantActive",type:cc.Prefab,bundleName:m.Bundles.GAME}).then(function(e){var a=cc.instantiate(e);y.battleDataProxy.battleView.addChild(a,t.node.zIndex);var i=t.node,o=t._root.getChildByName("shanguang");o&&(i=o);var n=v.default.convertToTargetNodeSpace(i,a);a.position=n,a.getComponent(T.default).play()}).catch(function(t){console.log("error:",t)})},e.prototype.ice=function(t){var e=this,a=Math.floor(100*Math.random())%t+1;this._iceBreakerMaxCount=t,this._iceBreakerCount=a,this._isIce||l.ResUtil.loadAsset({path:"prefabs/effect/PlantIceEffect",type:cc.Prefab,bundleName:m.Bundles.GAME}).then(function(t){e._plantIceEffect=cc.instantiate(t),e.node.addChild(e._plantIceEffect),e._plantIceEffect.getComponent(A.default).initPlantIceEffect(e.getIceFrameData()),e._plantIceEffect.getComponent(A.default).updateState(e._iceBreakerCount/e._iceBreakerMaxCount)}).catch(function(t){console.log("error:",t)}),this._isIce=!0},e.prototype.charm=function(t){var e=this;this._charmTime=t,this._isCharm||l.ResUtil.loadAsset({path:"prefabs/bossSkill/BossSkillCharm",type:cc.Prefab,bundleName:m.Bundles.GAME}).then(function(t){e._charmNode=cc.instantiate(t),e.node.addChild(e._charmNode),e._charmNode.position=cc.v3(0,0,0),e._charmNode.getComponent(b.default).play()}).catch(function(t){console.log("error:",t)}),this._isCharm=!0},e.prototype.equipItemClick=function(){this._bossSkillCourse&&this._bossSkillCourse.isValid&&(y.battleDataProxy.bossSkillCourseIds.push(3),y.battleDataProxy.saveBossSkillCourseIds(),this._bossSkillCourse.destroy(),this._bossSkillCourse.removeFromParent(),this._bossSkillCourse=null)},e.prototype.iceBreaker=function(){this._iceBreakerCount--,r.AudioManager.instance.playEffectPath("sounds/se_broken",m.Bundles.RES),this._iceBreakerCount<=0&&(this._isIce=!1,this.addBoxIceCrush(),this._plantIceEffect&&this._plantIceEffect.isValid&&(this._plantIceEffect.destroy(),this._plantIceEffect.removeFromParent(),this._plantIceEffect=null),this._bossSkillCourse&&this._bossSkillCourse.isValid&&(y.battleDataProxy.bossSkillCourseIds.push(1),y.battleDataProxy.saveBossSkillCourseIds(),this._bossSkillCourse.destroy(),this._bossSkillCourse.removeFromParent(),this._bossSkillCourse=null)),this._plantIceEffect&&this._plantIceEffect.isValid&&this._plantIceEffect.getComponent(A.default).updateState(this._iceBreakerCount/this._iceBreakerMaxCount),this.addBoxIceClick()},e.prototype.addBoxIceClick=function(){var t=this;l.ResUtil.loadAsset({path:"prefabs/effect/BoxIceClick",type:cc.Prefab,bundleName:m.Bundles.GAME}).then(function(e){var a=_.default.instance.getNode(e);t.node.addChild(a),a.getComponent(E.default).initBoxIceClick()}).catch(function(t){console.log("error:",t)})},e.prototype.addBoxIceCrush=function(){var t=this;l.ResUtil.loadAsset({path:"prefabs/effect/BoxIceCrush",type:cc.Prefab,bundleName:m.Bundles.GAME}).then(function(e){var a=_.default.instance.getNode(e);t.node.addChild(a),a.getComponent(B.default).initBoxIceCrush()}).catch(function(t){console.log("error:",t)})},e.prototype.beCapture=function(t){var e=this;if(this._isTakeEffect){this._isTakeEffect=!1,this.setIsCollider(!1),cc.Tween.stopAllByTarget(this._root);var a=v.default.convertToTargetNodeSpace(this.node,t);this.node.parent=t.parent,this.node.position=a,this.node.zIndex=t.zIndex-1,this._root.scale=1.1,cc.tween(this._root).delay(.2).by(.8,{position:cc.v3(0,cc.winSize.height)}).call(function(){e.node.destroy(),e.node.removeFromParent()}).start(),this.holdGrids.forEach(function(t){y.battleDataProxy.gridsMap.get(t).getComponent(R.default).belongTo=null}),this._bossSkillCourse&&this._bossSkillCourse.isValid&&(this._bossSkillCourse.destroy(),this._bossSkillCourse.removeFromParent(),this._bossSkillCourse=null),s.EventManager.instance.emit(y.EBattleEvent.UPDATE_SUPER_PLANT_NUM)}},e.prototype.beWashedAway=function(){if(this._isCanDemotion&&(this._isCanDemotion=!1,!(this.level<=1))){var t=this._level;t-=1,this.level=t,cc.Tween.stopAllByTarget(this._root),cc.tween(this._root).delay(.1).to(.25,{scale:1.2}).to(.25,{scale:1}).start()}},e.prototype.passWave=function(){this.hideTriggerBar(),this.cleanBossBall(),this._charmTime=0,this._isCharm=!1,this._charmNode&&this._charmNode.isValid&&(this._charmNode.destroy(),this._charmNode.removeFromParent(),this._charmNode=null)},e.prototype.lightningStroke=function(){this._lightningDizzinessTime=2,this.addEquipDizziness()},e.prototype.addEquipDizziness=function(){var t=this;this._isLightningStroke||l.ResUtil.loadAsset({path:"prefabs/effect/EquipDizziness",type:cc.Prefab,bundleName:m.Bundles.GAME}).then(function(e){if(t.node&&t.node.isValid){t._lightningStrokeEffect=cc.instantiate(e),t._root.addChild(t._lightningStrokeEffect);var a=t._root.getChildByName("head");a||(a=t._root.getChildByName("levelIcon")),t._lightningStrokeEffect.position=a.position}}).catch(function(t){console.log("error:",t)}),this._isLightningStroke=!0},e.prototype.getIceFrameData=function(){var t={frame:"pic_Icebox2",scaleX:1,scaleY:1,angle:90};return 3==this.mEquipId?(t.frame="pic_Icebox1",t.angle=0):4==this.mEquipId?(t.frame="pic_Icebox4",t.angle=180,t.scaleX=-1):5==this.mEquipId?(t.frame="pic_Icebox4",t.angle=180,t.scaleY=-1):7==this.mEquipId?(t.frame="pic_Icebox4",t.angle=0,t.scaleY=-1,t.scaleX=-1):8==this.mEquipId?(t.frame="pic_Icebox4",t.angle=0):10==this.mEquipId||101==this.mEquipId?(t.frame="pic_Icebox11",t.angle=0):11==this.mEquipId?(t.frame="pic_Icebox8",t.angle=0):13==this.mEquipId||105==this.mEquipId||106==this.mEquipId?(t.frame="pic_Icebox10",t.angle=0):13==this.mEquipId?(t.frame="pic_Icebox10",t.angle=0):103==this.mEquipId||104==this.mEquipId?(t.frame="pic_Icebox2",t.angle=0):107==this.mEquipId?(t.frame="pic_Icebox8",t.angle=0,t.scaleY=-1):6==this.mEquipId?(t.frame="pic_Icebox11",t.angle=90):15==this.mEquipId&&(t.frame="pic_Icebox8",t.angle=90),t},e.prototype.getCollisionIsValid=function(){return!(this.isIce||this.isLightningStroke||!this.isPurchased||this._isBeWindUp||this._isWeatherIce)},e.prototype.beWindUp=function(){var t=this;if(!this._isBeWindUp){if(this._isBeWindUp=!0,this.setIsCollider(!1),this._beWindUpTime=5,this._tornadoEffect&&this._tornadoEffect.isValid)return this._tornadoEffect.active=!0,void this.beWindUpAction();l.ResUtil.loadAsset({path:"prefabs/effect/TornadoEffect",type:cc.Prefab,bundleName:m.Bundles.GAME}).then(function(e){t.node&&t.node.isValid&&(t._tornadoEffect=cc.instantiate(e),t.node.addChild(t._tornadoEffect,-1),t._tornadoEffect.position=cc.v3(0,0,0),t.beWindUpAction())}).catch(function(t){console.log("error:",t)})}},e.prototype.beWindUpAction=function(){var t=this;this.node.zIndex=this.node.y,cc.Tween.stopAllByTarget(this._root),cc.tween(this._root).to(.1,{position:cc.v3(0,this._tornadoEffect.height)}).call(function(){var e=cc.tween(t._root).by(.15,{position:cc.v3(0,15),angle:-15}).by(.15,{position:cc.v3(0,-15),angle:15}).by(.15,{position:cc.v3(0,15),angle:15}).by(.15,{position:cc.v3(0,-15),angle:-15});cc.tween(t._root).repeatForever(e).start()}).start()},__decorate([k(cc.Node)],e.prototype,"mGridsLayout",void 0),__decorate([k({type:cc.Enum(d.EquipmentFormIdx)})],e.prototype,"mDataFormIdx",void 0),__decorate([k(cc.Label)],e.prototype,"mLvLab",void 0),__decorate([k(cc.Prefab)],e.prototype,"mBulletPb",void 0),__decorate([k(cc.Node)],e.prototype,"mFireNode",void 0),__decorate([k()],e.prototype,"mIsFixedPlant",void 0),__decorate([k({type:cc.Label,tooltip:"\u4ef7\u683c",visible:function(){return!this.mIsFixedPlant}})],e.prototype,"mPriceLab",void 0),__decorate([k({type:cc.Sprite,tooltip:"\u906e\u7f69",visible:function(){return!this.mIsFixedPlant}})],e.prototype,"mTriggerBar",void 0),__decorate([k],e.prototype,"mEquipId",void 0),__decorate([w],e)}(cc.Component);n.default=F,cc._RF.pop(),cc._RF.pop()},{}],EventManager:[function(t,e,a){"use strict";cc._RF.push(e,"c5192F0+3xEo7rOK7142Y61","EventManager");var i=e,o=a;cc._RF.push(i,"e4900aUwIxOl7dinMUrvilT","EventManager"),Object.defineProperty(o,"__esModule",{value:!0}),o.EventManager=void 0;var n=function(){function t(){}return Object.defineProperty(t,"instance",{get:function(){return null==t._instance&&(t._instance=new cc.EventTarget),t._instance},enumerable:!1,configurable:!0}),t._instance=null,t}();o.EventManager=n,cc._RF.pop(),cc._RF.pop()},{}],FixedPlantEquip101:[function(t,e,a){"use strict";cc._RF.push(e,"89cc5n0qOhCZrY61GPQWZxu","FixedPlantEquip101");var i=t,o=e,n=a;cc._RF.push(o,"6f533DSM+pNFo5BF7Q2/O3F","FixedPlantEquip101"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("BattleDataProxy"),s=i("BulletPlant101"),c=i("FixedPlantEquipBase"),l=cc._decorator,u=l.ccclass,p=l.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mXiSpine=null,e}return __extends(e,t),e.prototype.openFire=function(){var t=this._atkTargets[0];if(t&&t.isValid){var e=cc.instantiate(this.mBulletPb);r.battleDataProxy.bulletView.addChild(e,1e3);var a=this.getFixedPlantAtkNum(this._fixedPlantData.atk,this._fixedPlantData.atkLevelup);e.getComponent(s.default).initBullet(a,t),e.position=this.getCreatePosition(t)}},e.prototype.getCreatePosition=function(t){if(t.x<=this.node.width/2-275){var e=t.y;return e=e>0?e>640?640:e:e<-358?-358:e,cc.v3(-286,e)}return t.y>0?cc.v3(t.x,640):cc.v3(t.x,-358)},e.prototype.update=function(e){t.prototype.update.call(this,e),this.isPurchased&&(this.mXiSpine.active=r.battleDataProxy.priestZombie.length>0)},__decorate([p(cc.Node)],e.prototype,"mXiSpine",void 0),__decorate([u],e)}(c.default);n.default=h,cc._RF.pop(),cc._RF.pop()},{}],FixedPlantEquip102:[function(t,e,a){"use strict";cc._RF.push(e,"cd706S0ZgpLA5QQqM1+Ce/y","FixedPlantEquip102");var i=t,o=e,n=a;cc._RF.push(o,"acb6e2aHSVNoIR3YAJGIGKi","FixedPlantEquip102"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("BattleDataProxy"),s=i("Util"),c=i("BulletBase"),l=i("SuperBulletPlant6"),u=i("FixedPlantEquipBase"),p=cc._decorator,h=p.ccclass,d=(p.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.openFire=function(){for(var t=Number(this._fixedPlantData.num),e=this._fixedPlantData.time,a=this.getFixedPlantAtkNum(this._fixedPlantData.atk,this._fixedPlantData.atkLevelup),i=0;i<t;++i){var o=r.battleDataProxy.getPathPos(1,i+1),n=cc.instantiate(this.mBulletPb);r.battleDataProxy.bulletView.addChild(n,1e3);var u=s.default.convertToTargetNodeSpace(this.mFireNode,n);n.position=u;var p=null;0==i||2==i?p=cc.v3(0,o.y):1==i&&(p=cc.v3(o.x,99)),n.getComponent(c.default).setAtkPos(p),n.getComponent(l.default).initAtkPos(i+1),n.getComponent(l.default).initFixedPlantBullet(a,e,.5)}},__decorate([h],e)}(u.default));n.default=d,cc._RF.pop(),cc._RF.pop()},{}],FixedPlantEquip103:[function(t,e,a){"use strict";cc._RF.push(e,"d956dDZO/BAR5W60OtsgdbH","FixedPlantEquip103");var i=t,o=e,n=a;cc._RF.push(o,"219a1z4YUxM5Y+OUY54yv+p","FixedPlantEquip103"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("BattleDataProxy"),s=i("Util"),c=i("BulletPlant2"),l=i("FixedPlantEquipBase"),u=cc._decorator,p=u.ccclass,h=(u.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._bulletIdx=0,e._bulletNum=0,e._atkCd=0,e._atkTime=0,e}return __extends(e,t),e.prototype.update=function(e){t.prototype.update.call(this,e),this._bulletNum>0&&(this._atkCd+=e,this._atkCd>=this._atkTime&&(this._atkCd=0,this._bulletNum--,this.addSuperBullet(),this._bulletNum<=0&&(this._superIsAtkFinish=!0)))},e.prototype.addSuperBullet=function(){if(this._atkTime=.05*(Math.floor(1e3*Math.random())%11+10)/10,this._atkTargets=r.battleDataProxy.getPlantAtkTargets(5,this.mEquipId,!1),!(this._atkTargets.length<=0)){var t=this._atkTargets[this._bulletIdx];if(t||(t=this._atkTargets[0]),t&&t.isValid){var e=this.getFixedPlantAtkNum(this._fixedPlantData.atk,this._fixedPlantData.atkLevelup),a=cc.instantiate(this.mBulletPb);r.battleDataProxy.bulletView.addChild(a,1e3);var i=s.default.convertToTargetNodeSpace(this.mFireNode,a);a.position=i,a.getComponent(c.default).initFixedPlantBullet(e,t,1),this._bulletIdx++}}},e.prototype.openFire=function(){this._bulletNum=Number(this._fixedPlantData.num)-1,this._bulletIdx=0,this.addSuperBullet()},__decorate([p],e)}(l.default));n.default=h,cc._RF.pop(),cc._RF.pop()},{}],FixedPlantEquip104:[function(t,e,a){"use strict";cc._RF.push(e,"cf125XKdilMG4SK7QbuOn+Q","FixedPlantEquip104");var i=t,o=e,n=a;cc._RF.push(o,"8cacd9D+d9IZJXp4UaPUJ9p","FixedPlantEquip104"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("BattleDataProxy"),s=i("Util"),c=i("SuperBulletPlant2"),l=i("FixedPlantEquipBase"),u=cc._decorator,p=u.ccclass,h=(u.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.openFire=function(){if(this._atkTarget&&this._atkTarget.isValid){var t=cc.instantiate(this.mBulletPb);r.battleDataProxy.bulletView.addChild(t,1e3);var e=s.default.convertToTargetNodeSpace(this.mFireNode,t);t.position=e;var a=this.getFixedPlantAtkNum(this._fixedPlantData.atk,this._fixedPlantData.atkLevelup);t.getComponent(c.default).initFixedPlantBullet(a,this._atkTarget,Number(this._fixedPlantData.num))}},__decorate([p],e)}(l.default));n.default=h,cc._RF.pop(),cc._RF.pop()},{}],FixedPlantEquip105:[function(t,e,a){"use strict";cc._RF.push(e,"cc4f0hKU8tE8oFqEUVboh0m","FixedPlantEquip105");var i=t,o=e,n=a;cc._RF.push(o,"1992dcY2CVKybBp9s/MtOaP","FixedPlantEquip105"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("BattleDataProxy"),s=i("Util"),c=i("BulletPlant9"),l=i("FixedPlantEquipBase"),u=cc._decorator,p=u.ccclass,h=(u.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.openFire=function(){var t=cc.instantiate(this.mBulletPb);r.battleDataProxy.bulletView.addChild(t,1e3);var e=s.default.convertToTargetNodeSpace(this.mFireNode,t);t.position=e;var a=this.getFixedPlantAtkNum(this._fixedPlantData.atk,this._fixedPlantData.atkLevelup);t.getComponent(c.default).initFixedPlantBullet(a)},__decorate([p],e)}(l.default));n.default=h,cc._RF.pop(),cc._RF.pop()},{}],FixedPlantEquip106:[function(t,e,a){"use strict";cc._RF.push(e,"d8950NUrfZGN6H3OrWmhOIh","FixedPlantEquip106");var i=t,o=e,n=a;cc._RF.push(o,"4a58cLFB7pJsZLBanfe1m41","FixedPlantEquip106"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("BattleDataProxy"),s=i("Util"),c=i("BulletPlant106"),l=i("FixedPlantEquipBase"),u=cc._decorator,p=u.ccclass,h=(u.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.openFire=function(){if(this._atkTarget&&this._atkTarget.isValid){var t=cc.instantiate(this.mBulletPb);r.battleDataProxy.bulletView.addChild(t,1e3);var e=s.default.convertToTargetNodeSpace(this.mFireNode,t);t.position=e;var a=this.getFixedPlantAtkNum(this._fixedPlantData.atk,this._fixedPlantData.atkLevelup);t.getComponent(c.default).initFixedPlantBullet(a,this._atkTarget)}},__decorate([p],e)}(l.default));n.default=h,cc._RF.pop(),cc._RF.pop()},{}],FixedPlantEquip107:[function(t,e,a){"use strict";cc._RF.push(e,"182da0cfQROdYfAC7HVsmHD","FixedPlantEquip107");var i=t,o=e,n=a;cc._RF.push(o,"4fd7aFeIvVBM6ViMK8pb4E9","FixedPlantEquip107"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("BattleDataProxy"),s=i("Util"),c=i("BulletPlant12"),l=i("FixedPlantEquipBase"),u=cc._decorator,p=u.ccclass,h=(u.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._bulletNum=0,e._atkCd=0,e._bulletIdx=0,e}return __extends(e,t),e.prototype.update=function(e){t.prototype.update.call(this,e),this._bulletNum>0&&(this._atkCd+=e,this._atkCd>=.3&&(this._atkCd=0,this._bulletNum--,this.addSuperBullet()))},e.prototype.openFire=function(){this._bulletNum+=Number(this._fixedPlantData.num)-1,this._bulletIdx=0,this.addSuperBullet()},e.prototype.addSuperBullet=function(){if(this._atkTargets=r.battleDataProxy.getPlantAtkTargets(5,this.mEquipId,!1),!(this._atkTargets.length<=0)){var t=this._atkTargets[this._bulletIdx];if(t||(t=this._atkTargets[0]),t&&t.isValid){var e=this.getFixedPlantAtkNum(this._fixedPlantData.atk,this._fixedPlantData.atkLevelup),a=cc.instantiate(this.mBulletPb);r.battleDataProxy.bulletView.addChild(a,1e3);var i=s.default.convertToTargetNodeSpace(this.mFireNode,a);a.position=i,a.getComponent(c.default).initFixedPlantBullet(e,t),this._bulletIdx++}}},__decorate([p],e)}(l.default));n.default=h,cc._RF.pop(),cc._RF.pop()},{}],FixedPlantEquipBase:[function(t,e,a){"use strict";cc._RF.push(e,"900c1dxLPpB8rZjsa5ZRgsz","FixedPlantEquipBase");var i=t,o=e,n=a;cc._RF.push(o,"f5f8ekkp0hKhL0v1h22IKC2","FixedPlantEquipBase"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("EventManager"),s=i("GameEnum"),c=i("DataManager"),l=i("BattleDataProxy"),u=i("UserDataProxy"),p=i("EquipmentItem"),h=cc._decorator,d=h.ccclass,m=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._fixedPlantData=null,e}return __extends(e,t),e.prototype.onLoad=function(){this._equipmentData=s.EquipmentData["form"+this.mDataFormIdx].data,this.level=1,this._root=this.node.getChildByName("root"),this._adNode=this._root.getChildByName("Ad"),this.mCounterBar=this._root.getChildByName("barBg").getChildByName("bar").getComponent(cc.Sprite),this.mCounterBar.node.parent.active=!1,this._fixedPlantData=c.DataManager.instance.eData.data_fixedplant[this.mEquipId],this._superTriggerNum=this._fixedPlantData.triggerNum,this._isPurchased=!1,this.mBoxWhite=this._root.getChildByName("boxWhite"),this.mBoxWhite.active=!1,r.EventManager.instance.on(u.EUserDataEvent.UPDATE_VIDEO_CARD,this.updateVideoIconFrame,this),this.updateVideoIconFrame()},e.prototype.onDestroy=function(){t.prototype.onDestroy.call(this),r.EventManager.instance.off(u.EUserDataEvent.UPDATE_VIDEO_CARD,this.updateVideoIconFrame,this)},Object.defineProperty(e.prototype,"isPurchased",{get:function(){return this._isPurchased},set:function(t){this._isPurchased=t,t&&(this._adNode.active=!1,this.mCounterBar.node.parent.active=this._superTriggerNum>1,this.mCounterBar.fillRange=this._superTriggerCounter/this._superTriggerNum,this.addSleep())},enumerable:!1,configurable:!0}),e.prototype.hideTriggerBar=function(){this.mIsFixedPlant||(this._superTriggerCounter=0,this.mCounterBar.fillRange=this._superTriggerCounter/this._superTriggerNum)},e.prototype.frenzyCollisionEnter=function(){this.getCollisionIsValid()&&(this.initAtkTargets(),this._atkTargets.length>0&&(this.addSuperTriggerCounter()&&this.openFire(),t.prototype.frenzyCollisionEnter.call(this)))},e.prototype.ballCollisionEnter=function(){this.getCollisionIsValid()&&(t.prototype.ballCollisionEnter.call(this),this.addSuperTriggerCounter()&&this.openFire())},e.prototype.addSuperTriggerCounter=function(){var t=!1;if(106==this.mEquipId&&this._atkTargets.length<=0){var e=l.battleDataProxy.getEnemyById(4001);e&&(this._atkTargets.push(e),this._atkTarget=e)}return this._atkTargets.length>0&&(this._superTriggerCounter++,this._superTriggerCounter>=this._superTriggerNum&&(this._superTriggerCounter=0,t=!0,this.addSuperPlantActive()),this._superTriggerNum>1&&(this.mCounterBar.fillRange=this._superTriggerCounter/this._superTriggerNum)),t},e.prototype.setTriggerBarFillRange=function(){},e.prototype.getFixedPlantAtkNum=function(t,e){var a=(t+e*(u.userDataProxy.userData.curWave-1))*l.battleDataProxy.fixedPlantAtkRate;return Math.ceil(a)},__decorate([d],e)}(p.default));n.default=m,cc._RF.pop(),cc._RF.pop()},{}],FlyItemAnimCtrl2:[function(t,e,a){"use strict";cc._RF.push(e,"a2aa8j8ifxCwqI3ydOhX2yh","FlyItemAnimCtrl2");var i=t,o=e,n=a;cc._RF.push(o,"cb334EzJ4JJ/K/YZiZ0zost","FlyItemAnimCtrl2"),Object.defineProperty(n,"__esModule",{value:!0}),n.E_ItemIDType=n.EFlyItemAnimEvent=void 0;var r,s,c=i("HomeEnum"),l=i("NodePoolManager"),u=i("Util"),p=i("AudioManager"),h=i("AppBase"),d=i("EventManager"),m=i("ResUtil"),f=i("AnimUtils"),_=cc._decorator,y=_.ccclass,g=_.property;(r=n.EFlyItemAnimEvent||(n.EFlyItemAnimEvent={})).FLY_ITEM_ANIM="EFlyItemAnimEvent.fly_item_anim",function(t){t[t.GOLD=1]="GOLD",t[t.DIAMOND=2]="DIAMOND",t[t.Star=3]="Star",t[t.EnergySone=4]="EnergySone"}(s=n.E_ItemIDType||(n.E_ItemIDType={}));var v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pFlyItem=null,e.endNode1=null,e.endNode2=null,e.endNode3=null,e.endNode4=null,e}return __extends(e,t),e.prototype.onLoad=function(){d.EventManager.instance.on(r.FLY_ITEM_ANIM,this.flyItemAnim,this)},e.prototype.onDestroy=function(){d.EventManager.instance.off(r.FLY_ITEM_ANIM,this.flyItemAnim,this)},e.prototype.getFlyTargetNode=function(t){return this["endNode"+t]},e.prototype.flyItemAnim=function(t){var e,a=this["endNode"+t.itemId];if(a)e=a.convertToWorldSpaceAR(cc.v2(0,0));else{if(!t.endWorldPos)return;e=t.endWorldPos}var i=u.default.nodeLocalPos(this.node,cc.v3(t.startWorldPos)),o=u.default.nodeLocalPos(this.node,e);t.itemNum>20&&(t.itemNum=20);for(var n=[],r=function(){var e=l.default.instance.getNode(d.pFlyItem);h.topNode.addChild(e),m.ResUtil.loadAsset({bundleName:c.Bundles.GAME,path:t.iconPath,type:cc.SpriteFrame}).then(function(a){e.getComponent(cc.Sprite).spriteFrame=a,e.scale=t.iconScale?t.iconScale:1}).catch(function(){}),e.setPosition(u.default.nodeLocalPos(d.node,cc.v3(t.startWorldPos))),n.push(e)},d=this,_=0;_<t.itemNum;++_)r();t.itemId==s.GOLD?p.AudioManager.instance.playEffectPath("sounds/coin_001",c.Bundles.RES):t.itemId!=s.DIAMOND&&t.itemId!=s.Star||p.AudioManager.instance.playEffectPath("sounds/diamod_001",c.Bundles.RES),f.AnimUtil.flyItemAnim(n,35,i,o,20,function(){n.forEach(function(t){l.default.instance.putNode(t)}),t.onComplete&&t.onComplete()})},__decorate([g(cc.Prefab)],e.prototype,"pFlyItem",void 0),__decorate([g(cc.Node)],e.prototype,"endNode1",void 0),__decorate([g(cc.Node)],e.prototype,"endNode2",void 0),__decorate([g(cc.Node)],e.prototype,"endNode3",void 0),__decorate([g(cc.Node)],e.prototype,"endNode4",void 0),__decorate([y],e)}(cc.Component);n.default=v,cc._RF.pop(),cc._RF.pop()},{}],FlyItemAnimCtrl:[function(t,e,a){"use strict";cc._RF.push(e,"ad320KZiNlDm7k+NhkpHBLe","FlyItemAnimCtrl");var i=t,o=e,n=a;cc._RF.push(o,"19dbcLCnS5G/Z6yKqxCxJw9","FlyItemAnimCtrl"),Object.defineProperty(n,"__esModule",{value:!0}),n.EFlyItemAnimEvent=void 0;var r,s=i("HomeEnum"),c=i("NodePoolManager"),l=i("Util"),u=i("EventManager"),p=i("ResUtil"),h=cc._decorator,d=h.ccclass,m=h.property;(r=n.EFlyItemAnimEvent||(n.EFlyItemAnimEvent={})).FLY_ITEM_ANIM="EFlyItemAnimEvent.fly_item_anim";var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pFlyItem=null,e._layerMap=null,e._targetWorldPosMap=null,e}return __extends(e,t),e.prototype.onLoad=function(){u.EventManager.instance.on(r.FLY_ITEM_ANIM,this.flyItemAnim,this)},e.prototype.onDestroy=function(){u.EventManager.instance.off(r.FLY_ITEM_ANIM,this.flyItemAnim,this)},e.prototype.init=function(t,e){this._layerMap=t,this._targetWorldPosMap=e},e.prototype.flyItemAnim=function(t){if(this.node.activeInHierarchy){var e=this._layerMap.get(t.layerType);if(e&&this._targetWorldPosMap.get(t.itemId))for(var a=[],i=function(){var i=c.default.instance.getNode(o.pFlyItem);e.addChild(i,t.isTop?cc.macro.MAX_ZINDEX:void 0),p.ResUtil.loadAsset({bundleName:s.Bundles.GAME,path:"",type:cc.SpriteFrame}).then(function(t){i.getChildByName("Icon").getComponent(cc.Sprite).spriteFrame=t}).catch(function(){}),i.setPosition(l.default.nodeLocalPos(e,t.startWorldPos)),a.push(i)},o=this,n=0;n<t.itemNum;++n)i()}},__decorate([m(cc.Prefab)],e.prototype,"pFlyItem",void 0),__decorate([d],e)}(cc.Component);n.default=f,cc._RF.pop(),cc._RF.pop()},{}],FragmentBase:[function(t,e,a){"use strict";cc._RF.push(e,"0777fXIvSlOxr24pOtlXa2/","FragmentBase");var i=t,o=e,n=a;cc._RF.push(o,"0f1d9eHuCJCCYACyoUjdWpm","FragmentBase"),Object.defineProperty(n,"__esModule",{value:!0}),n.FragmentBase=void 0;var r=i("ComponentBase"),s=i("EventManager"),c=i("AppProxy"),l=i("SceneManager"),u=cc._decorator,p=u.ccclass,h=(u.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this)},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),l.SceneManager.instance.fragment=this.node,s.EventManager.instance.emit(c.AppEvent.FRAGMENT_CHANGED)},e.prototype.onDisable=function(){l.SceneManager.instance.fragment==this.node&&(l.SceneManager.instance.fragment=null)},__decorate([p],e)}(r.ComponentBase));n.FragmentBase=h,cc._RF.pop(),cc._RF.pop()},{}],FrenzyBar:[function(t,e,a){"use strict";cc._RF.push(e,"f31c0hYs3NO8Y7aOEm8+Ol4","FrenzyBar");var i=t,o=e,n=a;cc._RF.push(o,"bcf2ePVxUtAObKxVAUUFPwo","FrenzyBar"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("ComponentBase"),c=i("EventManager"),l=i("ResUtil"),u=i("GameEnum"),p=i("HomeEnum"),h=i("BattleDataProxy"),d=i("ComboEffect"),m=cc._decorator,f=m.ccclass,_=m.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mBar=null,e.mFrenzyFire=null,e.mRoot=null,e._frenzyTime=0,e._frenzyMaxTime=u.EGameEnum.FRENZY_TIME,e}return __extends(e,t),e.prototype.onLoad=function(){c.EventManager.instance.on(h.EBattleEvent.ACTIVE_FRENZY,this.activeFrenzy,this)},e.prototype.onDestroy=function(){c.EventManager.instance.off(h.EBattleEvent.ACTIVE_FRENZY,this.activeFrenzy,this),t.prototype.onDestroy.call(this)},e.prototype.activeFrenzy=function(){this._frenzyTime=this._frenzyMaxTime,h.battleDataProxy.isActiveFrenzy||r.AudioManager.instance.playBgmPath("sounds/frenzyBgm",p.Bundles.RES),this.addComboEffect()},e.prototype.initFrenzyBar=function(){this._frenzyTime=0,this.mRoot.active=!1,r.AudioManager.instance.playBgmPath("sounds/battleBGM",p.Bundles.RES),h.battleDataProxy.isActiveFrenzy=!1},e.prototype.addComboEffect=function(){var t=this;l.ResUtil.loadAsset({path:"prefabs/effect/ComboEffect",type:cc.Prefab,bundleName:p.Bundles.GAME}).then(function(e){var a=cc.instantiate(e);h.battleDataProxy.mTopUI.addChild(a),a.x=cc.winSize.width/2-a.width/2,a.y=t.node.y+a.height/2,a.getComponent(d.default).play()}).catch(function(t){console.log("error:",t)})},e.prototype.update=function(t){if(h.battleDataProxy.gameState==u.GameState.PLAYING)if(this._frenzyTime<=0)this.initFrenzyBar();else{h.battleDataProxy.isActiveFrenzy=!0,this._frenzyTime-=t,this.mRoot.active=!0;var e=this._frenzyTime/this._frenzyMaxTime;this.mBar.fillRange=e,this.mFrenzyFire.x=this.mBar.node.x-this.mBar.node.width/2+this.mBar.node.width*(1-e)}},__decorate([_(cc.Sprite)],e.prototype,"mBar",void 0),__decorate([_(cc.Node)],e.prototype,"mFrenzyFire",void 0),__decorate([_(cc.Node)],e.prototype,"mRoot",void 0),__decorate([f],e)}(s.ComponentBase);n.default=y,cc._RF.pop(),cc._RF.pop()},{}],GBaseData:[function(t,e,a){"use strict";cc._RF.push(e,"9cb5b+pGLFBkpLx8AthqPIK","GBaseData");var i=e,o=a;cc._RF.push(i,"94b26W1JdNPbpHF6v+PGJlV","GBaseData");var n=__decorate;Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,s=r.ccclass,c=(r.property,function(){function t(){}var e;return e=t,t.prototype.loadfromSave=function(t){for(var a in this)if(null!=t[a]){var i=this[a];i instanceof e?i.loadfromSave(t[a]):this[a]=t[a]}},e=n([s],t)}());o.default=c,cc._RF.pop(),cc._RF.pop()},{}],GMPopup:[function(t,e,a){"use strict";cc._RF.push(e,"615d1hBKqFCApayMrFj+x+5","GMPopup");var i=t,o=e,n=a;cc._RF.push(o,"6709aSjkrdNPbRziOvHPsxR","GMPopup"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("PopupBase"),s=cc._decorator,c=s.ccclass,l=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mItemIDBox=null,e.mItemAmountBox=null,e.mGmEmail=null,e.mActorIdBox=null,e.editBoxJumpStage=null,e.mSkillIdBox=null,e.editBoxTask=null,e.nBtnHomeFunc=null,e.nBtnBattleFunc=null,e.tBattlePlayerActorInvincible=null,e.nBattleToggle=null,e.jumpStage=0,e.jumpTask=0,e}return __extends(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this)},e.prototype.init=function(t){this.node.getChildByName("ItemAdd").active=!t.isBattle,this.node.getChildByName("ActorAdd").active=t.isBattle,this.node.getChildByName("JumpStage").active=!t.isBattle,this.nBattleToggle.active=t.isBattle,this.nBtnBattleFunc.active=t.isBattle,this.nBtnHomeFunc.active=!t.isBattle},e.prototype.onDestroy=function(){t.prototype.onDestroy.call(this)},e.prototype.onClickJumpTask=function(){var t=Number(this.editBoxTask.string);isNaN(t)||0==t||(this.jumpTask=t)},e.prototype.onClickJumpStage=function(){var t=Number(this.editBoxJumpStage.string);isNaN(t)},__decorate([l(cc.EditBox)],e.prototype,"mItemIDBox",void 0),__decorate([l(cc.EditBox)],e.prototype,"mItemAmountBox",void 0),__decorate([l(cc.Node)],e.prototype,"mGmEmail",void 0),__decorate([l(cc.EditBox)],e.prototype,"mActorIdBox",void 0),__decorate([l(cc.EditBox)],e.prototype,"editBoxJumpStage",void 0),__decorate([l(cc.EditBox)],e.prototype,"mSkillIdBox",void 0),__decorate([l(cc.EditBox)],e.prototype,"editBoxTask",void 0),__decorate([l(cc.Node)],e.prototype,"nBtnHomeFunc",void 0),__decorate([l(cc.Node)],e.prototype,"nBtnBattleFunc",void 0),__decorate([l(cc.Toggle)],e.prototype,"tBattlePlayerActorInvincible",void 0),__decorate([l(cc.Node)],e.prototype,"nBattleToggle",void 0),__decorate([c],e)}(r.PopupBase);n.default=u,cc._RF.pop(),cc._RF.pop()},{}],GTBattleView:[function(t,e,a){"use strict";cc._RF.push(e,"240d6SQJ2RPg65dL9ZYwisl","GTBattleView");var i=t,o=e,n=a;cc._RF.push(o,"4e2d4o6IW5LWZy6l9A1Wdnn","GTBattleView"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("EventManager"),s=i("PopupManager"),c=i("Common"),l=i("Simulator"),u=i("GameEnum"),p=i("HomeEnum"),h=i("DataManager"),d=i("BattleDataProxy"),m=i("GuardingDataProxy"),f=i("GTBuff"),_=i("GTEquipment"),y=i("GTMonster"),g=cc._decorator,v=g.ccclass,P=g.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.equipment=null,e.equipmentLayer=null,e.monster=null,e.bosss=[],e.buffNode=null,e._isNextStart=!1,e._currRefreshMonsterTime=0,e}return __extends(e,t),e.prototype.update=function(t){for(var e in d.battleDataProxy.audioFilterInfo)d.battleDataProxy.audioFilterInfo[e].time-=t;if(m.guardingDataProxy.gameState==u.GameState.PLAYING){if(m.guardingDataProxy.keyBoradList.length>0&&cc.Vec3.ZERO.equals(cc.Vec3.ZERO))switch(m.guardingDataProxy.keyBoradList[m.guardingDataProxy.keyBoradList.length-1]){case cc.macro.KEY.a:m.guardingDataProxy.playerNode.x-=500*t,m.guardingDataProxy.playerNode.x<-this.node.width/2+m.guardingDataProxy.playerNode.width/2&&(m.guardingDataProxy.playerNode.x=-this.node.width/2+m.guardingDataProxy.playerNode.width/2);break;case cc.macro.KEY.d:m.guardingDataProxy.playerNode.x+=500*t,m.guardingDataProxy.playerNode.x>this.node.width/2-m.guardingDataProxy.playerNode.width/2&&(m.guardingDataProxy.playerNode.x=this.node.width/2-m.guardingDataProxy.playerNode.width/2)}for(var e in l.Simulator.instance.run(t*d.battleDataProxy.getGameSpd()),d.battleDataProxy.audioFilterInfo)d.battleDataProxy.audioFilterInfo[e].time-=t;if(this._isNextStart){var a=h.DataManager.instance.eData.data_bridgestage[m.guardingDataProxy.currStageId];if(!a)return;this._currRefreshMonsterTime+=t,this._currRefreshMonsterTime>a.time&&(this.addMonster(m.guardingDataProxy.currStageId),m.guardingDataProxy.currStageId+=1)}}},e.prototype.addMonster=function(){var t=this,e=h.DataManager.instance.eData.data_bridgestage[m.guardingDataProxy.currStageId];if(e)if(e.monsterId>0){var a=e.row,i=e.column,o=e.cd,n=50,r=80;1==a&&(r=150),a>3&&(n=30);for(var s=0;s<i;s++)this.scheduleOnce(function(){for(var i=0;i<a;i++){var o=t.monster,s=h.DataManager.instance.eData.datamonster[e.monsterId];if(1!=s.type)for(var c=s.modeName,l=0;l<t.bosss.length;++l)if(c==t.bosss[l].name){o=t.bosss[l];break}var u=cc.instantiate(o);u.parent=t.node;var p=r+i*n,d=Math.min(p,230);u.setPosition(d,800),u.active=!0;var f=u.getComponent(y.default);f&&f.initEnemy(e),m.guardingDataProxy.monsters.push(u)}},o*s)}else{var c=cc.instantiate(this.buffNode);c.parent=m.guardingDataProxy.buffLayer,c.setPosition(175,800),c.getComponent(f.default).init(e),m.guardingDataProxy.skillBoxs.push(c)}},e.prototype.onDisable=function(){r.EventManager.instance.off(m.GuardingDataEvent.UPDATE_EQUIPMENT,this.addEquipemnt,this),r.EventManager.instance.off(m.GuardingDataEvent.KILL_MONSTER,this.killMonster,this),this.node.targetOff(this)},e.prototype.start=function(){this.equipmentLayer.y=1e3,r.EventManager.instance.on(m.GuardingDataEvent.UPDATE_EQUIPMENT,this.addEquipemnt,this),r.EventManager.instance.on(m.GuardingDataEvent.KILL_MONSTER,this.killMonster,this),this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},e.prototype.onTouchStart=function(){},e.prototype.onTouchMove=function(t){if(m.guardingDataProxy.gameState==u.GameState.PLAYING&&-1==m.guardingDataProxy.keyboradList.indexOf(cc.macro.KEY.a)&&-1==m.guardingDataProxy.keyboradList.indexOf(cc.macro.KEY.d)){var e=t.touch.getDelta();m.guardingDataProxy.playerNode.x+=e.x,m.guardingDataProxy.playerNode.x<-this.node.width/2+m.guardingDataProxy.playerNode.width/2&&(m.guardingDataProxy.playerNode.x=-this.node.width/2+m.guardingDataProxy.playerNode.width/2),m.guardingDataProxy.playerNode.x>this.node.width/2-m.guardingDataProxy.playerNode.width/2&&(m.guardingDataProxy.playerNode.x=this.node.width/2-m.guardingDataProxy.playerNode.width/2)}},e.prototype.onTouchEnd=function(){},e.prototype.killMonster=function(){m.guardingDataProxy.currStageId>46&&0==m.guardingDataProxy.monsters.length&&s.PopupManager.instance.show({bundleName:p.Bundles.GuardingTheBridge,path:"prefabs/popups/GTWinPopup",keep:!0})},e.prototype.startGame=function(){l.Simulator.instance.clear(),l.Simulator.instance.setAgentDefaults(50,5,1,.1,0,1e3,new c.Vector2(0,0)),this._currRefreshMonsterTime=0,this._isNextStart=!0,m.guardingDataProxy.skillBoxs=[],m.guardingDataProxy.monsters=[],m.guardingDataProxy.equipments=[],this.initBridge()},e.prototype.addEquipemnt=function(){m.guardingDataProxy.bridgeIndex+=1;var t=h.DataManager.instance.eData.data_bridgeobstacle[m.guardingDataProxy.bridgeIndex];if(t){var e=cc.instantiate(this.equipment);e.parent=this.equipmentLayer,e.setPosition(0,220*(m.guardingDataProxy.bridgeIndex-1)),e.active=!0,e.getComponent(_.default).init(t),m.guardingDataProxy.equipments.push(e)}cc.Tween.stopAllByTarget(this.equipmentLayer),cc.tween(this.equipmentLayer).to(.5,{y:280-220*(m.guardingDataProxy.bridgeIndex-4)}).start()},e.prototype.initBridge=function(){for(var t=this,e=h.DataManager.instance.eData.data_bridgeobstacle,a=function(a){var o=e[a];o&&i.scheduleOnce(function(){var e=cc.instantiate(t.equipment);e.parent=t.equipmentLayer,e.setPosition(0,220*m.guardingDataProxy.bridgeIndex),e.active=!0,e.getComponent(_.default).init(o),m.guardingDataProxy.equipments.push(e),m.guardingDataProxy.bridgeIndex=a},.1*a)},i=this,o=1;o<5;o++)a(o);this.scheduleOnce(function(){cc.tween(t.equipmentLayer).to(1,{y:280}).start()},.5)},__decorate([P(cc.Node)],e.prototype,"equipment",void 0),__decorate([P(cc.Node)],e.prototype,"equipmentLayer",void 0),__decorate([P(cc.Node)],e.prototype,"monster",void 0),__decorate([P([cc.Node])],e.prototype,"bosss",void 0),__decorate([P(cc.Node)],e.prototype,"buffNode",void 0),__decorate([v],e)}(cc.Component);n.default=b,cc._RF.pop(),cc._RF.pop()},{}],GTBoss:[function(t,e,a){"use strict";cc._RF.push(e,"721a6zw5WJKL6D2W5LlTl4c","GTBoss");var i=t,o=e,n=a;cc._RF.push(o,"04ab30mnxFFvbAWaRLhYZBD","GTBoss"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("GTMonster"),s=i("GTSpAnimCtrl"),c=cc._decorator,l=c.ccclass,u=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAnimCtrl=null,e}return __extends(e,t),e.prototype.playMoveAnim=function(){this.spAnimCtrl.playAnim("move",1,!0)},e.prototype.playAtkAnim=function(t){this.spAnimCtrl.playAnim("atk",1,!1,function(){t&&t()})},e.prototype.playIdleAnim=function(){this.spAnimCtrl.playAnim("move",1,!0)},e.prototype.playDeadAnim=function(t){this.spAnimCtrl.playAnim("die",1,!1,function(){t&&t()})},e.prototype.setAnimScaleX=function(t){var e=Math.abs(this.spAnimCtrl.node.scale);this.spAnimCtrl.node.scaleX=t?e:-e},e.prototype.hit=function(){var t=this;this.spAnimCtrl.node.color=cc.Color.RED,this.scheduleOnce(function(){t.spAnimCtrl.node.color=cc.Color.WHITE},.2)},__decorate([u(s.default)],e.prototype,"spAnimCtrl",void 0),__decorate([l],e)}(r.default);n.default=p,cc._RF.pop(),cc._RF.pop()},{}],GTBtnCtl:[function(t,e,a){"use strict";cc._RF.push(e,"65dedEow85J2YHHtkukMmni","GTBtnCtl");var i=t,o=e,n=a;cc._RF.push(o,"dc19d74VglLzZ/pA5m0cqPT","GTBtnCtl"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("EventManager"),s=i("PopupManager"),c=i("SceneManager"),l=i("AdsMgr"),u=i("HomeEnum"),p=i("DataManager"),h=i("GuardingDataProxy"),d=i("UserDataProxy"),m=i("Util"),f=i("GameUIManager"),_=cc._decorator,y=_.ccclass,g=(_.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onEnable=function(){this.updateView(),r.EventManager.instance.on(u.EHomeEvent.CHAPTER_SELECT,this.updateUnlock,this),r.EventManager.instance.on(u.EHomeEvent.UPDATE_MINI_BTN_VIEW,this.updateView,this)},e.prototype.onDisable=function(){r.EventManager.instance.off(u.EHomeEvent.CHAPTER_SELECT,this.updateUnlock,this),r.EventManager.instance.off(u.EHomeEvent.UPDATE_MINI_BTN_VIEW,this.updateView,this)},e.prototype.updateView=function(){p.DataManager.instance.isSubGameOpen(u.ESubGameSwitch.GT)?(this.node.active=!0,this.updateUnlock()):this.node.active=!1},e.prototype.updateUnlock=function(){var t=Number(p.DataManager.instance.eData.datapara[901].num);this.node.getChildByName("cdTime").active=!1,d.userDataProxy.userData.passChapter>=t?(this.updateTime(),m.default.setSpriteNormalMaterial(this.node.getChildByName("icon_wujing").getComponent(cc.Sprite))):m.default.setSpriteGrayMaterial(this.node.getChildByName("icon_wujing").getComponent(cc.Sprite)),this.node.getChildByName("txt").getComponent(cc.Label).string="\u5bb6\u56ed\u5b88\u536b",this.node.getChildByName("tipLabel").active=d.userDataProxy.userData.passChapter<t,this.node.getChildByName("tipLabel").getComponent(cc.Label).string="\u901a\u8fc7\u7b2c"+t+"\u7ae0\u89e3\u9501"},e.prototype.updateTime=function(){var t=this,e=this.node.getChildByName("cdTime");e.active=!1;var a=h.guardingDataProxy.GuardingData.btnStartTime;if(a>0){var i=6e4*Number(p.DataManager.instance.eData.datapara[902].num),o=e.getComponent(cc.Label),n=m.default.getTimeLeftTime(a,i);o.string=m.default.formatTimeMS(n,3),this.schedule(function(){(n=m.default.getTimeLeftTime(a,i))<=0&&(t.unscheduleAllCallbacks(),h.guardingDataProxy.GuardingData.btnStartTime=0,t.node.getChildByName("ad").active=!1,e.active=!1),o.string=m.default.formatTimeMS(n,3)},1),e.active=!0}else e.active=!1;this.node.getChildByName("ad").active=a>0},e.prototype.onEnterMiniGame=function(){var t=this,e=Number(p.DataManager.instance.eData.datapara[901].num);d.userDataProxy.userData.passChapter>=e?h.guardingDataProxy.GuardingData.btnStartTime>0?l.default.showVideoAds({id:1,eventId:"gt_game_enter",success:function(){t.enterGame()},fail:function(){},error:function(t){cc.log(t)}},!0):this.enterGame():f.gameUIMgr.showTips("\u7b2c"+e+"\u7ae0\u89e3\u9501!")},e.prototype.enterGame=function(){s.PopupManager.instance.removeAll(),c.SceneManager.instance.runScene("GuardingTheBridge","res_GuardingTheBridge")},__decorate([y],e)}(cc.Component));n.default=g,cc._RF.pop(),cc._RF.pop()},{}],GTBuff:[function(t,e,a){"use strict";cc._RF.push(e,"dd5b4SSA4lBhqxArJJjNukT","GTBuff");var i=t,o=e,n=a;cc._RF.push(o,"3b76eod2zNNDpSr9xM8QvuJ","GTBuff"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("GameUIManager"),s=i("SimplyRectCollider"),c=i("SimplyCollisionDetector"),l=i("GameEnum"),u=i("GuardingDataProxy"),p=i("GTGameMgr"),h=i("GTPlayerCtl"),d=cc._decorator,m=d.ccclass,f=d.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mColliderNode=null,e.redNode=null,e.blueNode=null,e.nameLabel=null,e.numLabel=null,e._curShowNum=0,e._changeNum=1,e._curChangeNum=0,e._difficulty=1,e._atkNum=0,e._bridgeStage=null,e._isDead=!1,e._startY=800,e._endMaxY=-1e3,e._moveSpeed=cc.v3(0,0),e._endScale=1.3,e}return __extends(e,t),e.prototype.update=function(t){if(u.guardingDataProxy.gameState==l.GameState.PLAYING&&!this._isDead){this.node.position=this.node.position.add(this._moveSpeed.mul(t)),this.node.zIndex=-this.node.y;var e=Math.max(0,Math.min(1,(this._startY-this.node.y)/(this._startY-this._endMaxY))),a=e*e,i=1+(this._endScale-1)*a;if(this.node.scale=i,this.node.y<380){var o=u.guardingDataProxy.playerNode.getChildByName("Collider").getComponent(s.default),n=this.mColliderNode.getComponent(s.default);if(o&&n&&c.default.isCollisionRectToRect(o.rect,n.rect))return void this.dealDie(!0)}this.node.y<this._endMaxY&&this.dealDie(!1)}},e.prototype.init=function(t){this._bridgeStage=t,this._curShowNum=t.num1,this._changeNum=t.num2,this._difficulty=t.num3,this._moveSpeed=cc.v3(0,-t.speed),this._isDead=!1;var e="\u653b\u51fb";2==t.buffType?e="\u89d2\u8272":3==t.buffType?e="\u653b\u901f":4==t.buffType&&(e="\u66b4\u51fb"),this.nameLabel.string=e,this.updateNum(),this.node.active=!0},e.prototype.updateNum=function(){1==this._bridgeStage.type?this.numLabel.string=(this._curShowNum>=0?"+":"-")+Math.abs(this._curShowNum):this.numLabel.string=(this._curShowNum>=0?"x":"\xf7")+Math.abs(this._curShowNum),this.blueNode.active=this._curShowNum>=0,this.redNode.active=this._curShowNum<0},e.prototype.beAttack=function(){this._curChangeNum>=this._changeNum||(this._atkNum+=1,this._atkNum>=this._difficulty&&(this._curShowNum+=Math.floor(this._atkNum/this._difficulty),this._curChangeNum+=Math.floor(this._atkNum/this._difficulty),this._atkNum=0,this.updateNum()))},e.prototype.dealDie=function(t){var e=this;if(!this._isDead){if(this._isDead=!0,t){var a="";1==this._bridgeStage.buffType?(1==this._bridgeStage.type?(u.guardingDataProxy.attackNum+=this._curShowNum,this._curShowNum>0?a="\u653b\u51fb+"+this._curShowNum:this._curShowNum<0&&(a="\u653b\u51fb-"+Math.abs(this._curShowNum))):this._curShowNum<0?(u.guardingDataProxy.attackNum=u.guardingDataProxy.attackNum/Math.abs(this._curShowNum),a="\u653b\u51fb\xf7"+Math.abs(this._curShowNum)):this._curShowNum>0&&(u.guardingDataProxy.attackNum=u.guardingDataProxy.attackNum*this._curShowNum,a="\u653b\u51fbx"+this._curShowNum),u.guardingDataProxy.attackNum<1&&(u.guardingDataProxy.attackNum=1)):2==this._bridgeStage.buffType?this._curShowNum>0?(u.guardingDataProxy.playerNode.getComponent(h.default).addPlay(this._curShowNum),a="\u89d2\u8272+"+this._curShowNum):this._curShowNum<0&&(u.guardingDataProxy.playerNode.getComponent(h.default).removePlay(Math.abs(this._curShowNum)),a="\u89d2\u8272-"+Math.abs(this._curShowNum)):3==this._bridgeStage.buffType?(1==this._bridgeStage.type?(this._curShowNum>0?u.guardingDataProxy.attackSpeed=u.guardingDataProxy.attackSpeed/this._curShowNum:u.guardingDataProxy.attackSpeed=u.guardingDataProxy.attackSpeed*Math.abs(this._curShowNum),this._curShowNum>0?a="\u653b\u901f+"+this._curShowNum:this._curShowNum<0&&(a="\u653b\u901f-"+Math.abs(this._curShowNum))):this._curShowNum<0?(u.guardingDataProxy.attackSpeed=u.guardingDataProxy.attackSpeed*Math.abs(this._curShowNum),a="\u653b\u901f\xf7"+Math.abs(this._curShowNum)):this._curShowNum>0&&(u.guardingDataProxy.attackSpeed=u.guardingDataProxy.attackSpeed/Math.abs(this._curShowNum),a="\u653b\u901fx"+this._curShowNum),u.guardingDataProxy.attackSpeed<u.guardingDataProxy.attackSpeedMax&&(u.guardingDataProxy.attackSpeed=u.guardingDataProxy.attackSpeedMax)):4==this._bridgeStage.buffType&&(1==this._bridgeStage.type?(u.guardingDataProxy.attackCrit+=this._curShowNum,this._curShowNum>0?a="\u66b4\u51fb+"+this._curShowNum:this._curShowNum<0&&(a="\u66b4\u51fb-"+Math.abs(this._curShowNum))):this._curShowNum<0?(u.guardingDataProxy.attackCrit=u.guardingDataProxy.attackCrit/Math.abs(this._curShowNum),a="\u66b4\u51fb\xf7"+Math.abs(this._curShowNum)):this._curShowNum>0&&(u.guardingDataProxy.attackCrit=u.guardingDataProxy.attackCrit*this._curShowNum,a="\u66b4\u51fbx"+this._curShowNum)),""!=a&&r.gameUIMgr.showTips(a),p.default.instance.setEffectEquipUpgrade()}cc.tween(this.node).to(.1,{scale:1.2}).to(.1,{opacity:0}).call(function(){var t=u.guardingDataProxy.skillBoxs.indexOf(e.node);-1!=t&&u.guardingDataProxy.skillBoxs.splice(t,1),e.node.destroy(),e.node.removeFromParent()}).start()}},__decorate([f(cc.Node)],e.prototype,"mColliderNode",void 0),__decorate([f(cc.Node)],e.prototype,"redNode",void 0),__decorate([f(cc.Node)],e.prototype,"blueNode",void 0),__decorate([f(cc.Label)],e.prototype,"nameLabel",void 0),__decorate([f(cc.Label)],e.prototype,"numLabel",void 0),__decorate([m],e)}(cc.Component);n.default=_,cc._RF.pop(),cc._RF.pop()},{}],GTBulletBase:[function(t,e,a){"use strict";cc._RF.push(e,"128c1Qnr8BCo4qMY/tAXOvS","GTBulletBase");var i=e,o=a;cc._RF.push(i,"935faEJJzxCD4wplWSguqKk","GTBulletBase"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,r=n.ccclass,s=(n.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._moveSpeed=cc.v3(0,1e3),e._penetrate=1,e._endMaxY=0,e}return __extends(e,t),e.prototype.init=function(t){t&&(this.roleData=t,this._penetrate=t.penetrate)},e.prototype.onCollisionEnter=function(){},e.prototype.update=function(){},e.prototype.recycle=function(t){void 0===t&&(t=!0)},__decorate([r],e)}(cc.Component));o.default=s,cc._RF.pop(),cc._RF.pop()},{}],GTBulletHit:[function(t,e,a){"use strict";cc._RF.push(e,"373cdMphRhERKGiiFsNppNo","GTBulletHit");var i=t,o=e,n=a;cc._RF.push(o,"37f07D4CH5HyL2glQP5nMUi","GTBulletHit"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("EnemyBase"),s=i("AnimationCfgMgr"),c=i("AnimationCtrl"),l=cc._decorator,u=l.ccclass,p=l.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mIsSpAni=!1,e.mAnimCtrl=null,e.mTargetNode=null,e._bulletId=0,e.otherBullets=["CWzidan1_2","CWzidan8_2","CWzidan11_2"],e}return __extends(e,t),e.prototype.initBulletHit=function(t,e){var a=this,i=Number(t.match(/\d+/)[0]);if(this._bulletId=i,this.mAnimCtrl.clearAnimEvent(),this.otherBullets.includes(t))this.node.scale=.45,this.mAnimCtrl.loadAnimation(s.AnimationCfgMgr.instance.getGTBulletHit(t)).then(function(){a.node&&a.node.isValid&&a.mAnimCtrl.playAnim("liekai2",!1,function(){var t;a.mTargetNode&&a.mTargetNode.isValid&&(null===(t=a.mTargetNode.getComponent(r.default))||void 0===t||t.removeHitEffectNode(a.node,a._bulletId)),e&&e()},null,3.5)});else{this.node.scale=1;var o=t.includes("CW");this.mAnimCtrl.loadAtlasAnimation(s.AnimationCfgMgr.instance.getBulletHitCfg(i,1,o)).then(function(){a.node&&a.node.isValid&&a.mAnimCtrl.playAnim("bulletHit",!1,function(){var t;a.mTargetNode&&a.mTargetNode.isValid&&(null===(t=a.mTargetNode.getComponent(r.default))||void 0===t||t.removeHitEffectNode(a.node,a._bulletId)),e&&e()},null,3.5)})}},__decorate([p()],e.prototype,"mIsSpAni",void 0),__decorate([p({type:c.default,tooltip:"\u662f\u5426\u5c55\u793aImg",visible:function(){return!this.mIsSpAni}})],e.prototype,"mAnimCtrl",void 0),__decorate([u],e)}(cc.Component);n.default=h,cc._RF.pop(),cc._RF.pop()},{}],GTBullet:[function(t,e,a){"use strict";cc._RF.push(e,"6b3c0KU+ndM+5QkwjFox42b","GTBullet");var i=t,o=e,n=a;cc._RF.push(o,"a8c61gievRLLqtcOxe1vLkR","GTBullet"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("ResUtil"),c=i("SimplyCircleCollider"),l=i("SimplyRectCollider"),u=i("SimplyCollisionDetector"),p=i("GameEnum"),h=i("HomeEnum"),d=i("GuardingDataProxy"),m=i("GTBuff"),f=i("GTBulletBase"),_=i("GTEquipment"),y=i("GTGameMgr"),g=i("GTMonster"),v=i("GTPoolMgr"),P=cc._decorator,b=P.ccclass,D=(P.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._colliderNode=null,e._markingnodes=[],e}return __extends(e,t),e.prototype.onLoad=function(){0==this._endMaxY&&(this._endMaxY=cc.winSize.height/2+100),this._colliderNode||(this._colliderNode=this.node.getChildByName("collider"))},e.prototype.updateImg=function(){},e.prototype.lateUpdate=function(t){d.guardingDataProxy.gameState==p.GameState.PLAYING&&(this.node.position=this.node.position.add(this._moveSpeed.mul(t)),this.node.y>this._endMaxY&&this.recycle(!1))},e.prototype.update=function(){if(d.guardingDataProxy.gameState==p.GameState.PLAYING&&this._colliderNode){var t=d.guardingDataProxy.monsters;if(t.length>0)for(var e=void 0,a=void 0,i=void 0,o=t.length-1;o>=0;o--)if(a=(e=t[o]).getChildByName("Collider").getComponent(c.default),i=this._colliderNode.getComponent(c.default),a&&i&&u.default.isCollisionCircleToCircle(i.circle,a.circle))return this._markingnodes.length>0&&this._markingnodes.indexOf(e.uuid)>-1?void 0:void this.myCollisionEnter(this.node,e);if(this.node.x>0){var n=d.guardingDataProxy.skillBoxs;if(n.length>0){e=void 0;var r=void 0;for(i=void 0,o=n.length-1;o>=0;o--)if(r=(e=n[o]).getChildByName("Collider").getComponent(l.default),i=this._colliderNode.getComponent(c.default),r&&i&&u.default.isCollisionRectToCircle(r.rect,i.circle))return this._markingnodes.length>0&&this._markingnodes.indexOf(e.uuid)>-1?void 0:void this.myCollisionEnter(this.node,e)}}if(this.node.x<0){var s=d.guardingDataProxy.equipments;for(e=void 0,r=void 0,i=void 0,o=s.length-1;o>=0;o--)if(r=(e=s[o]).getChildByName("Collider").getComponent(l.default),i=this._colliderNode.getComponent(c.default),r&&i&&u.default.isCollisionRectToCircle(r.rect,i.circle))return this._markingnodes.length>0&&this._markingnodes.indexOf(e.uuid)>-1?void 0:void this.myCollisionEnter(this.node,e)}}},e.prototype.myCollisionEnter=function(t,e){this.onCollisionEnter(t,e),y.default.instance.hitEffect(this.node.position,d.guardingDataProxy.curBulletImgsrc),r.AudioManager.instance.playEffectPath("sounds/hit",h.Bundles.GuardingTheBridge);var a=Math.floor(d.guardingDataProxy.attackNum),i=!1;if(d.guardingDataProxy.attackCrit>Math.random()&&(a=Math.floor(2*d.guardingDataProxy.attackNum),i=!0),e.name.includes("boss")||e.name.includes("zombie")||e.name.includes("Monster")){var o=e.getComponent(g.default);o&&o.beAttack(a,i)}else switch(e.name){case"BuffNode":var n=e.getComponent(m.default);n&&n.beAttack();break;case"Equipment":var s=e.getComponent(_.default);s&&s.beAttack(a,i)}},e.prototype.init=function(){this._penetrate=d.guardingDataProxy.bPenetrate,this._markingnodes=[],this._moveSpeed.y=d.guardingDataProxy.bulletSpeed,this.resetImg()},e.prototype.resetImg=function(){var t=this;s.ResUtil.loadAsset({bundleName:h.Bundles.GuardingTheBridge,path:"textrues/"+d.guardingDataProxy.curBulletImgsrc,type:cc.SpriteFrame}).then(function(e){t.node.getComponent(cc.Sprite).spriteFrame=e,t.node.active=!0,"xiandao_3"==d.guardingDataProxy.curBulletImgsrc||"modao_3"==d.guardingDataProxy.curBulletImgsrc?t.node.scale=.5:"xiandao_2"==d.guardingDataProxy.curBulletImgsrc||"modao_2"==d.guardingDataProxy.curBulletImgsrc?t.node.scale=.5:t.node.scale=.7})},e.prototype.onCollisionEnter=function(t,e){this._markingnodes.push(e.uuid),this._penetrate--,this._penetrate<=0&&this.recycle()},e.prototype.recycle=function(t){void 0===t&&(t=!0),this._markingnodes=[],v.GTPoolMgr.Inst.put("gt_bullet",this.node)},__decorate([b],e)}(f.default));n.default=D,cc._RF.pop(),cc._RF.pop()},{}],GTDZBullet:[function(t,e,a){"use strict";cc._RF.push(e,"45310VBUh9EVZPwZvJxf7im","GTDZBullet");var i=t,o=e,n=a;cc._RF.push(o,"065aeRjIipDoZUbSF/IVI+A","GTDZBullet"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("GameEnum"),s=i("GuardingDataProxy"),c=i("GTBulletBase"),l=i("SimplyCircleCollider"),u=i("SimplyCollisionDetector"),p=i("GTMonster"),h=i("SimplyRectCollider"),d=i("GTGameMgr"),m=cc._decorator,f=m.ccclass,_=(m.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._colliderNode=null,e._damage=0,e._direction=cc.v3(0,1,0),e._speed=1e3,e._markingnodes=[],e}return __extends(e,t),e.prototype.onLoad=function(){0==this._endMaxY&&(this._endMaxY=cc.winSize.height/2+100),this._colliderNode||(this._colliderNode=this.node.getChildByName("Collider"))},e.prototype.init=function(e){t.prototype.init.call(this,e),this._markingnodes=[],e&&(this._damage=e.damage||0,this._direction=e.direction||cc.v3(0,1,0),this._speed=e.speed||800,this._penetrate=e.penetrate||1),this.node.active=!0},e.prototype.update=function(t){if(s.guardingDataProxy.gameState==r.GameState.PLAYING){var e=this._direction.mul(this._speed*t);this.node.position=this.node.position.add(e),this.node.y>this._endMaxY||this.node.x>cc.winSize.width/2+100||this.node.x<-cc.winSize.width/2-100?this.recycle(!1):this.checkCollision()}},e.prototype.checkCollision=function(){if(this._colliderNode){var t=s.guardingDataProxy.monsters;if(t.length>0)for(var e=void 0,a=void 0,i=void 0,o=void 0,n=t.length-1;n>=0;n--)if(i=null==(a=(e=t[n]).getChildByName("Collider"))?void 0:a.getComponent(l.default),o=this._colliderNode.getComponent(h.default),i&&o&&u.default.isCollisionRectToCircle(o.rect,i.circle)){if(this._markingnodes.length>0&&this._markingnodes.indexOf(e.uuid)>-1)return;return void this.onHitTarget(e)}}},e.prototype.onHitTarget=function(t){this._markingnodes.push(t.uuid),d.default.instance.hitEffect(this.node.position,"zidan12");var e=t.getComponent(p.default);e&&e.beAttack(this._damage),this._penetrate--,this._penetrate<=0&&this.recycle()},e.prototype.recycle=function(t){void 0===t&&(t=!0),this._markingnodes=[],this.node.active=!1,this.node.removeFromParent(),this.node.destroy()},__decorate([f],e)}(c.default));n.default=_,cc._RF.pop(),cc._RF.pop()},{}],GTDaoZhang:[function(t,e,a){"use strict";cc._RF.push(e,"862d0gC/6BAKboBHVT/q6pG","GTDaoZhang");var i=t,o=e,n=a;cc._RF.push(o,"72a96KhBRJEuLrmJPJwDgrP","GTDaoZhang"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("GameEnum"),c=i("HomeEnum"),l=i("DataManager"),u=i("GuardingDataProxy"),p=i("GTDZBullet"),h=cc._decorator,d=h.ccclass,m=h.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mBullet=null,e._skillInfo=null,e._bulletAtk=0,e._atkSpeed=0,e._atkBulletNum=0,e._lifeTime=10,e._attackSpeed=.2,e._isStarShoot=!1,e}return __extends(e,t),e.prototype.update=function(t){u.guardingDataProxy.gameState==s.GameState.PLAYING&&this._isStarShoot&&(this._attackSpeed-=t,this._attackSpeed<=0&&(this._attackSpeed=this._atkSpeed,this.shoot()),this._lifeTime-=t,this._lifeTime<=0&&this.recycle())},e.prototype.playSkill=function(){this._skillInfo=l.DataManager.instance.eData.data_bridgeobstacle[20];var t=this._skillInfo.parm.split("|");this._atkBulletNum=Number(t[0]),this._bulletAtk=Number(t[1]),this._lifeTime=Number(t[2]),this._atkSpeed=Number(t[3]),this._isStarShoot=!0},e.prototype.shoot=function(){var t=this._atkBulletNum,e=150/(t-1);r.AudioManager.instance.playEffectPath("sounds/sword",c.Bundles.GuardingTheBridge);for(var a=0;a<t;a++){var i=e*a-75,o=i*Math.PI/180,n=cc.instantiate(this.mBullet);n.parent=u.guardingDataProxy.bulletLayout;var s=u.guardingDataProxy.bulletLayout.convertToNodeSpaceAR(this.node.convertToWorldSpaceAR(cc.v2(0,0)));n.setPosition(s.x,s.y);var l=n.getComponent(p.default);if(l){var h=cc.v3(Math.sin(o),Math.cos(o),0);l.init({damage:this._bulletAtk,direction:h,speed:800,penetrate:999})}n.angle=-i}},e.prototype.recycle=function(){this._isStarShoot=!1,this.node.removeFromParent(),this.node.destroy()},__decorate([m(cc.Node)],e.prototype,"mBullet",void 0),__decorate([d],e)}(cc.Component);n.default=f,cc._RF.pop(),cc._RF.pop()},{}],GTEquipment:[function(t,e,a){"use strict";cc._RF.push(e,"e148aYJpXZJMIHaKb++TX5k","GTEquipment");var i=t,o=e,n=a;cc._RF.push(o,"052d8+5spxMkat4XNlvrZ9y","GTEquipment"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("EventManager"),c=i("ResUtil"),l=i("GameEnum"),u=i("HomeEnum"),p=i("GuardingDataProxy"),h=i("GTGameMgr"),d=i("GTSpAnimCtrl"),m=cc._decorator,f=m.ccclass,_=m.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mColliderNode=null,e.mhpLabel=null,e.iconSp=null,e.nGuanzi=null,e.spGuanzi=null,e._isDead=!1,e._hp=0,e._equipmentData=null,e._isPlayHitIng=!1,e}return __extends(e,t),e.prototype.lateupdate=function(){p.guardingDataProxy.gameState==l.GameState.PLAYING&&(this.node.zIndex=-this.node.y)},e.prototype.init=function(t){var e=this;this._equipmentData=t,this.spGuanzi.node.active=!1,"lianhua"!=t.icon?c.ResUtil.loadAsset({bundleName:u.Bundles.GuardingTheBridge,path:"textrues/"+t.icon,type:cc.SpriteFrame}).then(function(t){e.iconSp&&e.iconSp.isValid&&(e.iconSp.spriteFrame=t,e.node.getChildByName("wupinfaguang").active=!0)}):(this.iconSp.node.active=!1,this.node.getChildByName("wupinfaguang").active=!1),this._hp=t.hp,this.updateHp()},e.prototype.updateHp=function(){this.mhpLabel.string=this._hp.toString()},e.prototype.beAttack=function(t,e){return t*=1,this.subHp(t),e&&this.showHurtLab(t),this._hp<=0?(this.dealDie(),!0):(this.hit(),!1)},e.prototype.showHurtLab=function(t){var e=p.guardingDataProxy.effectLayer.convertToNodeSpaceAR(this.node.parent.convertToWorldSpaceAR(this.node.position));h.default.instance.showHitNum(t,e)},e.prototype.subHp=function(t){isNaN(t)&&(t=1),this._hp-=t,isNaN(this._hp)&&(this._hp=10),this._hp<0&&(this._hp=0),this.updateHp()},e.prototype.hit=function(){var t=this;this._isPlayHitIng||(this._isPlayHitIng=!0,cc.tween(this.node).to(.1,{scale:1.1}).to(.1,{scale:1}).call(function(){t._isPlayHitIng=!1}).start())},e.prototype.dealDie=function(){var t=this;this._isDead||(this._isDead=!0,this.nGuanzi.active=!1,this.spGuanzi.node.active=!0,r.AudioManager.instance.playEffectPath("sounds/Knock",u.Bundles.GuardingTheBridge),this.spGuanzi.playAnim("broken",1,!1,function(){if("lianhua"!=t._equipmentData.icon){var e=p.guardingDataProxy.effectLayer.convertToNodeSpaceAR(t.node.parent.convertToWorldSpaceAR(t.node.position));h.default.instance.getEquipementEffect(e,t._equipmentData)}var a=p.guardingDataProxy.equipments.indexOf(t.node);-1!=a&&p.guardingDataProxy.equipments.splice(a,1),t.node.destroy(),t.node.removeFromParent(),"lianhua"!=t._equipmentData.icon?setTimeout(function(){s.EventManager.instance.emit(p.GuardingDataEvent.UPDATE_EQUIPMENT)},1e3):s.EventManager.instance.emit(p.GuardingDataEvent.UPDATE_EQUIPMENT)}))},__decorate([_(cc.Node)],e.prototype,"mColliderNode",void 0),__decorate([_(cc.Label)],e.prototype,"mhpLabel",void 0),__decorate([_(cc.Sprite)],e.prototype,"iconSp",void 0),__decorate([_(cc.Node)],e.prototype,"nGuanzi",void 0),__decorate([_(d.default)],e.prototype,"spGuanzi",void 0),__decorate([f],e)}(cc.Component);n.default=y,cc._RF.pop(),cc._RF.pop()},{}],GTGameMgr:[function(t,e,a){"use strict";cc._RF.push(e,"ee6a9wQjVhDNISX4Yu5s+r+","GTGameMgr");var i=t,o=e,n=a;cc._RF.push(o,"5ec4aYR+MVBLZcRFeTlgc1k","GTGameMgr"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("GameUIManager"),s=i("AudioManager"),c=i("CommonUtil"),l=i("ResUtil"),u=i("HomeEnum"),p=i("GuardingDataProxy"),h=i("GTBulletHit"),d=i("GTPoolMgr"),m=cc._decorator,f=m.ccclass,_=(m.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var a;return __extends(e,t),a=e,Object.defineProperty(e,"instance",{get:function(){return null==this._instance&&(this._instance=new a),this._instance},enumerable:!1,configurable:!0}),e.prototype.showHitNum=function(t,e){var a=d.GTPoolMgr.Inst.get("gtHitNum");if(a){a.parent=p.guardingDataProxy.effectLayer;var i=100*(Math.random()-.5);e.x+=i,a.setPosition(e);var o=a.getChildByName("num").getComponent(cc.Label);o&&(o.string=t.toString()),a.scale=0,a.opacity=255,a.active=!0;var n=50*(Math.random()-.5),r=cc.v3(e.x+n,e.y+50,e.z);cc.tween(a).parallel(cc.tween().to(.3,{scale:.8},{easing:"backOut"}),cc.tween().to(.8,{position:r},{easing:"sineOut"}),cc.tween().delay(.3).to(.5,{opacity:0},{easing:"sineIn"})).call(function(){a.active=!1,d.GTPoolMgr.Inst.put("gtHitNum",a)}).start()}else console.warn("gtHitNum\u9884\u5236\u4f53\u672a\u627e\u5230\uff0c\u8bf7\u68c0\u67e5\u5bf9\u8c61\u6c60\u521d\u59cb\u5316")},e.prototype.hitEffect=function(t,e){var a=d.GTPoolMgr.Inst.get("gtHitEeffect");a&&(a.parent=p.guardingDataProxy.effectLayer,a.setPosition(t),a.active=!0,a.getComponent(h.default).initBulletHit(e,function(){a.active=!1,d.GTPoolMgr.Inst.put("gtHitEeffect",a)}))},e.prototype.getEquipementEffect=function(t,e){var a=this;l.ResUtil.loadAsset({bundleName:u.Bundles.GuardingTheBridge,path:"prefabs/EquiEffect",type:cc.Prefab}).then(function(i){var o=cc.instantiate(i);o.parent=p.guardingDataProxy.effectLayer,o.setPosition(t),l.ResUtil.loadAsset({bundleName:u.Bundles.GuardingTheBridge,path:"textrues/"+e.icon,type:cc.SpriteFrame}).then(function(t){o.getComponent(cc.Sprite).spriteFrame=t,o.active=!0;var i=p.guardingDataProxy.playerNode?p.guardingDataProxy.playerNode.getPosition():cc.v3(0,0,0);cc.tween(o).parallel(cc.tween().to(.2,{scaleX:-1}).to(.2,{scaleX:1}),cc.tween().to(.2,{scaleX:-1}).to(.2,{scaleX:1})).delay(.2).parallel(cc.tween().to(.2,{position:i},{easing:"sineIn"}),cc.tween().delay(.2).to(.1,{opacity:0},{easing:"sineIn"})).call(function(){o&&o.isValid&&(o.destroy(),a.setEffectEquipUpgrade()),a.getEqupentAtt(e)}).start()})})},e.prototype.getEqupentAtt=function(t){if(""!=t.des&&r.gameUIMgr.showTips(t.des),20!=t.id){if(t.role&&p.guardingDataProxy.playerNode.getComponent("GTPlayerCtl").addPlay(t.role),t.atk&&(p.guardingDataProxy.attackNum+=t.atk),t.speed&&(p.guardingDataProxy.attackSpeed=p.guardingDataProxy.attackSpeed/t.speed),t.penetrate&&(p.guardingDataProxy.bPenetrate+=t.penetrate),t.atkNum&&(p.guardingDataProxy.attackNum=p.guardingDataProxy.attackNum*t.atkNum),t.skin){var e=t.skin.split("|");p.guardingDataProxy.curRoleImgsrc=e[p.guardingDataProxy.factions-1],p.guardingDataProxy.playerNode.getComponent("GTPlayerCtl").resetPlayerImg()}if(t.bullet){var a=t.bullet.split("|");p.guardingDataProxy.curBulletImgsrc=a[p.guardingDataProxy.factions-1],p.guardingDataProxy.playerNode.getComponent("GTPlayerCtl").resetPlayerImg()}}else l.ResUtil.loadAsset({bundleName:u.Bundles.GuardingTheBridge,path:"prefabs/DaoZhang",type:cc.Prefab}).then(function(t){var e=cc.instantiate(t);e.parent=p.guardingDataProxy.battleView,e.setPosition(cc.v3(0,-400)),e.getComponent("GTDaoZhang").playSkill(),e.zIndex=-e.y})},e.prototype.setEffectEquipUpgrade=function(){s.AudioManager.instance.playEffectPath("sounds/bonus",u.Bundles.GuardingTheBridge),l.ResUtil.loadAsset({bundleName:"Res",path:"prefab/MiniGameSkillUpgrade",type:cc.Prefab}).then(function(t){var e=cc.instantiate(t);e.parent=p.guardingDataProxy.playerNode,e.scale=1,e.setPosition(cc.v3(0,0));var a=e.getComponent(sp.Skeleton);a.setAnimation(0,"level up",!1),a.setCompleteListener(null),a.setCompleteListener(function(){e.destroy(),e.removeFromParent()})}).catch(function(t){c.CommonUtil.print(t)})},e._instance=null,a=__decorate([f],e)}(cc.Component));n.default=_,cc._RF.pop(),cc._RF.pop()},{}],GTGameUI:[function(t,e,a){"use strict";cc._RF.push(e,"5dd52g7lzpM4Z0pUrNzixL5","GTGameUI");var i=t,o=e,n=a;cc._RF.push(o,"033e64MqQ1GVZguhKAakIKZ","GTGameUI"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("PopupManager"),c=i("GameEnum"),l=i("HomeEnum"),u=i("DataManager"),p=i("GuardingDataProxy"),h=i("GTBattleView"),d=i("GTGameMgr"),m=i("GTPlayerCtl"),f=i("GTPoolMgr"),_=cc._decorator,y=_.ccclass,g=_.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.selectNode=null,e.gtHitNum=null,e.gtHitEeffect=null,e}return __extends(e,t),e.prototype.start=function(){var t=this;p.guardingDataProxy.refreshData(),p.guardingDataProxy.bulletLayout=this.node.getChildByName("BulletLayer"),p.guardingDataProxy.battleView=this.node.getChildByName("BattleView"),p.guardingDataProxy.effectLayer=this.node.getChildByName("EffectLayer"),p.guardingDataProxy.buffLayer=this.node.getChildByName("BuffLayer"),this.selectNode.active=!0,this.selectNode.x=-this.node.width,cc.tween(this.selectNode).to(.5,{x:0}).call(function(){t.startSelect()}).start(),f.GTPoolMgr.Inst.initPool("gtHitNum",this.gtHitNum,10),f.GTPoolMgr.Inst.initPool("gtHitEeffect",this.gtHitEeffect,10);var e=cc.find("Canvas/GameUI/zbTips");yzll.gameConfig.isZB&&cc.sys.isBrowser?(e.active=!0,cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this)):e.active=!1,r.AudioManager.instance.playBgmPath("sounds/bgm_1",l.Bundles.GuardingTheBridge,!0)},e.prototype.onKeyDown=function(t){this.addKeyDownList(t.keyCode)},e.prototype.onKeyUp=function(t){switch(this.removeKeyDownList(t.keyCode),t.keyCode){case cc.macro.KEY.space:cc.director.isPaused()?cc.director.resume():cc.director.pause()}},e.prototype.addKeyDownList=function(t){t!=cc.macro.KEY.a&&t!=cc.macro.KEY.s&&t!=cc.macro.KEY.d&&t!=cc.macro.KEY.w||p.guardingDataProxy.keyBoradList.includes(t)||p.guardingDataProxy.keyBoradList.push(t)},e.prototype.removeKeyDownList=function(t){var e=p.guardingDataProxy.keyBoradList.indexOf(t);-1!=e&&p.guardingDataProxy.keyBoradList.splice(e,1)},e.prototype.onDestroy=function(){yzll.gameConfig.isZB&&cc.sys.isBrowser&&(cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this)),f.GTPoolMgr.Inst.realse()},e.prototype.startSelect=function(){var t=this,e=Math.floor(3*Math.random()),a=function(e){r.AudioManager.instance.playEffectPath("sounds/choose",l.Bundles.GuardingTheBridge),t.selectNode.getChildByName("View").children.forEach(function(t,a){t.getChildByName("bg_1").active=a!==e,t.getChildByName("icon_1").active=a!==e,t.getChildByName("bg_2").active=a===e,t.getChildByName("icon_2").active=a===e})},i=0,o=0;a(0),this.schedule(function(){o>6&&i==e&&(t.unscheduleAllCallbacks(),t.scheduleOnce(function(){var a=p.guardingDataProxy.playerNode,i=t.selectNode.getChildByName("View").children[e],o=i.convertToWorldSpaceAR(cc.v2(0,0)),n=a.convertToWorldSpaceAR(cc.v2(0,0)),r=t.selectNode.convertToNodeSpaceAR(o),s=t.selectNode.convertToNodeSpaceAR(n),c=cc.instantiate(i);t.selectNode.getChildByName("View").children.forEach(function(t){t.active=!1}),t.selectNode.getChildByName("loading").active=!1,c.parent=t.selectNode,c.setPosition(r),cc.tween(c).to(.3,{position:cc.v3(s.x,s.y,0),scale:.5},{easing:"quadOut"}).call(function(){c.destroy(),d.default.instance.setEffectEquipUpgrade()}).start(),t.scheduleOnce(function(){t.selectNode.destroy(),t.selectNode.removeFromParent(),t.onClickFactions(null,e)},.6)},.3)),a(i),i++,i%=3,o++},.3)},e.prototype.onClickFactions=function(t,e){var a=this,i=__read(u.DataManager.instance.eData.datapara[906+e].num.split("|"),2),o=i[0],n=i[1];p.guardingDataProxy.factions=e+1,p.guardingDataProxy.curRoleImgsrc=o,p.guardingDataProxy.curBulletImgsrc=n;var r=u.DataManager.instance.eData.datapara[903+e].num.split("|");p.guardingDataProxy.attackNum=Number(r[0]),p.guardingDataProxy.attackSpeed=Number(r[1]),p.guardingDataProxy.attackSpeedMax=Number(r[2]),this.scheduleOnce(function(){a.initGameStart()},.5)},e.prototype.initGameStart=function(){p.guardingDataProxy.bulletSpeed=Number(u.DataManager.instance.eData.datapara[909].num),p.guardingDataProxy.gameState=c.GameState.PLAYING,p.guardingDataProxy.playerNode.getComponent(m.default).resetPlayerImg(),p.guardingDataProxy.battleView.getComponent(h.default).startGame()},e.prototype.onBtnSet=function(){s.PopupManager.instance.show({bundleName:l.Bundles.GuardingTheBridge,path:"prefabs/popups/GTSettingPopup",keep:!0})},__decorate([g(cc.Node)],e.prototype,"selectNode",void 0),__decorate([g(cc.Node)],e.prototype,"gtHitNum",void 0),__decorate([g(cc.Node)],e.prototype,"gtHitEeffect",void 0),__decorate([y],e)}(cc.Component);n.default=v,cc._RF.pop(),cc._RF.pop()},{}],GTLosePopup:[function(t,e,a){"use strict";cc._RF.push(e,"b62932UTSlHjbNZg4nAnv4t","GTLosePopup");var i=t,o=e,n=a;cc._RF.push(o,"353c8c53YNGDqcO7K55o+T3","GTLosePopup"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("PopupBase"),s=i("SceneManager"),c=i("AdsMgr"),l=i("HomeEnum"),u=i("DataManager"),p=i("UserDataProxy"),h=i("ResUtil"),d=i("GuardingDataProxy"),m=i("AnimationMgr"),f=i("AudioManager"),_=cc._decorator,y=_.ccclass,g=_.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mTips1=null,e.mTips2=null,e.mItemLayout=null,e._reawards=[],e._isCanClick=!0,e}return __extends(e,t),e.prototype.init=function(e){t.prototype.init.call(this,e);var a=[];f.AudioManager.instance.playEffectPath("sounds/lose","Res");var i=Math.floor(1e3*Math.random())%3+1,o=u.DataManager.instance.eData.datasettlement[1]["des"+i].split("|");this.mTips1.string=o[0],this.mTips2.string=o[1],this._reawards=a;var n=u.DataManager.instance.eData.data_bridgestage[d.guardingDataProxy.currStageId];if(n)for(var r=n.reward.split("|"),s=0;s<r.length;s++){var c=r[s].split("_"),p={};p.id=c[0],p.num=c[1],a.push(p)}a.length;for(var m=function(t){var e=u.DataManager.instance.eData.dataitem[a[t].id],i=_.mItemLayout.children[t];i||((i=cc.instantiate(_.mItemLayout.children[0])).parent=_.mItemLayout),i.active=!0;var o=i.getChildByName("itemBg").getComponent(cc.Sprite);h.ResUtil.loadAsset({path:"textures/public/item_bg"+e.qulity,type:cc.SpriteFrame,bundleName:l.Bundles.GAME}).then(function(t){o.spriteFrame=t}).catch(function(t){console.log("error:",t)});var n=i.getChildByName("itemImg").getComponent(cc.Sprite);h.ResUtil.loadAsset({path:"textures/item/"+e.icon,type:cc.SpriteFrame,bundleName:l.Bundles.GAME}).then(function(t){n.spriteFrame=t}).catch(function(t){console.log("error:",t)}),i.getChildByName("itemNum").getComponent(cc.Label).string="x"+a[t].num},_=this,y=(s=0,a.length);s<y;s++)m(s)},e.prototype.toHome=function(t){var e=this;this._isCanClick=!1;var a=this.node.getChildByName("layout"),i=0;d.guardingDataProxy.GuardingData.btnStartTime=(new Date).getTime(),d.guardingDataProxy.saveData();for(var o=this._reawards.length,n=o>0?2:0,r=function(n){var r=a.children[n];if(!r.active)return"continue";var s=c._reawards[i];s.num=t?2*s.num:s.num,c.scheduleOnce(function(){s&&(r.active=!1,m.default.instance.showAwardAni(s,e.node,r,0,cc.v3(-250,s.id>6?-850:850)),p.userDataProxy.addProp(s.id,s.num,i+1==o))},.1*i),i++},c=this,l=0;l<a.children.length;++l)r(l);this.scheduleOnce(function(){s.SceneManager.instance.runScene("Home",""),e.removeUI()},.1*i+n)},e.prototype.onClickBtnClose=function(){this._isCanClick&&this.toHome(!1)},e.prototype.onClickBtnDouble=function(){var t=this;this._isCanClick&&c.default.showVideoAds({id:1,eventId:"gt_double_reward",success:function(){t.toHome(!0)},fail:function(t){return console.log(t)},error:function(t){return console.log(t)}},!0)},__decorate([g(cc.Label)],e.prototype,"mTips1",void 0),__decorate([g(cc.Label)],e.prototype,"mTips2",void 0),__decorate([g(cc.Node)],e.prototype,"mItemLayout",void 0),__decorate([y],e)}(r.PopupBase);n.default=v,cc._RF.pop(),cc._RF.pop()},{}],GTMonster:[function(t,e,a){"use strict";cc._RF.push(e,"77007UJ/nhAWbZK6J3diW3R","GTMonster");var i=t,o=e,n=a;cc._RF.push(o,"648f38R49lMKJeQCI2gjyNP","GTMonster"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("EventManager"),c=i("ResUtil"),l=i("Simulator"),u=i("AnimationCfgMgr"),p=i("AnimationCtrl"),h=i("GameEnum"),d=i("HomeEnum"),m=i("DataManager"),f=i("GuardingDataProxy"),_=i("GTGameMgr"),y=i("GTPlayerCtl"),g=cc._decorator,v=g.ccclass,P=g.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mColliderNode=null,e.mBody=null,e.mAnimCtrl=null,e._hp=0,e._maxHp=0,e._isDead=!1,e._moveSpeed=cc.v3(0,0),e._atkInverval=1,e._endMaxY=0,e._target=null,e._hpProgress=null,e._isBoss=!1,e._amimState=h.RoleState.Default,e._placePos=null,e._agentHandleId=-1,e}return __extends(e,t),Object.defineProperty(e.prototype,"agentHandleId",{get:function(){return this._agentHandleId},set:function(t){this._agentHandleId=t},enumerable:!1,configurable:!0}),e.prototype.update=function(t){if(f.guardingDataProxy.gameState==h.GameState.PLAYING&&!this._isDead&&(this.agentHandleId<0&&(this.node.position=this.node.position.add(this._moveSpeed.mul(t)),this.node.zIndex=-this.node.y),this.node.y<this._endMaxY||this.agentHandleId>=0)){if(this._atkInverval>=0&&(this._atkInverval-=t),this.agentHandleId<0){this._target=f.guardingDataProxy.playerNode;var e=l.Simulator.instance.addAgent(cc.v2(this.node.position),10,999999,null,1);this.agentHandleId=e}if(this.checkAtk(),this._amimState==h.RoleState.Move&&(this.move(t),this.moveByRvo(t)),this._amimState==h.RoleState.Attack){if(!this._target||!this._target.isValid)return void(this._amimState=h.RoleState.Move);var a=cc.Vec2.len(this._target.position.clone().sub(this.node.position.clone()));if(Math.abs(a-0)>150)return this.playMoveAnim(),void(this._amimState=h.RoleState.Move);this._atkInverval<=0&&this.attack()}}},e.prototype.playMoveAnim=function(){this.mAnimCtrl.playAnim("move",!0,null,null,3)},e.prototype.playAtkAnim=function(t){this.scheduleOnce(function(){t&&t()},.5)},e.prototype.playIdleAnim=function(){this.mAnimCtrl.playAnim("move",!0,null,null,3)},e.prototype.playDeadAnim=function(t){this.mAnimCtrl.playAnim("die",!1,function(){t&&t()},null,5)},e.prototype.setAnimScaleX=function(t){var e=Math.abs(this.mAnimCtrl.node.scale);this.mAnimCtrl.node.scaleX=t?e:-e},e.prototype.attack=function(){var t=this;if(this._amimState!=h.RoleState.Dead)return this.playAttack(function(){t._atkInverval=1,t.breath(),t._amimState=h.RoleState.Move},this._target)},e.prototype.playAttack=function(t,e){var a=this;this._amimState!=h.RoleState.Dead&&this.playAtkAnim(function(){a.shoot(e),t&&t()})},e.prototype.breath=function(){this._amimState!=h.RoleState.Dead&&(this.playIdleAnim(),this._amimState=h.RoleState.Breath)},e.prototype.shoot=function(){this._target.getComponent(y.default).beAttack(5)},e.prototype.move=function(){if(!(this.agentHandleId<0)&&this._target&&this._target.isValid&&this._amimState!=h.RoleState.Dead&&this._amimState!=h.RoleState.Attack){var t=this.agentHandleId,e=l.Simulator.instance.getAgentByAid(t);if(!e)return console.error("RVO\u5f02\u5e38 agent::",e,t),!1;var a=l.Simulator.instance.getAgentPosition(t);if(!a)return console.error("RVO\u5f02\u5e38 agentPos::",a,t),!1;this._placePos=null;var i=cc.Vec3.ZERO;i=this._target.position.clone();var o=null;return o=cc.v2(i).subtract(cc.v2(a.x,a.y)).normalize(),this.setAnimScaleX(o.x>=0),l.Simulator.instance.setAgentPrefVelocity(t,o.multiplyScalar(this.getMoveSpeed())),!0}},e.prototype.getMoveSpeed=function(){return Math.abs(this._moveSpeed.y)},e.prototype.moveByRvo=function(){if(!(this.agentHandleId<0)&&this._target&&this._amimState!=h.RoleState.Dead&&this._amimState!=h.RoleState.Attack&&this._amimState!=h.RoleState.BeBack){var t=l.Simulator.instance.getAgentPosition(this.agentHandleId);if(!t||!t.x&&0!=t.x||!t.y&&0!=t.y)t&&(t.x=this.node.x,t.y=this.node.y);else{if(Math.abs(t.x-this.node.x)>100)return t.x=this.node.x,void(t.y=this.node.y);if(this._placePos)this.node.setPosition(this._placePos.x,this._placePos.y),t.x=this._placePos.x,t.y=this._placePos.y;else{var e=cc.v3(t.x-this.node.x,t.y-this.node.y,0),a=this.node.position.clone().add(e);this.node.setPosition(a.x,a.y)}this.node.zIndex=-this.node.y}}},e.prototype.initEnemy=function(t){var e=this;this._moveSpeed=cc.v3(0,-t.speed),this._hp=t.hp,this._maxHp=this._hp,this._isBoss=!1,2005==t.monsterId||4005==t.monsterId||t.monsterId,this.mAnimCtrl?this.mAnimCtrl.loadAtlasAnimation(u.AnimationCfgMgr.instance.getAnimationCfg(m.DataManager.instance.eData.datamonster[t.monsterId])).then(function(){e.playMoveAnim(),e._amimState=h.RoleState.Move,t.boss&&(e.mBody.scale=2,e.mColliderNode.getComponent("SimplyCircleCollider").radius=100,e.addHpBar(),e._isBoss=!0)}):(this.playMoveAnim(),this._amimState=h.RoleState.Move,t.boss&&(this.mBody.scale=2,this.mColliderNode.getComponent("SimplyCircleCollider").radius=100,this.addHpBar(),this._isBoss=!0))},e.prototype.addHpBar=function(){var t=this;c.ResUtil.loadAsset({bundleName:d.Bundles.GuardingTheBridge,path:"prefabs/HpProgress",type:cc.Prefab}).then(function(e){if(t.node&&t.node.isValid){var a=cc.instantiate(e);a.parent=t.node,a.position=cc.v3(0,t.mBody.height*t.mBody.scaleY+30),a.active=!0,t._hpProgress=a.getChildByName("Bar")}})},e.prototype.checkAtk=function(){var t=cc.Vec2.len(this._target.position.clone().sub(this.node.position.clone()));return Math.abs(t-0)<=150&&(this._amimState=h.RoleState.Attack,!0)},e.prototype.beAttack=function(t,e){return t*=1,this.subHp(t),e&&this.showHurtLab(t),this._hpProgress&&this._isBoss&&(this._hpProgress.getComponent(cc.Sprite).fillRange=this._hp/this._maxHp),r.AudioManager.instance.playEffectPath("sounds/hit",d.Bundles.RES),this._hp<=0?(this.dealDie(),!0):(this.hit(),!1)},e.prototype.hit=function(){var t=this;this.mAnimCtrl.node.color=cc.Color.RED,this.scheduleOnce(function(){t.mAnimCtrl.node.color=cc.Color.WHITE},.2)},e.prototype.dealDie=function(){var t=this;this._isDead||(this._isDead=!0,this.playDeadAnim(function(){var e=f.guardingDataProxy.monsters.indexOf(t.node);-1!=e&&f.guardingDataProxy.monsters.splice(e,1),t.node.destroy(),t.node.removeFromParent(),s.EventManager.instance.emit(f.GuardingDataEvent.KILL_MONSTER)}))},e.prototype.subHp=function(t){isNaN(t)&&(t=1),this._hp-=t,isNaN(this._hp)&&(this._hp=10),this._hp<0&&(this._hp=0)},e.prototype.showHurtLab=function(t){var e=this.node.position;e.y+=this.mBody.height,_.default.instance.showHitNum(t,e)},__decorate([P(cc.Node)],e.prototype,"mColliderNode",void 0),__decorate([P(cc.Node)],e.prototype,"mBody",void 0),__decorate([P({type:p.default})],e.prototype,"mAnimCtrl",void 0),__decorate([v],e)}(cc.Component);n.default=b,cc._RF.pop(),cc._RF.pop()},{}],GTPlayerCtl:[function(t,e,a){"use strict";cc._RF.push(e,"72146h58JBLN7J4akaUGg3k","GTPlayerCtl");var i=t,o=e,n=a;cc._RF.push(o,"92cd31ooJtKLZurtBWBVBGg","GTPlayerCtl"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("ComponentBase"),c=i("ResUtil"),l=i("PopupManager"),u=i("GameEnum"),p=i("HomeEnum"),h=i("GuardingDataProxy"),d=i("GTBullet"),m=i("GTPoolMgr"),f=cc._decorator,_=f.ccclass,y=f.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.player=null,e.bullet=null,e._playNodes=[],e._attackSpeed=.2,e}return __extends(e,t),e.prototype.update=function(t){h.guardingDataProxy.gameState==u.GameState.PLAYING&&(this._attackSpeed-=t,this._attackSpeed<=0&&(h.guardingDataProxy.attackSpeed<h.guardingDataProxy.attackSpeedMax&&(h.guardingDataProxy.attackSpeed=h.guardingDataProxy.attackSpeedMax),this._attackSpeed=h.guardingDataProxy.attackSpeed,this.shoot()))},e.prototype.onLoad=function(){this._playNodes=[],h.guardingDataProxy.playerNode=this.node,h.guardingDataProxy.gameState=u.GameState.NONE,h.guardingDataProxy.curRoleImgsrc="pic_plant10",this.addPlay(1)},e.prototype.start=function(){m.GTPoolMgr.Inst.initPool("gt_bullet",this.bullet,10)},e.prototype.shoot=function(){r.AudioManager.instance.playEffectPath("sounds/launch",p.Bundles.GuardingTheBridge);for(var t=this._playNodes.length,e=0;e<t;e++){var a=h.guardingDataProxy.bulletLayout.convertToNodeSpaceAR(this.node.convertToWorldSpaceAR(this._playNodes[e].position)),i=m.GTPoolMgr.Inst.get("gt_bullet");i.parent=h.guardingDataProxy.bulletLayout,i.getComponent(d.default).init(),i.setPosition(a.x,a.y)}},e.prototype.resetPlayerImg=function(){var t=this;c.ResUtil.loadAsset({bundleName:p.Bundles.GuardingTheBridge,path:"textrues/"+h.guardingDataProxy.curRoleImgsrc,type:cc.SpriteFrame}).then(function(e){for(var a=0,i=t._playNodes.length;a<i;a++){var o=t._playNodes[a].getChildByName("body");o&&(o.getComponent(cc.Sprite).spriteFrame=e)}})},e.prototype.beAttack=function(t){r.AudioManager.instance.playEffectPath("sounds/hit_2",p.Bundles.GuardingTheBridge);var e=this.node.getChildByName("zhuahen");e.opacity=0,e.active=!0,cc.tween(e).to(.1,{opacity:255}).delay(.2).to(.1,{opacity:0}).call(function(){e.active=!1}).start(),this.removePlay(t)},e.prototype.addPlay=function(t){if(h.guardingDataProxy.gameState!=u.GameState.OVER&&!(this._playNodes.length>=20)){this._playNodes.length+t>20&&(t=20-this._playNodes.length);for(var e=0;e<t;e++){var a=cc.instantiate(this.player);a.parent=this.node,this._playNodes.push(a)}this.teamArrange(),this.resetPlayerImg()}},e.prototype.removePlay=function(t){if(h.guardingDataProxy.gameState!=u.GameState.OVER){for(var e=0;e<t&&this._playNodes.length>0;e++){var a=this._playNodes.pop();a&&a.isValid&&(a.removeFromParent(),a.destroy())}0==this._playNodes.length&&(h.guardingDataProxy.gameState=u.GameState.OVER,l.PopupManager.instance.show({bundleName:p.Bundles.GuardingTheBridge,path:"prefabs/popups/GTLosePopup",keep:!0})),this.teamArrange()}},e.prototype.teamArrange=function(){var t=Math.min(this._playNodes.length,20);if(0!==t){if(t<3?(this.node.width=100+40*t,this.node.getChildByName("Collider").width=100+40*t):(this.node.width=250,this.node.getChildByName("Collider").width=250),1==this._playNodes.length)return this._playNodes[0].setPosition(cc.v3(0,0)),void(this._playNodes[0].active=!0);for(var e=function(t){return t%2==0?3:4},a=0,i=0,o=t;o>0;)o-=c=Math.min(e(i),o),i++;var n=40*(i-1)/2;a=0;for(var r=0;r<i&&a<t;r++){var s=e(r),c=Math.min(s,t-a),l=-50;r%2>0&&(l=-75);for(var u=0;u<c&&!(a>=t);u++)if(this._playNodes[a]&&this._playNodes[a].isValid){var p=l+50*u,h=n-40*r;this._playNodes[a].setPosition(p,h),this._playNodes[a].active=!0,this._playNodes[a].zIndex=-h,a++}else a++}}},__decorate([y(cc.Node)],e.prototype,"player",void 0),__decorate([y(cc.Node)],e.prototype,"bullet",void 0),__decorate([_],e)}(s.ComponentBase);n.default=g,cc._RF.pop(),cc._RF.pop()},{}],GTPoolMgr:[function(t,e,a){"use strict";cc._RF.push(e,"a3275z/J9tNKqgeT5fRjeq9","GTPoolMgr");var i=e,o=a;cc._RF.push(i,"92223aYdTpNNp7qO4CJ8OHk","GTPoolMgr"),Object.defineProperty(o,"__esModule",{value:!0}),o.GTPoolMgr=void 0;var n=function(){function t(){this.prefabs=new Map,this.pools=new Map}return Object.defineProperty(t,"Inst",{get:function(){return this.inst||(this.inst=new this)},enumerable:!1,configurable:!0}),t.prototype.initPool=function(t,e,a){if(void 0===a&&(a=10),!this.pools.has(t)){var i=new cc.NodePool;this.prefabs.set(t,cc.instantiate(e)),this.pools.set(t,i);for(var o=0;o<a;o++)this.pools.get(t).put(cc.instantiate(e))}},t.prototype.get=function(t){if(this.pools.has(t)){var e=this.pools.get(t);return e.size()>0?e.get():cc.instantiate(this.prefabs.get(t))}return null},t.prototype.put=function(t,e){if(this.pools.has(t)){var a=this.pools.get(t);e instanceof Array?e.forEach(function(t){a.put(t)}):a.put(e)}},t.prototype.realseName=function(t){this.pools.has(t)&&this.pools.get(t).clear()},t.prototype.realse=function(){this.pools.forEach(function(t){t.clear()}),this.prefabs.clear(),this.pools.clear()},t.inst=null,t}();o.GTPoolMgr=n,cc._RF.pop(),cc._RF.pop()},{}],GTScaleYAni:[function(t,e,a){"use strict";cc._RF.push(e,"1e0d4T/RStIco0bsC+5Sqtb","GTScaleYAni");var i=e,o=a;cc._RF.push(i,"fec87DQ97hMnqzxUve7wBUi","GTScaleYAni"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,r=n.ccclass,s=(n.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.start=function(){cc.tween(this.node).repeatForever(cc.tween().to(.2,{scaleY:1}).to(.2,{scaleY:1.01})).start()},__decorate([r],e)}(cc.Component));o.default=s,cc._RF.pop(),cc._RF.pop()},{}],GTSettingPopup:[function(t,e,a){"use strict";cc._RF.push(e,"4a54e78OXtBr7Mm0jDbRKD6","GTSettingPopup");var i=t,o=e,n=a;cc._RF.push(o,"e79f5/Ag89HULpb6WL1AbmI","GTSettingPopup"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("EventManager"),c=i("AppProxy"),l=i("PopupBase"),u=i("SceneManager"),p=i("GameEnum"),h=i("GuardingDataProxy"),d=i("UserSetDataProxy"),m=cc._decorator,f=m.ccclass,_=m.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nShake=null,e.musicVolumeSlider=null,e.musicVolumePro=null,e.effectVolumeSlider=null,e.effectVolumePro=null,e.mMusicVolumeLab=null,e.mEffectVolumeLab=null,e.mShakeLab=null,e}return __extends(e,t),e.prototype.init=function(){h.guardingDataProxy.gameState==p.GameState.PLAYING&&(h.guardingDataProxy.gameState=p.GameState.PAUSE),s.EventManager.instance.on(r.EAudioEvent.BACKGROUND_AUDIO_SWITCH_CHANGE,this.updateView,this),s.EventManager.instance.on(r.EAudioEvent.EFFECT_AUDIO_SWITCH_CHANGE,this.updateView,this),this.updateView()},e.prototype.onDisable=function(){s.EventManager.instance.off(r.EAudioEvent.BACKGROUND_AUDIO_SWITCH_CHANGE,this.updateView,this),s.EventManager.instance.off(r.EAudioEvent.EFFECT_AUDIO_SWITCH_CHANGE,this.updateView,this),t.prototype.onDisable.call(this),d.userSetDataProxy.saveData()},e.prototype.updateView=function(){this.musicVolumeSlider.progress=d.userSetDataProxy.setData.musicVolume,this.musicVolumePro.fillRange=d.userSetDataProxy.setData.musicVolume,this.effectVolumeSlider.progress=d.userSetDataProxy.setData.effectVolume,this.effectVolumePro.fillRange=d.userSetDataProxy.setData.effectVolume;var t=d.userSetDataProxy.setData.isOpenShake;this.nShake.getChildByName("Close").active=!t,this.nShake.getChildByName("Open").active=t,this.mShakeLab.string=t?"\u5f00":"\u5173",this.mMusicVolumeLab.string=(100*d.userSetDataProxy.setData.musicVolume).toFixed(0),this.mEffectVolumeLab.string=(100*d.userSetDataProxy.setData.effectVolume).toFixed(0)},e.prototype.onClickBtnEffectAudio=function(){},e.prototype.onClickBtnMusicAudio=function(){},e.prototype.onMusicVolumeSlider=function(t){this.musicVolumeSlider.progress=t.progress,this.musicVolumePro.fillRange=t.progress,r.AudioManager.instance.setBgmVolume(t.progress),d.userSetDataProxy.setData.musicVolume=t.progress,this.mMusicVolumeLab.string=(100*d.userSetDataProxy.setData.musicVolume).toFixed(0)},e.prototype.onEffectVolumeSlider=function(t){this.effectVolumeSlider.progress=t.progress,this.effectVolumePro.fillRange=t.progress,r.AudioManager.instance.setEffectVolume(t.progress),d.userSetDataProxy.setData.effectVolume=t.progress,this.mEffectVolumeLab.string=(100*d.userSetDataProxy.setData.effectVolume).toFixed(0)},e.prototype.onClickBtnShake=function(){d.userSetDataProxy.setVibrate(!d.userSetDataProxy.setData.isOpenShake),this.updateView()},e.prototype.onClickBtnBack=function(){h.guardingDataProxy.GuardingData.btnStartTime=(new Date).getTime(),h.guardingDataProxy.saveData(),this.removeUI(),u.SceneManager.instance.runScene("Home","",function(){s.EventManager.instance.emit(c.AppEvent.ENTER_GAME)})},e.prototype.onClickBtnClose=function(){h.guardingDataProxy.gameState==p.GameState.PAUSE&&(h.guardingDataProxy.gameState=p.GameState.PLAYING),this.removeUI()},__decorate([_(cc.Node)],e.prototype,"nShake",void 0),__decorate([_(cc.Slider)],e.prototype,"musicVolumeSlider",void 0),__decorate([_(cc.Sprite)],e.prototype,"musicVolumePro",void 0),__decorate([_(cc.Slider)],e.prototype,"effectVolumeSlider",void 0),__decorate([_(cc.Sprite)],e.prototype,"effectVolumePro",void 0),__decorate([_(cc.Label)],e.prototype,"mMusicVolumeLab",void 0),__decorate([_(cc.Label)],e.prototype,"mEffectVolumeLab",void 0),__decorate([_(cc.Label)],e.prototype,"mShakeLab",void 0),__decorate([f],e)}(l.PopupBase);n.default=y,cc._RF.pop(),cc._RF.pop()},{}],GTSpAnimCtrl:[function(t,e,a){"use strict";cc._RF.push(e,"e504f3jx6NPyZtobcQ0Hw0Z","GTSpAnimCtrl");var i=e,o=a;cc._RF.push(i,"a77afzRuNVFepM7TNMRY3rR","GTSpAnimCtrl"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,r=n.ccclass,s=n.property;n.menu,sp.SkeletonData.prototype.isTexturesLoaded=function(){for(var t=this.textures,e=t?t.length:0,a=0;a<e;a++)if(!t[a].loaded)return!1;return!0};var c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAnim=null,e.animFrameEventListener=new Map,e.animCompleteListener=new Map,e.onceOnComplete=null,e._onPlayAnimFunc=null,e._timeScale=1,e}return __extends(e,t),e.prototype.onLoad=function(){if(this.spAnim.setEventListener(this.onFrameEvent.bind(this)),this.spAnim.setCompleteListener(this.onCompleteEvent.bind(this)),this.spAnim.skeletonData){var t=this.spAnim.skeletonData.skeletonJson.animations;for(var e in t)for(var a in t)e!=a&&this.spAnim.setMix(e,a,.2)}},e.prototype.onDestroy=function(){this.animFrameEventListener.clear(),this.animCompleteListener.clear(),this.spAnim.setEventListener(null),this.spAnim.setCompleteListener(null)},e.prototype.init=function(t){if(void 0===t&&(t=null),this._timeScale=1,this.spAnim.enabled=!0,this.spAnim.node.opacity=255,t&&t.onPlayAnimFunc&&(this._onPlayAnimFunc=t.onPlayAnimFunc),null==t||!t.skeletonData||this.spAnim.skeletonData&&this.spAnim.skeletonData.name==t.skeletonData.name)return this.clearTracks(),this.spAnim.setToSetupPose(),this.animCompleteListener.clear(),void this.animFrameEventListener.clear();this.spAnim.skeletonData=t.skeletonData;var e=this.spAnim.skeletonData.skeletonJson.animations;for(var a in e)for(var i in e)a!=i&&this.spAnim.setMix(a,i,.2);this.clearTracks(),this.spAnim.setToSetupPose(),this.animCompleteListener.clear(),this.animFrameEventListener.clear()},e.prototype.playAnimWithFrame=function(t,e,a,i,o){if(void 0===e&&(e=!1),void 0===a&&(a=0),void 0===i&&(i=Number.MAX_SAFE_INTEGER),void 0===o&&(o=1),!this.spAnim)return null;if(this.node.active){var n=this.spAnim.findAnimation(t);if(n){var r=n.duration,s=Math.ceil(60*r);i=Math.min(i,s);var c=Math.max(0,a/60),l=Math.min(i/60,1),u=this.spAnim.setAnimation(0,t,e);return this.spAnim.timeScale=0,u.animationStart=c,u.animationEnd=l,this.spAnim.timeScale=o,this._timeScale=this.spAnim.timeScale,u}}},e.prototype.playAnim=function(t,e,a,i){if(void 0===e&&(e=1),void 0===a&&(a=!1),!this.spAnim)return null;if(this.node.active){if(t||(t=this.spAnim.defaultAnimation),!this.spAnim.isAnimationCached()){var o=this.spAnim.getCurrent(0);if(o&&o.animation.name==t)return null;this.spAnim.clearTrack(0)}return this.spAnim.setToSetupPose(),this.spAnim.timeScale=e,this._timeScale=this.spAnim.timeScale,this.onceOnComplete=i,this._onPlayAnimFunc&&this._onPlayAnimFunc(t,e,a),this.spAnim.setAnimation(0,t,a)}},e.prototype.playAnimFixSpeed=function(t,e,a,i){if(void 0===e&&(e=1),void 0===a&&(a=!1),!this.spAnim)return null;if(t||(t=this.spAnim.defaultAnimation),!this.spAnim.isAnimationCached()){var o=this.spAnim.getCurrent(0);if(o&&o.animation.name==t)return null;this.spAnim.clearTrack(0)}return this.spAnim.setToSetupPose(),this.spAnim.timeScale=e,this._timeScale=this.spAnim.timeScale,this.onceOnComplete=i,this.spAnim.setAnimation(0,t,a)},e.prototype.setTimeScale=function(t){t*this._timeScale!=this.spAnim.timeScale&&(this.spAnim.timeScale=this._timeScale*t)},e.prototype.getCurAnimTime=function(){if(!this.spAnim.isAnimationCached()){var t=this.spAnim.getCurrent(0);if(t)return t.animationEnd}return 0},e.prototype.registerFrameEvent=function(t,e){this.animFrameEventListener.set(e,t)},e.prototype.unregisterFrameEvent=function(t){this.animFrameEventListener.delete(t)},e.prototype.registerComplete=function(t,e){this.animCompleteListener.set(e,t)},e.prototype.unregisterComplete=function(t){this.animCompleteListener.delete(t)},e.prototype.onFrameEvent=function(t,e){var a=this;this.animFrameEventListener.forEach(function(i,o){i.call(o,t.animation.name,e.data.name,a)})},e.prototype.onCompleteEvent=function(t){this.onceOnComplete&&this.onceOnComplete(t),this.onceOnComplete=null,this.animCompleteListener.forEach(function(e,a){e.call(a,t)})},e.prototype.clearAnim=function(){this.clearTracks()},e.prototype.releaseRes=function(){},e.prototype.generateSomeNodes=function(t,e){var a=this.spAnim.attachUtil.generateAttachedNodes(t)[0];return e?(e instanceof cc.Prefab?a.addChild(cc.instantiate(e)):e.parent?e.parent=a:a.addChild(e),a):a},e.prototype.destroySomeNodes=function(t){this.spAnim.attachUtil.destroyAttachedNodes(t)},e.prototype.clearTracks=function(){this.spAnim.isAnimationCached()||this.spAnim.clearTracks()},e.prototype.clear=function(){this.clearTracks(),this.animCompleteListener.clear(),this.animFrameEventListener.clear()},e.prototype.clearOnceComplete=function(){this.onceOnComplete=null},__decorate([s(sp.Skeleton)],e.prototype,"spAnim",void 0),__decorate([r],e)}(cc.Component);o.default=c,cc._RF.pop(),cc._RF.pop()},{}],GTWinPopup:[function(t,e,a){"use strict";cc._RF.push(e,"dd6ee5GTLdJE5uIsYB0xmZ6","GTWinPopup");var i=t,o=e,n=a;cc._RF.push(o,"f0a07nA4b5NVqeC3JVAW364","GTWinPopup"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("PopupBase"),c=i("SceneManager"),l=i("AdsMgr"),u=i("HomeEnum"),p=i("DataManager"),h=i("UserDataProxy"),d=i("ResUtil"),m=i("GuardingDataProxy"),f=i("AnimationMgr"),_=cc._decorator,y=_.ccclass,g=_.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mTips1=null,e.mTips2=null,e.mItemLayout=null,e._reawards=[],e._isCanClick=!0,e}return __extends(e,t),e.prototype.init=function(e){t.prototype.init.call(this,e);var a=[];r.AudioManager.instance.playEffectPath("sounds/win","Res");var i=Math.floor(1e3*Math.random())%3+1,o=p.DataManager.instance.eData.datasettlement[1]["des"+i].split("|");this.mTips1.string=o[0],this.mTips2.string=o[1],this._reawards=a;var n=p.DataManager.instance.eData.data_bridgestage[46];if(n)for(var s=n.reward.split("|"),c=0;c<s.length;c++){var l=s[c].split("_"),h={};h.id=l[0],h.num=l[1],a.push(h)}a.length;for(var m=function(t){var e=p.DataManager.instance.eData.dataitem[a[t].id],i=f.mItemLayout.children[t];i||((i=cc.instantiate(f.mItemLayout.children[0])).parent=f.mItemLayout),i.active=!0;var o=i.getChildByName("itemBg").getComponent(cc.Sprite);d.ResUtil.loadAsset({path:"textures/public/item_bg"+e.qulity,type:cc.SpriteFrame,bundleName:u.Bundles.GAME}).then(function(t){o.spriteFrame=t}).catch(function(t){console.log("error:",t)});var n=i.getChildByName("itemImg").getComponent(cc.Sprite);d.ResUtil.loadAsset({path:"textures/item/"+e.icon,type:cc.SpriteFrame,bundleName:u.Bundles.GAME}).then(function(t){n.spriteFrame=t}).catch(function(t){console.log("error:",t)}),i.getChildByName("itemNum").getComponent(cc.Label).string="x"+a[t].num},f=this,_=(c=0,a.length);c<_;c++)m(c)},e.prototype.toHome=function(t){var e=this;this._isCanClick=!1;var a=this.node.getChildByName("layout"),i=0;m.guardingDataProxy.GuardingData.btnStartTime=(new Date).getTime(),m.guardingDataProxy.saveData();for(var o=this._reawards.length,n=o>0?2:0,r=function(n){var r=a.children[n];if(!r.active)return"continue";var c=s._reawards[i];c.num=t?2*c.num:c.num,s.scheduleOnce(function(){c&&(r.active=!1,f.default.instance.showAwardAni(c,e.node,r,0,cc.v3(-250,c.id>6?-850:850)),h.userDataProxy.addProp(c.id,c.num,i+1==o))},.1*i),i++},s=this,l=0;l<a.children.length;++l)r(l);this.scheduleOnce(function(){c.SceneManager.instance.runScene("Home",""),e.removeUI()},.1*i+n)},e.prototype.onClickBtnClose=function(){this._isCanClick&&this.toHome(!1)},e.prototype.onClickBtnDouble=function(){var t=this;this._isCanClick&&l.default.showVideoAds({id:1,eventId:"gt_double_reward",success:function(){t.toHome(!0)},fail:function(t){return console.log(t)},error:function(t){return console.log(t)}},!0)},__decorate([g(cc.Label)],e.prototype,"mTips1",void 0),__decorate([g(cc.Label)],e.prototype,"mTips2",void 0),__decorate([g(cc.Node)],e.prototype,"mItemLayout",void 0),__decorate([y],e)}(s.PopupBase);n.default=v,cc._RF.pop(),cc._RF.pop()},{}],GTXuanZhuan:[function(t,e,a){"use strict";cc._RF.push(e,"5faf24BiSNFH75SFhQiK80t","GTXuanZhuan");var i=e,o=a;cc._RF.push(i,"701casxT19Faqb8OW2LhTLy","GTXuanZhuan"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,r=n.ccclass,s=(n.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.update=function(){this.node.angle+=1},__decorate([r],e)}(cc.Component));o.default=s,cc._RF.pop(),cc._RF.pop()},{}],GameCamera:[function(t,e,a){"use strict";cc._RF.push(e,"dd5d5MrheFPbZaAvZxUDPB9","GameCamera");var i=t,o=e,n=a;cc._RF.push(o,"e04bbjBLxVL1YmFr4aVGQeZ","GameCamera"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("ComponentBase"),s=i("EventManager"),c=i("GameEnum"),l=i("BattleDataProxy"),u=cc._decorator,p=u.ccclass,h=u.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mCamera=null,e._originVec=null,e._target=null,e}return __extends(e,t),Object.defineProperty(e.prototype,"myCamera",{get:function(){return this.mCamera},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){s.EventManager.instance.on(c.EGameEvent.SCREEN_SHAKE,this.shake,this)},e.prototype.onDestroy=function(){s.EventManager.instance.off(c.EGameEvent.SCREEN_SHAKE,this.shake,this)},e.prototype.initGameCamera=function(t){this._target=t},e.prototype.lateUpdate=function(){l.battleDataProxy.gameState==c.GameState.PLAYING&&this._target},e.prototype.onMainEnter=function(t){void 0===t&&(t=1),cc.Tween.stopAllByTarget(this.mCamera),cc.tween(this.mCamera).to(.5,{zoomRatio:t}).start(),this.node.position=cc.v3(0,0)},e.prototype.onGameStart=function(t){cc.Tween.stopAllByTarget(this.mCamera),this.mCamera.zoomRatio=1,cc.tween(this.mCamera).to(.5,{zoomRatio:.7}).call(function(){t&&t()}).start()},e.prototype.shake=function(t,e,a,i,o){void 0===t&&(t=this.mCamera.node),void 0===e&&(e=5),void 0===a&&(a=.05),void 0===i&&(i=2),this._originVec||(this._originVec=t.position.clone()),cc.Tween.stopAllByTarget(t),t.position=this._originVec.clone(),cc.tween(t).by(a/2,{position:cc.v3(e,0,0)}).by(a/2,{position:cc.v3(-e,0,0)}).by(a/2,{position:cc.v3(0,-e,0)}).by(a/2,{position:cc.v3(0,e,0)}).by(a/2,{position:cc.v3(-e,0,0)}).by(a/2,{position:cc.v3(e,0,0)}).by(a/2,{position:cc.v3(0,e,0)}).by(a/2,{position:cc.v3(0,-e,0)}).union().repeat(i).call(function(){o&&o()}).start()},__decorate([h(cc.Camera)],e.prototype,"mCamera",void 0),__decorate([p],e)}(r.ComponentBase);n.default=d,cc._RF.pop(),cc._RF.pop()},{}],GameComponent:[function(t,e,a){"use strict";cc._RF.push(e,"e773auiEL9MIqXCJdQLE3Eb","GameComponent");var i=t,o=e,n=a;cc._RF.push(o,"c0615QGGntMX4Wrq9RxW2kX","GameComponent"),Object.defineProperty(n,"__esModule",{value:!0}),n.GameComponent=void 0;var r=i("ComponentBase"),s=i("TimeUtil"),c=i("AppBase"),l=cc._decorator,u=l.ccclass,p=l.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.debugArea=200,e.multiTouchCount=0,e.multiTouchTime=0,e.clickRect=null,e}return __extends(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this),cc.game.addPersistRootNode(this.node),c.AppBase.onShow(this.onShow),c.AppBase.onHide(this.onHide)},e.prototype.start=function(){t.prototype.start.call(this),this.clickRect=cc.rect(0,cc.winSize.height-this.debugArea,cc.winSize.width,this.debugArea)},e.prototype.onDestroy=function(){c.AppBase.offShow(this.onShow),c.AppBase.offHide(this.onHide),t.prototype.onDestroy.call(this)},e.prototype.onShow=function(){},e.prototype.onHide=function(){},e.prototype.showDebugInfo=function(){var t=s.TimeUtil.getTime();0!=this.multiTouchTime&&t-this.multiTouchTime>1e3&&(this.multiTouchCount=0),this.multiTouchTime=t,this.multiTouchCount++,this.multiTouchCount<10||(this.multiTouchCount=0)},__decorate([p()],e.prototype,"debugArea",void 0),__decorate([u],e)}(r.ComponentBase);n.GameComponent=h,cc._RF.pop(),cc._RF.pop()},{}],GameEnum:[function(t,e,a){"use strict";cc._RF.push(e,"36fef25c8xDAoIVkTZUPKmJ","GameEnum");var i,o=e,n=a;cc._RF.push(o,"3fe81wsVHNOPbneNq9+o3E6","GameEnum"),Object.defineProperty(n,"__esModule",{value:!0}),n.ArrayNeedCheckColliderMove=n.WeatherType=n.EquipmentType=n.EquipFormDataToIdx=n.EquipmentData=n.EquipmentFormIdx=n.OrginMapGridsData=n.GridColor=n.BuyType=n.ItemType=n.BoxType=n.GridStatus=n.GridBgStatus=n.ColliderName=n.EGameEnum=n.GameMapType=n.RoleState=n.EGameEvent=n.GameState=n.EGameSceneUIType=void 0,function(t){t[t.MAIN_UI=0]="MAIN_UI",t[t.MAIN_GAME=1]="MAIN_GAME",t[t.COPY_GAME=2]="COPY_GAME",t[t.CARTOON=3]="CARTOON",t[t.ARENA=4]="ARENA"}(n.EGameSceneUIType||(n.EGameSceneUIType={})),function(t){t[t.NONE=0]="NONE",t[t.READY=1]="READY",t[t.PLAYING=2]="PLAYING",t[t.PAUSE=3]="PAUSE",t[t.OVER=4]="OVER"}(n.GameState||(n.GameState={})),function(t){t.SCENE_TOUCH_START="EGameEvent.SCENE_TOUCH_START",t.SCENE_SWITCH="EGameEvent.SCENE_SWITCH",t.GAME_INIT_2="GAME_INIT_2",t.GAME_START="G_GAME_START",t.SCREEN_SHAKE="SCREEN_SHAKE",t.COMPOSE_GRID_FRAME_SHOW="COMPOSE_GRID_FRAME_SHOW",t.UPDATE_STAGE_WAVE="UPDATE_STAGE_WAVE",t.PASS_WAVE="PASS_WAVE",t.PASS_WAVE_MOVE_FINISH="PASS_WAVE_MOVE_FINISH",t.SELECT_SKILL_FINISH="SELECT_SKILL_FINISH",t.GAMELOSE_GRID="GAMELOSE_GRID",t.OPEN_HOME_VIEW="OPEN_HOME_VIEW"}(n.EGameEvent||(n.EGameEvent={})),function(t){t[t.Default=0]="Default",t[t.Breath=1]="Breath",t[t.Move=2]="Move",t[t.Attack=3]="Attack",t[t.BeBack=4]="BeBack",t[t.Hit=5]="Hit",t[t.Dead=6]="Dead",t[t.Dizziness=7]="Dizziness",t[t.Skill=8]="Skill"}(n.RoleState||(n.RoleState={})),function(t){t[t.NONE=0]="NONE",t[t.ROLES=1]="ROLES",t[t.ENEMYS=2]="ENEMYS",t[t.M_BULLET=3]="M_BULLET",t[t.E_BULLET=4]="E_BULLET",t[t.OBSTACLE=5]="OBSTACLE",t[t.BUILD=6]="BUILD",t[t.SQUARE=7]="SQUARE",t[t.BOX=8]="BOX",t[t.WEAPON=9]="WEAPON",t[t.FUELCAN=10]="FUELCAN",t[t.LANDMINE=11]="LANDMINE"}(n.GameMapType||(n.GameMapType={})),function(t){t[t.BULLET_MOVE_SPEED=13]="BULLET_MOVE_SPEED",t[t.GRID_SPEED=.132]="GRID_SPEED",t[t.COLLIDER_BASE_TIME=.1]="COLLIDER_BASE_TIME",t[t.BALL_SPEED=275]="BALL_SPEED",t[t.BOSS_BALL_SPEED=180]="BOSS_BALL_SPEED",t[t.FRENZY_TIME=10]="FRENZY_TIME",t[t.CHECK_COLLIDER_TIME=.08333333333333333]="CHECK_COLLIDER_TIME"}(n.EGameEnum||(n.EGameEnum={})),function(t){t.DEFAULT="DEFAULT",t.BUILD="BUILD",t.OBSTACLE="OBSTACLE"}(i=n.ColliderName||(n.ColliderName={})),function(t){t[t.NONE=0]="NONE",t[t.CHECK_EMPTY=1]="CHECK_EMPTY",t[t.CHECK_HOLD=2]="CHECK_HOLD"}(n.GridBgStatus||(n.GridBgStatus={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.Add=1]="Add"}(n.GridStatus||(n.GridStatus={})),function(t){t[t.NONE=0]="NONE",t[t.FIXED=1]="FIXED",t[t.RADOM=2]="RADOM",t[t.FIXEDRADOM=3]="FIXEDRADOM",t[t.RADOMTWO=4]="RADOMTWO"}(n.BoxType||(n.BoxType={})),function(t){t[t.NONE=0]="NONE",t[t.RESOURCE=1]="RESOURCE",t[t.PROPS=2]="PROPS",t[t.BOX=3]="BOX",t[t.EQUIPMENTFRAGMENT=4]="EQUIPMENTFRAGMENT",t[t.CARFRAGMENT=5]="CARFRAGMENT"}(n.ItemType||(n.ItemType={})),function(t){t[t.NONE=0]="NONE",t[t.VIDEOBUY=1]="VIDEOBUY",t[t.GLODBUY=2]="GLODBUY",t[t.GEMBUY=3]="GEMBUY"}(n.BuyType||(n.BuyType={})),function(t){t.COLOR_NORMAL="#DEDEDE",t.COLOR_EMPTY="#A1E865",t.COLOR_HOLD="#F96666"}(n.GridColor||(n.GridColor={})),n.OrginMapGridsData=[[0,0,0,0,0,0],[0,0,0,0,0,0],[0,1,1,1,1,0],[0,1,1,1,1,0],[0,1,1,1,1,0],[0,1,1,1,1,0],[0,1,1,1,1,0],[0,1,1,1,1,0],[0,1,1,1,1,0],[0,0,0,0,0,0],[0,0,0,0,0,0]],function(t){t[t.FORM_0=0]="FORM_0",t[t.FORM_31=31]="FORM_31",t[t.FORM_11=11]="FORM_11",t[t.FORM_21=21]="FORM_21",t[t.FORM_32=32]="FORM_32",t[t.FORM_12=12]="FORM_12",t[t.FORM_44=44]="FORM_44",t[t.FORM_23=23]="FORM_23",t[t.FORM_33=33]="FORM_33",t[t.FORM_13=13]="FORM_13",t[t.FORM_22=22]="FORM_22",t[t.FORM_14=14]="FORM_14",t[t.FORM_45=45]="FORM_45",t[t.FORM_46=46]="FORM_46",t[t.FORM_47=47]="FORM_47",t[t.FORM_48=48]="FORM_48",t[t.FORM_49=49]="FORM_49"}(n.EquipmentFormIdx||(n.EquipmentFormIdx={})),n.EquipmentData={form31:{name:"Item1_1",data:[[1]],center:[0,0],type:2,grids:1,colOffset:0},form11:{name:"Item2_1",data:[[1,1]],center:[.5,0],type:2,grids:2,colOffset:0},form21:{name:"Item2_2",data:[[1],[1]],center:[0,.5],type:1,grids:2,colOffset:0},form32:{name:"Item2_3",data:[[1],[1]],center:[0,.5],type:1,grids:2,colOffset:0},form12:{name:"Item3_1",data:[[1],[1],[1]],center:[0,1],type:2,grids:3,colOffset:0},form44:{name:"Item3_2",data:[[0,1],[1,1]],center:[-.5,.5],type:1,grids:3,colOffset:1},form23:{name:"Item3_3",data:[[1,1],[1,0]],center:[.5,.5],type:1,grids:3,colOffset:0},form33:{name:"Item3_4",data:[[1,0],[1,1]],center:[.5,.5],type:1,grids:3,colOffset:0},form13:{name:"Item3_5",data:[[1,1],[0,1]],center:[.5,.5],type:1,grids:3,colOffset:0},form22:{name:"Item4_4",data:[[1,1],[1,1]],center:[.5,.5],type:1,grids:4,colOffset:0},form14:{name:"Item4_5",data:[[1,1,1],[0,1]],center:[1,.5],type:1,grids:4,colOffset:0},form45:{name:"Item4_6",data:[[0,1,0],[1,1,1]],center:[0,.5],type:1,grids:4,colOffset:1},form46:{name:"Item4_4",data:[[1,1],[1,1]],center:[.5,.5],type:1,grids:4,colOffset:0},form47:{name:"Item2_3",data:[[1,1,1]],center:[1,0],type:2,grids:3,colOffset:0},form48:{name:"Item2_4",data:[[1,1]],center:[.5,0],type:2,grids:2,colOffset:0},form49:{name:"Item4_7",data:[[0,1],[1,1],[0,1]],center:[-.5,1],type:1,grids:4,colOffset:1}},n.EquipFormDataToIdx={Item1_1:1,Item2_1:2,Item2_2:3,Item2_3:4,Item3_1:5,Item3_2:6,Item3_3:7,Item3_4:8,Item3_5:9,Item4_4:10,Item4_5:12,Item4_6:11},function(t){t[t.NONE=0]="NONE",t[t.EQUIPMENT=1]="EQUIPMENT",t[t.EXTENSION=2]="EXTENSION"}(n.EquipmentType||(n.EquipmentType={})),function(t){t[t.NONE=0]="NONE",t[t.THUNDER=1]="THUNDER",t[t.HeavyRain=2]="HeavyRain",t[t.Night=3]="Night",t[t.SandWind=4]="SandWind",t[t.IceAndSnow=5]="IceAndSnow",t[t.HeavyFog=6]="HeavyFog"}(n.WeatherType||(n.WeatherType={})),n.ArrayNeedCheckColliderMove=[i.BUILD,i.OBSTACLE],cc._RF.pop(),cc._RF.pop()},{}],GameGlobal:[function(t,e,a){"use strict";cc._RF.push(e,"2c33dD9HuBMFawrNU4Ja4g4","GameGlobal");var i=t,o=e,n=a;cc._RF.push(o,"7b279zdvWRKlaayT03tFO83","GameGlobal"),Object.defineProperty(n,"__esModule",{value:!0}),n.GameGlobal=n.GGC=void 0;var r=i("AudioManager"),s=i("ComponentBase"),c=i("EventManager"),l=i("CommonUtil"),u=i("AppProxy"),p=i("HomeEnum"),h=i("AudioUtil"),d=cc._decorator,m=d.ccclass;d.property,n.GGC=null;var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._musicName="",e}return __extends(e,t),Object.defineProperty(e.prototype,"musicName",{get:function(){return this._musicName},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){t.prototype.onLoad.call(this),n.GGC=this,h.audioUtil.init()},e.prototype.registerEvents=function(){c.EventManager.instance.on(u.AppEvent.AUDIO_CLICK,this.playBtnAudio,this),c.EventManager.instance.on(u.AppEvent.BGM_CHANGED,this.playBgm,this)},e.prototype.onDestroy=function(){c.EventManager.instance.off(u.AppEvent.AUDIO_CLICK,this.playBtnAudio,this),c.EventManager.instance.off(u.AppEvent.BGM_CHANGED,this.playBgm,this),t.prototype.onDestroy.call(this)},e.prototype.playBtnAudio=function(){h.audioUtil.playBtnAudio()},e.prototype.playBgm=function(t){if(!l.CommonUtil.isEmpty(t))switch(t){case u.BgmTypes.close:this._musicName,r.AudioManager.instance.stopBgm();break;case u.BgmTypes.open:this._musicName,r.AudioManager.instance.playBgmPath("sounds/bgm",p.Bundles.RES,!0);break;case u.BgmTypes.load:case u.BgmTypes.main:case u.BgmTypes.draw:case u.BgmTypes.battle_ready:break;case u.BgmTypes.battle:}r.AudioManager.instance.setBgmVolume(1)},e.isFirstOpen=!0,__decorate([m],e)}(s.ComponentBase);n.GameGlobal=f,cc._RF.pop(),cc._RF.pop()},{}],GameLoopRewardPopup:[function(t,e,a){"use strict";cc._RF.push(e,"5c1099iaDRAT74+O2f22Nxj","GameLoopRewardPopup");var i=t,o=e,n=a;cc._RF.push(o,"69184ZqripEVIlqGLCC5rwq","GameLoopRewardPopup"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("List"),s=i("EventManager"),c=i("ResUtil"),l=i("PopupBase"),u=i("HomeEnum"),p=i("DataManager"),h=i("UserDataProxy"),d=i("Util"),m=i("GameUIManager"),f=i("RedDotMgr"),_=cc._decorator,y=_.ccclass,g=_.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mLoopTips=null,e.mMyList=null,e._datastagereward=[],e}return __extends(e,t),e.prototype.init=function(){var t=p.DataManager.instance.eData.datastagereward;for(var e in t)""!=t[e].roundReward&&this._datastagereward.push(t[e]);this.mLoopTips.string="\u5f53\u524d\uff1a\u7b2c"+h.userDataProxy.userData.loopNum+"\u8f6e",h.userDataProxy.userData.roundReward||(h.userDataProxy.userData.roundReward={})},e.prototype.onShow=function(){this.mMyList.numItems=this._datastagereward.length},e.prototype.onUpdateItem=function(t,e){var a=this._datastagereward[e];t.getChildByName("countLab").getComponent(cc.Label).string="\u7b2c\n"+a.round+"\n\u8f6e";var i=t.getChildByName("BtnReceive"),o=t.getChildByName("already"),n=t.getChildByName("bg2"),r=t.getChildByName("titleBg2");h.userDataProxy.userData.passChapter>=a.id?h.userDataProxy.userData.roundReward[a.round]?(i.active=!1,o.active=!0,n.active=!0,r.active=!0):(i.active=!0,o.active=!1,n.active=!1,r.active=!1,d.default.addButtonListener(i,"GameLoopRewardPopup","onItemReceive",this.node,{datastagereward:a,item:t,idx:e})):(i.active=!1,o.active=!1,n.active=!0,r.active=!0);for(var s=a.roundReward.split("|"),l=t.getChildByName("layout"),m=function(t){var e=s[t].split("_"),a=p.DataManager.instance.eData.dataitem[Number(e[0])];if(!a)return"continue";var i=l.children[t];i||((i=cc.instantiate(l.children[0])).parent=l);var o=i.getChildByName("itemBg").getComponent(cc.Sprite);c.ResUtil.loadAsset({path:"textures/public/item_bg"+a.qulity,type:cc.SpriteFrame,bundleName:u.Bundles.GAME}).then(function(t){o.spriteFrame=t}).catch(function(t){console.log("error:",t)});var n=i.getChildByName("itemImg").getComponent(cc.Sprite);c.ResUtil.loadAsset({path:"textures/item/"+a.icon,type:cc.SpriteFrame,bundleName:u.Bundles.GAME}).then(function(t){n.spriteFrame=t}).catch(function(t){console.log("error:",t)}),i.getChildByName("itemNum").getComponent(cc.Label).string="x"+e[1]},f=0,_=s.length;f<_;f++)m(f)},e.prototype.onItemReceive=function(t,e){if(h.userDataProxy.userData.roundReward[e.datastagereward.round])m.gameUIMgr.showTips("\u5956\u52b1\u5df2\u9886\u53d6\uff01");else{h.userDataProxy.userData.roundReward[e.datastagereward.round]=1,h.userDataProxy.saveData();for(var a=[],i=e.datastagereward.roundReward.split("|"),o=0,n=i.length;o<n;o++){var r=i[o].split("_");2==r.length&&a.push({id:Number(r[0]),num:Number(r[1])})}m.gameUIMgr.showCongratsGettingPopup({list:a,type:1}),this.onUpdateItem(e.item,e.idx),s.EventManager.instance.emit(h.EUserDataEvent.UPDATE_LOOP_REWARD_RED),f.default.instance.updateRedDotState([u.HOME_REDDOT.BATTLERED])}},__decorate([g(cc.Label)],e.prototype,"mLoopTips",void 0),__decorate([g(r.default)],e.prototype,"mMyList",void 0),__decorate([y],e)}(l.PopupBase);n.default=v,cc._RF.pop(),cc._RF.pop()},{}],GameLosePopup:[function(t,e,a){"use strict";cc._RF.push(e,"7192cZnKOxMFJ/9nHv2eR9D","GameLosePopup");var i=t,o=e,n=a;cc._RF.push(o,"89038N0GoBCsJdCRnFUsyOi","GameLosePopup"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("ResUtil"),c=i("PopupBase"),l=i("SceneManager"),u=i("AdsMgr"),p=i("GameEnum"),h=i("HomeEnum"),d=i("DataManager"),m=i("BattleDataProxy"),f=i("UserDataProxy"),_=i("AnimationMgr"),y=cc._decorator,g=y.ccclass,v=y.property,P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mTips1=null,e.mTips2=null,e.mItemLayout=null,e._isCanClick=!0,e._reawards=[],e._double=1,e}return __extends(e,t),e.prototype.init=function(e){t.prototype.init.call(this,e),r.AudioManager.instance.stopBgm(),r.AudioManager.instance.playEffectPath("sounds/lose",h.Bundles.RES),m.battleDataProxy.isEndless?this.endlessOver():m.battleDataProxy.weatherType!=p.WeatherType.NONE?this.weatherOver():this.chapterOver(),this.updateVideoCardNum(),m.battleDataProxy.gameState=p.GameState.OVER;var a=Math.floor(1e3*Math.random())%3+1;this.mTips2.string=d.DataManager.instance.eData.datasettlement[2]["des"+a],m.battleDataProxy.isGameLose=!0,m.battleDataProxy.clearData()},e.prototype.weatherOver=function(){var t=f.userDataProxy.userData.cursWeatherChapter,e=d.DataManager.instance.eData.data_weather[t];if(e){for(var a=[],i=0,o=f.userDataProxy.userData.curWeatherWave/20,n=e.reward.split("|"),r=function(t){var e=n[t].split("_");if((i=Math.floor(o*Number(e[1])))>0){var r=a.findIndex(function(t){return t.id==Number(e[0])});r>=0?a[r].num+=i:a.push({id:Number(e[0]),num:i})}},s=0,c=n.length;s<c;s++)r(s);this.setRewardItems(a),this._reawards=a}},e.prototype.endlessOver=function(){for(var t=d.DataManager.instance.eData.datapara[1005].num,e=d.DataManager.instance.eData.datapara[1006].num,a=Math.ceil(m.battleDataProxy.endlessCurWave/5),i=[],o=0,n=t.split("|"),r=e.split("|"),s=0,c=n.length;s<c;s++){var l=n[s].split("_");(o=Math.floor(1*Number(l[1])))>0&&i.push({id:Number(l[0]),num:o})}var u=function(t){var e=r[t].split("_");if((o=Math.floor(1*Number(e[1]))*a)>0){var n=i.findIndex(function(t){return t.id==Number(e[0])});n>=0?i[n].num+=o:i.push({id:Number(e[0]),num:o})}};for(s=0,c=r.length;s<c;s++)u(s);this.setRewardItems(i),this._reawards=i,f.userDataProxy.userData.endlessData.maxWave<m.battleDataProxy.endlessCurWave&&(f.userDataProxy.userData.endlessData.maxWave=m.battleDataProxy.endlessCurWave,f.userDataProxy.saveData()),m.battleDataProxy.uploadEndlessResult(function(){m.battleDataProxy.getEndlessRankDatas(function(){})})},e.prototype.chapterOver=function(){var t=m.battleDataProxy.getStageRewardCfg(),e=t.winReward.split("|"),a=[],i=0,o=f.userDataProxy.userData.curWave/Number(t.wave);o>1&&(o=1);for(var n=0,r=e.length;n<r;n++){var s=e[n].split("_");(i=Math.floor(o*Number(s[1])))>0&&a.push({id:Number(s[0]),num:i})}a=f.userDataProxy.checkBoxRetrunAwards(a),this.setRewardItems(a),this._reawards=a},e.prototype.setRewardItems=function(t){t=f.userDataProxy.checkBoxRetrunAwards(t);for(var e=function(e){var i=d.DataManager.instance.eData.dataitem[t[e].id],o=a.mItemLayout.children[e];o||((o=cc.instantiate(a.mItemLayout.children[0])).parent=a.mItemLayout),o.active=!0;var n=o.getChildByName("itemBg").getComponent(cc.Sprite);s.ResUtil.loadAsset({path:"textures/public/item_bg"+i.qulity,type:cc.SpriteFrame,bundleName:h.Bundles.GAME}).then(function(t){n.spriteFrame=t}).catch(function(t){console.log("error:",t)});var r=o.getChildByName("itemImg").getComponent(cc.Sprite);s.ResUtil.loadAsset({path:"textures/item/"+i.icon,type:cc.SpriteFrame,bundleName:h.Bundles.GAME}).then(function(t){r.spriteFrame=t}).catch(function(t){console.log("error:",t)}),o.getChildByName("itemNum").getComponent(cc.Label).string="x"+t[e].num},a=this,i=0,o=t.length;i<o;i++)e(i)},e.prototype.updateVideoCardNum=function(){var t=this.node.getChildByName("BtnDouble").getChildByName("pic_AD_green");m.battleDataProxy.setVideoCardIcon(t,2,1.5)},e.prototype.onBtnReceive=function(){this._isCanClick&&(this._double=1,this.toHome())},e.prototype.onBtnDouble=function(){var t=this;if(this._isCanClick){if(f.userDataProxy.getProp(4)>0)return f.userDataProxy.addProp(4,-1),this._double=2,void this.toHome();u.default.showVideoAds({id:1,eventId:"game_lose_double_ad",success:function(){t._double=2,t.toHome()},fail:function(t){return console.log(t)},error:function(t){return console.log(t)}},!0)}},e.prototype.toHome=function(){var t=this;this._isCanClick=!1;for(var e=this.node.getChildByName("layout"),a=0,i=this._reawards.length,o=i>0?2:0,n=function(o){var n=e.children[o];if(!n.active)return"continue";var s=r._reawards[a];r.scheduleOnce(function(){s&&(n.active=!1,_.default.instance.showAwardAni(s,t.node,n,0,cc.v3(-250,s.id>6?-850:850)),f.userDataProxy.addProp(s.id,s.num*t._double,a+1==i))},.1*a),a++},r=this,s=0;s<e.children.length;++s)n(s);this.scheduleOnce(function(){l.SceneManager.instance.runScene("Home",""),t.removeUI()},.1*a+o)},__decorate([v(cc.Label)],e.prototype,"mTips1",void 0),__decorate([v(cc.Label)],e.prototype,"mTips2",void 0),__decorate([v(cc.Node)],e.prototype,"mItemLayout",void 0),__decorate([g],e)}(c.PopupBase);n.default=P,cc._RF.pop(),cc._RF.pop()},{}],GameRevivePopup:[function(t,e,a){"use strict";cc._RF.push(e,"2ee42KaZ7VNXpSMLaYmwpiS","GameRevivePopup");var i=t,o=e,n=a;cc._RF.push(o,"8615eIdoiRAFaAxXso/9H6q","GameRevivePopup"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("EventManager"),c=i("PopupBase"),l=i("AdsMgr"),u=i("GameEnum"),p=i("HomeEnum"),h=i("BattleDataProxy"),d=i("UserDataProxy"),m=i("GameUIManager"),f=cc._decorator,_=f.ccclass,y=f.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mTime=null,e}return __extends(e,t),e.prototype.init=function(){h.battleDataProxy.gameState=u.GameState.PAUSE,this.updateVideoCardNum(),r.AudioManager.instance.playEffectPath("sounds/revive",p.Bundles.RES),this.mTime.string="\u5269\u4f59\u590d\u6d3b\u6b21\u6570:"+(3-(h.battleDataProxy.battleData.reviveNum-1))+"/3"},e.prototype.updateVideoCardNum=function(){var t=this.node.getChildByName("BtnRevive").getChildByName("pic_AD_yello");h.battleDataProxy.setVideoCardIcon(t,4,1.5)},e.prototype.onBtnRevive=function(){var t=this;if(d.userDataProxy.getProp(4)>0)return d.userDataProxy.addProp(4,-1),void this.onRevive();l.default.showVideoAds({id:1,eventId:"game_revive_ad",success:function(){t.onRevive()},fail:function(){},error:function(){}},!0)},e.prototype.onRevive=function(){s.EventManager.instance.emit(h.EBattleEvent.RESURGENCE),this.removeUI()},e.prototype.onBtnClose=function(){h.battleDataProxy.isEndless?m.gameUIMgr.showEndlessOverPopup():m.gameUIMgr.showGameLosePopup(),this.removeUI()},__decorate([y(cc.Label)],e.prototype,"mTime",void 0),__decorate([_],e)}(c.PopupBase);n.default=g,cc._RF.pop(),cc._RF.pop()},{}],GameSave:[function(t,e,a){"use strict";cc._RF.push(e,"5cfa8V4S8xI1I9yHJpDKpgN","GameSave");var i=t,o=e,n=a;cc._RF.push(o,"f548cwxOy1H8ZMHhwc7Epae","GameSave"),Object.defineProperty(n,"__esModule",{value:!0}),n.GameSave=void 0;var r=i("GBaseData"),s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.playerID="",e.playerName="",e.userCode="",e.lifeTime=0,e.lastLoginTime=0,e.gold=0,e.power=0,e.myItemMap=new Map,e.myEquipMap=new Map,e.myRoleMap=new Map,e.customData={},e.autoRefreshData={},e}return __extends(e,t),__decorate([c],e)}(r.default));n.GameSave=l,cc._RF.pop(),cc._RF.pop()},{}],GameScene:[function(t,e,a){"use strict";cc._RF.push(e,"b7637QTR5pHj4BSYNMqG6PP","GameScene");var i=t,o=e,n=a;cc._RF.push(o,"0088707qmtJUqzffRiwAXyw","GameScene"),Object.defineProperty(n,"__esModule",{value:!0}),n.GameScene=void 0;var r=i("AudioManager"),s=i("SceneBase"),c=i("HomeEnum"),l=i("BattleDataProxy"),u=i("GameUI"),p=cc._decorator,h=p.ccclass,d=p.property;cc.internal.inputManager._maxTouches=1;var m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mUICamera=null,e.mGameCamera=null,e.mGameUIPb=null,e._gameUI=null,e}return __extends(e,t),e.prototype.onDestroy=function(){t.prototype.onDestroy.call(this)},e.prototype.onLoad=function(){t.prototype.onLoad.call(this),l.battleDataProxy.gameCamera=this.mGameCamera,l.battleDataProxy.enterGame(),r.AudioManager.instance.playBgmPath("sounds/battleBGM",c.Bundles.RES),cc.director.getScene().name="Game"},e.prototype.onDisable=function(){},e.prototype.start=function(){this.addGameUI()},e.prototype.addGameUI=function(){this._gameUI=cc.instantiate(this.mGameUIPb),this.node.addChild(this._gameUI),this._gameUI.getComponent(u.default).initUI()},e.prototype.gameStart=function(){},__decorate([d(cc.Node)],e.prototype,"mUICamera",void 0),__decorate([d(cc.Node)],e.prototype,"mGameCamera",void 0),__decorate([d(cc.Prefab)],e.prototype,"mGameUIPb",void 0),__decorate([h],e)}(s.SceneBase);n.GameScene=m,cc._RF.pop(),cc._RF.pop()},{}],GameSettingPopup:[function(t,e,a){"use strict";cc._RF.push(e,"1994dg+NdJE6YTjApMGLbSV","GameSettingPopup");var i=t,o=e,n=a;cc._RF.push(o,"37c8dxhuO5Oy4PrSZl1v11H","GameSettingPopup"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("EventManager"),c=i("HttpRequest"),l=i("CommonUtil"),u=i("PopupBase"),p=i("PopupManager"),h=i("SceneManager"),d=i("GameEnum"),m=i("HomeEnum"),f=i("DataManager"),_=i("BattleDataProxy"),y=i("UserDataProxy"),g=i("UserSetDataProxy"),v=i("GameUIManager"),P=cc._decorator,b=P.ccclass,D=P.property,S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nEffectAudio=null,e.nMusicAudio=null,e.nShake=null,e.mVersions=null,e.mUID=null,e.mCodeBox=null,e.musicVolumeSlider=null,e.musicVolumePro=null,e.effectVolumeSlider=null,e.effectVolumePro=null,e.mMusicVolumeLab=null,e.mEffectVolumeLab=null,e.mShakeLab=null,e.mGameRoot=null,e.mHomeRoot=null,e.mTestBtn=null,e.mTitleClickNum=0,e}return __extends(e,t),e.prototype.onLoad=function(){if(t.prototype.onLoad.call(this),s.EventManager.instance.on(m.EHomeEvent.CHANGE_CONFIG_NOTIFY,this.onConfigChange,this),this.mTestBtn.active=yzll.gameConfig.mainTestBtn||yzll.gameConfig.isZB,cc.sys.platform==cc.sys.WECHAT_GAME){var e=this.mHomeRoot.getChildByName("BtncdKey");this.mHomeRoot.getChildByName("editBox").active=!1,e.active=!1,this.mUID.node.active=!1}else this.mUID.string="UUID:"+f.DataManager.playerId+" \u70b9\u51fb\u590d\u5236";this.mVersions.string="v"+mm.platform.versionStr+(yzll.gameConfig.debug?f.DataManager.instance.userVersion:"")},e.prototype.onDestroy=function(){s.EventManager.instance.off(m.EHomeEvent.CHANGE_CONFIG_NOTIFY,this.onConfigChange,this)},e.prototype.onConfigChange=function(){this.mVersions.string="v"+mm.platform.versionStr+(yzll.gameConfig.debug?f.DataManager.instance.userVersion:"")},e.prototype.init=function(t){_.battleDataProxy.isStartFight&&(_.battleDataProxy.gameState=d.GameState.PAUSE),this.mTitleClickNum=0,this.mGameRoot.active=t.isGame,this.mHomeRoot.active=!t.isGame,s.EventManager.instance.on(r.EAudioEvent.BACKGROUND_AUDIO_SWITCH_CHANGE,this.updateView,this),s.EventManager.instance.on(r.EAudioEvent.EFFECT_AUDIO_SWITCH_CHANGE,this.updateView,this),this.updateView()},e.prototype.onShow=function(){yzll.gameConfig.isGM&&this.initBgSelContent()},e.prototype.onDisable=function(){s.EventManager.instance.off(r.EAudioEvent.BACKGROUND_AUDIO_SWITCH_CHANGE,this.updateView,this),s.EventManager.instance.off(r.EAudioEvent.EFFECT_AUDIO_SWITCH_CHANGE,this.updateView,this),g.userSetDataProxy.saveData(),t.prototype.onDisable.call(this)},e.prototype.updateView=function(){this.musicVolumeSlider.progress=g.userSetDataProxy.setData.musicVolume,this.musicVolumePro.fillRange=g.userSetDataProxy.setData.musicVolume,this.effectVolumeSlider.progress=g.userSetDataProxy.setData.effectVolume,this.effectVolumePro.fillRange=g.userSetDataProxy.setData.effectVolume;var t=g.userSetDataProxy.setData.isOpenShake;this.nShake.getChildByName("Close").active=!t,this.nShake.getChildByName("Open").active=t,this.mShakeLab.string=t?"\u5f00":"\u5173",this.mMusicVolumeLab.string=(100*g.userSetDataProxy.setData.musicVolume).toFixed(0),this.mEffectVolumeLab.string=(100*g.userSetDataProxy.setData.effectVolume).toFixed(0)},e.prototype.onClickBtnEffectAudio=function(){},e.prototype.onClickBtnMusicAudio=function(){},e.prototype.onMusicVolumeSlider=function(t){this.musicVolumeSlider.progress=t.progress,this.musicVolumePro.fillRange=t.progress,r.AudioManager.instance.setBgmVolume(t.progress),g.userSetDataProxy.setData.musicVolume=t.progress,this.mMusicVolumeLab.string=(100*g.userSetDataProxy.setData.musicVolume).toFixed(0)},e.prototype.onEffectVolumeSlider=function(t){this.effectVolumeSlider.progress=t.progress,this.effectVolumePro.fillRange=t.progress,r.AudioManager.instance.setEffectVolume(t.progress),g.userSetDataProxy.setData.effectVolume=t.progress,this.mEffectVolumeLab.string=(100*g.userSetDataProxy.setData.effectVolume).toFixed(0)},e.prototype.onSlider1Changed=function(){},e.prototype.onSlider2Changed=function(){},e.prototype.onClickBtnShake=function(){g.userSetDataProxy.setVibrate(!g.userSetDataProxy.setData.isOpenShake),this.updateView()},e.prototype.onClickBtnExit=function(){this.removeUI(p.PopupCacheMode.ONCE,!1),_.battleDataProxy.clearData(),1==y.userDataProxy.userData.curChapter&&y.userDataProxy.userData.gameCourseData.curId<3&&(y.userDataProxy.userData.gameCourseData.curId=3,y.userDataProxy.userData.gameCourseData.completeId=3,y.userDataProxy.saveData()),p.PopupManager.instance.remove("CoursePopup"),h.SceneManager.instance.runScene("Home","Game",function(){})},e.prototype.onClickBtnClose=function(){this.removeUI(p.PopupCacheMode.ONCE,!1),_.battleDataProxy.isStartFight?_.battleDataProxy.gameState=d.GameState.PLAYING:_.battleDataProxy.gameState=d.GameState.READY},e.prototype.onBtncdKey=function(){},e.prototype.initBgSelContent=function(){},e.prototype.onBtnChangeMapFloor=function(t,e){l.CommonUtil.print("onBtnChangeMapFloor",e)},e.prototype.onTitleClick=function(){this.mTitleClickNum++,this.mTitleClickNum>=8&&(this.mTitleClickNum=0,v.gameUIMgr.showTortWarningPopup())},e.prototype.copyToClipboard=function(t){navigator.clipboard?navigator.clipboard.writeText(t).then(function(){v.gameUIMgr.showTips("\u590d\u5236\u6210\u529f~")}).catch(function(){v.gameUIMgr.showTips("\u590d\u5236\u5931\u8d25~")}):this.copyTextUsingExecCommand(t)},e.prototype.copyTextUsingExecCommand=function(t){var e=document.createElement("textarea");e.value=t,document.body.appendChild(e),e.select();try{var a=document.execCommand("copy")?"\u590d\u5236\u6210\u529f~":"\u590d\u5236\u5931\u8d25~";v.gameUIMgr.showTips(a)}catch(i){console.error("\u590d\u5236\u5931\u8d25:",i)}document.body.removeChild(e)},e.prototype.onBtnCopyUUID=function(){cc.sys.isBrowser?this.copyToClipboard(f.DataManager.playerId):mm.platform.setClipboardData(f.DataManager.playerId)},e.prototype.onBtnChange=function(){var t={value:this.mCodeBox.string},e=JSON.stringify({params:c.HttpRequest.inst.encryptStr(JSON.stringify(t))});c.HttpRequest.inst.request("POST","/player/cdkey/gm",e).then(function(t){if(200==t.code)if(""!=t.data){for(var e=t.data.split("|"),a=[],i=0,o=e.length;i<o;i++){var n=e[i].split("_");a.push({id:Number(n[0]),num:Number(n[1])})}v.gameUIMgr.showCongratsGettingPopup({list:a,type:1})}else cc.sys.isBrowser?v.gameUIMgr.showTips("\u6fc0\u6d3b\u6210\u529f\uff01"):v.gameUIMgr.showTips("\u5f00\u542f\u65e0\u5e7f\u6a21\u5f0f\uff01"),y.userDataProxy.userData.startGameRights=!0,y.userDataProxy.saveData(),yzll.gameConfig.isGM=!0;else v.gameUIMgr.showTips("\u65e0\u6548\u5151\u6362\u7801")}).catch(function(){v.gameUIMgr.showTips("\u65e0\u6548\u5151\u6362\u7801")})},e.prototype.onBtnTest=function(){p.PopupManager.instance.show({bundleName:m.Bundles.GAME,path:"uis/root/TestPopup",keep:!0})},__decorate([D(cc.Node)],e.prototype,"nEffectAudio",void 0),__decorate([D(cc.Node)],e.prototype,"nMusicAudio",void 0),__decorate([D(cc.Node)],e.prototype,"nShake",void 0),__decorate([D(cc.Label)],e.prototype,"mVersions",void 0),__decorate([D(cc.Label)],e.prototype,"mUID",void 0),__decorate([D(cc.EditBox)],e.prototype,"mCodeBox",void 0),__decorate([D(cc.Slider)],e.prototype,"musicVolumeSlider",void 0),__decorate([D(cc.Sprite)],e.prototype,"musicVolumePro",void 0),__decorate([D(cc.Slider)],e.prototype,"effectVolumeSlider",void 0),__decorate([D(cc.Sprite)],e.prototype,"effectVolumePro",void 0),__decorate([D(cc.Label)],e.prototype,"mMusicVolumeLab",void 0),__decorate([D(cc.Label)],e.prototype,"mEffectVolumeLab",void 0),__decorate([D(cc.Label)],e.prototype,"mShakeLab",void 0),__decorate([D(cc.Node)],e.prototype,"mGameRoot",void 0),__decorate([D(cc.Node)],e.prototype,"mHomeRoot",void 0),__decorate([D(cc.Node)],e.prototype,"mTestBtn",void 0),__decorate([b],e)}(u.PopupBase);n.default=S,cc._RF.pop(),cc._RF.pop()},{}],GameSound:[function(t,e,a){"use strict";cc._RF.push(e,"3f703VmDPhAmK1m1Od0GP7V","GameSound");var i=t,o=e,n=a;cc._RF.push(o,"32d5arRFmBNO4t2qQUSqN6+","GameSound"),Object.defineProperty(n,"__esModule",{value:!0}),n.GameSound=void 0;var r=i("AudioManager"),s=i("ComponentBase"),c=i("EventManager"),l=i("AppProxy"),u=i("HomeEnum"),p=cc._decorator,h=p.ccclass,d=(p.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this),c.EventManager.instance.on(l.AppEvent.AUDIO_CLICK,this.playClick,this)},e.prototype.onDestroy=function(){c.EventManager.instance.off(l.AppEvent.AUDIO_CLICK,this.playClick,this),t.prototype.onDestroy.call(this)},e.prototype.playClick=function(){r.AudioManager.instance.playEffectPath("sounds/click",u.Bundles.RES)},__decorate([h],e)}(s.ComponentBase));n.GameSound=d,cc._RF.pop(),cc._RF.pop()},{}],GameUIManager:[function(t,e,a){"use strict";cc._RF.push(e,"36200mwROxNYrDKv6/f5D+R","GameUIManager");var i=t,o=e,n=a;cc._RF.push(o,"6dad0ClurhIVr8EVrTSTbGg","GameUIManager"),Object.defineProperty(n,"__esModule",{value:!0}),n.gameUIMgr=n.GameUIManager=void 0;var r=i("AppBase"),s=i("ComponentBase"),c=i("ResUtil"),l=i("PopupManager"),u=i("HomeEnum"),p=i("Tips"),h=cc._decorator,d=h.ccclass,m=(h.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onLoad=function(){n.gameUIMgr=this,t.prototype.onLoad.call(this)},e.prototype.showDeclaration=function(){l.PopupManager.instance.show({bundleName:u.Bundles.GAME,path:"uis/main/CopyrightPopup",keep:!0})},e.prototype.showPublicTips=function(t,e,a,i,o){l.PopupManager.instance.show({bundleName:u.Bundles.GAME,path:"uis/main/PublicTipsPopup",keep:!0,params:{okCallBack:t,des:e,isVideo:a,cancelCallBack:i,btnDes:o}})},e.prototype.showTips=function(t){var e=r.topNode.getChildByName("Tips");if(e){var a=e.getComponent(p.default);if(a)return void a.pushTips(t)}c.ResUtil.loadAsset({bundleName:u.Bundles.RES,path:"uis/popup/Tips",type:cc.Prefab,success:function(e){e.addRef();var a=cc.instantiate(e);r.topNode.addChild(a);var i=a.getComponent(p.default);i&&i.pushTips(t)}})},e.prototype.showReceiveReward=function(t){void 0===t&&(t=null),l.PopupManager.instance.show({bundleName:u.Bundles.RES,path:"uis/popup/ReceiveAwardPopup",keep:!0,params:{onOpenComplete:t}})},e.prototype.showBuyPower=function(){l.PopupManager.instance.show({bundleName:u.Bundles.GAME,path:"uis/main/VitBuyPopup",keep:!0})},e.prototype.showBuyGold=function(){l.PopupManager.instance.show({bundleName:u.Bundles.GAME,path:"uis/main/GoldBuyPopup",keep:!0})},e.prototype.showTTSidebarPopup=function(){l.PopupManager.instance.show({bundleName:"res_TTSidebar",path:"prefab/TTSidebarPopup",keep:!0})},e.prototype.showSelectSkillPopup=function(){l.PopupManager.instance.show({bundleName:u.Bundles.GAME,path:"prefabs/popup/SelectSkillPopup",keep:!0})},e.prototype.showGameRevivePopup=function(){l.PopupManager.instance.show({bundleName:u.Bundles.GAME,path:"prefabs/popup/GameRevivePopup",keep:!0})},e.prototype.showGameWinPopup=function(){l.PopupManager.instance.show({bundleName:u.Bundles.GAME,path:"prefabs/popup/GameWinPopup",keep:!0})},e.prototype.showGameLosePopup=function(){l.PopupManager.instance.show({bundleName:u.Bundles.GAME,path:"prefabs/popup/GameLosePopup",keep:!0})},e.prototype.showGameSettingPopup=function(t){l.PopupManager.instance.show({bundleName:u.Bundles.GAME,path:"prefabs/popup/GameSettingPopup",keep:!0,params:{isGame:t}})},e.prototype.showGameLoopRewardPopup=function(){l.PopupManager.instance.show({bundleName:u.Bundles.GAME,path:"prefabs/popup/GameLoopRewardPopup",keep:!0})},e.prototype.showPlantEquipDetailsPopup=function(t,e,a,i){void 0===i&&(i=!0),l.PopupManager.instance.show({bundleName:u.Bundles.GAME,path:"prefabs/popup/PlantEquipDetailsPopup",keep:!0,params:{plantData:t,isWear:e,isShowWear:i,idx:a}})},e.prototype.showCongratsGettingPopup=function(t){l.PopupManager.instance.show({bundleName:u.Bundles.GAME,path:"prefabs/popup/CongratsGettingPopup",keep:!0,params:{args:t}})},e.prototype.showEquipmentFragmentsPopup=function(){l.PopupManager.instance.show({bundleName:u.Bundles.GAME,path:"prefabs/popup/EquipmentFragmentsPopup",keep:!0})},e.prototype.showUnlockNewPlantPopup=function(t){l.PopupManager.instance.show({bundleName:u.Bundles.GAME,path:"prefabs/popup/UnlockNewPlantPopup",keep:!0,params:{closeFunc:t}})},e.prototype.showSuperPlantMapPopup=function(){l.PopupManager.instance.show({bundleName:u.Bundles.GAME,path:"prefabs/popup/SuperPlantMapPopup",keep:!0})},e.prototype.showVideoPhysicalPopup=function(){l.PopupManager.instance.show({bundleName:u.Bundles.GAME,path:"prefabs/popup/VideoPhysicalPopup",keep:!0})},e.prototype.showSelectSuperPlantPopup=function(){l.PopupManager.instance.show({bundleName:u.Bundles.GAME,path:"prefabs/popup/SelectSuperPlantPopup",keep:!0})},e.prototype.showEnemyDetailsPopup=function(t){l.PopupManager.instance.show({bundleName:u.Bundles.GAME,path:"prefabs/popup/EnemyDetailsPopup",keep:!0,params:{enemyId:t}})},e.prototype.showVideoDiamondPopup=function(t){l.PopupManager.instance.show({bundleName:u.Bundles.GAME,path:"prefabs/popup/VideoDiamondPopup",keep:!0,params:{closeFunc:t}})},e.prototype.showCoursePopup=function(t){l.PopupManager.instance.show({bundleName:u.Bundles.GAME,path:"prefabs/popup/CoursePopup",keep:!0,params:{args:t}})},e.prototype.showTortWarningPopup=function(){l.PopupManager.instance.show({bundleName:u.Bundles.GAME,path:"prefabs/popup/TortWarningPopup",keep:!0})},e.prototype.showTTSidebar=function(){console.log("\u6253\u5f00\u4fa7\u8fb9\u680f"),l.PopupManager.instance.show({bundleName:"res_TTSidebar",path:"prefab/TTSidebarPopup",keep:!0,params:{}})},e.prototype.showPromoteTipsPopup=function(){l.PopupManager.instance.show({bundleName:u.Bundles.GAME,path:"prefabs/popup/PromoteTipsPopup",keep:!0})},e.prototype.showRandomSuperPlantPopup=function(){l.PopupManager.instance.show({bundleName:u.Bundles.GAME,path:"prefabs/popup/RandomSuperPlantPopup",keep:!0})},e.prototype.showVideoSunshinePopup=function(t){l.PopupManager.instance.show({bundleName:u.Bundles.GAME,path:"prefabs/popup/VideoSunshinePopup",keep:!0,params:{closeFunc:t}})},e.prototype.showEndlessStartPopup=function(){l.PopupManager.instance.show({bundleName:u.Bundles.GAME,path:"prefabs/popup/EndlessStartPopup",keep:!0})},e.prototype.showEndlessRewardPopup=function(t){l.PopupManager.instance.show({bundleName:u.Bundles.GAME,path:"prefabs/popup/EndlessRewardPopup",keep:!0,params:{myRank:t}})},e.prototype.showSetNikeNamePopup=function(t){l.PopupManager.instance.show({bundleName:u.Bundles.GAME,path:"prefabs/popup/SetNikeNamePopup",keep:!0,params:{closeFunc:t}})},e.prototype.showEndlessOverPopup=function(){l.PopupManager.instance.show({bundleName:u.Bundles.GAME,path:"prefabs/popup/EndlessOverPopup",keep:!0})},e.prototype.showContinueGamePopup=function(t){l.PopupManager.instance.show({bundleName:u.Bundles.GAME,path:"prefabs/popup/ContinueGamePopup",keep:!0,params:{callBack:t}})},e.prototype.showMessagePopup=function(t,e,a,i,o,n,r,s){l.PopupManager.instance.show({bundleName:u.Bundles.GAME,path:"prefabs/popup/MessagePopup",keep:!0,params:{title:t,tips:e,isVideo:a,isGameVideo:i,closeLab:o,sltLab:n,hideClose:r,callBack:s}})},e.prototype.showReportUI=function(){l.PopupManager.instance.show({bundleName:"res_Report",path:"UIReport",keep:!0})},__decorate([d],e)}(s.ComponentBase));n.GameUIManager=m,cc._RF.pop(),cc._RF.pop()},{}],GameUI:[function(t,e,a){"use strict";cc._RF.push(e,"83ba2Vg7BlEY4Qq2tAVyMcw","GameUI");var i=t,o=e,n=a;cc._RF.push(o,"1305a8OABdDVL493Kw4+kMz","GameUI"),Object.defineProperty(n,"__esModule",{value:!0}),n.COL_MAX=n.ROW_MAX=void 0;var r=i("AudioManager"),c=i("EventManager"),l=i("MathUtil"),u=i("ResUtil"),p=i("PopupManager"),h=i("AdsMgr"),d=i("GameEnum"),m=i("HomeEnum"),f=i("DataManager"),_=i("NodePoolManager"),y=i("BattleDataProxy"),g=i("UserDataProxy"),v=i("Util"),P=i("GameUIManager"),b=i("AnimationMgr"),D=i("SkillDataMgr"),S=i("BattleBaseInfoView"),C=i("BattleView"),E=i("BuildBase"),B=i("BulletBall"),A=i("ActiveSuperPlant"),x=i("EquipmentItem"),M=i("FrenzyBar"),N=i("MapBlockItem"),R=i("MapGridItem"),T=i("SelectLayout"),I=i("CourseView"),w=i("SuperPlantMapItem"),k=cc._decorator,F=k.ccclass,L=k.property;n.ROW_MAX=11,n.COL_MAX=6;var O=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mGridsLayout=null,e.mSelectLayout=null,e.mEquipmentNode=null,e.mBtnGetGrid=null,e.mBtnRefreshVideo=null,e.mBtnRefresh=null,e.mBtnLayout=null,e.mBulletBallPb=null,e.mBallView=null,e.mBattleBaseInfoView=null,e.mBattleView=null,e.mPathView=null,e.mBuildBase=null,e.mBtnRecycle=null,e.mPathPointView=null,e.mSuperPlantView=null,e.mChapterBg=null,e.mPathWallView=null,e.mMapBlockItemPb=null,e.mBlockLayout=null,e.mFrenzyBar=null,e.mZbTips=null,e.mBulletView=null,e._mapGridsData=[],e._gridsMap=new Map,e._selectEquipment=null,e._rowColInfo=null,e._lightGird=[],e._moveResult=null,e._freeRefreshCnt=0,e._touchTime=0,e._dealCoursMsg=!1,e.mEquipBubbleIds=[],e.mComposeLinkDatas=[],e._isCanClick=!0,e.mBuyBallPrice=[],e.mVideoSunshineNum=0,e._selectEquipData=null,e._superPlantMapItem=null,e._isActiveSuperPlant=!1,e._resumeBall=[],e._fightEquipData=null,e._isCanClickItem=!0,e._pauseGameState=0,e}return __extends(e,t),e.prototype.update=function(t){for(var e=0;e<this._resumeBall.length;++e)this._resumeBall[e]+=t,this._resumeBall[e]>=3&&(this._resumeBall.splice(e--,1),this.addBulletBall())},e.prototype.onLoad=function(){var t=this;this.node.on(cc.Node.EventType.TOUCH_START,this.touchBegin,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.touchMoved,this),this.node.on(cc.Node.EventType.TOUCH_END,this.touchEnded,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.touchEnded,this),c.EventManager.instance.on(y.EBattleEvent.PASS_WAVE,this.passWave,this),c.EventManager.instance.on(y.EBattleEvent.UPDATE_SUNSHINE,this.updateSunshine,this),c.EventManager.instance.on(y.EBattleEvent.RESURGENCE,this.resurgence,this),c.EventManager.instance.on(g.EUserDataEvent.UPDATE_VIDEO_CARD,this.updateVideoCardNum,this),c.EventManager.instance.on(y.EBattleEvent.SELECT_SUPER_PLANT,this.selectSuperPlant,this),c.EventManager.instance.on(y.EBattleEvent.GM_ADD_FIXEDPLANT,this.addFixedPlant,this),c.EventManager.instance.on(y.EBattleEvent.GM_ADD_BALL,this.addBulletBall,this),c.EventManager.instance.on(y.EBattleEvent.RESUME_BALL,this.resumeBall,this),c.EventManager.instance.on(y.EBattleEvent.CLEAN_BOSS_BALL,this.cleanBossBall,this),c.EventManager.instance.on(y.EBattleEvent.UPDATE_SUPER_PLANT_NUM,this.updateSuperPlantNum,this),c.EventManager.instance.on(y.EBattleEvent.MAP_BLOCK_DESTROY,this.mapBlockDestroy,this),c.EventManager.instance.on(g.EUserDataEvent.COURSE_OPEN,this.onCourseNotify,this);var e=y.battleDataProxy.getStageRewardCfg().monsterList.replace("stage","");u.ResUtil.loadAsset({path:"textures/chapter/pic_bg_"+e,type:cc.SpriteFrame,bundleName:m.Bundles.GAME}).then(function(e){t.mChapterBg.spriteFrame=e}).catch(function(t){console.log("error:",t)}),this.mBuyBallPrice=f.DataManager.instance.eData.datapara[62].num.split("|").map(Number),this.mVideoSunshineNum=Number(f.DataManager.instance.eData.datapara[65].num),this.mBtnGetGrid.getChildByName("time").getComponent(cc.Label).string="X"+this.mVideoSunshineNum,this.mBtnRecycle.active=!1,this.updateVideoCardNum(),this.mZbTips.active=(y.battleDataProxy.isEndless||y.battleDataProxy.weatherType!=d.WeatherType.NONE)&&(yzll.gameConfig.isZB||yzll.gameConfig.debug),this.mZbTips.active&&y.battleDataProxy.weatherType!=d.WeatherType.NONE&&(this.mZbTips.getComponent(cc.Label).string="\u6e38\u620f\u4e3b\u9875=>\u901a\u8fc7\u7b2c\u4e09\u7ae0\u89e3\u9501>\u6311\u6218\u6a21\u5f0f"),this.setWeatherBgSprite()},e.prototype.onEnable=function(){},e.prototype.setWeatherBgSprite=function(){var t="",e="",a="",i="",o="",n="",r="",s=this.node.getChildByName("root"),c=s.getChildByName("WallView").getChildByName("wall_right").getChildByName("fence"),l=s.getChildByName("WallView").getChildByName("wall_left").getChildByName("fence"),p=s.getChildByName("WallView").getChildByName("wall_bottom").getChildByName("fence"),h=s.getChildByName("topFence");if(y.battleDataProxy.weatherType!=d.WeatherType.NONE){y.battleDataProxy.weatherType==d.WeatherType.SandWind?(t="textures/weatherBg/pic_ditu_da_tianqi4",e="textures/weatherBg/pic_ditu_tianqi4",a="textures/weather/pic_zhalan_qian_tianqi4",i="textures/weather/pic_zhalan_zuo_tianqi4",o="textures/weather/pic_zhalan_you_tianqi4",n="textures/weatherBg/pic_BGzhezhao4"):y.battleDataProxy.weatherType==d.WeatherType.IceAndSnow?(t="textures/weatherBg/pic_ditu_da_tianqi5",e="textures/weatherBg/pic_ditu_tianqi5",a="textures/weather/pic_zhalan_qian_tianqi5",i="textures/weather/pic_zhalan_zuo_tianqi5",o="textures/weather/pic_zhalan_zuo_tianqi5",n="textures/weatherBg/pic_BGzhezhao"):y.battleDataProxy.weatherType==d.WeatherType.HeavyFog&&(n="textures/weatherBg/pic_wuqi_shangxia"),y.battleDataProxy.weatherType==d.WeatherType.THUNDER?r="textures/weather/pic_tianqi1_zhezhao":y.battleDataProxy.weatherType==d.WeatherType.HeavyRain?r="textures/weather/pic_tianqi2_zhezhao":y.battleDataProxy.weatherType==d.WeatherType.HeavyFog&&(r="textures/weather/pic_tianqi6_zhezhao");var f=s.getChildByName("bg"),_=s.getChildByName("equipBg");if(""!=t&&this.setSpriteFrame([f],t),""!=e&&this.setSpriteFrame([_],e),""!=r){var g=s.getChildByName("nightView").getChildByName("weatherMask");this.setSpriteFrame([g],r)}if(""!=a&&this.setSpriteFrame([p,h],a),""!=i&&this.setSpriteFrame([l],i),""!=o&&this.setSpriteFrame([c],o),""!=n){var v=null;v=y.battleDataProxy.weatherType==d.WeatherType.IceAndSnow||y.battleDataProxy.weatherType==d.WeatherType.HeavyFog?s.getChildByName("BGzhezhao"):s.getChildByName("chapterBg").getChildByName("BGzhezhao");var P=this.node.getChildByName("BattleBaseInfoView").getChildByName("BGzhezhao");v.active=!0,P.active=y.battleDataProxy.weatherType==d.WeatherType.IceAndSnow||y.battleDataProxy.weatherType==d.WeatherType.HeavyFog,this.setSpriteFrame([v,P],n),y.battleDataProxy.weatherType==d.WeatherType.IceAndSnow?v.y=cc.winSize.height/2-282:y.battleDataProxy.weatherType==d.WeatherType.HeavyFog&&(v.y=cc.winSize.height/2-73.5),P.y=-cc.winSize.height/2}}else{var b=y.battleDataProxy.getStageRewardCfg().monsterList.replace("stage","");"1"!=b&&u.ResUtil.loadAsset({path:"textures/mapAdorn/MapAdorn",type:cc.SpriteAtlas,bundleName:m.Bundles.GAME}).then(function(t){l.getComponent(cc.Sprite).spriteFrame=t.getSpriteFrame("pic_zhalan"+b+"_zuo"),c.getComponent(cc.Sprite).spriteFrame=t.getSpriteFrame("pic_zhalan"+b+"_zuo"),p.getComponent(cc.Sprite).spriteFrame=t.getSpriteFrame("pic_zhalan"+b+"_qian"),h.getComponent(cc.Sprite).spriteFrame=t.getSpriteFrame("pic_zhalan"+b+"_qian"),"7"!=b&&"4"!=b||(c.scaleX=-1)}).catch(function(t){console.log("error:",t)})}},e.prototype.setSpriteFrame=function(t,e){""!=e&&u.ResUtil.loadAsset({path:e,type:cc.SpriteFrame,bundleName:m.Bundles.GAME}).then(function(e){for(var a=0;a<t.length;++a)t[a].getComponent(cc.Sprite).spriteFrame=e}).catch(function(t){console.log("error:",t)})},e.prototype.getIsCanShowEquipBubble=function(t){for(var e=0;e<this.mEquipBubbleIds.length;++e)if(this.mEquipBubbleIds[e]==t)return!1;return!0},e.prototype.mapBlockDestroy=function(t){var e=this._gridsMap.get(t);e&&(e.getComponent(R.default).bValid=!0)},e.prototype.onDestroy=function(){this.node.off(cc.Node.EventType.TOUCH_START,this.touchBegin,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this.touchMoved,this),this.node.off(cc.Node.EventType.TOUCH_END,this.touchEnded,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this.touchEnded,this),c.EventManager.instance.off(y.EBattleEvent.PASS_WAVE,this.passWave,this),c.EventManager.instance.off(y.EBattleEvent.UPDATE_SUNSHINE,this.updateSunshine,this),c.EventManager.instance.off(y.EBattleEvent.RESURGENCE,this.resurgence,this),c.EventManager.instance.off(g.EUserDataEvent.UPDATE_VIDEO_CARD,this.updateVideoCardNum,this),c.EventManager.instance.off(y.EBattleEvent.SELECT_SUPER_PLANT,this.selectSuperPlant,this),c.EventManager.instance.off(y.EBattleEvent.GM_ADD_FIXEDPLANT,this.addFixedPlant,this),c.EventManager.instance.off(y.EBattleEvent.GM_ADD_BALL,this.addBulletBall,this),c.EventManager.instance.off(y.EBattleEvent.RESUME_BALL,this.resumeBall,this),c.EventManager.instance.off(y.EBattleEvent.CLEAN_BOSS_BALL,this.cleanBossBall,this),c.EventManager.instance.off(y.EBattleEvent.UPDATE_SUPER_PLANT_NUM,this.updateSuperPlantNum,this),c.EventManager.instance.off(y.EBattleEvent.MAP_BLOCK_DESTROY,this.mapBlockDestroy,this),c.EventManager.instance.off(g.EUserDataEvent.COURSE_OPEN,this.onCourseNotify,this)},e.prototype.resumeBall=function(){this._resumeBall.push(0)},e.prototype.updateVideoCardNum=function(){var t=this.mBtnGetGrid.getChildByName("videoIcon");y.battleDataProxy.setVideoCardIcon(t,3,1.2)},e.prototype.updateSunshine=function(){var t=y.battleDataProxy.getPlantRefreshPrice();255==this.mBtnRefresh.opacity&&(this.mBtnRefresh.getComponent(cc.Button).interactable=y.battleDataProxy.sunshineNum>=t);var e=y.battleDataProxy.bulletBalls.length,a=this.mBuyBallPrice[e-1];this.mBtnRefreshVideo.getChildByName("desc").getComponent(cc.Label).string=""+a,this.mBtnRefresh.getChildByName("num").getComponent(cc.Label).string=""+t,this.setBtnSpriteMaterial();for(var i=this.mSelectLayout.children,o=0;o<i.length;++o)i[o].getComponent(x.default).updatesunshineNum()},e.prototype.selectSuperPlant=function(t){var e=this;this.mSuperPlantView.active=!0;var a=this.mSuperPlantView.getChildByName("plantIcon"),i=this.mSuperPlantView.getChildByName("time"),o=y.battleDataProxy.battleData.superPlantId,n=f.DataManager.instance.eData.datasuperplant[o];n||(n=f.DataManager.instance.eData.datasuperplant[1]);var r=y.battleDataProxy.getSuperPlantNum();i.getComponent(cc.Label).string=r+"/"+n.superNum,y.battleDataProxy.topSuperId=o,u.ResUtil.loadAsset({path:"textures/superBigImg/pic_CWplant"+o,type:cc.SpriteFrame,bundleName:m.Bundles.GAME}).then(function(t){a.getComponent(cc.Sprite).spriteFrame=t}).catch(function(t){console.log("error:",t)}),u.ResUtil.loadAsset({path:"prefabs/superMapItem/SuperPlantMapItem"+o,type:cc.Prefab,bundleName:m.Bundles.GAME}).then(function(t){e._superPlantMapItem=cc.instantiate(t),e.mSuperPlantView.addChild(e._superPlantMapItem),e._superPlantMapItem.getComponent(w.default).init()}).catch(function(t){console.log("error:",t)}),g.userDataProxy.userData.gameCourseData.curId<=1&&this.onCourseNotify(1);var s=y.battleDataProxy.battleData.ballNum;this.addBulletBall(s),this.updateSunshine(),y.battleDataProxy.isEndless&&P.gameUIMgr.showSelectSkillPopup(),t?this.startFight():this.initCarAnim()},e.prototype.updateSuperPlantNum=function(){var t=this,e=y.battleDataProxy.battleData.superPlantId,a=f.DataManager.instance.eData.datasuperplant[e];if(a){var i=y.battleDataProxy.getSuperPlantNum(),o=this.mSuperPlantView.getChildByName("rotateBg"),n=this.mSuperPlantView.getChildByName("plantIcon");this.mSuperPlantView.getChildByName("time").getComponent(cc.Label).string=i+"/"+a.superNum;var r=this.mSuperPlantView.getChildByName("notBg"),s=this.mSuperPlantView.getChildByName("notRotateBg");if(this._superPlantMapItem&&this._superPlantMapItem.isValid){var l=this._superPlantMapItem.getComponent(w.default).updateSuperPlantNum(i);if(l!=this._isActiveSuperPlant){if(this._isActiveSuperPlant=l,y.battleDataProxy.isActiveSuperPlant=this._isActiveSuperPlant,this._isActiveSuperPlant){r.active=!1,s.active=!1,v.default.setSpriteNormalMaterial(n.getComponent(cc.Sprite));var p=cc.tween(o).by(.3,{angle:90});cc.tween(o).repeatForever(p).start()}else r.active=!0,s.active=!0,v.default.setSpriteGrayMaterial(n.getComponent(cc.Sprite)),o.angle=0,cc.Tween.stopAllByTarget(o);this._isActiveSuperPlant&&y.battleDataProxy.superPlantNum!=i&&u.ResUtil.loadAsset({bundleName:m.Bundles.GAME,path:"prefabs/item/ActiveSuperPlant",type:cc.Prefab}).then(function(e){if(t.node&&t.node.isValid){var a=cc.instantiate(e);t.node.addChild(a),a&&a.isValid&&a.getComponent(A.default).play()}}),c.EventManager.instance.emit(y.EBattleEvent.UPDATE_SUPER_STATE)}y.battleDataProxy.superPlantNum=i}else{var h=f.DataManager.instance.eData.datasuperplant[e];if(h){var d=h.superNum<=i;this._isActiveSuperPlant=d,y.battleDataProxy.isActiveSuperPlant=this._isActiveSuperPlant,d&&c.EventManager.instance.emit(y.EBattleEvent.UPDATE_SUPER_STATE)}}}},e.prototype.initUI=function(){var t=this;y.battleDataProxy.gameState=d.GameState.READY;var e=this.node.getChildByName("top");y.battleDataProxy.mTopUI=e,y.battleDataProxy.numberView=this.node.getChildByName("root").getChildByName("numberView"),y.battleDataProxy.top1=this.node.getChildByName("root").getChildByName("top"),y.battleDataProxy.blackHoleView=this.node.getChildByName("root").getChildByName("blackHoleView"),y.battleDataProxy.battleView=this.mBattleView,y.battleDataProxy.house=this.mBuildBase,y.battleDataProxy.equipRoot=this.mEquipmentNode,y.battleDataProxy.pathPointView=this.mPathPointView,y.battleDataProxy.gameUI=this.node,y.battleDataProxy.iceView=this.node.getChildByName("root").getChildByName("iceView"),y.battleDataProxy.excludeCollisionView=this.node.getChildByName("root").getChildByName("excludeCollisionView"),y.battleDataProxy.waterView=this.node.getChildByName("root").getChildByName("wateView"),y.battleDataProxy.bulletView=this.mBulletView,this.mBattleBaseInfoView.getComponent(S.default).setTipsIsShow(!0),e.getChildByName("BtnTest").active=yzll.gameConfig.gameTestBtn,this.mBattleView.getComponent(C.default).initBattleView();var a=[];if(y.battleDataProxy.isEndless)for(var i=1;i<7;++i)a.push(this.mPathView.getChildByName("routeEndless"+i));else for(i=1;i<4;++i)a.push(this.mPathView.getChildByName("route"+i));y.battleDataProxy.setEnemyMovePaths(a);var o=this.node.getChildByName("root").getChildByName("WallView");o.active=!0,this.mSuperPlantView.active=!1;var n=o.children,r=function(t){var e=n[t],a=e.position.clone();s.scheduleOnce(function(){e.position=a}),console.log("childre:"+e.position)},s=this;for(i=0;i<n.length;++i)r(i);for(this.scheduleOnce(function(){var e=y.battleDataProxy.loadBattlePlantData(),a=null,i=!1,o=null,n=!1;if(e&&""!=e){var r=JSON.parse(e);a=r.equipData,i=r.isBuyFixedPlant,o=r.mapBlockData,y.battleDataProxy.battleData=r.battleData;for(var s=0;s<y.battleDataProxy.battleData.ownSkillList.length;++s){var c=y.battleDataProxy.battleData.ownSkillList[s];D.default.instance.pushSkillInfo(c.id)}n=!0}else y.battleDataProxy.weatherType!=d.WeatherType.NONE?y.battleDataProxy.battleData.battleChapter=g.userDataProxy.userData.cursWeatherChapter:y.battleDataProxy.battleData.battleChapter=g.userDataProxy.userData.curChapter;t.mBattleBaseInfoView.getComponent(S.default).initBattleBaseInfoView(),t.mBuildBase.getComponent(E.default).initBuildBase(),t.loadBattlePlantData(a),t.addFixedPlant(null,i,function(){n?t.selectSuperPlant(n):y.battleDataProxy.loadSuperFrameDatas(function(){P.gameUIMgr.showRandomSuperPlantPopup()})});var l=g.userDataProxy.userData.curChapter,u=y.battleDataProxy.getStageRewardCfg(l);t.addMapBlockItems(u,o),t.addWeatherEffect()}),y.battleDataProxy.pathWalls=[],i=0;i<this.mPathWallView.childrenCount;++i)y.battleDataProxy.pathWalls.push(this.mPathWallView.children[i]);this.initMapGridsData(),this.refreshSilverCoin()},e.prototype.addMapBlockItems=function(t,e){var a=t.plantPosition.split("|"),i=0;if(this.mBlockLayout.removeAllChildren(),y.battleDataProxy.blockLayout=this.mBlockLayout,e){for(var o=function(a){var o=Math.floor(a/8),r=a%8,s=o-1+"-"+(r-1),c=e.findIndex(function(t){return t.holdGrid==s}),l=e[c];if(!l){var u=n._gridsMap.get(s);return u&&(u.getComponent(R.default).belongTo=null,u.getComponent(R.default).bValid=!0),"continue"}var p=l.stoneHp;n.createMapBlockItemData(t,s,o,r,720,p),i++},n=this,r=0;r<104;++r)o(r);y.battleDataProxy.mapBlockNum=i}else{for(r=0;r<104;++r){var s=Math.floor(r/8),c=r%8,l=!1;if(0!=c&&0!=s&&7!=c&&12!=s||(l=!0),l||0==d.OrginMapGridsData[s-1][c-1]){var u=s-1+"-"+(c-1);this.getIsFixedPlantGird(a,u)||(this.createMapBlockItemData(t,u,s,c,720),i++)}}y.battleDataProxy.mapBlockNum=i}},e.prototype.createMapBlockItemData=function(t,e,a,i,o,n){var r=t.stoneHp,s=t.stoneSun;if(2==g.userDataProxy.userData.gameModel){var c=g.userDataProxy.userData.cursWeatherChapter;s=f.DataManager.instance.eData.data_weather[c].gold}y.battleDataProxy.isEndless&&(s=Number(f.DataManager.instance.eData.datapara[1004].num)),n||(n=r);var l=cc.instantiate(this.mMapBlockItemPb);this.mBlockLayout.addChild(l),l.getComponent(N.default).initMapBlockItem(n,r,s),l.getComponent(N.default).holdGrid=e;var u=-this.mBlockLayout.width/2+l.width*i+l.width/2,p=o-l.height*a+l.height/2;l.position=cc.v3(u,p)},e.prototype.getIsFixedPlantGird=function(t,e){return!y.battleDataProxy.isEndless&&y.battleDataProxy.weatherType==d.WeatherType.NONE&&t.length>0&&t.indexOf(e)>=0},e.prototype.loadBattlePlantData=function(t){var e=this;if(!t){var a=y.battleDataProxy.loadBattlePlantData();t=a&&""!=a?JSON.parse(a+""):[]}console.log("equipLayoutData:",t);for(var i=0;i<n.ROW_MAX*n.COL_MAX;++i){var o=Math.floor(i/n.COL_MAX)+"-"+i%n.COL_MAX,r=this._gridsMap.get(o);r&&(r.getComponent(R.default).belongTo=null)}var s,c=this.mEquipmentNode.children,l=function(t){var a=c[t];if(a.getComponent(x.default).mIsFixedPlant)return a.getComponent(x.default).holdGrids.forEach(function(t){var i=e._gridsMap.get(t);i&&(i.getComponent(R.default).belongTo=a)}),s=t,"continue";a.destroy(),a.removeFromParent(),s=--t};for(i=0;i<c.length;++i)l(i),i=s;var p=function(a){var i=t[a],o=d.EquipmentData["form"+i.dataFormIdx];u.ResUtil.loadAsset({path:"prefabItem/"+o.name,type:cc.Prefab,bundleName:m.Bundles.GAME}).then(function(t){var a=cc.instantiate(t);e.mEquipmentNode.addChild(a),a.position=cc.v3(JSON.parse(i.pos)),a.getComponent(x.default).holdGrids=i.holdGrids;for(var o=0;o<i.holdGrids.length;++o){var r=i.holdGrids[o].split("-").map(Number);e.mGridsLayout.children[r[0]*n.COL_MAX+r[1]].getComponent(R.default).belongTo=a}a.getComponent(x.default).level=i.level,a.getComponent(x.default).isPurchased=!0,a.getComponent(x.default).setCounterIsShow(!0),a.getComponent(x.default).equipId==y.battleDataProxy.battleData.superPlantId&&e.updateSuperPlantNum()}).catch(function(t){console.log("error:",t)})};for(i=0;i<t.length;++i)p(i)},e.prototype.initMapGridsData=function(){var t;this._mapGridsData=JSON.parse(JSON.stringify(d.OrginMapGridsData));for(var e=this.mGridsLayout.children[0],a=0;a<e.children.length;++a)"Frame"==e.children[a].name?e.children[a].children.forEach(function(t){t.active=!1}):e.children[a].active=!1;for(this.mGridsLayout.removeAllChildren(),a=0;a<n.ROW_MAX*n.COL_MAX;++a){var i=cc.instantiate(e);this.mGridsLayout.addChild(i);var o=Math.floor(a/n.COL_MAX),r=a%n.COL_MAX,s=o+"-"+r;i.getComponent(R.default).rowCol=s,i.getComponent(R.default).bValid=(null===(t=this._mapGridsData[o])||void 0===t?void 0:t[r])>0,this._gridsMap.set(s,this.mGridsLayout.children[a])}for(a=0;a<n.ROW_MAX*n.COL_MAX;++a)(i=this.mGridsLayout.children[a]).getComponent(R.default).checkBorderShow(this._mapGridsData);y.battleDataProxy.gridsMap=this._gridsMap},e.prototype.addFixedPlant=function(t,e,a){var i=this;if(void 0===e&&(e=!1),t){this.mEquipmentNode.removeAllChildren(),this.updateSuperPlantNum(),this._superPlantMapItem.getComponent(w.default).init();for(var o=0;o<n.ROW_MAX*n.COL_MAX;++o){var r=this.mGridsLayout.children[o];r.getComponent(R.default).bValid=!0,r.getComponent(R.default).belongTo=null}}else t=g.userDataProxy.userData.curChapter;var s=y.battleDataProxy.getStageRewardCfg(t);if(y.battleDataProxy.isEndless||y.battleDataProxy.weatherType!=d.WeatherType.NONE)a&&a();else{var c=s.plant;if(""!=c){var l=c.split("|").map(Number),p=s.plantPosition.split("|");y.battleDataProxy.fixedPlantAtkRate=l[1];var h=l[0];u.ResUtil.loadAsset({path:"fixedPlant/Item"+h,type:cc.Prefab,bundleName:m.Bundles.GAME}).then(function(t){var o=cc.instantiate(t);i.mEquipmentNode.addChild(o,1);var r=d.EquipmentData["form"+o.getComponent(x.default).dataFormIdx].center,s=i._gridsMap.get(p[0]),c=s.getComponent(R.default).gridSize,l=s.position,u=cc.v3(l.x+r[0]*c-4,l.y-r[1]*c);o.position=u,o.getComponent(x.default).holdGrids=p;for(var h=0;h<p.length;++h){var m=p[h].split("-").map(Number);i.mGridsLayout.children[m[0]*n.COL_MAX+m[1]].getComponent(R.default).belongTo=o}o.getComponent(x.default).level=1,o.getComponent(x.default).isPurchased=e,a&&a()}).catch(function(t){console.log("error:",t)})}else a&&a()}},e.prototype.initCarAnim=function(){this.mSelectLayout.getComponent(T.default).initData(this._gridsMap),this.mSelectLayout.active=!0,this._dealCoursMsg=!0},e.prototype.touchBegin=function(t){var e=this;if(this._isCanClick&&this._isCanClickItem){this._selectEquipment=null;var a=t.getLocation();this._rowColInfo=null,this.setMapGridsBgStatus(d.GridBgStatus.NONE),this._lightGird=[],this._touchTime=(new Date).getTime();var i=y.battleDataProxy.gameCamera;a.addSelf(cc.v2(i.position));var o=this.findSelectEquipment(a);if(o){if(o.getComponent(x.default).mIsFixedPlant)return o.getComponent(x.default).isPurchased?void(this._selectEquipment=null):(g.userDataProxy.getProp(4)>0?(g.userDataProxy.addProp(4,-1),o.getComponent(x.default).isPurchased=!0,y.battleDataProxy.isStartFight&&this.saveBattlePlantData()):(this.pauseGame(),h.default.showVideoAds({id:1,eventId:"unlock_fixedPlant_ad",success:function(){o.getComponent(x.default).isPurchased=!0,e.resumeGame(),y.battleDataProxy.isStartFight&&e.saveBattlePlantData()},fail:function(){e.resumeGame()},error:function(t){e.resumeGame(),cc.log(t)}},!0)),void(this._selectEquipment=null));cc.Tween.stopAllByTarget(o),this._isCanClickItem=!1,o.getComponent(x.default).bAnim=!0,o.getComponent(x.default).setIsCollider(!1),o.getComponent(x.default).setCounterIsShow(!1)}if(this._selectEquipment||(this._selectEquipment=o),this.setComposeLink(),this._selectEquipment){this._selectEquipment.setSiblingIndex(999);var n=this.mSelectLayout.convertToNodeSpaceAR(a);if(this._selectEquipment.position=cc.v3(n.x,n.y),this.mSelectLayout.getComponent(T.default).confirmItemsPos(!0,this._selectEquipment),this.dealSelectEquipMove(a),this._selectEquipment.getComponent(x.default).setPriceLabIsShow(!1),!y.battleDataProxy.isStartFight)for(var r=o.getComponent(x.default),s=r.equipId,c=r.level,l=0;l<this.mEquipmentNode.children.length;++l){var u=this.mEquipmentNode.children[l].getComponent(x.default);if(!u.getComponent(x.default).mIsFixedPlant&&u.level<this.getComposeMaxLevel(u.equipId)&&u.equipId==s&&u.level==c){var p=u.getComponent(x.default).root.getChildByName("itemIcon"),m=cc.tween(p).by(.1,{angle:-10}).by(.1,{angle:10}).by(.1,{angle:10}).by(.1,{angle:-10}).delay(.5);cc.tween(p).repeatForever(m).start();break}}}}},e.prototype.setComposeLink=function(){for(var t=0;t<this.mComposeLinkDatas.length;++t){var e=this.mComposeLinkDatas[t],a=e.itemLink,i=v.default.convertToTargetNodeSpace(this._selectEquipment,a);a.position=i;var o=v.default.convertToTargetNodeSpace(e.equipItem,a),n=l.MathUtil.getDoublPointRadian(i,o),r=l.MathUtil.getAngle(n);a.angle=r+90;var s=l.MathUtil.distance(o,i);a.scaleY=s/500}},e.prototype.getComposeMaxLevel=function(t){return(g.userDataProxy.getPlantData(t).lv||0)>=this.getSuperUnlockLevel(t)?5:4},e.prototype.getSuperUnlockLevel=function(t){for(var e=f.DataManager.instance.eData.dataplant[t].skillId.split("|").map(Number),a=0;a<e.length;++a)if(e[a]%1e4==5)return a+1;return 5},e.prototype.getIsHaveGrids=function(t,e){for(var a=0;a<t.length;++a)if(t[a].mapGridKey==e.mapGridKey)return!0;return!1},e.prototype.updateAllDisGrids=function(t,e){for(var a=0;a<e.length;++a){var i=e[a];this.getIsHaveGrids(t,i)||t.push(i)}return t},e.prototype.dealSelectEquipMove=function(t){for(var e,a=this.findRowCol(t),i=this._selectEquipment.getComponent(x.default).grids,o=[],n=0;n<i.length;++n){var r=i[n],s=this.getcheckGridIsBeLinked(a,r);o=this.updateAllDisGrids(o,s)}if(e=this._selectEquipment.getComponent(x.default).checkGridIsBeLinked(o,this._gridsMap),this._moveResult=e,e)for(this.setMapGridsBgStatus(d.GridBgStatus.NONE,e),this._lightGird=[],n=0;n<e.length;++n){var c=this._gridsMap.get(e[n]);if(c){var l=c.getComponent(R.default).bValid?d.GridBgStatus.CHECK_EMPTY:d.GridBgStatus.CHECK_HOLD;c.getComponent(R.default).setBgStatus(l),this._lightGird.push(c)}}else this.setMapGridsBgStatus(d.GridBgStatus.NONE,[])},e.prototype.touchMoved=function(t){if(this._isCanClick&&this._selectEquipment&&this._selectEquipment.isValid){var e=t.getLocation(),a=y.battleDataProxy.gameCamera;e.addSelf(cc.v2(a.position));var i=this.mSelectLayout.convertToNodeSpaceAR(e.clone());this._selectEquipment.position=cc.v3(i.x,i.y),this.dealSelectEquipMove(e),this.setComposeLink()}},e.prototype.getcheckGridIsBeLinked=function(t,e){for(var a=[],i=t.row-1;i<=t.row+1;++i)for(var o=t.col-1;o<=t.col+1;++o){var n=i+"-"+o,r=this._gridsMap.get(n);if(r&&r.getComponent(R.default).isValid){var s=e.getBoundingBoxToWorld(),c=r.getBoundingBoxToWorld();if(c.intersects(s)){var l=new cc.Rect;c.intersection(l,s);var u=l.width*l.height;a.push({node:r,area:u,mapGridKey:n})}}}return a},e.prototype.touchEnded=function(t){var e=this;if(this._isCanClick){for(var a=0;a<this.mComposeLinkDatas.length;++a){var i=this.mComposeLinkDatas[a].itemLink;_.default.instance.putNode(i)}if(this.mComposeLinkDatas.length=0,this._selectEquipment){var o=t.getLocation(),n=y.battleDataProxy.gameCamera;o.addSelf(cc.v2(n.position));var r=this.findRowCol(o);(new Date).getTime()-this._touchTime<130&&this._selectEquipment.getComponent(x.default).equipId;var s=this._selectEquipment.getComponent(x.default).isPurchased;if(s){var l=this.mBtnRecycle.parent.convertToNodeSpaceAR(o.clone());if(this.mBtnRecycle.getBoundingBox().contains(l)&&this.mBtnRecycle.active){var u=this._selectEquipment.getComponent(x.default).equipId,h=this._selectEquipment.getComponent(x.default).level,m=y.battleDataProxy.getRecyclePlantPrice(u,h),f=y.battleDataProxy.sunshineNum;return f+=m,y.battleDataProxy.sunshineNum=f,this._selectEquipment.destroy(),this._selectEquipment.removeFromParent(),this._selectEquipment=null,b.default.instance.showAwardAni({id:8,num:m},this.node,this.mBtnRecycle),this.mBtnRecycle.active=!1,this.updateSuperPlantNum(),this.initEquipmentNode(),void(this._isCanClickItem=!0)}}this.mBtnRecycle.active=!1;var P=!1;if(-1!=r.row&&-1!=r.col){var D=!!this._moveResult;if(D)for(a=0;a<this._moveResult.length;++a){var S=this._moveResult[a];if(!this._gridsMap.get(S).getComponent(R.default).bValid){D=!1;break}}if(this._moveResult&&D){var C=function(){for(var t=!1,a=E._moveResult.toString(),i=E._selectEquipment.getComponent(x.default).level,o=E._selectEquipment.getComponent(x.default).dataFormIdx,n=function(n){var r=E.mEquipmentNode.children[n];if(r.getComponent(x.default).mIsFixedPlant)return"continue";if(y.battleDataProxy.isStartFight)return"continue";var s=r.getComponent(x.default).holdGrids,c=r.getComponent(x.default).level,l=r.getComponent(x.default).dataFormIdx;if(c<E.getComposeMaxLevel(r.getComponent(x.default).mEquipId)&&s.toString()==a&&c==i&&l==o){var u=E._selectEquipment;return t=!0,E.getIsCanPlacePlant(!0,function(t){if(t){var a=v.default.convertToTargetNodeSpace(r,e.node);++r.getComponent(x.default).level,u.removeFromParent(),e.setEffectEquipUpgrade(cc.v3(a),e.node),r.getComponent(x.default).checkIsActive(),e.mSelectLayout.getComponent(T.default).orderItems(),e.mSelectLayout.getComponent(T.default).confirmItemsPos(!0),P=!0,r.getComponent(x.default).holdGrids.forEach(function(t){e._gridsMap.get(t).getChildByName("Course").active=!1}),e.updateSuperPlantNum()}u.getComponent(x.default).bAnim=!1,e.placePlantResult(P,u.getComponent(x.default).isPurchased)}),"break"}},r=0;r<E.mEquipmentNode.children.length&&"break"!==n(r);++r);if(t)return"break";var l=!1,u=[];if(E._moveResult.forEach(function(t){var a=e._gridsMap.get(t),i=a.getComponent(R.default).belongTo;a.getComponent(R.default).isBlackHole&&(l=!0),i&&!u.includes(i)&&u.push(i)}),l)return console.log("\u8fd9\u4e2a\u5730\u65b9\u6709\u9ed1\u6d1e"),E.placePlantResult(P,s),"break";if(u.length>0)return console.log("\u8fd9\u4e2a\u5730\u65b9\u6709\u4e1c\u897f:"),E.placePlantResult(P,s),"break";var h=E._selectEquipment,m=E._moveResult.slice();E.getIsCanPlacePlant(!1,function(t){var a;if(t){h.getComponent(x.default).holdGrids=m.slice(),h.getComponent(x.default).checkIsActive(),h.getComponent(x.default).setCounterIsShow(!0),m.forEach(function(t){e._gridsMap.get(t).getComponent(R.default).belongTo=h});var i=d.EquipmentData["form"+h.getComponent(x.default).dataFormIdx].center,o=e._gridsMap.get(m[0]),n=o.getComponent(R.default).gridSize,r=o.position,s=cc.v3(r.x+i[0]*n-4,r.y-i[1]*n);if(h.parent=e.mEquipmentNode,h.position=s,e.mSelectLayout.getComponent(T.default).orderItems(),e.mSelectLayout.getComponent(T.default).confirmItemsPos(!0),P=!0,e.updateSuperPlantNum(),h.getComponent(x.default).equipId==y.battleDataProxy.battleData.superPlantId&&(e.mSelectLayout.getComponent(T.default).superRefreshNum=0),e.mSelectLayout.childrenCount<=0)1==g.userDataProxy.userData.gameCourseData.curId&&(c.EventManager.instance.emit(y.EBattleEvent.LOSE_COURSE_VIEW),g.userDataProxy.completeCourse(2));else if(1==g.userDataProxy.userData.gameCourseData.curId){var l=p.PopupManager.instance.getPopup("CoursePopup");if(l&&l.isValid){for(var u=[e._gridsMap.get("5-1"),e._gridsMap.get("5-2"),e._gridsMap.get("5-3")],f=null,_=0;_<u.length;++_){var v=u[_];if(v&&v.isValid&&!v.getComponent(R.default).belongTo){f=v;break}}f&&(null===(a=l.getComponent(I.default))||void 0===a||a.updateMoveTargetNode(e.mSelectLayout.children[0],f))}}}e.placePlantResult(P,h.getComponent(x.default).isPurchased),h.getComponent(x.default).bAnim=!1})},E=this;do{if("break"===C())break}while(0)}else this.placePlantResult(P,s)}else this.placePlantResult(P,s)}}},e.prototype.placePlantResult=function(t,e){this.initEquipmentNode(),t?(this._isCanClickItem=!0,this._selectEquipment&&this._selectEquipment.isValid&&(this._selectEquipment.getComponent(x.default).bAnim=!1)):e?this.placeFailBack():(this.mSelectLayout.getComponent(T.default).orderItems(),this.mSelectLayout.getComponent(T.default).confirmItemsPos(!0),this._selectEquipment&&this._selectEquipment.isValid&&(this._selectEquipment.getComponent(x.default).bAnim=!1),this._isCanClickItem=!0),this._selectEquipment=null,this._moveResult=null,this._rowColInfo=null,this.setMapGridsBgStatus(d.GridBgStatus.NONE),this._lightGird=[]},e.prototype.initEquipmentNode=function(){for(var t=0;t<this.mEquipmentNode.children.length;++t){var e=this.mEquipmentNode.children[t].getChildByName("root").getChildByName("itemIcon");cc.Tween.stopAllByTarget(e),e.angle=0}},e.prototype.placeFailBack=function(){var t=this;if(this._selectEquipData){var e=this._selectEquipment.convertToWorldSpaceAR(cc.v3()),a=this.mEquipmentNode.convertToNodeSpaceAR(e);this._selectEquipment.parent=this.mEquipmentNode,this._selectEquipment.position=a;var i=this._selectEquipment;cc.Tween.stopAllByTarget(i),cc.tween(i).to(.1,{position:this._selectEquipData.pos}).call(function(){i.scale=1,i.getComponent(x.default).bAnim=!1,i.getComponent(x.default).checkIsActive(),i.getComponent(x.default).setCounterIsShow(!0),t._isCanClickItem=!0}).start();for(var o=this._selectEquipData.holdGrids,n=0;n<o.length;++n){var r=o[n],s=this._gridsMap.get(r);if(!s)return;s.getComponent(R.default).belongTo=i}}else this._selectEquipment&&this._selectEquipment.isValid&&(this._selectEquipment.getComponent(x.default).bAnim=!1),this.mSelectLayout.getComponent(T.default).orderItems(),this.mSelectLayout.getComponent(T.default).confirmItemsPos(!0),this._isCanClickItem=!0},e.prototype.getIsCanPlacePlant=function(t,e){var a=this;if(t){var i=this._selectEquipment.getComponent(x.default).equipId;if(g.userDataProxy.userData.gameCourseData.curId<=3&&!y.battleDataProxy.isActiveSuperPlant&&i==y.battleDataProxy.battleData.superPlantId)return P.gameUIMgr.showTips("\u8bf7\u5148\u5408\u6210\u8d85\u7ea7\u690d\u7269!"),void(e&&e(!1))}if(this._selectEquipment.getComponent(x.default).isPurchased)e&&e(!0);else if(this._selectEquipment.getComponent(x.default).isBeWindUp)e&&e(!1);else if(this._selectEquipment.getComponent(x.default).adFlag)if(g.userDataProxy.getProp(4)>0)g.userDataProxy.addProp(4,-1),this._selectEquipment.getComponent(x.default).isPurchased=!0,e&&e(!0);else{var o=this._selectEquipment;this.pauseGame(),h.default.showVideoAds({id:1,eventId:"purchased_plant_ad",success:function(){a.resumeGame(),o.getComponent(x.default).isPurchased=!0,e&&e(!0)},fail:function(){a.resumeGame(),e&&e(!1)},error:function(){a.resumeGame(),e&&e(!1)}},!0)}else{var n=this._selectEquipment.getComponent(x.default).purchasePlant();n||(P.gameUIMgr.showTips("\u9633\u5149\u4e0d\u8db3"),this.showVideoSunshinePopup()),e&&e(n)}},e.prototype.setSelectEquipData=function(t){if(t.getComponent(x.default).isPurchased){if(t.getComponent(x.default).mIsFixedPlant)return;var e=g.userDataProxy.userData.gameCourseData.curId;this.mBtnRecycle.active=!(e<=3||y.battleDataProxy.isStartFight);var a=this.mBtnRecycle.getChildByName("layout").getChildByName("priceNum"),i=t.getComponent(x.default).equipId,o=t.getComponent(x.default).level,n=y.battleDataProxy.getRecyclePlantPrice(i,o);a.getComponent(cc.Label).string="x"+n;var r=t.getComponent(x.default).holdGrids;this._selectEquipData={pos:t.position.clone(),holdGrids:r}}},e.prototype.findSelectEquipment=function(t){for(var e=this,a=0;a<this.mSelectLayout.children.length;++a)if((i=this.mSelectLayout.children[a]).getBoundingBoxToWorld().contains(t)&&i.getComponent(x.default).canClick)return i;for(a=0;a<this.mEquipmentNode.children.length;++a){var i;if((i=this.mEquipmentNode.children[a]).getComponent(x.default).isTakeEffect&&!i.getComponent(x.default).isBeWindUp&&i.getBoundingBoxToWorld().contains(t)&&i.getComponent(x.default).canClick)return i.getComponent(x.default).isIce?(i.getComponent(x.default).iceBreaker(),null):(i.getComponent(x.default).equipItemClick(),this.setSelectEquipData(i),i.getComponent(x.default).mIsFixedPlant?i:(i.parent=this.mSelectLayout,i.getComponent(x.default).holdGrids.forEach(function(t){e._gridsMap.get(t).getComponent(R.default).belongTo=null}),i))}return null},e.prototype.findRowCol=function(t){var e=-1,a=-1,i=this.mGridsLayout.convertToNodeSpaceAR(t),o=this.mGridsLayout.width,r=this.mGridsLayout.height;if(!new cc.Rect(this.mGridsLayout.x-o/2-this.mGridsLayout.x,0,o,r).contains(i))return{row:e,col:a};for(var s=999,c=0;c<n.ROW_MAX;++c){var l=this.mGridsLayout.children[c*n.COL_MAX];(p=cc.v3(0,i.y).subtract(cc.v3(0,l.y)).len())<s&&(e=c,s=p)}s=999;for(var u=0;u<n.COL_MAX;++u){var p;l=this.mGridsLayout.children[u],(p=cc.v3(i.x,0).subtract(cc.v3(l.x,0)).len())<s&&(a=u,s=p)}return{row:e,col:a}},e.prototype.setMapGridsStatus=function(t,e){var a,i;try{for(var o=__awaiter(this._gridsMap),n=o.next();!n.done;n=o.next()){var r=s(n.value,2),c=(r[0],r[1]);e?c.getComponent(R.default).setGridStatus(t):c.getComponent(R.default).bValid||c.getComponent(R.default).setGridStatus(t)}}catch(l){a={error:l}}finally{try{n&&!n.done&&(i=o.return)&&i.call(o)}finally{if(a)throw a.error}}},e.prototype.setMapGridsBgStatus=function(t,e){this._lightGird.forEach(function(a){e&&e.includes(a.getComponent(R.default).rowCol)||a.getComponent(R.default).setBgStatus(t)})},e.prototype.showVideoSunshinePopup=function(){var t=this;y.battleDataProxy.isEndless&&y.battleDataProxy.endlessVideoSunNum<=0||P.gameUIMgr.showVideoSunshinePopup(function(){t.addSunshineNum()})},e.prototype.updateEndlessVideoSunNum=function(){if(y.battleDataProxy.isEndless){var t=y.battleDataProxy.endlessVideoSunNum;t--,y.battleDataProxy.endlessVideoSunNum=t,y.battleDataProxy.endlessVideoSunNum<=0&&(this.mBtnGetGrid.active=!1)}},e.prototype.addSunshineNum=function(){var t=this;if(!(y.battleDataProxy.isEndless&&y.battleDataProxy.endlessVideoSunNum<=0))if(g.userDataProxy.getProp(4)>0){g.userDataProxy.addProp(4,-1);var e=y.battleDataProxy.sunshineNum;e+=this.mVideoSunshineNum,y.battleDataProxy.sunshineNum=e,this.updateEndlessVideoSunNum()}else this.pauseGame(),h.default.showVideoAds({id:1,eventId:"add_sunshine_ad",success:function(){t.resumeGame(),t.addSunshineNumEx(t.mVideoSunshineNum,t.mBtnGetGrid),t.updateEndlessVideoSunNum()},fail:function(){t.resumeGame()},error:function(e){t.resumeGame(),cc.log(e)}},!0)},e.prototype.btnCallback=function(t,e){var a=this;if(this._isCanClick)switch(this._isCanClick=!1,this.scheduleOnce(function(){a._isCanClick=!0},.5),e){case"btn_refresh":var i=y.battleDataProxy.getPlantRefreshPrice();if((o=y.battleDataProxy.sunshineNum)<i)return P.gameUIMgr.showTips("\u9633\u5149\u4e0d\u8db3"),void this.showVideoSunshinePopup();o-=i,y.battleDataProxy.sunshineNum=o,this.mSelectLayout.getComponent(T.default).refreshSeletItems(this._gridsMap,!1,!0);break;case"btn_refresh_video":var o,n=y.battleDataProxy.battleData.ballNum,s=this.mBuyBallPrice[n-1];if(s||(s=300),(o=y.battleDataProxy.sunshineNum)<s)return P.gameUIMgr.showTips("\u9633\u5149\u4e0d\u8db3"),void this.showVideoSunshinePopup();o-=s,n++,y.battleDataProxy.battleData.ballNum=n,this.addBulletBall(),y.battleDataProxy.sunshineNum=o,y.battleDataProxy.saveData();break;case"btn_start_fight":var l=this.mEquipmentNode.childrenCount;if(1==this.mEquipmentNode.childrenCount&&this.mEquipmentNode.children[0].getComponent(x.default).mIsFixedPlant&&l--,l<=0)return void P.gameUIMgr.showTips("\u8bf7\u81f3\u5c11\u4e0a\u9635\u4e00\u79cd\u690d\u7269\uff01");y.battleDataProxy.weatherType!=d.WeatherType.NONE?y.battleDataProxy.battleData.battleWave=g.userDataProxy.userData.curWeatherWave:y.battleDataProxy.battleData.battleWave=g.userDataProxy.userData.curWave,this.saveBattlePlantData();var u=0;if(y.battleDataProxy.weatherType!=d.WeatherType.NONE)u=20;else{var h=g.userDataProxy.userData.curChapter,f=y.battleDataProxy.getStageRewardCfg(h);u=Number(f.wave)}u<=g.userDataProxy.userData.curWave?r.AudioManager.instance.playEffectPath("sounds/startEnd",m.Bundles.RES):r.AudioManager.instance.playEffectPath("sounds/startBattle",m.Bundles.RES),this._dealCoursMsg=!1,this._isCanClick=!1,this.startFight(),y.battleDataProxy.pushFirstPlayChapter(),2==g.userDataProxy.userData.gameCourseData.curId&&(g.userDataProxy.completeCourse(3),c.EventManager.instance.emit(y.EBattleEvent.LOSE_COURSE_VIEW));break;case"btn_get_grid":this.addSunshineNum();break;case"BtnSet":P.gameUIMgr.showGameSettingPopup(!0);break;case"BtnTest":p.PopupManager.instance.show({bundleName:m.Bundles.GAME,path:"uis/root/TestNode",keep:!0});break;case"BtnSuperPlant":P.gameUIMgr.showSuperPlantMapPopup()}},e.prototype.addBulletBall=function(t){void 0===t&&(t=1);for(var e=[],a=0;a<n.ROW_MAX*n.COL_MAX;++a){var i=Math.floor(a/n.COL_MAX)+"-"+a%n.COL_MAX,o=this._gridsMap.get(i);if(o){var r=o.getComponent(R.default).belongTo,s=o.getComponent(R.default).bValid;!r&&s&&e.push(o)}}for(a=0;a<t;++a){var c=cc.instantiate(this.mBulletBallPb);this.mBallView.addChild(c);var l=cc.v3(-141,-218,0);if(e.length>0){var u=Math.floor(100*Math.random())%e.length,p=e[u];l=v.default.convertToTargetNodeSpace(p,c),e.splice(u,1)}c.position=l,c.getComponent(B.default).initBulletBall(a),y.battleDataProxy.bulletBalls.push(c)}var h=Number(f.DataManager.instance.eData.datapara[61].num);y.battleDataProxy.battleData.ballNum>=h&&(this.mBtnRefreshVideo.active=!1)},e.prototype.startFight=function(){var t=this,e=y.battleDataProxy.gameCamera;e.y=0,y.battleDataProxy.isStartFight=!0,this.mSuperPlantView.active=!1,cc.tween(e).by(.5,{position:cc.v3(0,196)}).call(function(){t.mBattleView.getComponent(C.default).startFight(),t._isCanClick=!0}).start(),cc.Tween.stopAllByTarget(this.mSelectLayout),cc.tween(this.mSelectLayout).by(.5,{position:cc.v3(0,-196)}).call(function(){t.mBattleBaseInfoView.getComponent(S.default).seBattleUiIsShow(!0),t.mSelectLayout.removeAllChildren()}).start(),cc.Tween.stopAllByTarget(this.mBtnLayout.parent),cc.tween(this.mBtnLayout.parent).by(.5,{position:cc.v3(0,-196)}).call(function(){t.mBtnLayout.parent.active=!1}).start(),this.mBattleBaseInfoView.getComponent(S.default).setTipsIsShow(!1);for(var a=0;a<y.battleDataProxy.bulletBalls.length;++a)y.battleDataProxy.bulletBalls[a].getComponent(B.default).initCollisionPlantNum()},e.prototype.refreshSilverCoin=function(){},e.prototype.setEffectEquipUpgrade=function(){},e.prototype.setBottomBtnsValid=function(t){this.mBtnLayout.children.forEach(function(e){e.opacity=t?255:150,e.getComponent(cc.Button).interactable=t}),this.setBtnSpriteMaterial()},e.prototype.setBtnSpriteMaterial=function(){for(var t=this.mBtnRefresh.children,e=!this.mBtnRefresh.getComponent(cc.Button).interactable,a=0;a<t.length;++a){var i=t[a];"icon"==i.name?e?v.default.setSpriteGrayMaterial(i.getComponent(cc.Sprite)):v.default.setSpriteNormalMaterial(i.getComponent(cc.Sprite)):"num"==i.name?i.color=e?cc.color(75,75,75):cc.color("#FFFFFF"):i.color=e?cc.color(75,75,75):cc.color("#6F3318")}},e.prototype.passWave=function(t){var e=this;this._isCanClick=!1;var a=y.battleDataProxy.gameCamera;cc.tween(a).to(.5,{position:cc.v3(0,0)}).call(function(){e._isCanClick=!0}).start(),this._selectEquipment&&this._selectEquipment.isValid&&(this.placeFailBack(),this._selectEquipment=null);for(var i=0;i<y.battleDataProxy.bulletBalls.length;++i)y.battleDataProxy.bulletBalls[i].getComponent(B.default).initAddSpdTime();this.mFrenzyBar.getComponent(M.default).initFrenzyBar(),this.mSelectLayout.getComponent(T.default).refreshNum=1,y.battleDataProxy.isStartFight=!1,cc.Tween.stopAllByTarget(this.mSelectLayout),this.mSelectLayout.active=!0,cc.tween(this.mSelectLayout).by(.5,{position:cc.v3(0,196)}).call(function(){y.battleDataProxy.gameState=d.GameState.READY,e.mSelectLayout.getComponent(T.default).refreshSeletItems(e._gridsMap),e.mBattleBaseInfoView.getComponent(S.default).setTipsIsShow(!0);for(var a=0;a<e.mEquipmentNode.children.length;++a)e.mEquipmentNode.children[a].getComponent(x.default).passWave(),e.mEquipmentNode.children[a].getComponent(x.default).bAnim=!1,e.mEquipmentNode.children[a].getComponent(x.default).isTakeEffect=!0;e._isCanClickItem=!0,e.mSuperPlantView.active=!0;var i=y.battleDataProxy.getSuperPlantNum();if(t?e.updateSuperPlantNum():e._superPlantMapItem.getComponent(w.default).initSuperPlantNum(i),y.battleDataProxy.battleView.getComponent(C.default).initEnemyDatas(),y.battleDataProxy.battleView.getComponent(C.default).preLoadEnemyAni(),y.battleDataProxy.isEndless){var o=y.battleDataProxy.endlessCurWave;1!=o&&o%5==1&&P.gameUIMgr.showSelectSkillPopup()}}).start(),this.mBattleBaseInfoView.getComponent(S.default).seBattleUiIsShow(!1),this.mBattleBaseInfoView.getComponent(S.default).passWave(),y.battleDataProxy.bossSkillBall.forEach(function(t){t.destroy(),t.removeFromParent()}),y.battleDataProxy.blackHoleNodes.forEach(function(t){t.destroy(),t.removeFromParent()}),y.battleDataProxy.blackHoleNodes=[],y.battleDataProxy.bossSkillBall=[],y.battleDataProxy.enemyAirship=[],this.setMapGridsBgStatus(d.GridBgStatus.NONE),this.mBtnLayout.parent.active=!0,cc.Tween.stopAllByTarget(this.mBtnLayout.parent),cc.tween(this.mBtnLayout.parent).by(.5,{position:cc.v3(0,196)}).start()},e.prototype.cleanBossBall=function(){if(y.battleDataProxy.bossSkillBall.length<=0)for(var t=0;t<this.mEquipmentNode.children.length;++t)this.mEquipmentNode.children[t].getComponent(x.default).cleanBossBall();this._selectEquipment&&this._selectEquipment.isValid&&this._selectEquipment.getComponent(x.default).cleanBossBall()},e.prototype.resurgence=function(){this._fightEquipData&&(this._selectEquipment&&this._selectEquipment.isValid&&(this._selectEquipment.destroy(),this._selectEquipment.removeFromParent(),this._selectEquipment=null),this.loadBattlePlantData(this._fightEquipData),this.addSunshineNumEx(45)),this.passWave(!0)},e.prototype.addSunshineNumEx=function(t,e){var a=y.battleDataProxy.sunshineNum;a+=t,y.battleDataProxy.sunshineNum=a;var i=this.node.getChildByName("top"),o=y.battleDataProxy.sunshineRoot,n=i.convertToNodeSpaceAR(o.parent.convertToWorldSpaceAR(o.position)),r=y.battleDataProxy.gameCamera;b.default.instance.showAwardAni({id:8,num:30},i,e,0,n.addSelf(r.position))},e.prototype.onCourseNotify=function(t){if(!(t>3)){t<3?this.setBottomBtnsValid(!1):this.setBottomBtnsValid(!0);var e={courseId:0,isGame:!0};switch(e.courseId=t,t){case 2:e.targetNode1=this.mSelectLayout.children[0],e.targetNode2=this._gridsMap.get("5-2");break;case 3:e.targetNode=this.mBtnRefresh.parent.getChildByName("BtnFight");break;case 11:if(y.battleDataProxy.isStartFight)return}g.userDataProxy.showCourse(e)}},e.prototype.pauseGame=function(){this._pauseGameState=y.battleDataProxy.gameState,y.battleDataProxy.gameState=d.GameState.PAUSE},e.prototype.resumeGame=function(){y.battleDataProxy.gameState=this._pauseGameState},e.prototype.saveBattlePlantData=function(){for(var t=!1,e=[],a=0;a<this.mEquipmentNode.children.length;++a){var i=this.mEquipmentNode.children[a].getComponent(x.default);if(i.mIsFixedPlant)t=i.getComponent(x.default).isPurchased;else{var o={idx:a,equipId:i.equipId,dataFormIdx:i.dataFormIdx,holdGrids:i.holdGrids,level:i.level,pos:JSON.stringify(i.node.position)};e.push(o),this.mEquipmentNode.children[a].getComponent(x.default).setTriggerBarFillRange(!1)}}var n=[];for(a=0;a<this.mBlockLayout.children.length;++a){var r=this.mBlockLayout.children[a];if(r&&r.isValid){var s=r.getComponent(N.default);if(s){var c=s.holdGrid,l=s.stoneHp;n.push({holdGrid:c,stoneHp:l})}}}var u={};u.equipData=e,y.battleDataProxy.weatherType!=d.WeatherType.NONE?(u.curChapter=g.userDataProxy.userData.cursWeatherChapter,u.curWave=g.userDataProxy.userData.curWeatherWave):(u.curChapter=g.userDataProxy.userData.curChapter,u.curWave=g.userDataProxy.userData.curWave),u.mapBlockData=n,u.isBuyFixedPlant=t,u.battleData=y.battleDataProxy.battleData,y.battleDataProxy.saveBattlePlantData(JSON.stringify(u)),this._fightEquipData=e},e.prototype.addWeatherEffect=function(){var t=this,e="";y.battleDataProxy.weatherType==d.WeatherType.THUNDER?e="prefabs/weather/WeatherThunder":y.battleDataProxy.weatherType==d.WeatherType.HeavyRain?e="prefabs/weather/WeatherRain":y.battleDataProxy.weatherType==d.WeatherType.Night?e="prefabs/weather/WeatherNight":y.battleDataProxy.weatherType==d.WeatherType.SandWind?e="prefabs/weather/WeatherSandWind":y.battleDataProxy.weatherType==d.WeatherType.IceAndSnow?e="prefabs/weather/WeatherSnow":y.battleDataProxy.weatherType==d.WeatherType.HeavyFog&&(e="prefabs/weather/WeatherHeavyFog"),""!=e&&u.ResUtil.loadAsset({path:e,type:cc.Prefab,bundleName:m.Bundles.GAME}).then(function(e){var a=_.default.instance.getNode(e);y.battleDataProxy.weatherType==d.WeatherType.Night?t.node.getChildByName("root").getChildByName("nightView").addChild(a):y.battleDataProxy.weatherType==d.WeatherType.HeavyFog?t.node.getChildByName("root").getChildByName("top").addChild(a):t.node.getChildByName("BattleBaseInfoView").getChildByName("topView").addChild(a,10)}).catch(function(t){console.log("error:",t)})},__decorate([L(cc.Node)],e.prototype,"mGridsLayout",void 0),__decorate([L(cc.Node)],e.prototype,"mSelectLayout",void 0),__decorate([L(cc.Node)],e.prototype,"mEquipmentNode",void 0),__decorate([L(cc.Node)],e.prototype,"mBtnGetGrid",void 0),__decorate([L(cc.Node)],e.prototype,"mBtnRefreshVideo",void 0),__decorate([L(cc.Node)],e.prototype,"mBtnRefresh",void 0),__decorate([L(cc.Node)],e.prototype,"mBtnLayout",void 0),__decorate([L(cc.Prefab)],e.prototype,"mBulletBallPb",void 0),__decorate([L(cc.Node)],e.prototype,"mBallView",void 0),__decorate([L(cc.Node)],e.prototype,"mBattleBaseInfoView",void 0),__decorate([L(cc.Node)],e.prototype,"mBattleView",void 0),__decorate([L(cc.Node)],e.prototype,"mPathView",void 0),__decorate([L(cc.Node)],e.prototype,"mBuildBase",void 0),__decorate([L(cc.Node)],e.prototype,"mBtnRecycle",void 0),__decorate([L(cc.Node)],e.prototype,"mPathPointView",void 0),__decorate([L(cc.Node)],e.prototype,"mSuperPlantView",void 0),__decorate([L(cc.Sprite)],e.prototype,"mChapterBg",void 0),__decorate([L(cc.Node)],e.prototype,"mPathWallView",void 0),__decorate([L(cc.Prefab)],e.prototype,"mMapBlockItemPb",void 0),__decorate([L(cc.Node)],e.prototype,"mBlockLayout",void 0),__decorate([L(cc.Node)],e.prototype,"mFrenzyBar",void 0),__decorate([L(cc.Node)],e.prototype,"mZbTips",void 0),__decorate([L(cc.Node)],e.prototype,"mBulletView",void 0),__decorate([F],e)}(cc.Component);n.default=O,cc._RF.pop(),cc._RF.pop()},{}],GameWinPopup:[function(t,e,a){"use strict";cc._RF.push(e,"bf104vkiDtDCZqseyH+mzNT","GameWinPopup");var i=t,o=e,n=a;cc._RF.push(o,"d9279OdZ5FM64eh8JwFqCfu","GameWinPopup"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("ResUtil"),c=i("TimeUtil"),l=i("PopupBase"),u=i("SceneManager"),p=i("AdsMgr"),h=i("GameEnum"),d=i("HomeEnum"),m=i("DataManager"),f=i("BattleDataProxy"),_=i("UserDataProxy"),y=i("AnimationMgr"),g=cc._decorator,v=g.ccclass,P=g.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mTips1=null,e.mTips2=null,e.mItemLayout=null,e._isCanClick=!0,e._reawards=[],e._double=1,e}return __extends(e,t),e.prototype.init=function(e){t.prototype.init.call(this,e),r.AudioManager.instance.stopBgm(),r.AudioManager.instance.playEffectPath("sounds/win",d.Bundles.RES),f.battleDataProxy.isEndless?this.endlessOver():f.battleDataProxy.weatherType!=h.WeatherType.NONE?this.weatherOver():this.chapterOver(),this.updateVideoCardNum(),f.battleDataProxy.gameState=h.GameState.OVER;var a=Math.floor(1e3*Math.random())%3+1,i=m.DataManager.instance.eData.datasettlement[1]["des"+a].split("|");this.mTips1.string=i[0],this.mTips2.string=i[1],f.battleDataProxy.clearData()},e.prototype.weatherOver=function(){var t=_.userDataProxy.userData.cursWeatherChapter,e=m.DataManager.instance.eData.data_weather[t];if(e){for(var a=[],i=0,o=e.reward.split("|"),n=function(t){var e=o[t].split("_");if((i=Math.floor(1*Number(e[1])))>0){var n=a.findIndex(function(t){return t.id==Number(e[0])});n>=0?a[n].num+=i:a.push({id:Number(e[0]),num:i})}},r=0,s=o.length;r<s;r++)n(r);this.setRewardItems(a),this._reawards=a}if(t>_.userDataProxy.userData.passWeatherChapter){_.userDataProxy.userData.passWeatherChapter=t;var c=m.DataManager.instance.eData.data_weatherdata,l=0,u=Object.keys(c),p=c[u[u.length-1]];p&&(l=p.stageID),_.userDataProxy.userData.passWeatherChapter<l&&(_.userDataProxy.userData.cursWeatherChapter=_.userDataProxy.userData.passWeatherChapter+1),_.userDataProxy.saveData()}},e.prototype.endlessOver=function(){for(var t=m.DataManager.instance.eData.datapara[1005].num,e=m.DataManager.instance.eData.datapara[1006].num,a=Math.ceil(f.battleDataProxy.endlessCurWave/5),i=[],o=0,n=t.split("|"),r=e.split("|"),s=0,c=n.length;s<c;s++){var l=n[s].split("_");(o=Math.floor(1*Number(l[1])))>0&&i.push({id:Number(l[0]),num:o})}var u=function(t){var e=r[t].split("_");if((o=Math.floor(1*Number(e[1]))*a)>0){var n=i.findIndex(function(t){return t.id==Number(e[0])});n>=0?i[n].num+=o:i.push({id:Number(e[0]),num:o})}};for(s=0,c=r.length;s<c;s++)u(s);this.setRewardItems(i),this._reawards=i,_.userDataProxy.userData.endlessData.maxWave<f.battleDataProxy.endlessCurWave&&(_.userDataProxy.userData.endlessData.maxWave=f.battleDataProxy.endlessCurWave,_.userDataProxy.saveData()),f.battleDataProxy.uploadEndlessResult(function(){f.battleDataProxy.getEndlessRankDatas(function(){})})},e.prototype.chapterOver=function(){1==_.userDataProxy.userData.curChapter&&_.userDataProxy.userData.gameCourseData.curId<3&&(_.userDataProxy.userData.gameCourseData.curId=3,_.userDataProxy.userData.gameCourseData.completeId=3,_.userDataProxy.saveData());for(var t=f.battleDataProxy.getStageRewardCfg().winReward.split("|"),e=[],a=0,i=0,o=t.length;i<o;i++){var n=t[i].split("_");(a=Math.floor(1*Number(n[1])))>0&&e.push({id:Number(n[0]),num:a})}this.setRewardItems(e);var r=_.userDataProxy.userData.curChapter;if(r>_.userDataProxy.userData.passChapter){_.userDataProxy.userData.passChapter=r;var s=m.DataManager.instance.eData.datastagereward,l=0;for(var u in s)l=s[u].id;_.userDataProxy.userData.passChapter<l&&(_.userDataProxy.userData.curChapter=_.userDataProxy.userData.passChapter+1),_.userDataProxy.userData.passWave=0;var p=new Date,h=c.TimeUtil.getCalendarDaysBetweenTimestamps(m.DataManager.instance.mCreateTime,p.getTime())+1;mm.platform.umaTrackEvent("progress",{userA:"lv_until_"+h+"_"+_.userDataProxy.userData.curChapter}),_.userDataProxy.saveData()}var d=m.DataManager.instance.eData.dataplant;for(var u in d){var y=d[u];y.stageID==r&&(_.userDataProxy.getIsUnlockPlant(y.id)||_.userDataProxy.mNewUnlockPlantIds.push(y.id))}this._reawards=e},e.prototype.setRewardItems=function(t){t=_.userDataProxy.checkBoxRetrunAwards(t);for(var e=function(e){var i=m.DataManager.instance.eData.dataitem[t[e].id],o=a.mItemLayout.children[e];o||((o=cc.instantiate(a.mItemLayout.children[0])).parent=a.mItemLayout),o.active=!0;var n=o.getChildByName("itemBg").getComponent(cc.Sprite);s.ResUtil.loadAsset({path:"textures/public/item_bg"+i.qulity,type:cc.SpriteFrame,bundleName:d.Bundles.GAME}).then(function(t){n.spriteFrame=t}).catch(function(t){console.log("error:",t)});var r=o.getChildByName("itemImg").getComponent(cc.Sprite);s.ResUtil.loadAsset({path:"textures/item/"+i.icon,type:cc.SpriteFrame,bundleName:d.Bundles.GAME}).then(function(t){r.spriteFrame=t}).catch(function(t){console.log("error:",t)}),o.getChildByName("itemNum").getComponent(cc.Label).string="x"+t[e].num},a=this,i=0,o=t.length;i<o;i++)e(i)},e.prototype.updateVideoCardNum=function(){var t=this.node.getChildByName("BtnDouble").getChildByName("pic_AD_green");f.battleDataProxy.setVideoCardIcon(t,2,1.5)},e.prototype.onBtnReceive=function(){this._isCanClick&&(this._double=1,this.toHome())},e.prototype.onBtnDouble=function(){var t=this;if(this._isCanClick){if(_.userDataProxy.getProp(4)>0)return _.userDataProxy.addProp(4,-1),this._double=2,void this.toHome();p.default.showVideoAds({id:1,eventId:"game_win_double_ad",success:function(){t._double=2,t.toHome()},fail:function(t){return console.log(t)},error:function(t){return console.log(t)}},!0)}},e.prototype.toHome=function(){var t=this;this._isCanClick=!1;for(var e=this.node.getChildByName("layout"),a=0,i=this._reawards.length,o=i>0?2:0,n=function(o){var n=e.children[o];if(!n.active)return"continue";var s=r._reawards[a];r.scheduleOnce(function(){s&&(n.active=!1,y.default.instance.showAwardAni(s,t.node,n,0,cc.v3(-250,s.id>6?-850:850)),_.userDataProxy.addProp(s.id,s.num*t._double,a+1==i))},.1*a),a++},r=this,s=0;s<e.children.length;++s)n(s);this.scheduleOnce(function(){u.SceneManager.instance.runScene("Home",""),t.removeUI()},.1*a+o)},__decorate([P(cc.Label)],e.prototype,"mTips1",void 0),__decorate([P(cc.Label)],e.prototype,"mTips2",void 0),__decorate([P(cc.Node)],e.prototype,"mItemLayout",void 0),__decorate([v],e)}(l.PopupBase);n.default=b,cc._RF.pop(),cc._RF.pop()},{}],GlodShopItem:[function(t,e,a){"use strict";cc._RF.push(e,"c3cf5YC3v1CEqa4TO3KY1w2","GlodShopItem");var i=t,o=e,n=a;cc._RF.push(o,"96a69NnjXxCkKGuUZpYNr3C","GlodShopItem"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("EventManager"),c=i("TimeUtil"),l=i("AdsMgr"),u=i("HomeEnum"),p=i("UserDataProxy"),h=i("Util"),d=i("GameUIManager"),m=cc._decorator,f=m.ccclass,_=(m.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._itemData=null,e}return __extends(e,t),e.prototype.init=function(t){var e=this;s.EventManager.instance.on(p.EUserDataEvent.DIAMOD_UPDATE,this.updateDiamond,this),this._itemData=t;var a=p.userDataProxy.userData.goldData,i=this._itemData.buyType,o=Number(this._itemData.reward.split("_")[1]);if(this.node.getChildByName("numLabel").getComponent(cc.Label).string="X"+o,1==i){this.unscheduleAllCallbacks(),this.node.getChildByName("mianfeiBtn").active=this._itemData.freeNum>a.mfNum;var n=this.node.getChildByName("proLabel");if(this._itemData.buyNum>1&&this._itemData.freeNum==a.mfNum){var r=10-a.videoNum;n.getComponent(cc.Label).string=r+"/"+this._itemData.buyNum,n.active=!0}if(this.node.getChildByName("videoBtn").active=this._itemData.freeNum<=a.mfNum&&this._itemData.buyNum>a.videoNum,a.videoNum>=this._itemData.buyNum){var l=h.default.getNextDayZeroTimestamp()-Date.now(),u=this.node.getChildByName("timerCd").getComponent(cc.Label);u.node.active=!0,u.string=c.TimeUtil.format_MMSS(l),this.schedule(function(){(l-=1e3)<0&&e.unscheduleAllCallbacks(),u.string=c.TimeUtil.format_MMSS(l)},1)}}else{var d=Number(this._itemData.cost.split("_")[1]),m=this.node.getChildByName("buyBtn");m.getChildByName("label").getComponent(cc.Label).string=""+d,m.active=!0,p.userDataProxy.userData.diamond>=d?m.getChildByName("label").color=cc.Color.WHITE:m.getChildByName("label").color=cc.Color.RED}},e.prototype.onDestroy=function(){s.EventManager.instance.off(p.EUserDataEvent.DIAMOD_UPDATE,this.updateDiamond,this)},e.prototype.updateDiamond=function(){var t=Number(this._itemData.cost.split("_")[1]),e=this.node.getChildByName("buyBtn");p.userDataProxy.userData.diamond>=t?e.getChildByName("label").color=cc.Color.WHITE:e.getChildByName("label").color=cc.Color.RED},e.prototype.onMianFeiClick=function(){r.AudioManager.instance.playEffectPath("sounds/click",u.Bundles.RES),p.userDataProxy.userData.goldData.mfNum+=1,p.userDataProxy.saveData();var t=this._itemData.reward.split("_"),e=[{id:Number(t[0]),num:Number(t[1])}];d.gameUIMgr.showCongratsGettingPopup({list:e,type:1}),this.init(this._itemData),s.EventManager.instance.emit(u.EHomeEvent.UPDATE_HOME_REDDOT,[u.HOME_REDDOT.SHOPRED])},e.prototype.onBuyClick=function(){r.AudioManager.instance.playEffectPath("sounds/click",u.Bundles.RES);var t=Number(this._itemData.cost.split("_")[1]);if(!(p.userDataProxy.userData.diamond>=t))return d.gameUIMgr.showTips("\u94bb\u77f3\u4e0d\u591f\uff01"),void s.EventManager.instance.emit(u.EHomeEvent.SHOW_VIDEO_DIAMOMND_POPUP);p.userDataProxy.changeDiamond(-t);var e=this._itemData.reward.split("_"),a=[{id:Number(e[0]),num:Number(e[1])}];d.gameUIMgr.showCongratsGettingPopup({list:a,type:1})},e.prototype.onVideoClick=function(){var t=this;r.AudioManager.instance.playEffectPath("sounds/click",u.Bundles.RES),this._itemData.buyNum>p.userDataProxy.userData.goldData.videoNum?l.default.showVideoAds({id:1,eventId:"shop_getGold_ad",success:function(){p.userDataProxy.userData.goldData.videoNum+=1,p.userDataProxy.saveData();var e=t._itemData.reward.split("_"),a=[{id:Number(e[0]),num:Number(e[1])}];d.gameUIMgr.showCongratsGettingPopup({list:a,type:1}),t.init(t._itemData)},fail:function(t){return console.log(t)},error:function(t){return console.log(t)}},!0):d.gameUIMgr.showTips("\u5e7f\u544a\u6b21\u6570\u8d85\u8fc7\u4e86!")},__decorate([f],e)}(cc.Component));n.default=_,cc._RF.pop(),cc._RF.pop()},{}],GuardingDataProxy:[function(t,e,a){"use strict";cc._RF.push(e,"2021bRpTsJDsaGLGvnetdCQ","GuardingDataProxy");var i=t,o=e,n=a;cc._RF.push(o,"1acbe4Mt2JHLbpbB+us1YfM","GuardingDataProxy"),Object.defineProperty(n,"__esModule",{value:!0}),n.guardingDataProxy=n.GuardingDataEvent=n.GuardingData=void 0;var r=i("ProxyBase"),s=i("GameEnum"),c=i("DataManager"),l=cc._decorator,u=l.ccclass,p=(l.property,function(){this.btnStartTime=0,this.unlockLevels=[1],this.unlocklookAd={}});n.GuardingData=p,function(t){t.ITEM_UPDATE="ITEM_UPDATE",t.UPDATE_EQUIPMENT="UPDATE_EQUIPMENT",t.KILL_MONSTER="KILL_MONSTER",t.ENTER_LEVEL="ENTER_LEVEL"}(n.GuardingDataEvent||(n.GuardingDataEvent={}));var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.gameState=s.GameState.NONE,e.bulletLayout=null,e.battleView=null,e.effectLayer=null,e.buffLayer=null,e.factions=1,e.monsters=[],e.equipments=[],e.skillBoxs=[],e.keyboradList=[],e.currStageId=1,e.bridgeIndex=0,e.curRoleImgsrc="pic_plant10",e.curBulletImgsrc="xiandao_1",e.bulletCount=1,e.attackSpeed=.2,e.attackCrit=0,e.attackSpeedMax=.08,e.attackNum=10,e.playerNode=null,e.bulletSpeed=1e3,e.bPenetrate=1,e.selectLevel=1,e.keyBoradList=[],e}return __extends(e,t),e.prototype.refreshData=function(){this.curRoleImgsrc="juese_1",this.curBulletImgsrc="xiandao_1",this.bPenetrate=1,this.attackNum=10,this.attackCrit=0,this.attackSpeed=.2,this.bulletCount=1,this.currStageId=1,this.bridgeIndex=0},Object.defineProperty(e.prototype,"GuardingData",{get:function(){return this._data},enumerable:!1,configurable:!0}),e.prototype.saveData=function(){c.DataManager.instance.writeGameDataBase(r.ProxyKey.GuardingData,this.GuardingData,null)},__decorate([u],e)}(r.ProxyBase);n.default=h,n.guardingDataProxy=new h(p),cc._RF.pop(),cc._RF.pop()},{}],GuardingtherBridge:[function(t,e,a){"use strict";cc._RF.push(e,"8b7ffvgFE9EbZCsPTVX7cVW","GuardingtherBridge");var i=t,o=e,n=a;cc._RF.push(o,"a54bcOs9utJLJnBRNkdJl6L","GuardingtherBridge"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("SceneBase"),s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this)},__decorate([c],e)}(r.SceneBase));n.default=l,cc._RF.pop(),cc._RF.pop()},{}],Gutil:[function(t,e,a){"use strict";cc._RF.push(e,"f551b22uhlNDIPwRarpXy6W","Gutil");var i=e,o=a,n=t("./helpers/typeof");cc._RF.push(i,"16478WlCX1PBr3Y81MW7tfY","Gutil");var r=function(t,e,a,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,a):i;if("object"==("undefined"==typeof Reflect?"undefined":n(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,a,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(s=(r<3?o(s):r>3?o(e,a,s):o(e,a))||s);return r>3&&s&&Object.defineProperty(e,a,s),s},s=function(t,e){var a="function"==typeof Symbol&&t[Symbol.iterator];if(!a)return t;var i,o,n=a.call(t),r=[];try{for(;(void 0===e||e-- >0)&&!(i=n.next()).done;)r.push(i.value)}catch(u){o={error:u}}finally{try{i&&!i.done&&(a=n.return)&&a.call(n)}finally{if(o)throw o.error}}return r};Object.defineProperty(o,"__esModule",{value:!0}),o.Gutil=void 0;var c=cc._decorator,l=c.ccclass,u=(c.property,function(){function t(){}var e;return e=t,t.base64decode=function(t){var e,a,i,o,n,r,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="",l=0;for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");l<t.length;)e=s.indexOf(t.charAt(l++))<<2|(o=s.indexOf(t.charAt(l++)))>>4,a=(15&o)<<4|(n=s.indexOf(t.charAt(l++)))>>2,i=(3&n)<<6|(r=s.indexOf(t.charAt(l++))),c+=String.fromCharCode(e),64!=n&&(c+=String.fromCharCode(a)),64!=r&&(c+=String.fromCharCode(i));return this._utf8_encode(c)},t._utf8_encode=function(t){t=t.replace(/\r\n/g,"\n");for(var e="",a=0;a<t.length;a++){var i=t.charCodeAt(a);i<128?e+=String.fromCharCode(i):i>127&&i<2048?(e+=String.fromCharCode(i>>6|192),e+=String.fromCharCode(63&i|128)):(e+=String.fromCharCode(i>>12|224),e+=String.fromCharCode(i>>6&63|128),e+=String.fromCharCode(63&i|128))}return e},t.base64_encode=function(t){var e,a,i,o,n,r,s,c="",l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u=0;for(t=this._utf8_encode(t);u<t.length;)o=(e=t.charCodeAt(u++))>>2,n=(3&e)<<4|(a=t.charCodeAt(u++))>>4,r=(15&a)<<2|(i=t.charCodeAt(u++))>>6,s=63&i,isNaN(a)?r=s=64:isNaN(i)&&(s=64),c=c+l.charAt(o)+l.charAt(n)+l.charAt(r)+l.charAt(s);return c},t.isBase64=function(t){if(""===t||""===t.trim())return!1;try{return this.base64_encode(this.base64decode(t))==t}catch(e){return!1}},t.arrDeleteObj=function(t,e){var a=t.indexOf(e);-1!=a&&t.splice(a,1)},t.Random=function(t,e){return Math.random()*(e-t)+t},t.RandomRangeInt=function(t,e){var a=e+1-t,i=Math.random();return t+Math.floor(i*a)},t.xipai=function(t){for(var e,a=1;a<t.length;a++){var i=Math.floor(Math.random()*(a+1));e=s([t[i],t[a]],2),t[a]=e[0],t[i]=e[1]}return t},t.makeRandomArr=function(t,e){if(e>t.length)return t;for(var a=t.slice(),i=[],o=0;o<e;o++){var n=Math.floor(Math.random()*a.length),r=a[n];a.splice(n,1),i.push(r)}return i},t.DistanceSqrtWithoutY=function(t,e){return this._a.x=t.x,this._a.y=0,this._a.z=t.z,this._b.x=e.x,this._b.y=0,this._b.z=e.z,cc.Vec3.squaredDistance(this._a,this._b)},t.DistanceSqrtWithoutYXZXZ=function(t,e,a,i){return this._a.x=t,this._a.y=0,this._a.z=e,this._b.x=a,this._b.y=0,this._b.z=i,cc.Vec3.squaredDistance(this._a,this._b)},t.DistanceWithoutZ=function(t,e){return this._a.x=t.x,this._a.z=0,this._a.y=t.y,this._b.x=e.x,this._b.z=0,this._b.y=e.y,cc.Vec3.distance(this._a,this._b)},t.setNewV3=function(t,e){return t.x=e.x,t.y=e.y,t.z=e.z,t},t.setNewV3with=function(t,e,a,i){return void 0===i&&(i=0),t.x=e,t.y=a,t.z=i,t},t.SystemTime=function(){return(new Date).getTime()},t.SystemMillionSecond=function(){return 0==e._sms&&e.UpdateSystemTime(),e._sms},t.UpdateSystemTime=function(){e._sms=(new Date).getTime()},t.SystemTimeHHMMSS=function(){var t=(new Date).getTime(),a=t.toString();return a=a.substr(a.length-4),e.FormatTime_HHMMSS(t)+" "+a},t.SystemDay=function(){return this.GetDay(this.SystemTime())},t.GetDay=function(t){var e=t/1e3;return e/=60,e/=60,e+=8,e/=24,Math.floor(e)},t.FormatTime_HHMMSS=function(t){var e=t/1e3,a=(Array(2).join("0")+Math.floor(e/3600)).slice(-2),i=(Array(2).join("0")+Math.floor(e%3600/60)).slice(-2),o=(Array(2).join("0")+Math.floor(e)%60).slice(-2);return"00"==a?i+":"+o:a+":"+i+":"+o},t.FormatTime_DDHHMMSS=function(t){var e=t/1e3;return e=Math.floor(e/60),e=Math.floor(e/60),e=Math.floor(e/24),""},t.FormatTime_YYMMDD=function(t){var e=new Date(t);return e.getFullYear()+"/"+(e.getMonth()+1)+"/"+e.getDate()+" "+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()},t.getLookAtAngle=function(t){return Math.atan2(t.y,t.x)/Math.PI*180},t.getDirFromAngle=function(t){var e=t*Math.PI/180,a=cc.v3(Math.cos(e),Math.sin(e));return a.normalizeSelf(),a},t.WorldPos=function(t){return t.parent.convertToWorldSpaceAR(t.position)},t.LocationPos=function(t,e){return t.convertToNodeSpaceAR(e)},t._a=new cc.Vec3,t._b=new cc.Vec3,t._sms=0,e=r([l],t)}());o.Gutil=u,cc._RF.pop(),cc._RF.pop()},{"./helpers/typeof":"typeof"}],HeavyFogEffect:[function(t,e,a){"use strict";cc._RF.push(e,"cfd473r7GVHeomkcZHqdFRn","HeavyFogEffect");var i=t,o=e,n=a;cc._RF.push(o,"914a9aVgapBy47DZVdbSV29","HeavyFogEffect"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("MathUtil"),s=i("GameEnum"),c=i("BattleDataProxy"),l=cc._decorator,u=l.ccclass,p=(l.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._isMoveBack=!1,e._backTime=0,e._isCanBeBlown=!0,e._showImage=null,e._heavyFogPos=null,e}return __extends(e,t),e.prototype.initHeavyFogEffect=function(t){this._heavyFogPos=t,this._heavyFogPos.pos.addSelf(cc.v3(0,196)),this._showImage=this.node.getChildByName("image"+this._heavyFogPos.imageId),cc.Tween.stopAllByTarget(this._showImage);var e=Math.floor(1e3*Math.random())%20+15;0==Math.floor(1e3*Math.random())%2&&(e*=-1);var a=cc.tween(this._showImage).by(2,{position:cc.v3(e,0)}).by(2,{position:cc.v3(-e,0)});cc.tween(this._showImage).repeatForever(a).start(),this.node.position=this._heavyFogPos.pos,this.node.scale=this._heavyFogPos.scale,this._showImage.active=!0},e.prototype.beBlownAway=function(t){if(!this._isMoveBack&&this._isCanBeBlown){this._showImage.pauseAllActions();var e=r.MathUtil.getDoublPointRadian(this.node.position,t.position),a=this.node.x+500*Math.cos(e),i=this.node.y+500*Math.sin(e),o=cc.v3(a,i);cc.Tween.stopAllByTarget(this.node),cc.tween(this.node).to(.5,{position:o,angle:950}).start(),this._isMoveBack=!0}},e.prototype.update=function(t){var e=this;c.battleDataProxy.gameState==s.GameState.PLAYING&&this._isMoveBack&&(this._backTime+=t,this._backTime>=6&&(this._backTime=0,this._isMoveBack=!1,this._isCanBeBlown=!1,cc.Tween.stopAllByTarget(this.node),this.node.scale=0,this.node.position=this._heavyFogPos.pos,this.node.angle=0,this._showImage.resumeAllActions(),cc.tween(this.node).to(.5,{scale:this._heavyFogPos.scale}).call(function(){e._isCanBeBlown=!0}).start()))},__decorate([u],e)}(cc.Component));n.default=p,cc._RF.pop(),cc._RF.pop()},{}],HollowOut:[function(t,e,a){"use strict";cc._RF.push(e,"31807BsW+lG0bnY7hQP1mdd","HollowOut");var i=e,o=a;cc._RF.push(i,"4cc83KbkjBG0pdZ3ToJTCYb","HollowOut"),Object.defineProperty(o,"__esModule",{value:!0}),o.HollowOutShape=void 0;var n,r=cc._decorator,s=r.ccclass,c=r.property,l=r.requireComponent,u=r.executeInEditMode,p=r.disallowMultiple,h=r.executionOrder;(function(t){t[t.Rect=1]="Rect",t[t.Circle=2]="Circle"})(n=o.HollowOutShape||(o.HollowOutShape={}));var d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._effect=null,e._shape=n.Rect,e._center=cc.v2(),e._width=300,e._height=300,e._round=1,e._radius=200,e._feather=.5,e.sprite=null,e.material=null,e.tweenRes=null,e}return __extends(e,t),Object.defineProperty(e.prototype,"effect",{get:function(){return this._effect},set:function(t){this._effect=t,this.init()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shape",{get:function(){return this._shape},set:function(t){this._shape=t,this.updateProperties()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"center",{get:function(){return this._center},set:function(t){this._center=t,this.updateProperties()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t,this.updateProperties()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t,this.updateProperties()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"round",{get:function(){return this._round},set:function(t){this._round=t,this.updateProperties()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"radius",{get:function(){return this._radius},set:function(t){this._radius=t,this.updateProperties()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"feather",{get:function(){return this._feather},set:function(t){this._feather=t,this.updateProperties()},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){this.init()},e.prototype.resetInEditor=function(){this.init()},e.prototype.init=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(){return this._effect?((t=this.sprite=this.node.getComponent(cc.Sprite)).spriteFrame&&(t.spriteFrame.getTexture().packable=!1),this.material=cc.Material.create(this._effect),t.setMaterial(0,this.material),this.updateProperties(),[2]):[2]})})},e.prototype.updateProperties=function(){switch(this._shape){case n.Rect:this.rect(this._center,this._width,this._height,this._round,this._feather);break;case n.Circle:this.circle(this._center,this._radius,this._feather)}},e.prototype.rect=function(t,e,a,i,o){if(this._shape=n.Rect,null!=t&&(this._center=t),null!=e&&(this._width=e),null!=a&&(this._height=a),null!=i){this._round=i>=0?i:0;var r=Math.min(this._width/2,this._height/2);this._round=this._round<=r?this._round:r}null!=o&&(this._feather=o>=0?o:0,this._feather=this._feather<=this._round?this._feather:this._round);var s=this.material;s.setProperty("size",this.getNodeSize()),s.setProperty("center",this.getCenter(this._center)),s.setProperty("width",this.getWidth(this._width)),s.setProperty("height",this.getHeight(this._height)),s.setProperty("round",this.getRound(this._round)),s.setProperty("feather",this.getFeather(this._feather))},e.prototype.circle=function(t,e,a){this._shape=n.Circle,null!=t&&(this._center=t),null!=e&&(this._radius=e),null!=a&&(this._feather=a>=0?a:0);var i=this.material;i.setProperty("size",this.getNodeSize()),i.setProperty("center",this.getCenter(this._center)),i.setProperty("width",this.getWidth(2*this._radius)),i.setProperty("height",this.getHeight(2*this._radius)),i.setProperty("round",this.getRound(this._radius)),i.setProperty("feather",this.getFeather(this._feather))},e.prototype.rectTo=function(t,e,a,i,o,r){var s=this;return void 0===o&&(o=0),void 0===r&&(r=0),new Promise(function(c){s._shape=n.Rect,cc.Tween.stopAllByTarget(s),s.unscheduleAllCallbacks(),s.tweenRes&&s.tweenRes(),s.tweenRes=c,o=Math.min(o,a/2,i/2),r=Math.min(r,o),cc.tween(s).to(t,{center:e,width:a,height:i,round:o,feather:r}).call(function(){s.scheduleOnce(function(){s.tweenRes&&(s.tweenRes(),s.tweenRes=null)})}).start()})},e.prototype.circleTo=function(t,e,a,i){var o=this;return void 0===i&&(i=0),new Promise(function(r){o._shape=n.Circle,cc.Tween.stopAllByTarget(o),o.unscheduleAllCallbacks(),o.tweenRes&&o.tweenRes(),o.tweenRes=r,cc.tween(o).to(t,{center:e,radius:a,feather:i}).call(function(){o.scheduleOnce(function(){o.tweenRes&&(o.tweenRes(),o.tweenRes=null)})}).start()})},e.prototype.reset=function(){this.rect(cc.v2(),0,0,0,0)},e.prototype.setNodeSize=function(){var t=this.node,e=t.width,a=t.height;this._radius=Math.sqrt(Math.pow(e,2)+Math.pow(a,2))/2,this.rect(t.getPosition(),e,a,0,0)},e.prototype.getCenter=function(t){var e=this.node,a=e.width,i=e.height,o=(t.x+a/2)/a,n=(-t.y+i/2)/i;return cc.v2(o,n)},e.prototype.getNodeSize=function(){return cc.v2(this.node.width,this.node.height)},e.prototype.getWidth=function(t){return t/this.node.width},e.prototype.getHeight=function(t){return t/this.node.width},e.prototype.getRound=function(t){return t/this.node.width},e.prototype.getFeather=function(t){return t/this.node.width},__decorate([c],e.prototype,"_effect",void 0),__decorate([c({type:cc.EffectAsset,tooltip:!1,readonly:!0})],e.prototype,"effect",null),__decorate([c],e.prototype,"_shape",void 0),__decorate([c({type:cc.Enum(n),tooltip:!1})],e.prototype,"shape",null),__decorate([c],e.prototype,"_center",void 0),__decorate([c({tooltip:!1})],e.prototype,"center",null),__decorate([c],e.prototype,"_width",void 0),__decorate([c({tooltip:!1,visible:function(){return this._shape===n.Rect}})],e.prototype,"width",null),__decorate([c],e.prototype,"_height",void 0),__decorate([c({tooltip:!1,visible:function(){return this._shape===n.Rect}})],e.prototype,"height",null),__decorate([c],e.prototype,"_round",void 0),__decorate([c({tooltip:!1,visible:function(){return this._shape===n.Rect}})],e.prototype,"round",null),__decorate([c],e.prototype,"_radius",void 0),__decorate([c({tooltip:!1,visible:function(){return this._shape===n.Circle}})],e.prototype,"radius",null),__decorate([c],e.prototype,"_feather",void 0),__decorate([c({tooltip:!1,visible:function(){return this._shape===n.Circle||this.round>0}})],e.prototype,"feather",null),__decorate([s,l(cc.Sprite),u,p,h(-10)],e)}(cc.Component);o.default=d,cc._RF.pop(),cc._RF.pop()},{}],HomeBall:[function(t,e,a){"use strict";cc._RF.push(e,"1b32dCSSyBI2KL8BTzZow4i","HomeBall");var i=t,o=e,n=a;cc._RF.push(o,"f08a4f2VM5F4K4ZK9yVQa+8","HomeBall"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("GameEnum"),s=i("NodePoolManager"),c=i("BallCollisionEffect"),l=i("HomeCollisionBase"),u=cc._decorator,p=u.ccclass,h=u.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mRigidBody=null,e.mCollisionEffectPb=null,e._baseTargetSpeed=0,e}return __extends(e,t),e.prototype.onLoad=function(){this.mRigidBody.linearVelocity=this.getLinearVelocity(),this._baseTargetSpeed=this.mRigidBody.linearVelocity.lengthSqr()},e.prototype.getLinearVelocity=function(){var t=Math.floor(100*Math.random())%2==0?1:-1,e=Math.floor(100*Math.random())%2==0?1:-1;return cc.v2(r.EGameEnum.BALL_SPEED*t,r.EGameEnum.BALL_SPEED*e)},e.prototype.onBeginContact=function(t,e,a){var i,o=a.node;null===(i=o.getComponent(l.default))||void 0===i||i.onCollision();var n=t.getWorldManifold().points,r=s.default.instance.getNode(this.mCollisionEffectPb);this.node.parent.addChild(r);var u=this.node.parent.convertToNodeSpaceAR(cc.v3(n[0]));r.position=u,r.getComponent(c.default).play();var p=o.getChildByName("root");p&&(cc.Tween.stopAllByTarget(p),p.scale=1,cc.tween(p).to(.15,{scale:1.1}).to(.15,{scale:1}).start())},e.prototype.pause=function(){this.mRigidBody.type=cc.RigidBodyType.Static},e.prototype.resume=function(){this.mRigidBody.type=cc.RigidBodyType.Dynamic},e.prototype.lateUpdate=function(){var t=this.mRigidBody.linearVelocity;if(0!=t.x||0!=t.y){var e=t.lengthSqr();if(Math.abs(e-this._baseTargetSpeed)>.1){var a=t.clone().normalize().multiplyScalar(Math.sqrt(this._baseTargetSpeed));this.mRigidBody.linearVelocity=a,console.log("\u901f\u5ea6\u66f4\u65b0\uff1a"+a)}}},__decorate([h(cc.RigidBody)],e.prototype,"mRigidBody",void 0),__decorate([h(cc.Prefab)],e.prototype,"mCollisionEffectPb",void 0),__decorate([p],e)}(cc.Component);n.default=d,cc._RF.pop(),cc._RF.pop()},{}],HomeBattleView:[function(t,e,a){"use strict";cc._RF.push(e,"b5ea2/SNzRFCp/t8jouse2b","HomeBattleView");var i=t,o=e,n=a;cc._RF.push(o,"6ece31dilBIX5FuD0N5ler2","HomeBattleView"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("EventManager"),c=i("HttpRequest"),l=i("CommonUtil"),u=i("ResUtil"),p=i("AppProxy"),h=i("SceneManager"),d=i("AdsMgr"),m=i("GameEnum"),f=i("HomeEnum"),_=i("DataManager"),y=i("BattleDataProxy"),g=i("UserDataProxy"),v=i("Util"),P=i("GameUIManager"),b=i("RedDotMgr"),D=i("HomeBall"),S=cc._decorator,C=S.ccclass,E=S.property,B=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mRewardBar=null,e.mBoxRoot=null,e.mQuickNum=null,e.mChapterName=null,e.mBtnLeft=null,e.mBtnRight=null,e.mBtnStart=null,e.mBtnQuick=null,e.mLoopNum=null,e.mFlyPower=null,e.mAwardTips=null,e.mLevelDetail=null,e.mHomeball=null,e.mChapterBg=null,e.mBtnPlant=null,e.mSidebarBtn=null,e.mBtnShortcut=null,e.mGuankaBg=null,e.mReportBtn=null,e.mEndlessRed=null,e.mWeatherSpine=null,e.mPhysicalNum=null,e._curChapter=0,e._stageRewardCfg=null,e._currentRound=-1,e._selectIndex=0,e._isCanClick=!0,e}return __extends(e,t),e.prototype.onLoad=function(){var t=this;if(s.EventManager.instance.on(g.EUserDataEvent.UPDATE_LOOP_REWARD_RED,this.updateLoopRewardRed,this),s.EventManager.instance.on(p.AppEvent.GET_SIDEBAR,this.handlePublicize,this),s.EventManager.instance.on(f.EHomeEvent.REPORT_BTN_SHOW_NOTIFY,this.onReportBtnShow,this),s.EventManager.instance.on(f.EHomeEvent.STAET_FIGHT,this.startFight,this),s.EventManager.instance.on(f.EHomeEvent.RECEIVE_ENDLESS_RWWARDS,this.onReceiveEndlessRewards,this),y.battleDataProxy.gameState=m.GameState.NONE,r.AudioManager.instance.playBgmPath("sounds/homeBgm",f.Bundles.RES),this.node.on(cc.Node.EventType.TOUCH_START,this.touchBegin,this),g.userDataProxy.userData.rewardBox||(g.userDataProxy.userData.rewardBox=[]),g.userDataProxy.userData.roundReward||(g.userDataProxy.userData.roundReward=[]),g.userDataProxy.userData.weatherRewardBox||(g.userDataProxy.userData.weatherRewardBox=[]),_.DataManager.instance.mIsInitData){if(2==g.userDataProxy.userData.gameModel){var e=y.battleDataProxy.loadBattlePlantData();e&&""!=e||(g.userDataProxy.userData.gameModel=1)}_.DataManager.instance.mIsInitData=!1}if(g.userDataProxy.userData.endlessData?this.mEndlessRed.active=g.userDataProxy.mYesterdayRank>0&&1!=g.userDataProxy.userData.endlessData.isReceive:(g.userDataProxy.userData.endlessData={maxWave:0,myRank:0,isReceive:0,playNum:Number(_.DataManager.instance.eData.datapara[1001].num)},this.mEndlessRed.active=!1),this.initCurChapter(),this.initLoopNum(),this.updateChapter(),this.updateLoopRewardRed(),this.updatePhysicsLocation(),this.handlePublicize(),this.onChangeGameModel(),this.mReportBtn.active=!1,this.mEndlessRed.parent.active=!1,this.switchCheck(function(){t.mReportBtn.active=_.DataManager.instance.allSwitch&&(cc.sys.platform==cc.sys.WECHAT_GAME||cc.sys.platform==cc.sys.BYTEDANCE_GAME),s.EventManager.instance.emit(f.EHomeEvent.UPDATE_MINI_BTN_VIEW);var e=_.DataManager.instance.miniGames.indexOf(f.ESubGameSwitch.Endless);t.mEndlessRed.parent.active=e>=0,t.initEndlessBtn()}),g.userDataProxy.userData.passChapter<3){var a=this.node.getChildByName("BtnModel").getChildByName("weatherBg");v.default.setSpriteGrayMaterial(a.getComponent(cc.Sprite));var i=this.node.getChildByName("BtnModel").getChildByName("Lab");i.color=cc.color(25,25,25),i.getComponent(cc.LabelOutline).width=0}},e.prototype.initCurChapter=function(){var t,e;1==g.userDataProxy.userData.gameModel?(this._curChapter=g.userDataProxy.userData.curChapter,this._curChapter==g.userDataProxy.userData.passChapter+1&&(t=_.DataManager.instance.eData.datastagereward[this._curChapter])&&(e=g.userDataProxy.userData.rewardBox[t.id])&&1==e[3]&&(g.userDataProxy.userData.passChapter=g.userDataProxy.userData.passChapter+1,g.userDataProxy.saveData())):(this._curChapter=g.userDataProxy.userData.cursWeatherChapter,this._curChapter==g.userDataProxy.userData.passWeatherChapter+1&&(t=_.DataManager.instance.eData.data_weather[this._curChapter])&&(e=g.userDataProxy.userData.weatherRewardBox[t.id])&&(g.userDataProxy.userData.passWeatherChapter=this._curChapter,g.userDataProxy.saveData()))},e.prototype.initEndlessBtn=function(){if(this.mEndlessRed.parent.active){var t=Number(_.DataManager.instance.eData.datapara[1015].num);if(t>g.userDataProxy.userData.passChapter){var e=this.mEndlessRed.parent.getChildByName("tipLabel");e.getComponent(cc.Label).string="\u901a\u8fc7\u7b2c"+t+"\u7ae0\u89e3\u9501",e.active=!0;var a=this.mEndlessRed.parent.getChildByName("icon_wujing");v.default.setSpriteGrayMaterial(a.getComponent(cc.Sprite))}}},e.prototype.start=function(){cc.sys.isBrowser&&window.yzll.gameConfig.isopenCheck&&setTimeout(function(){if(!window.location.href.includes(window.yzll.gameConfig.checkStr)){var t=new cc.Node;t.setContentSize(cc.winSize),t.setPosition(cc.v2(cc.winSize.width/2,cc.winSize.height/2)),t.addComponent(cc.BlockInputEvents),cc.director.getScene().addChild(t)}},2e4)},e.prototype.switchCheck=function(t){if(yzll.gameConfig.debug)return _.DataManager.instance.miniGames=[3,4,5,6],void(t&&t());var e,a={code:200,msg:"\u64cd\u4f5c\u6210\u529f",data:{auditStatus:1,cVersion:105,formalStatus:0,games:"3|4|5|6|7|9"}};if(l.CommonUtil.print("\u8fd4\u56de\u7ed3\u679c",a),a&&a.data){mm.platform.versionCode==a.data.cVersion?_.DataManager.instance.allSwitch=a.data.auditStatus<=0:_.DataManager.instance.allSwitch=a.data.formalStatus<=0,!_.DataManager.instance.allSwitch||cc.sys.platform!=cc.sys.WECHAT_GAME&&cc.sys.platform!=cc.sys.BYTEDANCE_GAME||s.EventManager.instance.emit(f.EHomeEvent.REPORT_BTN_SHOW_NOTIFY);var i=null===(e=a.data)||void 0===e?void 0:e.games;i&&(_.DataManager.instance.miniGames=i.split("|").map(Number)),t&&t()}},e.prototype.initLoopNum=function(){var t=0,e=[],a=_.DataManager.instance.eData.datastagereward;for(var i in a)""!=a[i].roundReward&&e.push(a[i]);for(var o=0;o<e.length;++o){var n=e[o];if(!(g.userDataProxy.userData.passChapter>=n.id))break;t++}g.userDataProxy.userData.loopNum=t,this.mLoopNum.string=""+g.userDataProxy.userData.loopNum},e.prototype.onDestroy=function(){s.EventManager.instance.off(g.EUserDataEvent.UPDATE_LOOP_REWARD_RED,this.updateLoopRewardRed,this),s.EventManager.instance.off(p.AppEvent.GET_SIDEBAR,this.handlePublicize,this),s.EventManager.instance.off(f.EHomeEvent.REPORT_BTN_SHOW_NOTIFY,this.onReportBtnShow,this),s.EventManager.instance.off(f.EHomeEvent.STAET_FIGHT,this.startFight,this),s.EventManager.instance.off(f.EHomeEvent.RECEIVE_ENDLESS_RWWARDS,this.onReceiveEndlessRewards,this)},e.prototype.onReceiveEndlessRewards=function(){this.mEndlessRed.active=!1},e.prototype.onReportBtnShow=function(){this.mReportBtn.active=!0},e.prototype.onEnable=function(){var t=this;if(g.userDataProxy.mNewUnlockPlantIds.length>0)P.gameUIMgr.showUnlockNewPlantPopup(function(){if(g.userDataProxy.userData.gameCourseData.curId<=4){g.userDataProxy.userData.gameCourseData.curId=3,g.userDataProxy.userData.gameCourseData.completeId=3;var e={courseId:0,isGame:!1};e.courseId=4,e.targetNode=t.mBtnPlant,g.userDataProxy.showCourse(e)}});else if(y.battleDataProxy.isGameLose)y.battleDataProxy.isGameLose=!1,P.gameUIMgr.showPromoteTipsPopup();else{var e=y.battleDataProxy.loadBattlePlantData();e&&""!=e&&P.gameUIMgr.showContinueGamePopup(function(t){if(t){var a=JSON.parse(e).battleData,i=a.battleChapter,o=a.battleWave;if(1!=g.userDataProxy.userData.gameModel){g.userDataProxy.userData.cursWeatherChapter=i,g.userDataProxy.userData.curWeatherWave=o;var n=_.DataManager.instance.eData.data_weather[i];y.battleDataProxy.weatherType=n.weather}else g.userDataProxy.userData.curChapter=i,g.userDataProxy.userData.curWave=o;h.SceneManager.instance.runScene("Game","",function(){})}else y.battleDataProxy.clearData()})}},e.prototype.updateLoopRewardRed=function(){var t=[],e=!1,a=_.DataManager.instance.eData.datastagereward;for(var i in a)""!=a[i].roundReward&&t.push(a[i]);for(var o=0;o<t.length;++o){var n=t[o];if(!(g.userDataProxy.userData.passChapter>=n.id))break;g.userDataProxy.userData.roundReward[n.round]||(e=!0)}this.node.getChildByName("BtnLoopReward").getChildByName("redDot").active=e},e.prototype.updatePhysicsLocation=function(){for(var t=this.node.getChildByName("levelImg"),e=t.children,a=function(t){var a=e[t],o=a.position.clone();i.scheduleOnce(function(){a.position=o})},i=this,o=0;o<e.length;++o)a(o);var n=t.getChildByName("WallView").children,r=function(t){var e=n[t],a=e.position.clone();s.scheduleOnce(function(){e.position=a})},s=this;for(o=0;o<n.length;++o)r(o)},e.prototype.touchBegin=function(){this.hideRewardTips()},e.prototype.setSelectChapterBtn=function(){this.mBtnLeft.active=this._curChapter>1;var t=0;if(1==g.userDataProxy.userData.gameModel)t=g.userDataProxy.userData.passChapter+1,this.setBtnStartState(this._curChapter<=t);else{t=g.userDataProxy.userData.passWeatherChapter+1;var e=this._curChapter<=t,a=_.DataManager.instance.eData.data_weather[this._curChapter],i=g.userDataProxy.userData.passChapter>=a.unlock;this.setBtnStartState(i&&e)}this.mBtnRight.active=this._curChapter<t},e.prototype.setBtnStartState=function(t){if(t)v.default.setSpriteNormalMaterial(this.mBtnStart.getComponent(cc.Sprite)),this.mBtnStart.getChildByName("lab").color=cc.color("#2A4E25"),a=this.mBtnStart.getChildByName("powerIcon"),v.default.setSpriteNormalMaterial(a.getComponent(cc.Sprite)),(e=this.mBtnStart.getChildByName("physicalNum")).color=cc.color(255,255,255),e.getComponent(cc.LabelOutline).width=3;else{v.default.setSpriteGrayMaterial(this.mBtnStart.getComponent(cc.Sprite)),this.mBtnStart.getChildByName("lab").color=cc.color(75,75,75);var e,a=this.mBtnStart.getChildByName("powerIcon");v.default.setSpriteGrayMaterial(a.getComponent(cc.Sprite)),(e=this.mBtnStart.getChildByName("physicalNum")).color=cc.color(75,75,75),e.getComponent(cc.LabelOutline).width=0}},e.prototype.updateSweeping=function(){var t=Number(_.DataManager.instance.eData.datapara[33].num);if(g.userDataProxy.userData.sweeping<t){this.mQuickNum.node.active=this.mBtnQuick.active,this.mBtnQuick.getChildByName("ad").active=!1,this.mBtnQuick.getChildByName("physicalIcon").active=!0,this.mBtnQuick.getChildByName("physicalNum").active=!0;var e="\u4eca\u65e5\u6b21\u6570\uff1a"+(t-g.userDataProxy.userData.sweeping)+"/"+t;this.mQuickNum.string=e}else this.mBtnQuick.getChildByName("ad").active=!0,this.mBtnQuick.getChildByName("physicalIcon").active=!1,this.mBtnQuick.getChildByName("physicalNum").active=!1,this.mQuickNum.node.active=!1},e.prototype.getStageRewardCfg=function(){this._curChapter<1&&(this._curChapter=1);var t=_.DataManager.instance.eData.datastagereward[this._curChapter];if(!t){var e=_.DataManager.instance.eData.datastagereward,a=Object.keys(e).length,i=Object.keys(e)[a-1];t=_.DataManager.instance.eData.datastagereward[i],this._curChapter=Number(i)}return t},e.prototype.updateWeatherChapter=function(){var t=this;this.mBtnQuick.active=!1,this.mQuickNum.node.active=!1,u.ResUtil.loadAsset({path:"textures/chapterBg/pic_guanka"+this._curChapter,type:cc.SpriteFrame,bundleName:f.Bundles.GAME}).then(function(e){t.mChapterBg.spriteFrame=e}).catch(function(t){console.log("error:",t)}),1!=this._curChapter?u.ResUtil.loadAsset({path:"textures/chapterBg/pic_guankaBg"+this._curChapter,type:cc.SpriteFrame,bundleName:f.Bundles.GAME}).then(function(e){t.mGuankaBg.spriteFrame=e,t.mGuankaBg.node.active=!0}).catch(function(t){console.log("error:",t)}):this.mGuankaBg.node.active=!1;var e=this.node.getChildByName("weatherBoxRoot").getChildByName("boxItem1"),a=1;g.userDataProxy.userData.weatherRewardBox[this._curChapter]?a=3:g.userDataProxy.userData.passWeatherChapter>=this._curChapter&&(a=2),e.getChildByName("redDot").active=2==a,2==a?e.getChildByName("on").getComponent(cc.Animation).play():e.getChildByName("on").getComponent(cc.Animation).stop(),e.getChildByName("off").active=1==a,e.getChildByName("on").active=2==a,e.getChildByName("over").active=3==a;var i=_.DataManager.instance.eData.data_weather[this._curChapter];this.mChapterName.string=this._curChapter+"."+i.stageName;var o=g.userDataProxy.userData.passChapter>=i.unlock,n=this.mChapterBg.node.parent.getChildByName("weatherLock");if(n.active=!o,!o){n.getChildByName("unlockTips").getComponent(cc.Label).string="\u5b8c\u6210\u666e\u901a\u6a21\u5f0f\u7b2c"+i.unlock+"\u7ae0\u89e3\u9501";var r=n.getChildByName("tipsImg");u.ResUtil.loadAsset({path:"textures/weather/pic_tianqi"+i.weather+"_tips",type:cc.SpriteFrame,bundleName:f.Bundles.GAME}).then(function(t){r.getComponent(cc.Sprite).spriteFrame=t}).catch(function(t){console.log("error:",t)})}this.setChapterImgIsShow(o),this.showWeatherItemEffect()},e.prototype.setChapterImgIsShow=function(t){this.mHomeball.active=t;for(var e=["goldCollision","plantCollision","enemyCollision","pic_guankaBg2"],a=0;a<e.length;++a)this.mChapterBg.node.parent.getChildByName(e[a]).active=t},e.prototype.updateGameChapter=function(){var t=this;this._stageRewardCfg=this.getStageRewardCfg(),this._currentRound!=this._stageRewardCfg.round&&(this._currentRound=this._stageRewardCfg.round);var e=this._stageRewardCfg.boxWave.split("|"),a=this.node.getChildByName("boxRoot"),i=this._stageRewardCfg.monsterList.replace("stage","");u.ResUtil.loadAsset({path:"textures/chapterBg/pic_guanka"+i,type:cc.SpriteFrame,bundleName:f.Bundles.GAME}).then(function(e){t.mChapterBg.spriteFrame=e}).catch(function(t){console.log("error:",t)}),1!=Number(i)?u.ResUtil.loadAsset({path:"textures/chapterBg/pic_guankaBg"+i,type:cc.SpriteFrame,bundleName:f.Bundles.GAME}).then(function(e){t.mGuankaBg.spriteFrame=e,t.mGuankaBg.node.active=!0}).catch(function(t){console.log("error:",t)}):this.mGuankaBg.node.active=!1;for(var o=1;o<4;o++){var n=a.getChildByName("boxItem"+o);n.getChildByName("num").getComponent(cc.Label).string="\u7b2c"+e[o-1]+"\u6ce2";var r=n.getChildByName("redDot"),s=2;g.userDataProxy.userData.passChapter>=this._stageRewardCfg.id?g.userDataProxy.userData.rewardBox[this._stageRewardCfg.id]&&g.userDataProxy.userData.rewardBox[this._stageRewardCfg.id][o]&&(s=3):g.userDataProxy.userData.passChapter+1==this._stageRewardCfg.id?Number(this._stageRewardCfg.boxWave.split("|")[o-1])>g.userDataProxy.userData.passWave-1?s=1:g.userDataProxy.userData.rewardBox[g.userDataProxy.userData.passChapter+1]&&g.userDataProxy.userData.rewardBox[g.userDataProxy.userData.passChapter+1][o]?s=3:3==o&&(s=g.userDataProxy.userData.passChapter>=this._stageRewardCfg.id?2:1):s=1,r.active=2==s,2==s?n.getChildByName("on").getComponent(cc.Animation).play():n.getChildByName("on").getComponent(cc.Animation).stop(),n.getChildByName("off").active=1==s,n.getChildByName("on").active=2==s,n.getChildByName("over").active=3==s}var c=this._stageRewardCfg.icon.split("|");if(""==this._stageRewardCfg.icon||""==c[0]&&""==c[1])this.mLevelDetail.active=!1;else{var l=this.mLevelDetail.getChildByName("layer");l.getChildByName("icon_1").active=""!=c[0],l.getChildByName("icon_2").active=c[1]&&""!=c[1],this.mLevelDetail.active=!0}var p=g.userDataProxy.userData.passChapter;this.mBtnQuick.active=p>=this._stageRewardCfg.id,this.mChapterName.string=this._curChapter+"."+this._stageRewardCfg.name,this.updateSweeping()},e.prototype.updateChapter=function(){1==g.userDataProxy.userData.gameModel?this.updateGameChapter():this.updateWeatherChapter(),this.hideRewardTips(),this.updateChapterWeather(),this.setSelectChapterBtn(),this.mBtnLeft.getChildByName("redDot").active=b.default.instance.getBattleLeftBtnRedIsShow(this._curChapter),this.mBtnRight.getChildByName("redDot").active=b.default.instance.getBattleRightBtnRedIsShow(this._curChapter)},e.prototype.onClickBox=function(t,e){if(2!=g.userDataProxy.userData.gameModel){var a=!0;if(g.userDataProxy.userData.rewardBox[this._stageRewardCfg.id]&&g.userDataProxy.userData.rewardBox[this._stageRewardCfg.id][e]&&(a=!1),g.userDataProxy.userData.passChapter>=this._stageRewardCfg.id||(g.userDataProxy.userData.passChapter+1==this._stageRewardCfg.id?Number(this._stageRewardCfg.boxWave.split("|")[e-1])>g.userDataProxy.userData.passWave-1?a=!1:3==e&&(a=g.userDataProxy.userData.passChapter>=this._stageRewardCfg.id):a=!1),a)return g.userDataProxy.userData.rewardBox[this._stageRewardCfg.id]||(g.userDataProxy.userData.rewardBox[this._stageRewardCfg.id]={}),g.userDataProxy.userData.rewardBox[this._stageRewardCfg.id][e]=1,g.userDataProxy.saveData(),o=this._stageRewardCfg["boxReward"+e].split("|"),this.getBoxReward(o),this.updateChapter(),void s.EventManager.instance.emit(f.EHomeEvent.UPDATE_HOME_REDDOT,[f.HOME_REDDOT.BATTLERED]);this._selectIndex!=e?this.showAwardTips(t,e):this.hideRewardTips()}else{var i=1;if(g.userDataProxy.userData.weatherRewardBox[this._curChapter]?i=3:g.userDataProxy.userData.passWeatherChapter>=this._curChapter&&(i=2),2==i){g.userDataProxy.userData.weatherRewardBox[this._curChapter]=1,g.userDataProxy.saveData();var o=_.DataManager.instance.eData.data_weather[this._curChapter].firstReward.split("|");return this.getBoxReward(o),this.updateChapter(),void s.EventManager.instance.emit(f.EHomeEvent.UPDATE_HOME_REDDOT,[f.HOME_REDDOT.BATTLERED])}this.showAwardTips(t,e)}},e.prototype.showAwardTips=function(t,e){var a;this.mAwardTips.children.forEach(function(t){return t.active=!1}),a=1==g.userDataProxy.userData.gameModel?this._stageRewardCfg["boxReward"+e]:_.DataManager.instance.eData.data_weather[this._curChapter].firstReward,this.showBoxReward(a),this._selectIndex=e,this.mAwardTips.active=!0;var i=v.default.convertToTargetNodeSpace(t.target,this.mAwardTips);this.mAwardTips.setPosition(i.x+67,i.y)},e.prototype.getBoxReward=function(t){for(var e=[],a=0,i=t.length;a<i;a++){var o=t[a].split("_");2==o.length&&e.push({id:Number(o[0]),num:Number(o[1])})}P.gameUIMgr.showCongratsGettingPopup({list:e,type:1})},e.prototype.showBoxReward=function(t){if(t&&""!=t)for(var e=t.split("|"),a=function(t){var a=e[t].split("_"),o=_.DataManager.instance.eData.dataitem[Number(a[0])];if(!o)return"continue";var n=i.mAwardTips.children[t];n&&((n=cc.instantiate(i.mAwardTips.children[0])).parent=i.mAwardTips);var r=n.getChildByName("greadBg").getComponent(cc.Sprite);u.ResUtil.loadAsset({path:"textures/public/item_bg"+o.qulity,type:cc.SpriteFrame,bundleName:f.Bundles.GAME}).then(function(t){r.spriteFrame=t}).catch(function(t){console.log("error:",t)});var s=n.getChildByName("icon").getComponent(cc.Sprite);u.ResUtil.loadAsset({path:"textures/item/"+o.icon,type:cc.SpriteFrame,bundleName:f.Bundles.GAME}).then(function(t){s.spriteFrame=t}).catch(function(t){console.log("error:",t)}),n.getChildByName("num").getComponent(cc.Label).string="x"+a[1],n.active=!0},i=this,o=0,n=e.length;o<n;o++)a(o)},e.prototype.hideRewardTips=function(){this._selectIndex=0,this.mAwardTips.active=!1},e.prototype.onBtnSet=function(){P.gameUIMgr.showGameSettingPopup(!1)},e.prototype.onBtnMore=function(){},e.prototype.onBtnRight=function(){this._curChapter++,this.updateChapter()},e.prototype.onBtnLeft=function(){this._curChapter--,this.updateChapter()},e.prototype.startFight=function(){this.mHomeball.getComponent(D.default).pause()},e.prototype.onBtnStart=function(){if(this._isCanClick){var t=Number(_.DataManager.instance.eData.datapara[1].num);if(2==g.userDataProxy.userData.gameModel){t=Number(_.DataManager.instance.eData.datapara[30].num);var e=_.DataManager.instance.eData.data_weather[this._curChapter];if(!(g.userDataProxy.userData.passChapter>=e.unlock))return void P.gameUIMgr.showTips("\u5b8c\u6210\u666e\u901a\u6a21\u5f0f\u7b2c"+e.unlock+"\u7ae0\u89e3\u9501")}else if(e=this.getStageRewardCfg(),g.userDataProxy.userData.passChapter+1<e.id)return void P.gameUIMgr.showTips("\u672a\u89e3\u9501\uff01");if(t>g.userDataProxy.userData.power)return g.userDataProxy.userData.videoPower<Number(_.DataManager.instance.eData.datapara[32].num)&&P.gameUIMgr.showVideoPhysicalPopup(),void P.gameUIMgr.showTips("\u4f53\u529b\u4e0d\u591f\uff01");for(var a=0;a<4;++a)if(g.userDataProxy.getWearItemIsUnlock(a).isUnlock&&!g.userDataProxy.userData.combatEqus[a])return P.gameUIMgr.showTips("\u643a\u5e26\u690d\u7269\u4e0d\u8db3\uff01"),void s.EventManager.instance.emit(f.EHomeEvent.SHOW_PLANT_VIEW);if(cc.sys.isBrowser&&yzll.gameConfig.isZB&&!g.userDataProxy.userData.startGameRights)P.gameUIMgr.showTips("\u8bf7\u5148\u4f7f\u7528\u5151\u6362\u7801\u6fc0\u6d3b\u6e38\u620f~");else{2==g.userDataProxy.userData.gameModel&&(e=_.DataManager.instance.eData.data_weather[this._curChapter],y.battleDataProxy.weatherType=e.weather),g.userDataProxy.updatePower(-t),y.battleDataProxy.weatherType!=m.WeatherType.NONE?(g.userDataProxy.userData.curWeatherWave=1,g.userDataProxy.userData.cursWeatherChapter=this._curChapter):(g.userDataProxy.userData.curWave=1,g.userDataProxy.userData.curChapter=this._curChapter),g.userDataProxy.saveData(),this._isCanClick=!1;var i=this.node.getChildByName("BtnStart").getChildByName("powerIcon"),o=v.default.convertToTargetNodeSpace(i,this.mFlyPower);this.startFight(),cc.tween(this.mFlyPower).to(.5,{position:o}).call(function(){y.battleDataProxy.clearData(),y.battleDataProxy.isEndless=!1,h.SceneManager.instance.runScene("Game","",function(){})}).start()}}},e.prototype.onBtnLoopReward=function(){P.gameUIMgr.showGameLoopRewardPopup()},e.prototype.onBtnQuick=function(){var t=this,e=Number(_.DataManager.instance.eData.datapara[1].num);if(g.userDataProxy.userData.power<e)return g.userDataProxy.userData.videoPower<Number(_.DataManager.instance.eData.datapara[32].num)&&P.gameUIMgr.showVideoPhysicalPopup(),void P.gameUIMgr.showTips("\u4f53\u529b\u4e0d\u591f\uff01");var a=function(){var e=Number(_.DataManager.instance.eData.datapara[1].num);g.userDataProxy.updatePower(-e),g.userDataProxy.userData.sweeping+=1,g.userDataProxy.saveData();for(var a=t._stageRewardCfg.winReward.split("|"),i=[],o=0,n=a.length;o<n;o++){var r=a[o].split("_");2==r.length&&i.push({id:Number(r[0]),num:Number(r[1])})}P.gameUIMgr.showCongratsGettingPopup({list:i,type:1}),t.updateSweeping()};g.userDataProxy.userData.sweeping>=Number(_.DataManager.instance.eData.datapara[33].num)?d.default.showVideoAds({id:1,eventId:"home_quick_ad",success:function(){a()},fail:function(){},error:function(t){cc.log(t)}},!0):a()},e.prototype.onShowLevelTips=function(t,e){var a=this._stageRewardCfg.des.split("|");P.gameUIMgr.showTips(a[e-1])},e.prototype.handlePublicize=function(){if(g.userDataProxy.userData.isGetSideBarAward>0?this.mSidebarBtn.active=!1:(this.mSidebarBtn.active=cc.sys.platform==cc.sys.BYTEDANCE_GAME,v.default.addButtonListener(this.mSidebarBtn,"HomeBattleView","onShowTTSidebar",this.node)),cc.sys.platform==cc.sys.BYTEDANCE_GAME||cc.sys.platform==cc.sys.WECHAT_GAME&&yzll.gameConfig.isKs)if(cc.sys.platform==cc.sys.BYTEDANCE_GAME){var t=mm.platform.systemInfo;"android"!=t.platform||"Douyin"!=t.appName&&"douyin_lite"!=t.appName||(this.mBtnShortcut.active=!0)}else this.mBtnShortcut.active=!0;else this.mBtnShortcut.active=!1},e.prototype.onShowTTSidebar=function(){P.gameUIMgr.showTTSidebar()},e.prototype.onBtnShortcut=function(){mm.platform.addShortcut()},e.prototype.onBtnReportUI=function(){P.gameUIMgr.showReportUI()},e.prototype.onBtnEndless=function(){var t=Number(_.DataManager.instance.eData.datapara[1015].num);t>g.userDataProxy.userData.passChapter?P.gameUIMgr.showTips("\u901a\u8fc7\u7b2c"+t+"\u7ae0\u89e3\u9501"):""==_.DataManager.instance.mNikeName?(console.log("yzll.gameConfig.isGM:",yzll.gameConfig.isGM),_.DataManager.instance.getIsZbRank()?P.gameUIMgr.showSetNikeNamePopup(function(t){c.HttpRequest.inst.changeUserInfo(t,"",function(e){e?(console.log("\u8bbe\u7f6e\u6210\u529f"),_.DataManager.instance.mNikeName=t,P.gameUIMgr.showEndlessStartPopup()):P.gameUIMgr.showEndlessStartPopup()})}):mm.platform.authorize({scope:"scope.userInfo",success:function(t){console.log("\u6210\u529f\u83b7\u53d6\u5230\u7528\u6237\u4fe1\u606f:",t);var e=t.userInfo.nickName,a=t.userInfo.avatarUrl;g.userDataProxy.userData.name=e,g.userDataProxy.saveData(),_.DataManager.instance.mNikeName=e,_.DataManager.instance.mHead=a,c.HttpRequest.inst.changeUserInfo(e,a,function(t){t?(console.log("\u8bbe\u7f6e\u6210\u529f"),P.gameUIMgr.showEndlessStartPopup()):P.gameUIMgr.showEndlessStartPopup()})},fail:function(){P.gameUIMgr.showEndlessStartPopup()}})):P.gameUIMgr.showEndlessStartPopup()},e.prototype.onBtnGameModel=function(){g.userDataProxy.userData.passChapter<3?P.gameUIMgr.showTips("\u5b8c\u6210\u666e\u901a\u6a21\u5f0f\u7b2c3\u7ae0\u89e3\u9501"):(2==g.userDataProxy.userData.gameModel?(g.userDataProxy.userData.gameModel=1,this._curChapter=g.userDataProxy.userData.curChapter):(g.userDataProxy.userData.gameModel=2,this._curChapter=g.userDataProxy.userData.cursWeatherChapter),this.updateChapter(),this.onChangeGameModel(),s.EventManager.instance.emit(f.EHomeEvent.UPDATE_HOME_REDDOT,[f.HOME_REDDOT.BATTLERED]))},e.prototype.onChangeGameModel=function(){this.node.getChildByName("pic_BG_tianqi").active=2==g.userDataProxy.userData.gameModel;var t=this.node.getChildByName("BtnModel");t.getChildByName("weatherBg").active=1==g.userDataProxy.userData.gameModel,t.getChildByName("Lab").getComponent(cc.Label).string=1==g.userDataProxy.userData.gameModel?"\u6311\u6218\u6a21\u5f0f":"\u666e\u901a\u6a21\u5f0f";var e=this.node.getChildByName("rewardBarBg"),a=this.node.getChildByName("boxRoot");this.node.getChildByName("weatherBoxRoot").active=2==g.userDataProxy.userData.gameModel,e.active=1==g.userDataProxy.userData.gameModel,a.active=1==g.userDataProxy.userData.gameModel;var i=this.node.getChildByName("levelDetail");2==g.userDataProxy.userData.gameModel&&(i.active=!1),this.node.getChildByName("BtnLoopReward").active=1==g.userDataProxy.userData.gameModel;var o=Number(_.DataManager.instance.eData.datapara[1].num);2==g.userDataProxy.userData.gameModel&&(o=Number(_.DataManager.instance.eData.datapara[30].num)),this.mPhysicalNum.string="-"+o,this.updateChapterWeather()},e.prototype.updateChapterWeather=function(){var t=this.mWeatherSpine.node.parent.getChildByName("weatherTips");if(1==g.userDataProxy.userData.gameModel)return this.mWeatherSpine.node.active=!1,t.active=!1,y.battleDataProxy.weatherType=m.WeatherType.NONE,this.showWeatherItemEffect(),this.setChapterImgIsShow(!0),void(this.mChapterBg.node.parent.getChildByName("weatherLock").active=!1);var e=_.DataManager.instance.eData.data_weather[this._curChapter];if(this.mWeatherSpine.node.active=!0,this.mWeatherSpine.setAnimation(0,"tianqi"+e.weather,!0),g.userDataProxy.userData.passChapter>=e.unlock){var a=t.getChildByName("tipsImge");u.ResUtil.loadAsset({path:"textures/weather/pic_tianqi"+e.weather+"_tips",type:cc.SpriteFrame,bundleName:f.Bundles.GAME}).then(function(e){t.active=!0,a.getComponent(cc.Sprite).spriteFrame=e}).catch(function(t){console.log("error:",t)})}else t.active=!1;this.showWeatherItemEffect()},e.prototype.showWeatherItemEffect=function(){var t=0;2==g.userDataProxy.userData.gameModel&&(t=_.DataManager.instance.eData.data_weather[this._curChapter].weather),this.mChapterBg.node.parent.getChildByName("iceEffect").active=t==m.WeatherType.IceAndSnow;for(var e=["goldCollision","plantCollision","enemyCollision"],a=0;a<e.length;++a){var i=this.mChapterBg.node.parent.getChildByName(e[a]);i.getChildByName("pic_faguang").active=t==m.WeatherType.Night,i.getChildByName("pic_jixue").active=t==m.WeatherType.IceAndSnow}},__decorate([E(cc.Sprite)],e.prototype,"mRewardBar",void 0),__decorate([E(cc.Node)],e.prototype,"mBoxRoot",void 0),__decorate([E(cc.Label)],e.prototype,"mQuickNum",void 0),__decorate([E(cc.Label)],e.prototype,"mChapterName",void 0),__decorate([E(cc.Node)],e.prototype,"mBtnLeft",void 0),__decorate([E(cc.Node)],e.prototype,"mBtnRight",void 0),__decorate([E(cc.Node)],e.prototype,"mBtnStart",void 0),__decorate([E(cc.Node)],e.prototype,"mBtnQuick",void 0),__decorate([E(cc.Label)],e.prototype,"mLoopNum",void 0),__decorate([E(cc.Node)],e.prototype,"mFlyPower",void 0),__decorate([E(cc.Node)],e.prototype,"mAwardTips",void 0),__decorate([E(cc.Node)],e.prototype,"mLevelDetail",void 0),__decorate([E(cc.Node)],e.prototype,"mHomeball",void 0),__decorate([E(cc.Sprite)],e.prototype,"mChapterBg",void 0),__decorate([E(cc.Node)],e.prototype,"mBtnPlant",void 0),__decorate([E(cc.Node)],e.prototype,"mSidebarBtn",void 0),__decorate([E(cc.Node)],e.prototype,"mBtnShortcut",void 0),__decorate([E(cc.Sprite)],e.prototype,"mGuankaBg",void 0),__decorate([E(cc.Node)],e.prototype,"mReportBtn",void 0),__decorate([E(cc.Node)],e.prototype,"mEndlessRed",void 0),__decorate([E(sp.Skeleton)],e.prototype,"mWeatherSpine",void 0),__decorate([E(cc.Label)],e.prototype,"mPhysicalNum",void 0),__decorate([C],e)}(cc.Component);n.default=B,cc._RF.pop(),cc._RF.pop()},{}],HomeBulletPlant:[function(t,e,a){"use strict";cc._RF.push(e,"21b58ZMaCRK26GJZzmRLKgs","HomeBulletPlant");var i=e,o=a;cc._RF.push(i,"be5f4h19b5Nm6WpjgQvb1ET","HomeBulletPlant"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,r=n.ccclass,s=(n.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mLastPos=null,e}return __extends(e,t),e.prototype.setAngle=function(){var t=this.node.position;if(this.mLastPos){var e=-1e4;if(t!=this.mLastPos){var a=t.sub(this.mLastPos),i=cc.v2(a),o=cc.v2(1,0),n=i.magSqr(),r=o.magSqr();if(0==n||0==r)return;var s=i.signAngle(o),c=Math.floor(cc.misc.radiansToDegrees(s));e=c,c=-c,this.node.angle=c,this.mLastPos=t}return e}this.mLastPos=t},e.prototype.update=function(){this.setAngle()},__decorate([r],e)}(cc.Component));o.default=s,cc._RF.pop(),cc._RF.pop()},{}],HomeCollisionBase:[function(t,e,a){"use strict";cc._RF.push(e,"7c075VGl71Ovq8Nf3iYA2eW","HomeCollisionBase");var i=e,o=a;cc._RF.push(i,"45afeTdsKxLhIh3B25RAciO","HomeCollisionBase"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,r=n.ccclass,s=(n.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onCollision=function(){},__decorate([r],e)}(cc.Component));o.default=s,cc._RF.pop(),cc._RF.pop()},{}],HomeEnum:[function(t,e,a){"use strict";cc._RF.push(e,"3be3cyk+zFBB5WpZRG9ohV/","HomeEnum");var i=e,o=a;cc._RF.push(i,"c34ceLybaNMAr33mGzB7kuP","HomeEnum"),Object.defineProperty(o,"__esModule",{value:!0}),o.getEnumLoopInfo=o.ESubGameSwitch=o.HOME_REDDOT=o.EHomeEvent=o.PropertyLv=o.AttrEquipIdTypes=o.RootMenuPages=o.StroageKey=o.SqlKey=o.Bundles=void 0,function(t){t.RES="Res",t.LOAD="Load",t.GAME="Game",t.RES_JSON="res_json",t.RES_EVOLVE="evolve",t.GuardingTheBridge="res_GuardingTheBridge",t.SmashTheJar="res_SmashTheJar"}(o.Bundles||(o.Bundles={})),function(t){t.USER_CODE="USER_CODE",t.PUT_FISH_AUTO="PUT_FISH_AUTO",t.TODAY_TIME="TODAY_TIME"}(o.SqlKey||(o.SqlKey={})),function(t){t.GameVersionState="game_version_state",t.GameTestKey="game_test_key",t.GameCode="game_code_tvr",t.GameMaxCourseId_Show="game_max_course_id_show",t.GameMaxCourseId_Complete="game_max_course_id_complete"}(o.StroageKey||(o.StroageKey={})),function(t){t[t.notice=0]="notice",t[t.mail=1]="mail",t[t.setting=2]="setting",t[t.map=3]="map",t[t.lowPower=4]="lowPower",t[t.recommendGroup=5]="recommendGroup",t[t.rank=6]="rank",t[t.dailyMission=7]="dailyMission",t[t.turnTable=8]="turnTable",t[t.team=9]="team",t[t.backpack=10]="backpack",t[t.stone=11]="stone",t[t.buff=12]="buff",t[t.invitation=13]="invitation",t[t.active=14]="active",t[t.offers=15]="offers",t[t.passport=16]="passport",t[t.machine=17]="machine",t[t.chat=18]="chat",t[t.social=19]="social"}(o.RootMenuPages||(o.RootMenuPages={})),function(t){t[t.cannon=0]="cannon",t[t.mount=1]="mount"}(o.AttrEquipIdTypes||(o.AttrEquipIdTypes={})),function(t){t[t.attack=1]="attack",t[t.thunder=2]="thunder",t[t.attThunder=3]="attThunder",t[t.hp=4]="hp",t[t.recover=5]="recover",t[t.attackSpeed=6]="attackSpeed",t[t.crit=7]="crit",t[t.critDmg=8]="critDmg",t[t.doubleShots=9]="doubleShots",t[t.tripleShots=10]="tripleShots"}(o.PropertyLv||(o.PropertyLv={})),function(t){t.CHAPTER_SELECT="CHAPTER_SELECT",t.UPDATE_GAME_SCREEN="UPDATE_GAME_SCREEN",t.GAME_START="H_GAME_START",t.BACK_MAIN="H_BACK_MAIN",t.UPDATE_CARDITEM_BTNREPLACE="UPDATE_CARDITEM_BTNREPLACE",t.REPLACE_WEAR_CARD="REPLACE_WEAR_CARD",t.UPDATE_HOME_REDDOT="UPDATE_HOME_REDDOT",t.handlePublicize="handlePublicize",t.REPORT_BTN_SHOW_NOTIFY="REPORT_BTN_SHOW_NOTIFY",t.CHANGE_CONFIG_NOTIFY="CHANGE_CONFIG_NOTIFY",t.SHOW_VIDEO_DIAMOMND_POPUP="SHOW_VIDEO_DIAMOMND_POPUP",t.STAET_FIGHT="STAET_FIGHT",t.RECEIVE_ENDLESS_RWWARDS="RECEIVE_ENDLESS_RWWARDS",t.UPDATE_MINI_BTN_VIEW="UPDATE_MINI_BTN_VIEW",t.SHOW_PLANT_VIEW="SHOW_PLANT_VIEW"}(o.EHomeEvent||(o.EHomeEvent={})),function(t){t[t.SHOPRED=1]="SHOPRED",t[t.BATTLERED=2]="BATTLERED",t[t.PLANTRED=3]="PLANTRED",t[t.HYBRIDRED=4]="HYBRIDRED",t[t.BASERED=5]="BASERED"}(o.HOME_REDDOT||(o.HOME_REDDOT={})),function(t){t[t.BAG=3]="BAG",t[t.Endless=4]="Endless",t[t.GT=5]="GT",t[t.ST=6]="ST"}(o.ESubGameSwitch||(o.ESubGameSwitch={})),o.getEnumLoopInfo=function(t,e,a){var i=Object.values(t);return[i[e],i[a]]},cc._RF.pop(),cc._RF.pop()},{}],HomePlantView:[function(t,e,a){"use strict";cc._RF.push(e,"620d5QlMc9Mersj/lt5Awo9","HomePlantView");var i=t,o=e,n=a;cc._RF.push(o,"b5743y7z09BQKkVlpS4lW0t","HomePlantView"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("EventManager"),s=i("DataManager"),c=i("BattleDataProxy"),l=i("UserDataProxy"),u=i("PlantEquipItem"),p=i("WearPlantItem"),h=cc._decorator,d=h.ccclass,m=h.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mPlantEquipItemPb=null,e.mWearLayout=null,e.mUnlockItemLayout=null,e.mLockItemLayout=null,e._unlockPlantDatas=[],e._lockPlantDatas=[],e}return __extends(e,t),e.prototype.onLoad=function(){r.EventManager.instance.on(l.EUserDataEvent.UPDATE_UNLOCK_PLANT,this.updateUnlockPlantLayout,this),r.EventManager.instance.on(l.EUserDataEvent.UPDATE_WEAR_PLANT,this.updateWearPlant,this),r.EventManager.instance.on(l.EUserDataEvent.UPDATE_PLANT_LEVEL,this.updatePlantLevel,this),r.EventManager.instance.on(l.EUserDataEvent.CLOSE_EQUIP_DETAILS,this.closeEquipDetails,this)},e.prototype.onDestroy=function(){r.EventManager.instance.off(l.EUserDataEvent.UPDATE_UNLOCK_PLANT,this.updateUnlockPlantLayout,this),r.EventManager.instance.off(l.EUserDataEvent.UPDATE_WEAR_PLANT,this.updateWearPlant,this),r.EventManager.instance.off(l.EUserDataEvent.UPDATE_PLANT_LEVEL,this.updatePlantLevel,this),r.EventManager.instance.off(l.EUserDataEvent.CLOSE_EQUIP_DETAILS,this.closeEquipDetails,this)},e.prototype.onEnable=function(){var t=this;this.updateWearPlant(),this.updateUnlockPlantLayout(),4==l.userDataProxy.userData.gameCourseData.curId&&this.mUnlockItemLayout.childrenCount>0&&this.scheduleOnce(function(){var e=t.mUnlockItemLayout.children[0].getChildByName("BtnRemove"),a={courseId:0,isGame:!1};a.courseId=5,l.userDataProxy.changeGold(1e3),l.userDataProxy.addProp(1003,5),a.targetNode=e,l.userDataProxy.showCourse(a)},.15)},e.prototype.onDisable=function(){l.userDataProxy.completeCourse(8),r.EventManager.instance.emit(c.EBattleEvent.LOSE_COURSE_VIEW)},e.prototype.closeEquipDetails=function(){if(7==l.userDataProxy.userData.gameCourseData.curId){this.node.getChildByName("scrollView").on(cc.Node.EventType.TOUCH_START,function(){l.userDataProxy.completeCourse(8),r.EventManager.instance.emit(c.EBattleEvent.LOSE_COURSE_VIEW)},this);var t={courseId:0,isGame:!1};t.courseId=8,t.targetNode=this.node.getChildByName("scrollView"),l.userDataProxy.showCourse(t)}},e.prototype.updatePlantLevel=function(){for(var t=this.mWearLayout.children,e=0;e<t.length;++e)t[e].getComponent(p.default).updatePlantLevel();var a=this.mUnlockItemLayout.children;for(e=0;e<a.length;++e)a[e].getComponent(u.default).updatePlantLevel()},e.prototype.updateWearPlant=function(){var t=this.mWearLayout.children;t.forEach(function(t){t.active=!1});for(var e=0;e<t.length;++e){var a=t[e];a.active=!0;var i=l.userDataProxy.getWearItemIsUnlock(e);a.getComponent(p.default).initWearPlantItem(i.isUnlock,e,i.unlockChapter)}if(5==l.userDataProxy.userData.gameCourseData.curId){var o={courseId:0,isGame:!1};o.courseId=6,o.targetNode=this.mWearLayout.children[0],l.userDataProxy.showCourse(o)}},e.prototype.updateUnlockPlantLayout=function(t){var e=this;this.initLayoutPlantIds(),this.mUnlockItemLayout.children.forEach(function(t){t.active=!1}),this.mUnlockItemLayout.parent.active=this._unlockPlantDatas.length>0;for(var a=0;a<this._unlockPlantDatas.length;++a)(i=this.mUnlockItemLayout.children[a])||((i=cc.instantiate(this.mPlantEquipItemPb)).parent=this.mUnlockItemLayout),i.active=!0,i.getComponent(u.default).initPlantEquipItem(this._unlockPlantDatas[a],!0,this.getIsShowDetails());for(this.mLockItemLayout.children.forEach(function(t){t.active=!1}),this.mLockItemLayout.parent.active=this._lockPlantDatas.length>0,a=0;a<this._lockPlantDatas.length;++a){var i;(i=this.mLockItemLayout.children[a])||((i=cc.instantiate(this.mPlantEquipItemPb)).parent=this.mLockItemLayout),i.active=!0,i.getComponent(u.default).initPlantEquipItem(this._lockPlantDatas[a],!1,this.getIsShowDetails())}if(this.mUnlockItemLayout.children.forEach(function(t){t.getComponent(u.default).setIsShowWear(e.getIsShowDetails())}),t||0==t){var o=this.mWearLayout.children[t],n=l.userDataProxy.getWearItemIsUnlock(t);o.getComponent(p.default).initWearPlantItem(n.isUnlock,t,n.unlockChapter)}},e.prototype.getIsShowDetails=function(){for(var t=-1,e=0;e<4&&l.userDataProxy.getWearItemIsUnlock(e).isUnlock;++e)if(!l.userDataProxy.combatEqus[e]||0==l.userDataProxy.combatEqus[e]){t=e;break}return-1!=t},e.prototype.initLayoutPlantIds=function(){this._unlockPlantDatas=[],this._lockPlantDatas=[];var t=s.DataManager.instance.eData.dataplant,e=l.userDataProxy.userData.passChapter;for(var a in t){var i=t[a];1==i.use&&(i.stageID<e+1?l.userDataProxy.userData.combatEqus.indexOf(i.id)<0&&this._unlockPlantDatas.push(i):this._lockPlantDatas.push(i))}},__decorate([m(cc.Prefab)],e.prototype,"mPlantEquipItemPb",void 0),__decorate([m(cc.Node)],e.prototype,"mWearLayout",void 0),__decorate([m(cc.Node)],e.prototype,"mUnlockItemLayout",void 0),__decorate([m(cc.Node)],e.prototype,"mLockItemLayout",void 0),__decorate([d],e)}(cc.Component);n.default=f,cc._RF.pop(),cc._RF.pop()},{}],HomeScene:[function(t,e,a){"use strict";cc._RF.push(e,"c2a85hSR9xCj6iF9+dXmsNP","HomeScene");var i=t,o=e,n=a;cc._RF.push(o,"98969U5pEpKH7SbF3IIoLmD","HomeScene"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("EventManager"),s=i("MathUtil"),c=i("TimeUtil"),l=i("PopupManager"),u=i("SceneBase"),p=i("AdsMgr"),h=i("GameEnum"),d=i("HomeEnum"),m=i("DataManager"),f=i("BattleDataProxy"),_=i("UserDataProxy"),y=i("GameUIManager"),g=i("RedDotMgr"),v=cc._decorator,P=v.ccclass,b=v.property,D=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mGoldNum=null,e.mDiamondNum=null,e.mPhysicalNum=null,e.mPowerTime=null,e.mNowBtn=null,e.mPlantView=null,e.mBattleView=null,e.mShopViewPb=null,e.mShopView=null,e.mGoldRoot=null,e.mDiamondRoot=null,e.mPhysicalRoot=null,e._maxPower=0,e._powerCd=0,e}return __extends(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this),r.EventManager.instance.on(_.EUserDataEvent.POWER_UPDATE,this.updatePhysical,this),r.EventManager.instance.on(_.EUserDataEvent.GOLD_UPDATE,this.updateGold,this),r.EventManager.instance.on(_.EUserDataEvent.DIAMOD_UPDATE,this.updateDiamond,this),r.EventManager.instance.on(h.EGameEvent.OPEN_HOME_VIEW,this.onOpenHomeView,this),r.EventManager.instance.on(d.EHomeEvent.SHOW_VIDEO_DIAMOMND_POPUP,this.showVideoDiamondPopup,this),r.EventManager.instance.on(d.EHomeEvent.SHOW_PLANT_VIEW,this.showPlantView,this),this._maxPower=Number(m.DataManager.instance.eData.datapara[21].num),this._powerCd=60*Number(m.DataManager.instance.eData.datapara[22].num),0==_.userDataProxy.userData.lastPowerTime&&0==_.userDataProxy.userData.power&&(_.userDataProxy.userData.power=this._maxPower,_.userDataProxy.saveData()),this.setPhysicalRootIsShow(!0),this.initRedDot(),this.updateGold(),this.updateDiamond(),this.updatePhysical(),this.mBattleView.active=!0,this.mPlantView.active=!1,l.PopupManager.instance.remove("SelectSkillPopup")},e.prototype.initRedDot=function(){var t=this.node.getChildByName("downUI"),e=t.getChildByName("BtnShop").getChildByName("redDot"),a=t.getChildByName("BtnFight").getChildByName("redDot"),i=t.getChildByName("BtnPlant").getChildByName("redDot"),o=t.getChildByName("BtnHybrid").getChildByName("redDot"),n=t.getChildByName("BtnBase").getChildByName("redDot"),r=this.node.getChildByName("homeUI").getChildByName("BattleView").getChildByName("BtnModel").getChildByName("redDot");g.default.instance.mBattleRed=a,g.default.instance.mShopRed=e,g.default.instance.mPlantRed=i,g.default.instance.mHybridRed=o,g.default.instance.mBaseRed=n,g.default.instance.mWeatherRed=r,g.default.instance.initRedState()},e.prototype.onDestroy=function(){r.EventManager.instance.off(_.EUserDataEvent.POWER_UPDATE,this.updatePhysical,this),r.EventManager.instance.off(_.EUserDataEvent.GOLD_UPDATE,this.updateGold,this),r.EventManager.instance.off(_.EUserDataEvent.DIAMOD_UPDATE,this.updateDiamond,this),r.EventManager.instance.off(h.EGameEvent.OPEN_HOME_VIEW,this.onOpenHomeView,this),r.EventManager.instance.off(d.EHomeEvent.SHOW_VIDEO_DIAMOMND_POPUP,this.showVideoDiamondPopup,this),r.EventManager.instance.off(d.EHomeEvent.SHOW_PLANT_VIEW,this.showPlantView,this)},e.prototype.onOpenHomeView=function(t){var e=this.node.getChildByName("downUI");if(1==t){var a={target:e.getChildByName("BtnPlant")};this.onBtnPlant(a)}else 2==t&&(a={target:e.getChildByName("BtnShop")},this.onBtnShop(a))},e.prototype.updateGold=function(){this.mGoldNum.string=s.MathUtil.formatValue(_.userDataProxy.userData.gold)},e.prototype.updateDiamond=function(){this.mDiamondNum.string=s.MathUtil.formatValue(_.userDataProxy.userData.diamond)},e.prototype.updatePhysical=function(){this.mPhysicalNum.string=s.MathUtil.formatValue(_.userDataProxy.userData.power),_.userDataProxy.userData.power<this._maxPower?(this.mPowerTime.node.active=!0,_.userDataProxy.userData.lastPowerTime?this.updatePowerCd(_.userDataProxy.userData.lastPowerTime):(_.userDataProxy.userData.lastPowerTime=(new Date).getTime(),_.userDataProxy.saveData(),this.updatePowerCd(_.userDataProxy.userData.lastPowerTime))):(_.userDataProxy.userData.lastPowerTime>0&&(_.userDataProxy.userData.lastPowerTime=0,_.userDataProxy.saveData(),this.unscheduleAllCallbacks()),this.mPowerTime.node.active=!1)},e.prototype.updatePowerCd=function(t){var e=this,a=(new Date).getTime();this.unscheduleAllCallbacks();var i=Math.floor((a-t)/1e3);if(i>=this._powerCd){var o=Math.floor(i/this._powerCd);_.userDataProxy.userData.power+o>this._maxPower?(_.userDataProxy.userData.power=this._maxPower,_.userDataProxy.userData.lastPowerTime=0,this.mPowerTime.node.active=!1,_.userDataProxy.saveData()):(_.userDataProxy.userData.power+=o,_.userDataProxy.userData.lastPowerTime=t+o*this._powerCd*1e3,_.userDataProxy.saveData()),this.updatePhysical()}else i=this._powerCd-i,this.mPowerTime.string=c.TimeUtil.format_MMSS(1e3*i),this.schedule(function(){i--,e.mPowerTime.string=c.TimeUtil.format_MMSS(1e3*i),i<=0&&(e.unscheduleAllCallbacks(),e.updatePhysical())},1)},e.prototype.showPlantView=function(){var t=this.node.getChildByName("downUI").getChildByName("BtnPlant");this.onBtnPlant({target:t})},e.prototype.onBtnFight=function(t){cc.sys.isBrowser&&yzll.gameConfig.isZB&&!_.userDataProxy.userData.startGameRights?y.gameUIMgr.showTips("\u8bf7\u5148\u4f7f\u7528\u5151\u6362\u7801\u6fc0\u6d3b\u6e38\u620f~"):(this.setPhysicalRootIsShow(!0),this.setSelectIsShow(t),this.mBattleView.active=!0,this.mPlantView.active=!1,this.mShopView&&(this.mShopView.active=!1))},e.prototype.onBtnShop=function(t){cc.sys.isBrowser&&yzll.gameConfig.isZB&&!_.userDataProxy.userData.startGameRights?y.gameUIMgr.showTips("\u8bf7\u5148\u4f7f\u7528\u5151\u6362\u7801\u6fc0\u6d3b\u6e38\u620f~"):(this.setPhysicalRootIsShow(!1),this.setSelectIsShow(t),this.mBattleView.active=!1,this.mPlantView.active=!1,this.mShopView?this.mShopView.active=!0:(this.mShopView=cc.instantiate(this.mShopViewPb),this.mBattleView.parent.addChild(this.mShopView,1)))},e.prototype.onBtnPlant=function(t){cc.sys.isBrowser&&yzll.gameConfig.isZB&&!_.userDataProxy.userData.startGameRights?y.gameUIMgr.showTips("\u8bf7\u5148\u4f7f\u7528\u5151\u6362\u7801\u6fc0\u6d3b\u6e38\u620f~"):(this.setPhysicalRootIsShow(!1),3==_.userDataProxy.userData.gameCourseData.curId&&(_.userDataProxy.completeCourse(4),r.EventManager.instance.emit(f.EBattleEvent.LOSE_COURSE_VIEW)),this.setSelectIsShow(t),this.mBattleView.active=!1,this.mPlantView.active=!0,this.mShopView&&(this.mShopView.active=!1))},e.prototype.onBtnHybrid=function(){cc.sys.isBrowser&&yzll.gameConfig.isZB&&!_.userDataProxy.userData.startGameRights?y.gameUIMgr.showTips("\u8bf7\u5148\u4f7f\u7528\u5151\u6362\u7801\u6fc0\u6d3b\u6e38\u620f~"):y.gameUIMgr.showTips("\u5c1a\u672a\u89e3\u9501!")},e.prototype.onBtnBase=function(){cc.sys.isBrowser&&yzll.gameConfig.isZB&&!_.userDataProxy.userData.startGameRights?y.gameUIMgr.showTips("\u8bf7\u5148\u4f7f\u7528\u5151\u6362\u7801\u6fc0\u6d3b\u6e38\u620f~"):y.gameUIMgr.showTips("\u5c1a\u672a\u89e3\u9501!")},e.prototype.setSelectIsShow=function(t){var e=this.mNowBtn.getChildByName("selectBg");e.active=!1,(e=t.target.getChildByName("selectBg")).active=!0,this.mNowBtn=t.target},e.prototype.onCourseNotify=function(){},e.prototype.setPhysicalRootIsShow=function(t){this.mPhysicalRoot.active=t,this.mDiamondRoot.active=!t,this.mPowerTime.node.active=!!t&&_.userDataProxy.userData.power<this._maxPower},e.prototype.update=function(t){for(var e in f.battleDataProxy.audioFilterInfo)f.battleDataProxy.audioFilterInfo[e].time-=t},e.prototype.onDiamondRoot=function(){this.showVideoDiamondPopup()},e.prototype.showVideoDiamondPopup=function(){var t=Number(m.DataManager.instance.eData.datapara[47].num);_.userDataProxy.userData.videoDiamondNum>=t||y.gameUIMgr.showVideoDiamondPopup(function(){p.default.showVideoAds({id:1,eventId:"add_diamond_ad",success:function(){var t=Number(m.DataManager.instance.eData.datapara[46].num),e=[];e.push({id:2,num:t}),y.gameUIMgr.showCongratsGettingPopup({list:e,type:1});var a=_.userDataProxy.userData.videoDiamondNum;a++,_.userDataProxy.userData.videoDiamondNum=a,_.userDataProxy.saveData()},fail:function(){},error:function(t){cc.log(t)}},!0)})},__decorate([b(cc.Label)],e.prototype,"mGoldNum",void 0),__decorate([b(cc.Label)],e.prototype,"mDiamondNum",void 0),__decorate([b(cc.Label)],e.prototype,"mPhysicalNum",void 0),__decorate([b(cc.Label)],e.prototype,"mPowerTime",void 0),__decorate([b(cc.Node)],e.prototype,"mNowBtn",void 0),__decorate([b(cc.Node)],e.prototype,"mPlantView",void 0),__decorate([b(cc.Node)],e.prototype,"mBattleView",void 0),__decorate([b(cc.Prefab)],e.prototype,"mShopViewPb",void 0),__decorate([b(cc.Node)],e.prototype,"mGoldRoot",void 0),__decorate([b(cc.Node)],e.prototype,"mDiamondRoot",void 0),__decorate([b(cc.Node)],e.prototype,"mPhysicalRoot",void 0),__decorate([P],e)}(u.SceneBase);n.default=D,cc._RF.pop(),cc._RF.pop()},{}],HomeShopView:[function(t,e,a){"use strict";cc._RF.push(e,"c75e1VI84RNfYLdaLh9sr3i","HomeShopView");var i=t,o=e,n=a;cc._RF.push(o,"9f0eaaNK9pJc5b0SQikSarl","HomeShopView"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("EventManager"),s=i("TimeUtil"),c=i("AdsMgr"),l=i("DataManager"),u=i("UserDataProxy"),p=i("Util"),h=i("GameUIManager"),d=i("GlodShopItem"),m=i("BigBoxShopLayer"),f=i("ShopItem"),_=cc._decorator,y=_.ccclass,g=_.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.contant=null,e.dailyContant=null,e.bigBoxShopLayer=null,e.goldContant=null,e}return __extends(e,t),e.prototype.onEnable=function(){u.userDataProxy.userData.boxData||(u.userDataProxy.userData.boxData={cdTime:0,bigState:0,level:1,exp:0}),u.userDataProxy.userData.goldData||(u.userDataProxy.userData.goldData={videoNum:0,mfNum:0}),this.initView(),this.startCdTimer(),r.EventManager.instance.on(u.EUserDataEvent.REFRESH_DIAMOND,this.initView,this),r.EventManager.instance.on(u.EUserDataEvent.REFRESH_MONEY,this.initView,this)},e.prototype.onDisable=function(){this.unscheduleAllCallbacks(),r.EventManager.instance.off(u.EUserDataEvent.REFRESH_DIAMOND,this.initView,this),r.EventManager.instance.off(u.EUserDataEvent.REFRESH_MONEY,this.initView,this)},e.prototype.initView=function(){var t=l.DataManager.instance.eData.datadailyshop,e=0;for(var a in t)this.dailyContant.children[e].getComponent(f.default).init(t[a]),e++;var i=cc.find("dailyShopLayer/videoBtn",this.contant);i.getChildByName("proLabel").getComponent(cc.Label).string=20-u.userDataProxy.userData.refreshNum+"/20",this.bigBoxShopLayer.getComponent(m.default).init();var o=l.DataManager.instance.eData.databuygold;for(var a in e=0,o)this.goldContant.getChildByName("glodItem_"+(e+1)).getComponent(d.default).init(o[a]),e++;u.userDataProxy.userData.refreshNum>=20&&(i.getChildByName("icon_ad").getComponent(cc.Sprite).setMaterial(0,cc.Material.getBuiltinMaterial("2d-gray-sprite")),i.getComponent(cc.Sprite).setMaterial(0,cc.Material.getBuiltinMaterial("2d-gray-sprite")))},e.prototype.startCdTimer=function(){var t=this;this.unscheduleAllCallbacks();var e=p.default.getNextDayZeroTimestamp()-Date.now(),a=cc.find("dailyShopLayer/timerCd",this.contant).getComponent(cc.Label),i=cc.find("bigBoxShopLayer/boxShopItem2/timerCd",this.contant).getComponent(cc.Label);i.node.active=1==u.userDataProxy.userData.boxData.bigState,a.string=s.TimeUtil.format_HHMMSS(e),this.schedule(function(){(e-=1e3)<0&&(t.unscheduleAllCallbacks(),u.userDataProxy.userData.dailyData={},u.userDataProxy.userData.boxData.cdTime=0,u.userDataProxy.userData.boxData.bigState=0,u.userDataProxy.saveData(),t.initView(),t.startCdTimer()),a.string=s.TimeUtil.format_HHMMSS(e),1==u.userDataProxy.userData.boxData.bigState&&(i.string=s.TimeUtil.format_HHMMSS(e))},1)},e.prototype.refreshClick=function(){var t=this;u.userDataProxy.userData.refreshNum>=20?h.gameUIMgr.showTips("\u4eca\u65e5\u5237\u65b0\u6b21\u6570\u5df2\u8fbe\u4e0a\u9650\uff01"):c.default.showVideoAds({id:1,eventId:"shop_refresh_ad",success:function(){u.userDataProxy.userData.refreshNum+=1;var e=l.DataManager.instance.eData.datadailyshop;for(var a in e)e[a].videoRefresh>0&&(u.userDataProxy.userData.dailyData[e[a].id]=null);t.initView(),u.userDataProxy.saveData()},fail:function(t){return console.log(t)},error:function(t){return console.log(t)}},!0)},e.prototype.openEquipmentFragmentsPopup=function(){h.gameUIMgr.showEquipmentFragmentsPopup()},__decorate([g(cc.Node)],e.prototype,"contant",void 0),__decorate([g(cc.Node)],e.prototype,"dailyContant",void 0),__decorate([g(cc.Node)],e.prototype,"bigBoxShopLayer",void 0),__decorate([g(cc.Node)],e.prototype,"goldContant",void 0),__decorate([y],e)}(cc.Component);n.default=v,cc._RF.pop(),cc._RF.pop()},{}],HttpManager:[function(t,e,a){"use strict";cc._RF.push(e,"1656fT3rU1G45mknMJIVstG","HttpManager");var i=e,o=a;cc._RF.push(i,"e5020hHGaFCHpqw5xRZP/wN","HttpManager");var n=function(t,e,a,i){return new(a||(a=Promise))(function(o,n){function r(t){try{c(i.next(t))}catch(e){n(e)}}function s(t){try{c(i.throw(t))}catch(e){n(e)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof a?e:new a(function(t){t(e)})).then(r,s)}c((i=i.apply(t,e||[])).next())})},r=function(){var t;return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(t){return function(e){return __decorate([t,e])}}};Object.defineProperty(o,"__esModule",{value:!0}),o.HttpManager=o.NET_ERROR_CODE=void 0,function(t){t[t.NONE=0]="NONE",t[t.TIME_OUT=1]="TIME_OUT",t[t.ERROR=2]="ERROR"}(o.NET_ERROR_CODE||(o.NET_ERROR_CODE={}));var s=function(){function t(){this._account="",this._serverInfo=null,this.timeOut=5e3}return Object.defineProperty(t.prototype,"account",{get:function(){return this._account},set:function(t){this._account=t},enumerable:!1,configurable:!0}),Object.defineProperty(t,"instance",{get:function(){return null==this._instance&&(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t.prototype.getUrl=function(){return""},t.prototype.doHttpAsynGet=function(){var t=this;return new Promise(function(){return n(t,void 0,void 0,function(){return r()})})},t.prototype.doHttpAsynPost=function(t,e,a){var i=this;return void 0===a&&(a=""),new Promise(function(){return n(i,void 0,void 0,function(){return r()})})},t.prototype.doHttpAsynPostNotToken=function(){var t=this;return new Promise(function(){return n(t,void 0,void 0,function(){return r()})})},t._instance=null,t}();o.HttpManager=s,cc._RF.pop(),cc._RF.pop()},{}],HttpRequest:[function(t,e,a){"use strict";cc._RF.push(e,"33a98hZoFFDL7TlvWxW1E5v","HttpRequest");var i=t,o=e,n=a;cc._RF.push(o,"867ebfdd9FHFYZvVQN1n3xW","HttpRequest");var r=function(t,e,a,i){return new(a||(a=Promise))(function(o,n){function r(t){try{c(i.next(t))}catch(e){n(e)}}function s(t){try{c(i.throw(t))}catch(e){n(e)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof a?e:new a(function(t){t(e)})).then(r,s)}c((i=i.apply(t,e||[])).next())})},s=function(){var t;return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(t){return function(e){return __decorate([t,e])}}};Object.defineProperty(n,"__esModule",{value:!0}),n.HttpRequest=void 0;i("DataManager");var c=function(){function t(){this.ddd="yuanzililiang"}return Object.defineProperty(t,"inst",{get:function(){return this._inst||(this._inst=new t),this._inst},enumerable:!1,configurable:!0}),t.prototype.request=function(t,e,a,i,o){return void 0===o&&(o=null),r(this,void 0,void 0,function(){return s()})},t.prototype.encryptStr=function(t,e){if(void 0===e&&(e=null),null==t)return"";try{var a=CryptoJS.enc.Utf8.parse(t);return e=CryptoJS.MD5(e||this.ddd),CryptoJS.AES.encrypt(a,e,{iv:e,mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Iso10126}).toString()}catch(r){console.log("encryptStr error::",r)}return""},t.prototype.decryptStr=function(t,e){if(void 0===e&&(e=null),null==t)return"";try{return e=CryptoJS.MD5(e||this.ddd),CryptoJS.AES.decrypt(t,e,{iv:e,mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Iso10126}).toString(CryptoJS.enc.Utf8)}catch(n){cc.log(n)}return""},t.prototype.changeUserInfo=function(e,a,i){var o={nickname:e,head:a},n=JSON.stringify({params:t.inst.encryptStr(JSON.stringify(o))});this.request("POST","/player/updateNickname",n).then(function(t){200==t.code?(console.log("changeUserInfo:",t),i&&i(!0)):(console.error("\u66f4\u65b0\u73a9\u5bb6\u4fe1\u606f\u5931\u8d25:",t),i&&i(!1))}).catch(function(t){console.error("\u66f4\u65b0\u73a9\u5bb6\u4fe1\u606f\u5931\u8d25",t),i&&i(!1)})},t._inst=null,t}();n.HttpRequest=c,cc._RF.pop(),cc._RF.pop()},{}],IceEffect:[function(t,e,a){"use strict";cc._RF.push(e,"a7c58lct5hCcIPFVyQCzUnk","IceEffect");var i=e,o=a;cc._RF.push(i,"658e14FL2VJQbkfSElH6Dyu","IceEffect"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,r=n.ccclass,s=n.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mIceSpine=null,e}return __extends(e,t),e.prototype.onLoad=function(){var t=this;this.mIceSpine.setCompleteListener(function(e){"start"==(e.animation?e.animation.name:"")&&t.mIceSpine.setAnimation(0,"stand",!0)})},e.prototype.play=function(){this.mIceSpine.setAnimation(0,"start",!1)},__decorate([s(sp.Skeleton)],e.prototype,"mIceSpine",void 0),__decorate([r],e)}(cc.Component);o.default=c,cc._RF.pop(),cc._RF.pop()},{}],ItemAni:[function(t,e,a){"use strict";cc._RF.push(e,"921baSICWZKzZGrrVzUKQEG","ItemAni");var i=t,o=e,n=a;cc._RF.push(o,"4a917iQO5tFxK59oa9mldDF","ItemAni"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("NodePoolManager"),s=i("Util"),c=cc._decorator,l=c.ccclass,u=(c.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.init=function(t,e,a,i){var o=this,n=80,c=80;t.num<10&&(n=60,c=60),1!=t.id&&2!=t.id||(n=200);var l=2*Math.random()*c-c,u=2*Math.random()*n-n;if(e?this.node.setPosition(e):this.node.y=0,1==t.id||2==t.id||8==t.id){var p=e.y-10;cc.tween(this.node).to(s.default.getRandomNum(10,20,!0)/100,{position:cc.v3(e.x+l,e.y+Math.abs(u))},{easing:"quadOut"}).to(s.default.getRandomNum(10,20,!0)/100,{position:cc.v3(e.x+l,p)},{easing:"quadIn"}).call(function(){for(var t=cc.tween(o.node),e=0;e<3;e++){var a=s.default.getRandomNum(10,20,!0);t.to(.2,{y:p+a},{easing:"quadOut"}),t.to(.2,{y:p},{easing:"quadIn"}),a-=a/3}t.start()}).start(),this.scheduleOnce(function(){var e,n=cc.v2(o.node.position.x,o.node.position.y);e=o.node.position.x>0?cc.v2(o.node.position.x+150,o.node.position.y+200):cc.v2(o.node.position.x-150,o.node.position.y+200);var s=cc.v2(a.x,a.y);cc.tween(o.node).bezierTo(i||.4,n,e,s).call(function(){t.id,r.default.instance.putNode(o.node)}).start()},s.default.getRandomNum(80,100,!0)/100)}else{var h=e.y-20;cc.tween(this.node).to(s.default.getRandomNum(10,20,!0)/100,{position:cc.v3(e.x+l,e.y+Math.abs(u))},{easing:"quadIn"}).to(s.default.getRandomNum(10,20,!0)/100,{position:cc.v3(e.x+l,h)},{easing:"quadIn"}).start(),this.scheduleOnce(function(){var t,e=cc.v2(o.node.position.x,o.node.position.y);t=o.node.position.x>0?cc.v2(o.node.position.x+150,o.node.position.y-300):cc.v2(o.node.position.x-150,o.node.position.y-300);var n=cc.v2(a.x,a.y);cc.tween(o.node).bezierTo(i||.4,e,t,n).call(function(){r.default.instance.putNode(o.node)}).start()},s.default.getRandomNum(80,100,!0)/100)}},e.prototype.init2=function(t,e){var a,i=this,o=cc.v2(this.node.position.x,this.node.position.y);a=this.node.position.x>0?cc.v2(this.node.position.x+150,this.node.position.y-200):cc.v2(this.node.position.x-150,this.node.position.y-200);var n=cc.v2(t.x,t.y);cc.tween(this.node).bezierTo(e||.4,o,a,n).call(function(){r.default.instance.putNode(i.node)}).start()},__decorate([l],e)}(cc.Component));n.default=u,cc._RF.pop(),cc._RF.pop()},{}],Joystick:[function(t,e,a){"use strict";cc._RF.push(e,"d7950tIeu1E26/e6ybBZxPg","Joystick");var i=t,o=e,n=a;cc._RF.push(o,"1b1b6SzRIxEwJ1OfnjSQGgb","Joystick"),Object.defineProperty(n,"__esModule",{value:!0}),n.JoystickEvent=void 0;var r,s=i("GameEnum"),c=i("BattleDataProxy"),l=i("EventManager"),u=cc._decorator,p=u.ccclass,h=u.property,d=u.menu;(function(t){t.TOUCH_BEGIN="Joystic_TOUCH_BEGIN",t.TOUCH_MOVED="Joystic_TOUCH_MOVED",t.TOUCH_ENDED="Joystic_TOUCH_ENDED"})(r=n.JoystickEvent||(n.JoystickEvent={}));var m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nControlDot=null,e._radian=0,e._vec2=null,e._power=0,e._isMovable=!1,e._initPos=null,e.isTouchJoystick=!1,e}return __extends(e,t),Object.defineProperty(e.prototype,"radian",{get:function(){return this._radian},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"moveVec",{get:function(){return this._vec2},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"power",{get:function(){return this._power},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isMovable",{get:function(){return this._isMovable},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){var t,e=this;e.node.parent.on(cc.Node.EventType.TOUCH_START,e.onTouchStart,e),e.node.parent.on(cc.Node.EventType.TOUCH_MOVE,e.onTouchMove,e),e.node.parent.on(cc.Node.EventType.TOUCH_END,e.onTouchEnd,e),e.node.parent.on(cc.Node.EventType.TOUCH_CANCEL,e.onTouchEnd,e),null===(t=e.node.getComponent(cc.Widget))||void 0===t||t.updateAlignment(),e._initPos=e.node.getPosition(),this.node.active=!1},e.prototype.onDestroy=function(){var t=this;t.node.parent.off(cc.Node.EventType.TOUCH_START,t.onTouchStart,t),t.node.parent.off(cc.Node.EventType.TOUCH_MOVE,t.onTouchMove,t),t.node.parent.off(cc.Node.EventType.TOUCH_END,t.onTouchEnd,t),t.node.parent.off(cc.Node.EventType.TOUCH_CANCEL,t.onTouchEnd,t)},e.prototype.onTouchStart=function(t){if(c.battleDataProxy.gameState==s.GameState.PLAYING){var e=this;this.node.active=!0,e.isTouchJoystick=!0;var a=e.node.parent.convertToNodeSpaceAR(t.getLocation());e.setSafePos(a);var i=e.node.convertToNodeSpaceAR(t.getLocation()),o=i.len(),n=e.node.width/2;e._radian=0==i.x&&0==i.y?0:cc.v2(1,0).signAngle(i);var u=Math.cos(e._radian)*n,p=Math.sin(e._radian)*n;this._vec2=cc.v2(0,0),e.nControlDot.setPosition(n>o?i:cc.v2(u,p)),this._power=Math.min(o,n)/n,e._isMovable=!0,l.EventManager.instance.emit(r.TOUCH_BEGIN,this._vec2)}},e.prototype.onTouchMove=function(t){if(c.battleDataProxy.gameState==s.GameState.PLAYING){var e=this,a=e.node.convertToNodeSpaceAR(t.getLocation()),i=a.len(),o=e.node.width/2;e._radian=0==a.x&&0==a.y?0:cc.v2(1,0).signAngle(a);var n=Math.cos(e._radian)*o,r=Math.sin(e._radian)*o;this._vec2=cc.v2(Math.cos(this._radian),Math.sin(this._radian)),e.nControlDot.setPosition(o>i?a:cc.v2(n,r)),this._power=Math.min(i,o)/o}},e.prototype.onTouchEnd=function(){c.battleDataProxy.gameState==s.GameState.PLAYING&&(this.nControlDot.setPosition(cc.v2(0,0)),this._vec2=cc.v2(0,0),this._isMovable=!1,this._power=0,this.isTouchJoystick=!1,this.node.active=!1,l.EventManager.instance.emit(r.TOUCH_ENDED,this._vec2))},e.prototype.setSafePos=function(t){var e=this,a=e.node.width/2,i=e.node.height/2,o=e.node.parent.width-a,n=e.node.parent.height-i;t.x<a?t.x=a:t.x>o&&(t.x=o),t.y<i?t.y=i:t.y>n&&(t.y=n),e.node.setPosition(t)},e.prototype.update=function(t){this.updateKeyCode(),this.isTouchJoystick&&l.EventManager.instance.emit(r.TOUCH_MOVED,this._vec2,t)},e.prototype.updateKeyCode=function(){},e.prototype.stopTouch=function(){var t=this;t.setSafePos(this._initPos),t.nControlDot.setPosition(cc.v2(0,0)),t._isMovable=!1,t.isTouchJoystick=!1,this._power=1,t.node.pauseSystemEvents(!0)},__decorate([h({type:cc.Node,tooltip:"\u6447\u6746\u63a7\u5236\u70b9"})],e.prototype,"nControlDot",void 0),__decorate([p,d("Utils/Compoments/Joystick")],e)}(cc.Component);n.default=m,cc._RF.pop(),cc._RF.pop()},{}],LayoutAdaptive:[function(t,e,a){"use strict";cc._RF.push(e,"13a66SERZBLJpABZD92o/BZ","LayoutAdaptive");var i=e,o=a;cc._RF.push(i,"82286Bdz6ZPKpI3M7Cqbzup","LayoutAdaptive"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,r=n.ccclass,s=(n.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.start=function(){var t=this.node.getComponent(cc.Layout),e=this.node.getComponent(cc.Widget),a=this.node.width;t.resizeMode=cc.Layout.ResizeMode.NONE,e.updateAlignment();var i=this.node.width-a,o=this.node.childrenCount;t.spacingX+=i/(o-1),e.enabled=!1,t.resizeMode=cc.Layout.ResizeMode.CONTAINER,t.updateLayout()},__decorate([r],e)}(cc.Component));o.default=s,cc._RF.pop(),cc._RF.pop()},{}],ListItem:[function(t,e,a){"use strict";cc._RF.push(e,"0e3c2vLnXRJZrBNirQzo10b","ListItem");var i=e,o=a;cc._RF.push(i,"b9fb4mYbxFCG6ScvYYkttc8","ListItem"),Object.defineProperty(o,"__esModule",{value:!0});var n,r=cc._decorator,s=r.ccclass,c=r.property,l=r.disallowMultiple,u=r.menu,p=r.executionOrder;(function(t){t[t.NONE=0]="NONE",t[t.TOGGLE=1]="TOGGLE",t[t.SWITCH=2]="SWITCH"})(n||(n={}));var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.selectedMode=n.NONE,e.selectedFlag=null,e.selectedSpriteFrame=null,e._unselectedSpriteFrame=null,e.adaptiveSize=!1,e._selected=!1,e._eventReg=!1,e}return __extends(e,t),Object.defineProperty(e.prototype,"selected",{get:function(){return this._selected},set:function(t){if(this._selected=t,this.selectedFlag)switch(this.selectedMode){case n.TOGGLE:this.selectedFlag.active=t;break;case n.SWITCH:var e=this.selectedFlag.getComponent(cc.Sprite);e&&(e.spriteFrame=t?this.selectedSpriteFrame:this._unselectedSpriteFrame)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"btnCom",{get:function(){return this._btnCom||(this._btnCom=this.node.getComponent(cc.Button)),this._btnCom},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){if(this.selectedMode==n.SWITCH){var t=this.selectedFlag.getComponent(cc.Sprite);this._unselectedSpriteFrame=t.spriteFrame}},e.prototype.onDestroy=function(){this.node.off(cc.Node.EventType.SIZE_CHANGED,this._onSizeChange,this)},e.prototype._registerEvent=function(){this._eventReg||(this.btnCom&&this.list.selectedMode>0&&this.btnCom.clickEvents.unshift(this.createEvt(this,"onClickThis")),this.adaptiveSize&&this.node.on(cc.Node.EventType.SIZE_CHANGED,this._onSizeChange,this),this._eventReg=!0)},e.prototype._onSizeChange=function(){this.list._onItemAdaptive(this.node)},e.prototype.createEvt=function(t,e,a){if(void 0===a&&(a=null),t.isValid){t.comName=t.comName||t.name.match(/\<(.*?)\>/g).pop().replace(/\<|>/g,"");var i=new cc.Component.EventHandler;return i.target=a||t.node,i.component=t.comName,i.handler=e,i}},e.prototype.showAni=function(t,e,a){var i,o=this;switch(t){case 0:i=cc.tween(o.node).to(.2,{scale:.7}).by(.3,{y:2*o.node.height});break;case 1:i=cc.tween(o.node).to(.2,{scale:.7}).by(.3,{x:2*o.node.width});break;case 2:i=cc.tween(o.node).to(.2,{scale:.7}).by(.3,{y:-2*o.node.height});break;case 3:i=cc.tween(o.node).to(.2,{scale:.7}).by(.3,{x:-2*o.node.width});break;default:i=cc.tween(o.node).to(.3,{scale:.1})}(e||a)&&i.call(function(){if(a){o.list._delSingleItem(o.node);for(var t=o.list.displayData.length-1;t>=0;t--)if(o.list.displayData[t].id==o.listId){o.list.displayData.splice(t,1);break}}e()}),i.start()},e.prototype.onClickThis=function(){this.list.selectedId=this.listId},__decorate([c({type:cc.Enum(n),tooltip:!1})],e.prototype,"selectedMode",void 0),__decorate([c({type:cc.Node,tooltip:!1,visible:function(){return this.selectedMode>n.NONE}})],e.prototype,"selectedFlag",void 0),__decorate([c({type:cc.SpriteFrame,tooltip:!1,visible:function(){return this.selectedMode==n.SWITCH}})],e.prototype,"selectedSpriteFrame",void 0),__decorate([c({tooltip:!1})],e.prototype,"adaptiveSize",void 0),__decorate([s,l(),u("\u81ea\u5b9a\u4e49\u7ec4\u4ef6/List Item"),p(-5001)],e)}(cc.Component);o.default=h,cc._RF.pop(),cc._RF.pop()},{}],List:[function(t,e,a){"use strict";cc._RF.push(e,"0916dWy6ghIUrGFBGp8urmE","List");var i=t,o=e,n=a;cc._RF.push(o,"0dc5fC+7fNH7rIvKg2qfnxL","List"),Object.defineProperty(n,"__esModule",{value:!0});var r,s,c,l=cc._decorator,u=l.ccclass,p=l.property,h=l.disallowMultiple,d=l.menu,m=l.executionOrder,f=l.requireComponent,_=i("ListItem");(function(t){t[t.NODE=1]="NODE",t[t.PREFAB=2]="PREFAB"})(r||(r={})),function(t){t[t.NORMAL=1]="NORMAL",t[t.ADHERING=2]="ADHERING",t[t.PAGE=3]="PAGE"}(s||(s={})),function(t){t[t.NONE=0]="NONE",t[t.SINGLE=1]="SINGLE",t[t.MULT=2]="MULT"}(c||(c={}));var y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.templateType=r.NODE,e.tmpNode=null,e.tmpPrefab=null,e._slideMode=s.NORMAL,e.pageDistance=.3,e.pageItemNum=1,e.pageChangeEvent=new cc.Component.EventHandler,e._virtual=!0,e.cyclic=!1,e.lackCenter=!1,e.lackSlide=!1,e._updateRate=0,e.frameByFrameRenderNum=0,e.renderEvent=new cc.Component.EventHandler,e.selectedMode=c.NONE,e.repeatEventSingle=!1,e.selectedEvent=new cc.Component.EventHandler,e._selectedId=-1,e._forceUpdate=!1,e._updateDone=!0,e._numItems=0,e._inited=!1,e._needUpdateWidget=!1,e._aniDelRuning=!1,e._doneAfterUpdate=!1,e.adhering=!1,e._adheringBarrier=!1,e.curPageNum=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"slideMode",{get:function(){return this._slideMode},set:function(t){this._slideMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"virtual",{get:function(){return this._virtual},set:function(t){null!=t&&(this._virtual=t),0!=this._numItems&&this._onScrolling()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"updateRate",{get:function(){return this._updateRate},set:function(t){t>=0&&t<=6&&(this._updateRate=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selectedId",{get:function(){return this._selectedId},set:function(t){var e,a=this;switch(a.selectedMode){case c.SINGLE:if(!a.repeatEventSingle&&t==a._selectedId)return;e=a.getItemByListId(t);var i=void 0;if(a._selectedId>=0?a._lastSelectedId=a._selectedId:a._lastSelectedId=null,a._selectedId=t,e&&((i=e.getComponent(_.default)).selected=!0),a._lastSelectedId>=0&&a._lastSelectedId!=a._selectedId){var o=a.getItemByListId(a._lastSelectedId);o&&(o.getComponent(_.default).selected=!1)}a.selectedEvent&&cc.Component.EventHandler.emitEvents([a.selectedEvent],e,t%this._actualNumItems,null==a._lastSelectedId?null:a._lastSelectedId%this._actualNumItems);break;case c.MULT:if(!(e=a.getItemByListId(t)))return;i=e.getComponent(_.default),a._selectedId>=0&&(a._lastSelectedId=a._selectedId),a._selectedId=t;var n=!i.selected;i.selected=n;var r=a.multSelected.indexOf(t);n&&r<0?a.multSelected.push(t):!n&&r>=0&&a.multSelected.splice(r,1),a.selectedEvent&&cc.Component.EventHandler.emitEvents([a.selectedEvent],e,t%this._actualNumItems,null==a._lastSelectedId?null:a._lastSelectedId%this._actualNumItems,n)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"numItems",{get:function(){return this._actualNumItems},set:function(t){var e=this;if(e.checkInited(!1))if(null==t||t<0)cc.error("numItems set the wrong::",t);else if(e._actualNumItems=e._numItems=t,e._forceUpdate=!0,e._virtual)e._resizeContent(),e.cyclic&&(e._numItems=e._cyclicNum*e._numItems),e._onScrolling(),e.frameByFrameRenderNum||e.slideMode!=s.PAGE||(e.curPageNum=Math.floor(e.nearestListId/e.pageItemNum));else{e.cyclic&&(e._resizeContent(),e._numItems=e._cyclicNum*e._numItems);var a=e.content.getComponent(cc.Layout);if(a&&(a.enabled=!0),e._delRedundantItem(),e.firstListId=0,e.frameByFrameRenderNum>0){for(var i=e.frameByFrameRenderNum>e._numItems?e._numItems:e.frameByFrameRenderNum,o=0;o<i;o++)e._createOrUpdateItem2(o);e.frameByFrameRenderNum<e._numItems&&(e._updateCounter=e.frameByFrameRenderNum,e._updateDone=!1)}else{for(o=0;o<e._numItems;o++)e._createOrUpdateItem2(o);e.displayItemNum=e._numItems}}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scrollView",{get:function(){return this._scrollView},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){this._init()},e.prototype.onDestroy=function(){var t=this;cc.isValid(t._itemTmp)&&t._itemTmp.destroy(),cc.isValid(t.tmpNode)&&t.tmpNode.destroy(),t._pool&&t._pool.clear()},e.prototype.onEnable=function(){this._registerEvent(),this._init(),this._aniDelRuning&&(this._aniDelRuning=!1,this._aniDelItem&&(this._aniDelBeforePos&&(this._aniDelItem.position=this._aniDelBeforePos,delete this._aniDelBeforePos),this._aniDelBeforeScale&&(this._aniDelItem.scale=this._aniDelBeforeScale,delete this._aniDelBeforeScale),delete this._aniDelItem),this._aniDelCB&&(this._aniDelCB(),delete this._aniDelCB))},e.prototype.onDisable=function(){this._unregisterEvent()},e.prototype._registerEvent=function(){var t=this;t.node.on(cc.Node.EventType.TOUCH_START,t._onTouchStart,t,!0),t.node.on("touch-up",t._onTouchUp,t),t.node.on(cc.Node.EventType.TOUCH_CANCEL,t._onTouchCancelled,t,!0),t.node.on("scroll-began",t._onScrollBegan,t,!0),t.node.on("scroll-ended",t._onScrollEnded,t,!0),t.node.on("scrolling",t._onScrolling,t,!0),t.node.on(cc.Node.EventType.SIZE_CHANGED,t._onSizeChanged,t)},e.prototype._unregisterEvent=function(){var t=this;t.node.off(cc.Node.EventType.TOUCH_START,t._onTouchStart,t,!0),t.node.off("touch-up",t._onTouchUp,t),t.node.off(cc.Node.EventType.TOUCH_CANCEL,t._onTouchCancelled,t,!0),t.node.off("scroll-began",t._onScrollBegan,t,!0),t.node.off("scroll-ended",t._onScrollEnded,t,!0),t.node.off("scrolling",t._onScrolling,t,!0),t.node.off(cc.Node.EventType.SIZE_CHANGED,t._onSizeChanged,t)},e.prototype._init=function(){var t=this;if(!t._inited)if(t._scrollView=t.node.getComponent(cc.ScrollView),t.content=t._scrollView.content,t.content){switch(t._layout=t.content.getComponent(cc.Layout),t._align=t._layout.type,t._resizeMode=t._layout.resizeMode,t._startAxis=t._layout.startAxis,t._topGap=t._layout.paddingTop,t._rightGap=t._layout.paddingRight,t._bottomGap=t._layout.paddingBottom,t._leftGap=t._layout.paddingLeft,t._columnGap=t._layout.spacingX,t._lineGap=t._layout.spacingY,t._colLineNum,t._verticalDir=t._layout.verticalDirection,t._horizontalDir=t._layout.horizontalDirection,t.setTemplateItem(cc.instantiate(t.templateType==r.PREFAB?t.tmpPrefab:t.tmpNode)),t._slideMode!=s.ADHERING&&t._slideMode!=s.PAGE||(t._scrollView.inertia=!1,t._scrollView._onMouseWheel=function(){}),t.virtual||(t.lackCenter=!1),t._lastDisplayData=[],t.displayData=[],t._pool=new cc.NodePool,t._forceUpdate=!1,t._updateCounter=0,t._updateDone=!0,t.curPageNum=0,t.cyclic&&(t._scrollView._processAutoScrolling=this._processAutoScrolling.bind(t),t._scrollView._startBounceBackIfNeeded=function(){return!1}),t._align){case cc.Layout.Type.HORIZONTAL:switch(t._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:t._alignCalcType=1;break;case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:t._alignCalcType=2}break;case cc.Layout.Type.VERTICAL:switch(t._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:t._alignCalcType=3;break;case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:t._alignCalcType=4}break;case cc.Layout.Type.GRID:switch(t._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:switch(t._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:t._alignCalcType=3;break;case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:t._alignCalcType=4}break;case cc.Layout.AxisDirection.VERTICAL:switch(t._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:t._alignCalcType=1;break;case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:t._alignCalcType=2}}}t.content.children.forEach(function(e){e.removeFromParent(),e!=t.tmpNode&&e.isValid&&e.destroy()}),t._inited=!0}else cc.error(t.node.name+"'s cc.ScrollView unset content!")},e.prototype._processAutoScrolling=function(t){this._scrollView._autoScrollAccumulatedTime+=1*t;var e=Math.min(1,this._scrollView._autoScrollAccumulatedTime/this._scrollView._autoScrollTotalTime);if(this._scrollView._autoScrollAttenuate){var a=e-1;e=a*a*a*a*a+1}var i=this._scrollView._autoScrollStartPosition.add(this._scrollView._autoScrollTargetDelta.mul(e)),o=this._scrollView.getScrollEndedEventTiming(),n=Math.abs(e-1)<=o;Math.abs(e-1)<=this._scrollView.getScrollEndedEventTiming()&&!this._scrollView._isScrollEndedWithThresholdEventFired&&(this._scrollView._dispatchEvent("scroll-ended-with-threshold"),this._scrollView._isScrollEndedWithThresholdEventFired=!0),n&&(this._scrollView._autoScrolling=!1);var r=i.sub(this._scrollView.getContentPosition());this._scrollView._moveContent(this._scrollView._clampDelta(r),n),this._scrollView._dispatchEvent("scrolling"),this._scrollView._autoScrolling||(this._scrollView._isBouncing=!1,this._scrollView._scrolling=!1,this._scrollView._dispatchEvent("scroll-ended"))},e.prototype.setTemplateItem=function(t){if(t){var e=this;e._itemTmp=t,e._resizeMode==cc.Layout.ResizeMode.CHILDREN?e._itemSize=e._layout.cellSize:e._itemSize=cc.size(t.width,t.height);var a=t.getComponent(_.default),i=!1;switch(a||(i=!0),i&&(e.selectedMode=c.NONE),(a=t.getComponent(cc.Widget))&&a.enabled&&(e._needUpdateWidget=!0),e.selectedMode==c.MULT&&(e.multSelected=[]),e._align){case cc.Layout.Type.HORIZONTAL:e._colLineNum=1,e._sizeType=!1;break;case cc.Layout.Type.VERTICAL:e._colLineNum=1,e._sizeType=!0;break;case cc.Layout.Type.GRID:switch(e._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:var o=e.content.width-e._leftGap-e._rightGap;e._colLineNum=Math.floor((o+e._columnGap)/(e._itemSize.width+e._columnGap)),e._sizeType=!0;break;case cc.Layout.AxisDirection.VERTICAL:var n=e.content.height-e._topGap-e._bottomGap;e._colLineNum=Math.floor((n+e._lineGap)/(e._itemSize.height+e._lineGap)),e._sizeType=!1}}}},e.prototype.checkInited=function(t){return void 0===t&&(t=!0),!!this._inited||(t&&cc.error("List initialization not completed!"),!1)},e.prototype._resizeContent=function(){var t,e=this;switch(e._align){case cc.Layout.Type.HORIZONTAL:if(e._customSize){var a=e._getFixedSize(null);t=e._leftGap+a.val+e._itemSize.width*(e._numItems-a.count)+e._columnGap*(e._numItems-1)+e._rightGap}else t=e._leftGap+e._itemSize.width*e._numItems+e._columnGap*(e._numItems-1)+e._rightGap;break;case cc.Layout.Type.VERTICAL:e._customSize?(a=e._getFixedSize(null),t=e._topGap+a.val+e._itemSize.height*(e._numItems-a.count)+e._lineGap*(e._numItems-1)+e._bottomGap):t=e._topGap+e._itemSize.height*e._numItems+e._lineGap*(e._numItems-1)+e._bottomGap;break;case cc.Layout.Type.GRID:switch(e.lackCenter&&(e.lackCenter=!1),e._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:var i=Math.ceil(e._numItems/e._colLineNum);t=e._topGap+e._itemSize.height*i+e._lineGap*(i-1)+e._bottomGap;break;case cc.Layout.AxisDirection.VERTICAL:var o=Math.ceil(e._numItems/e._colLineNum);t=e._leftGap+e._itemSize.width*o+e._columnGap*(o-1)+e._rightGap}}var n=e.content.getComponent(cc.Layout);if(n&&(n.enabled=!1),e._allItemSize=t,e._allItemSizeNoEdge=e._allItemSize-(e._sizeType?e._topGap+e._bottomGap:e._leftGap+e._rightGap),e.cyclic){var r=e._sizeType?e.node.height:e.node.width;e._cyclicPos1=0,r-=e._cyclicPos1,e._cyclicNum=Math.ceil(r/e._allItemSizeNoEdge)+1;var s=e._sizeType?e._lineGap:e._columnGap;e._cyclicPos2=e._cyclicPos1+e._allItemSizeNoEdge+s,e._cyclicAllItemSize=e._allItemSize+e._allItemSizeNoEdge*(e._cyclicNum-1)+s*(e._cyclicNum-1),e._cycilcAllItemSizeNoEdge=e._allItemSizeNoEdge*e._cyclicNum,e._cycilcAllItemSizeNoEdge+=s*(e._cyclicNum-1)}e._lack=!e.cyclic&&e._allItemSize<(e._sizeType?e.node.height:e.node.width);var c=e._lack&&e.lackCenter||!e.lackSlide?.1:0,l=e._lack?(e._sizeType?e.node.height:e.node.width)-c:e.cyclic?e._cyclicAllItemSize:e._allItemSize;l<0&&(l=0),e._sizeType?e.content.height=l:e.content.width=l},e.prototype._onScrolling=function(t){if(void 0===t&&(t=null),null==this.frameCount&&(this.frameCount=this._updateRate),!this._forceUpdate&&t&&"scroll-ended"!=t.type&&this.frameCount>0)this.frameCount--;else if(this.frameCount=this._updateRate,!this._aniDelRuning){if(this.cyclic){var e=this.content.getPosition();e=this._sizeType?e.y:e.x;var a=this._allItemSizeNoEdge+(this._sizeType?this._lineGap:this._columnGap),i=this._sizeType?cc.v2(0,a):cc.v2(a,0);switch(this._alignCalcType){case 1:e>-this._cyclicPos1?(this.content.x=-this._cyclicPos2,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.sub(i))):e<-this._cyclicPos2&&(this.content.x=-this._cyclicPos1,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.add(i)));break;case 2:e<this._cyclicPos1?(this.content.x=this._cyclicPos2,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.add(i))):e>this._cyclicPos2&&(this.content.x=this._cyclicPos1,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.sub(i)));break;case 3:e<this._cyclicPos1?(this.content.y=this._cyclicPos2,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.add(i))):e>this._cyclicPos2&&(this.content.y=this._cyclicPos1,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.sub(i)));break;case 4:e>-this._cyclicPos1?(this.content.y=-this._cyclicPos2,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.sub(i))):e<-this._cyclicPos2&&(this.content.y=-this._cyclicPos1,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.add(i)))}}var o,n,r,s;if(this._calcViewPos(),this._sizeType?(o=this.viewTop,r=this.viewBottom):(n=this.viewRight,s=this.viewLeft),this._virtual){this.displayData=[];var c=void 0,l=0,u=this._numItems-1;if(this._customSize)for(var p=!1;l<=u&&!p;l++)switch(c=this._calcItemPos(l),this._align){case cc.Layout.Type.HORIZONTAL:c.right>=s&&c.left<=n?this.displayData.push(c):0!=l&&this.displayData.length>0&&(p=!0);break;case cc.Layout.Type.VERTICAL:c.bottom<=o&&c.top>=r?this.displayData.push(c):0!=l&&this.displayData.length>0&&(p=!0);break;case cc.Layout.Type.GRID:switch(this._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:c.bottom<=o&&c.top>=r?this.displayData.push(c):0!=l&&this.displayData.length>0&&(p=!0);break;case cc.Layout.AxisDirection.VERTICAL:c.right>=s&&c.left<=n?this.displayData.push(c):0!=l&&this.displayData.length>0&&(p=!0)}}else{var h=this._itemSize.width+this._columnGap,d=this._itemSize.height+this._lineGap;switch(this._alignCalcType){case 1:l=(s-this._leftGap)/h,u=(n-this._leftGap)/h;break;case 2:l=(-n-this._rightGap)/h,u=(-s-this._rightGap)/h;break;case 3:l=(-o-this._topGap)/d,u=(-r-this._topGap)/d;break;case 4:l=(r-this._bottomGap)/d,u=(o-this._bottomGap)/d}for(l=Math.floor(l)*this._colLineNum,u=Math.ceil(u)*this._colLineNum,l<0&&(l=0),--u>=this._numItems&&(u=this._numItems-1);l<=u;l++)this.displayData.push(this._calcItemPos(l))}if(this._delRedundantItem(),this.displayData.length<=0||!this._numItems)return void(this._lastDisplayData=[]);this.firstListId=this.displayData[0].id,this.displayItemNum=this.displayData.length;var m=this._lastDisplayData.length,f=this.displayItemNum!=m;if(f&&(this.frameByFrameRenderNum>0&&this._lastDisplayData.sort(function(t,e){return t-e}),f=this.firstListId!=this._lastDisplayData[0]||this.displayData[this.displayItemNum-1].id!=this._lastDisplayData[m-1]),this._forceUpdate||f)if(this.frameByFrameRenderNum>0)this._numItems>0?(this._updateDone?this._updateCounter=0:this._doneAfterUpdate=!0,this._updateDone=!1):(this._updateCounter=0,this._updateDone=!0);else{this._lastDisplayData=[];for(var _=0;_<this.displayItemNum;_++)this._createOrUpdateItem(this.displayData[_]);this._forceUpdate=!1}this._calcNearestItem()}}},e.prototype._calcViewPos=function(){var t=this.content.getPosition();switch(this._alignCalcType){case 1:this.elasticLeft=t.x>0?t.x:0,this.viewLeft=(t.x<0?-t.x:0)-this.elasticLeft,this.viewRight=this.viewLeft+this.node.width,this.elasticRight=this.viewRight>this.content.width?Math.abs(this.viewRight-this.content.width):0,this.viewRight+=this.elasticRight;break;case 2:this.elasticRight=t.x<0?-t.x:0,this.viewRight=(t.x>0?-t.x:0)+this.elasticRight,this.viewLeft=this.viewRight-this.node.width,this.elasticLeft=this.viewLeft<-this.content.width?Math.abs(this.viewLeft+this.content.width):0,this.viewLeft-=this.elasticLeft;break;case 3:this.elasticTop=t.y<0?Math.abs(t.y):0,this.viewTop=(t.y>0?-t.y:0)+this.elasticTop,this.viewBottom=this.viewTop-this.node.height,this.elasticBottom=this.viewBottom<-this.content.height?Math.abs(this.viewBottom+this.content.height):0,this.viewBottom+=this.elasticBottom;break;case 4:this.elasticBottom=t.y>0?Math.abs(t.y):0,this.viewBottom=(t.y<0?-t.y:0)-this.elasticBottom,this.viewTop=this.viewBottom+this.node.height,this.elasticTop=this.viewTop>this.content.height?Math.abs(this.viewTop-this.content.height):0,this.viewTop-=this.elasticTop}},e.prototype._calcItemPos=function(t){var e,a,i,o,n,r,s,c;switch(this._align){case cc.Layout.Type.HORIZONTAL:switch(this._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:if(this._customSize){var l=this._getFixedSize(t);n=this._leftGap+(this._itemSize.width+this._columnGap)*(t-l.count)+(l.val+this._columnGap*l.count),e=(u=this._customSize[t])>0?u:this._itemSize.width}else n=this._leftGap+(this._itemSize.width+this._columnGap)*t,e=this._itemSize.width;return this.lackCenter&&(n-=this._leftGap,n+=this.content.width/2-this._allItemSizeNoEdge/2),{id:t,left:n,right:r=n+e,x:n+this._itemTmp.anchorX*e,y:this._itemTmp.y};case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:return this._customSize?(l=this._getFixedSize(t),r=-this._rightGap-(this._itemSize.width+this._columnGap)*(t-l.count)-(l.val+this._columnGap*l.count),e=(u=this._customSize[t])>0?u:this._itemSize.width):(r=-this._rightGap-(this._itemSize.width+this._columnGap)*t,e=this._itemSize.width),this.lackCenter&&(r+=this._rightGap,r-=this.content.width/2-this._allItemSizeNoEdge/2),{id:t,right:r,left:n=r-e,x:n+this._itemTmp.anchorX*e,y:this._itemTmp.y}}break;case cc.Layout.Type.VERTICAL:switch(this._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:return this._customSize?(l=this._getFixedSize(t),i=-this._topGap-(this._itemSize.height+this._lineGap)*(t-l.count)-(l.val+this._lineGap*l.count),a=(u=this._customSize[t])>0?u:this._itemSize.height):(i=-this._topGap-(this._itemSize.height+this._lineGap)*t,a=this._itemSize.height),this.lackCenter&&(i+=this._topGap,i-=this.content.height/2-this._allItemSizeNoEdge/2),{id:t,top:i,bottom:o=i-a,x:this._itemTmp.x,y:o+this._itemTmp.anchorY*a};case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:var u;return this._customSize?(l=this._getFixedSize(t),o=this._bottomGap+(this._itemSize.height+this._lineGap)*(t-l.count)+(l.val+this._lineGap*l.count),a=(u=this._customSize[t])>0?u:this._itemSize.height):(o=this._bottomGap+(this._itemSize.height+this._lineGap)*t,a=this._itemSize.height),this.lackCenter&&(o-=this._bottomGap,o+=this.content.height/2-this._allItemSizeNoEdge/2),{id:t,top:i=o+a,bottom:o,x:this._itemTmp.x,y:o+this._itemTmp.anchorY*a}}case cc.Layout.Type.GRID:var p=Math.floor(t/this._colLineNum);switch(this._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:switch(this._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:c=(o=(i=-this._topGap-(this._itemSize.height+this._lineGap)*p)-this._itemSize.height)+this._itemTmp.anchorY*this._itemSize.height;break;case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:i=(o=this._bottomGap+(this._itemSize.height+this._lineGap)*p)+this._itemSize.height,c=o+this._itemTmp.anchorY*this._itemSize.height}switch(s=this._leftGap+t%this._colLineNum*(this._itemSize.width+this._columnGap),this._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:s+=this._itemTmp.anchorX*this._itemSize.width,s-=this.content.anchorX*this.content.width;break;case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:s+=(1-this._itemTmp.anchorX)*this._itemSize.width,s-=(1-this.content.anchorX)*this.content.width,s*=-1}return{id:t,top:i,bottom:o,x:s,y:c};case cc.Layout.AxisDirection.VERTICAL:switch(this._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:r=(n=this._leftGap+(this._itemSize.width+this._columnGap)*p)+this._itemSize.width,s=n+this._itemTmp.anchorX*this._itemSize.width,s-=this.content.anchorX*this.content.width;break;case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:s=(n=(r=-this._rightGap-(this._itemSize.width+this._columnGap)*p)-this._itemSize.width)+this._itemTmp.anchorX*this._itemSize.width,s+=(1-this.content.anchorX)*this.content.width}switch(c=-this._topGap-t%this._colLineNum*(this._itemSize.height+this._lineGap),this._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:c-=(1-this._itemTmp.anchorY)*this._itemSize.height,c+=(1-this.content.anchorY)*this.content.height;break;case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:c-=this._itemTmp.anchorY*this._itemSize.height,c+=this.content.anchorY*this.content.height,c*=-1}return{id:t,left:n,right:r,x:s,y:c}}}},e.prototype._calcExistItemPos=function(t){var e=this.getItemByListId(t);if(!e)return null;var a={id:t,x:e.x,y:e.y};return this._sizeType?(a.top=e.y+e.height*(1-e.anchorY),a.bottom=e.y-e.height*e.anchorY):(a.left=e.x-e.width*e.anchorX,a.right=e.x+e.width*(1-e.anchorX)),a},e.prototype.getItemPos=function(t){return this._virtual?this._calcItemPos(t):this.frameByFrameRenderNum?this._calcItemPos(t):this._calcExistItemPos(t)},e.prototype._getFixedSize=function(t){if(!this._customSize)return null;null==t&&(t=this._numItems);var e=0,a=0;for(var i in this._customSize)parseInt(i)<t&&(e+=this._customSize[i],a++);return{val:e,count:a}},e.prototype._onScrollBegan=function(){this._beganPos=this._sizeType?this.viewTop:this.viewLeft},e.prototype._onScrollEnded=function(){var t=this;if(t.curScrollIsTouch=!1,null!=t.scrollToListId){var e=t.getItemByListId(t.scrollToListId);t.scrollToListId=null,e&&cc.tween(e).to(.1,{scale:1.06}).to(.1,{scale:1}).start()}t._onScrolling(),t._slideMode!=s.ADHERING||t.adhering?t._slideMode==s.PAGE&&(null!=t._beganPos&&t.curScrollIsTouch?this._pageAdhere():t.adhere()):t.adhere()},e.prototype._onTouchStart=function(t,e){if(!this._scrollView.hasNestedViewGroup(t,e)&&(this.curScrollIsTouch=!0,t.eventPhase!==cc.Event.AT_TARGET||t.target!==this.node)){for(var a=t.target;null==a._listId&&a.parent;)a=a.parent;this._scrollItem=null!=a._listId?a:t.target}},e.prototype._onTouchUp=function(){var t=this;t._scrollPos=null,t._slideMode==s.ADHERING?(this.adhering&&(this._adheringBarrier=!0),t.adhere()):t._slideMode==s.PAGE&&(null!=t._beganPos?this._pageAdhere():t.adhere()),this._scrollItem=null},e.prototype._onTouchCancelled=function(t,e){var a=this;a._scrollView.hasNestedViewGroup(t,e)||t.simulate||(a._scrollPos=null,a._slideMode==s.ADHERING?(a.adhering&&(a._adheringBarrier=!0),a.adhere()):a._slideMode==s.PAGE&&(null!=a._beganPos?a._pageAdhere():a.adhere()),this._scrollItem=null)},e.prototype._onSizeChanged=function(){this.checkInited(!1)&&this._onScrolling()},e.prototype._onItemAdaptive=function(t){if(!this._sizeType&&t.width!=this._itemSize.width||this._sizeType&&t.height!=this._itemSize.height){this._customSize||(this._customSize={});var e=this._sizeType?t.height:t.width;this._customSize[t._listId]!=e&&(this._customSize[t._listId]=e,this._resizeContent(),this.updateAll(),null!=this._scrollToListId&&(this._scrollPos=null,this.unschedule(this._scrollToSo),this.scrollTo(this._scrollToListId,Math.max(0,this._scrollToEndTime-(new Date).getTime()/1e3))))}},e.prototype._pageAdhere=function(){var t=this;if(t.cyclic||!(t.elasticTop>0||t.elasticRight>0||t.elasticBottom>0||t.elasticLeft>0)){var e=t._sizeType?t.viewTop:t.viewLeft,a=(t._sizeType?t.node.height:t.node.width)*t.pageDistance;if(Math.abs(t._beganPos-e)>a)switch(t._alignCalcType){case 1:case 4:t._beganPos>e?t.prePage(.5):t.nextPage(.5);break;case 2:case 3:t._beganPos<e?t.prePage(.5):t.nextPage(.5)}else t.elasticTop<=0&&t.elasticRight<=0&&t.elasticBottom<=0&&t.elasticLeft<=0&&t.adhere();t._beganPos=null}},e.prototype.adhere=function(){var t=this;if(t.checkInited()&&!(t.elasticTop>0||t.elasticRight>0||t.elasticBottom>0||t.elasticLeft>0)){t.adhering=!0,t._calcNearestItem();var e=(t._sizeType?t._topGap:t._leftGap)/(t._sizeType?t.node.height:t.node.width);t.scrollTo(t.nearestListId,.7,e)}},e.prototype.update=function(){if(!(this.frameByFrameRenderNum<=0||this._updateDone))if(this._virtual){for(var t=this._updateCounter+this.frameByFrameRenderNum>this.displayItemNum?this.displayItemNum:this._updateCounter+this.frameByFrameRenderNum,e=this._updateCounter;e<t;e++){var a=this.displayData[e];a&&this._createOrUpdateItem(a)}this._updateCounter>=this.displayItemNum-1?this._doneAfterUpdate?(this._updateCounter=0,this._updateDone=!1,this._doneAfterUpdate=!1):(this._updateDone=!0,this._delRedundantItem(),this._forceUpdate=!1,this._calcNearestItem(),this.slideMode==s.PAGE&&(this.curPageNum=Math.floor(this.nearestListId/this.pageItemNum))):this._updateCounter+=this.frameByFrameRenderNum}else if(this._updateCounter<this._numItems){for(t=this._updateCounter+this.frameByFrameRenderNum>this._numItems?this._numItems:this._updateCounter+this.frameByFrameRenderNum,e=this._updateCounter;e<t;e++)this._createOrUpdateItem2(e);this._updateCounter+=this.frameByFrameRenderNum}else this._updateDone=!0,this._calcNearestItem(),this.slideMode==s.PAGE&&(this.curPageNum=Math.floor(this.nearestListId/this.pageItemNum))},e.prototype._createOrUpdateItem=function(t){var e=this.getItemByListId(t.id);if(e)this._forceUpdate&&this.renderEvent&&(e.setPosition(cc.v2(t.x,t.y)),this._resetItemSize(e),this.renderEvent&&cc.Component.EventHandler.emitEvents([this.renderEvent],e,t.id%this._actualNumItems));else{var a=this._pool.size()>0;if(e=a?this._pool.get():cc.instantiate(this._itemTmp),a&&cc.isValid(e)||(e=cc.instantiate(this._itemTmp),a=!1),e._listId!=t.id&&(e._listId=t.id,e.setContentSize(this._itemSize)),e.setPosition(cc.v2(t.x,t.y)),this._resetItemSize(e),this.content.addChild(e),a&&this._needUpdateWidget){var i=e.getComponent(cc.Widget);i&&i.updateAlignment()}e.setSiblingIndex(this.content.childrenCount-1);var o=e.getComponent(_.default);e.listItem=o,o&&(o.listId=t.id,o.list=this,o._registerEvent()),this.renderEvent&&cc.Component.EventHandler.emitEvents([this.renderEvent],e,t.id%this._actualNumItems)}this._resetItemSize(e),this._updateListItem(e.listItem),this._lastDisplayData.indexOf(t.id)<0&&this._lastDisplayData.push(t.id)},e.prototype._createOrUpdateItem2=function(t){var e,a=this.content.children[t];a?this._forceUpdate&&this.renderEvent&&(a._listId=t,e&&(e.listId=t),this.renderEvent&&cc.Component.EventHandler.emitEvents([this.renderEvent],a,t%this._actualNumItems)):((a=cc.instantiate(this._itemTmp))._listId=t,this.content.addChild(a),e=a.getComponent(_.default),a.listItem=e,e&&(e.listId=t,e.list=this,e._registerEvent()),this.renderEvent&&cc.Component.EventHandler.emitEvents([this.renderEvent],a,t%this._actualNumItems)),this._updateListItem(e),this._lastDisplayData.indexOf(t)<0&&this._lastDisplayData.push(t)},e.prototype._updateListItem=function(t){if(t&&this.selectedMode>c.NONE){var e=t.node;switch(this.selectedMode){case c.SINGLE:t.selected=this.selectedId==e._listId;break;case c.MULT:t.selected=this.multSelected.indexOf(e._listId)>=0}}},e.prototype._resetItemSize=function(){},e.prototype._updateItemPos=function(t){var e=isNaN(t)?t:this.getItemByListId(t),a=this.getItemPos(e._listId);e.setPosition(a.x,a.y)},e.prototype.setMultSelected=function(t,e){var a=this;if(a.checkInited()){if(Array.isArray(t)||(t=[t]),null==e)a.multSelected=t;else{var i=void 0,o=void 0;if(e)for(var n=t.length-1;n>=0;n--)i=t[n],(o=a.multSelected.indexOf(i))<0&&a.multSelected.push(i);else for(n=t.length-1;n>=0;n--)i=t[n],(o=a.multSelected.indexOf(i))>=0&&a.multSelected.splice(o,1)}a._forceUpdate=!0,a._onScrolling()}},e.prototype.getMultSelected=function(){return this.multSelected},e.prototype.hasMultSelected=function(t){return this.multSelected&&this.multSelected.indexOf(t)>=0},e.prototype.updateItem=function(t){if(this.checkInited()){Array.isArray(t)||(t=[t]);for(var e=0,a=t.length;e<a;e++){var i=t[e],o=this.getItemByListId(i);o&&cc.Component.EventHandler.emitEvents([this.renderEvent],o,i%this._actualNumItems)}}},e.prototype.updateAll=function(){this.checkInited()&&(this._selectedId=-1,this.numItems=this.numItems)},e.prototype.getItemByListId=function(t){if(this.content)for(var e=this.content.childrenCount-1;e>=0;e--){var a=this.content.children[e];if(a._listId==t)return a}},e.prototype._getOutsideItem=function(){for(var t,e=[],a=this.content.childrenCount-1;a>=0;a--)t=this.content.children[a],this.displayData.find(function(e){return e.id==t._listId})||e.push(t);return e},e.prototype._delRedundantItem=function(){if(this._virtual)for(var t=this._getOutsideItem(),e=t.length-1;e>=0;e--){var a=t[e];if(!this._scrollItem||a._listId!=this._scrollItem._listId){a.isCached=!0,this._pool.put(a);for(var i=this._lastDisplayData.length-1;i>=0;i--)if(this._lastDisplayData[i]==a._listId){this._lastDisplayData.splice(i,1);break}}}else for(;this.content.childrenCount>this._numItems;)this._delSingleItem(this.content.children[this.content.childrenCount-1])},e.prototype._delSingleItem=function(t){t.removeFromParent(),t.destroy&&t.destroy(),t=null},e.prototype.aniDelItem=function(t,e,a){var i=this;if(!i.checkInited()||i.cyclic||!i._virtual)return cc.error("This function is not allowed to be called!");if(!e)return cc.error("CallFunc are not allowed to be NULL, You need to delete the corresponding index in the data array in the CallFunc!");if(i._aniDelRuning)return cc.warn("Please wait for the current deletion to finish!");var o,n=i.getItemByListId(t);if(n){o=n.getComponent(_.default),i._aniDelRuning=!0,i._aniDelCB=e,i._aniDelItem=n,i._aniDelBeforePos=n.position,i._aniDelBeforeScale=n.scale;var r=i.displayData[i.displayData.length-1].id,s=o.selected;o.showAni(a,function(){var a,o,l;if(r<i._numItems-2&&(a=r+1),null!=a){var u=i._calcItemPos(a);i.displayData.push(u),i._virtual?i._createOrUpdateItem(u):i._createOrUpdateItem2(a)}else i._numItems--;if(i.selectedMode==c.SINGLE)s?i._selectedId=-1:i._selectedId-1>=0&&i._selectedId--;else if(i.selectedMode==c.MULT&&i.multSelected.length){var p=i.multSelected.indexOf(t);p>=0&&i.multSelected.splice(p,1);for(var h=i.multSelected.length-1;h>=0;h--)(f=i.multSelected[h])>=t&&i.multSelected[h]--}if(i._customSize){i._customSize[t]&&delete i._customSize[t];var d={},m=void 0;for(var f in i._customSize){m=i._customSize[f];var _=parseInt(f);d[_-(_>=t?1:0)]=m}i._customSize=d}for(h=null!=a?a:r;h>=t+1;h--)if(n=i.getItemByListId(h)){var y=i._calcItemPos(h-1);o=cc.tween(n).to(.2333,{position:cc.v2(y.x,y.y)}),h<=t+1&&(l=!0,o.call(function(){i._aniDelRuning=!1,e(t),delete i._aniDelCB})),o.start()}l||(i._aniDelRuning=!1,e(t),i._aniDelCB=null)},!0)}else e(t)},e.prototype.scrollTo=function(t,e,a,i){void 0===e&&(e=.5),void 0===a&&(a=null),void 0===i&&(i=!1);var o=this;if(o.checkInited(!1)){null==e?e=.5:e<0&&(e=0),t<0?t=0:t>=o._numItems&&(t=o._numItems-1),!o._virtual&&o._layout&&o._layout.enabled&&o._layout.updateLayout();var n,r,s=o.getItemPos(t);if(!s)return!1;switch(o._alignCalcType){case 1:n=s.left,n-=null!=a?o.node.width*a:o._leftGap,s=cc.v2(n,0);break;case 2:n=s.right-o.node.width,n+=null!=a?o.node.width*a:o._rightGap,s=cc.v2(n+o.content.width,0);break;case 3:r=s.top,r+=null!=a?o.node.height*a:o._topGap,s=cc.v2(0,-r);break;case 4:r=s.bottom+o.node.height,r-=null!=a?o.node.height*a:o._bottomGap,s=cc.v2(0,-r+o.content.height)}var c=o.content.getPosition();c=Math.abs(o._sizeType?c.y:c.x);var l=o._sizeType?s.y:s.x;Math.abs((null!=o._scrollPos?o._scrollPos:c)-l)>.5&&(o._scrollView.scrollToOffset(s,e),o._scrollToListId=t,o._scrollToEndTime=(new Date).getTime()/1e3+e,o._scrollToSo=o.scheduleOnce(function(){if(o._adheringBarrier||(o.adhering=o._adheringBarrier=!1),o._scrollPos=o._scrollToListId=o._scrollToEndTime=o._scrollToSo=null,i){var e=o.getItemByListId(t);e&&cc.tween(e).to(.1,{scale:1.05}).to(.1,{scale:1}).start()}},e+.1),e<=0&&o._onScrolling())}},e.prototype._calcNearestItem=function(){var t,e,a,i,o,n,r=this;r.nearestListId=null,r._virtual&&r._calcViewPos(),a=r.viewTop,i=r.viewRight,o=r.viewBottom,n=r.viewLeft;for(var s=!1,c=0;c<r.content.childrenCount&&!s;c+=r._colLineNum)if(t=r._virtual?r.displayData[c]:r._calcExistItemPos(c))switch(e=r._sizeType?(t.top+t.bottom)/2:e=(t.left+t.right)/2,r._alignCalcType){case 1:t.right>=n&&(r.nearestListId=t.id,n>e&&(r.nearestListId+=r._colLineNum),s=!0);break;case 2:t.left<=i&&(r.nearestListId=t.id,i<e&&(r.nearestListId+=r._colLineNum),s=!0);break;case 3:t.bottom<=a&&(r.nearestListId=t.id,a<e&&(r.nearestListId+=r._colLineNum),s=!0);break;case 4:t.top>=o&&(r.nearestListId=t.id,o>e&&(r.nearestListId+=r._colLineNum),s=!0)}if((t=r._virtual?r.displayData[r.displayItemNum-1]:r._calcExistItemPos(r._numItems-1))&&t.id==r._numItems-1)switch(e=r._sizeType?(t.top+t.bottom)/2:e=(t.left+t.right)/2,r._alignCalcType){case 1:i>e&&(r.nearestListId=t.id);break;case 2:n<e&&(r.nearestListId=t.id);break;case 3:o<e&&(r.nearestListId=t.id);break;case 4:a>e&&(r.nearestListId=t.id)}},e.prototype.prePage=function(t){void 0===t&&(t=.5),this.checkInited()&&this.skipPage(this.curPageNum-1,t)},e.prototype.nextPage=function(t){void 0===t&&(t=.5),this.checkInited()&&this.skipPage(this.curPageNum+1,t)},e.prototype.skipPage=function(t,e){var a=this;if(a.checkInited())return a._slideMode!=s.PAGE?cc.error("This function is not allowed to be called, Must SlideMode = PAGE!"):void(t<0||t*a.pageItemNum>=a._numItems||a.curPageNum!=t&&(a.curPageNum=t,a.pageChangeEvent&&cc.Component.EventHandler.emitEvents([a.pageChangeEvent],t),a.scrollTo(t*this.pageItemNum,e)))},e.prototype.calcCustomSize=function(t){var e=this;if(e.checkInited()){if(!e._itemTmp)return cc.error("Unset template item!");if(!e.renderEvent)return cc.error("Unset Render-Event!");e._customSize={};var a=cc.instantiate(e._itemTmp);e.content.addChild(a);for(var i=0;i<t;i++)cc.Component.EventHandler.emitEvents([e.renderEvent],a,i),a.height==e._itemSize.height&&a.width==e._itemSize.width||(e._customSize[i]=e._sizeType?a.height:a.width);return Object.keys(e._customSize).length||(e._customSize=null),a.removeFromParent(),a.destroy&&a.destroy(),e._customSize}},__decorate([p({type:cc.Enum(r),tooltip:!1})],e.prototype,"templateType",void 0),__decorate([p({type:cc.Node,tooltip:!1,visible:function(){return this.templateType==r.NODE}})],e.prototype,"tmpNode",void 0),__decorate([p({type:cc.Prefab,tooltip:!1,visible:function(){return this.templateType==r.PREFAB}})],e.prototype,"tmpPrefab",void 0),__decorate([p()],e.prototype,"_slideMode",void 0),__decorate([p({type:cc.Enum(s),tooltip:!1})],e.prototype,"slideMode",null),__decorate([p({type:cc.Float,range:[0,1,.1],tooltip:!1,slide:!0,visible:function(){return this._slideMode==s.PAGE}})],e.prototype,"pageDistance",void 0),__decorate([p({tooltip:!1,visible:function(){return this._slideMode==s.PAGE}})],e.prototype,"pageItemNum",void 0),__decorate([p({type:cc.Component.EventHandler,tooltip:!1,visible:function(){return this._slideMode==s.PAGE}})],e.prototype,"pageChangeEvent",void 0),__decorate([p()],e.prototype,"_virtual",void 0),__decorate([p({type:cc.Boolean,tooltip:!1})],e.prototype,"virtual",null),__decorate([p({tooltip:!1,visible:function(){var t=this.slideMode==s.NORMAL;return t||(this.cyclic=!1),t}})],e.prototype,"cyclic",void 0),__decorate([p({tooltip:!1,visible:function(){return this.virtual}})],e.prototype,"lackCenter",void 0),__decorate([p({tooltip:!1,visible:function(){var t=this.virtual&&!this.lackCenter;return t||(this.lackSlide=!1),t}})],e.prototype,"lackSlide",void 0),__decorate([p({type:cc.Integer})],e.prototype,"_updateRate",void 0),__decorate([p({type:cc.Integer,range:[0,6,1],tooltip:!1,slide:!0})],e.prototype,"updateRate",null),__decorate([p({type:cc.Integer,range:[0,12,1],tooltip:!1,slide:!0})],e.prototype,"frameByFrameRenderNum",void 0),__decorate([p({type:cc.Component.EventHandler,tooltip:!1})],e.prototype,"renderEvent",void 0),__decorate([p({type:cc.Enum(c),tooltip:!1})],e.prototype,"selectedMode",void 0),__decorate([p({tooltip:!1,visible:function(){return this.selectedMode==c.SINGLE}})],e.prototype,"repeatEventSingle",void 0),__decorate([p({type:cc.Component.EventHandler,tooltip:!1,visible:function(){return this.selectedMode>c.NONE}})],e.prototype,"selectedEvent",void 0),__decorate([p({serializable:!1})],e.prototype,"_numItems",void 0),__decorate([u,h(),d("\u81ea\u5b9a\u4e49\u7ec4\u4ef6/List"),f(cc.ScrollView),m(-5e3)],e)}(cc.Component);n.default=y,cc._RF.pop(),cc._RF.pop()},{}],LoadScene:[function(t,e,a){"use strict";cc._RF.push(e,"b0e52V6+r5NM6pLLlv4FAc1","LoadScene");var i=t,o=e,n=a;cc._RF.push(o,"2d6a1bYBRBHrah8ExiYrSsD","LoadScene"),Object.defineProperty(n,"__esModule",{value:!0}),n.LoadScene=void 0;var r=i("AppBase"),s=i("PopupManager"),c=i("EngineExUtils"),l=i("SceneBase"),u=i("ResUtil"),p=i("BlockInputManager"),h=i("AudioManager"),d=i("CommonUtil"),m=i("EventManager"),f=i("CServerItem"),_=i("HomeEnum"),y=cc._decorator,g=y.ccclass,v=y.property,P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mLoadSpine=null,e}return __extends(e,t),e.prototype.onLoad=function(){var e=this;cc.director.getScene().name="Load",m.EventManager.instance.clear(),f.CServerItem.instance.sessionId="",u.ResUtil.preload({paths:"uis/LoadUI",type:cc.Prefab,bundleName:_.Bundles.LOAD}),t.prototype.onLoad.call(this);var a=Math.floor(1e3*Math.random())%4+1;this.mLoadSpine.setSkin("skin"+a),this.mLoadSpine.setAnimation(0,"loading",!1),this.mLoadSpine.setCompleteListener(function(){var t=Math.floor(1e3*Math.random())%4+1;e.mLoadSpine.setSkin("skin"+t),e.mLoadSpine.setAnimation(0,"loading",!1)}),c.EngineExUtils.all();var i=new Date;d.CommonUtil.print("nowData-----:",i.getTime()),"Android"==cc.sys.os&&this.checkDuration(),h.AudioManager.instance.stopBgm()},e.prototype.start=function(){t.prototype.start.call(this),r.AppBase.init(),s.PopupManager.instance.init(),p.BlockInputManager.instance.init(),this.showLoadUI()},e.prototype.showLoadUI=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(a){switch(a.label){case 0:return[4,u.ResUtil.loadAsset({path:"uis/LoadUI",type:cc.Prefab,bundleName:_.Bundles.LOAD})];case 1:return(t=a.sent())&&((e=cc.instantiate(t)).name="LoadUI",e.parent=this.node),[2]}})})},e.prototype.checkDuration=function(){},__decorate([v(sp.Skeleton)],e.prototype,"mLoadSpine",void 0),__decorate([g],e)}(l.SceneBase);n.LoadScene=P,cc._RF.pop(),cc._RF.pop()},{}],LoadUIBase:[function(t,e,a){"use strict";cc._RF.push(e,"83be2KHfoZME5mGOcu+/ATy","LoadUIBase");var i=t,o=e,n=a;cc._RF.push(o,"8e0bfdaCf1Os4PIxtBnrmNH","LoadUIBase"),Object.defineProperty(n,"__esModule",{value:!0}),n.LoadUIBase=void 0;var r=i("ComponentBase"),s=i("EventManager"),c=i("AppProxy"),l=i("ResUtil"),u=i("AppBase"),p=i("StringUtil"),h=i("SceneManager"),d=i("HomeEnum"),m=i("StroageMgr"),f=i("HttpRequest"),_=i("CommonUtil"),y=i("DataManager"),g=i("RobotJSON"),v=i("UserDataProxy"),P=i("SensitiveUtils"),b=i("TimeUtil"),D=cc._decorator,S=D.ccclass,C=D.property,E=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.progressBar=null,e.progressLabel=null,e.progressBlock=null,e.nextSceneBundle="",e.nextSceneName="",e._isNet=!1,e._maxProgress=0,e._retryNum=0,e._progress=0,e._progressTag=!1,e._msg="",e._msgTag=!1,e.bundles=[],e.dirs=[],e.configs=null,e._bundleLoading=!1,e._jumpNext=!1,e._resData=null,e}return __extends(e,t),Object.defineProperty(e.prototype,"progress",{get:function(){return this._progress},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){t.prototype.onLoad.call(this)},e.prototype.onDestroy=function(){t.prototype.onDestroy.call(this)},e.prototype.start=function(){t.prototype.start.call(this),this.loadGame()},e.prototype.loadGame=function(){this.preloadRes(),this.loginServers()},e.prototype.loginServers=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return p.StringUtil.isEmpty(this.nextSceneBundle)&&!p.StringUtil.isEmpty(this.nextSceneName)&&cc.director.preloadScene(this.nextSceneName),(cc.sys.platform==cc.sys.BYTEDANCE_GAME||yzll.gameConfig.isZB)&&(yzll.gameConfig.isGM=!1,yzll.gameConfig.isTest=!1),this.setProgress("\u8bf7\u6c42\u670d\u52a1\u5668...",0,!0),this._maxProgress=.4,this._isNet=!0,[4,this.loginDeal()];case 1:return t.sent(),[4,this.platformLogin()];case 2:return t.sent(),[4,this.gameConfig()];case 3:return t.sent(),[4,this.getUserData()];case 4:return t.sent(),this.loginComplete(),[2]}})})},e.prototype.platformLogin=function(){var t=this;return new Promise(function(e){if(cc.sys.platform==cc.sys.WECHAT_GAME||cc.sys.platform==cc.sys.BYTEDANCE_GAME)mm.platform.login(function(a,i){a?(_.CommonUtil.print("issuc::",i),t.loginGameServer(i.code,e),m.StroageMgr.Inst.setValue({k:d.StroageKey.GameCode,v:"default"},i.code)):(_.CommonUtil.print("\u767b\u5f55\u5931\u8d25"),e())});else{var a=m.StroageMgr.Inst.getString({k:d.StroageKey.GameCode,v:"default"});"default"==a&&(a=Date.now().toString()+Math.floor(1e3*Math.random()),m.StroageMgr.Inst.setValue({k:d.StroageKey.GameCode,v:"default"},a)),t.loginGameServer(a,e)}})},e.prototype.loginGameServer=function(t,e){var a=0;cc.sys.platform==cc.sys.WECHAT_GAME?a=401:cc.sys.platform==cc.sys.BYTEDANCE_GAME&&(a=501);var i={channel:a,openId:t,projectName:(yzll.gameConfig.debug,"")},o=JSON.stringify({params:f.HttpRequest.inst.encryptStr(JSON.stringify(i))});_.CommonUtil.print("\u8bf7\u6c42\u767b\u9646\uff1a",i),_.CommonUtil.print("\u8bf7\u6c42\u767b\u9646\uff1a",o);var n={code:200,msg:null,data:{playerId:1943006,openId:"on5j26wRFDZr5h3gWN-W8O8y7xXM",token:"966f6f3a8b3c46a4971c63a9f505589d",nickName:null,head:null,realnameState:0,createTime:1758331745688,loginTime:1758629805295,ab:{key:"a",confUrl:null},endlessRank:306,endlessZBRank:0,props:{UserData:'{"newPlayer":false,"name":"\u73a9\u5bb6\u540d\u5b57","gold":822,"diamond":444,"power":99999,"passChapter":0,"curChapter":1,"lastLoginTime":1,"lastPowerTime":0,"isGetSideBarAward":0,"sweeping":1,"loopNum":1,"videoPower":0,"passWeatherChapter":2,"cursWeatherChapter":2,"combatEqus":[7,8,10,5],"superEquipId":0,"curWave":16,"plantLvDatas":[],"propData":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,202,54,6,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,315,null,332,319,28,49,11,9,null,3,12,null,9,51,14],"refreshNum":0,"dailyData":{"1":{"id":2,"num":100,"buyNum":0,"totalNum":10,"freeNum":0},"2":{"id":4,"num":2,"buyNum":0,"totalNum":1,"freeNum":0},"3":{"id":1014,"num":10,"buyNum":0,"totalNum":1,"freeNum":0},"4":{"id":1003,"num":10,"buyNum":0,"totalNum":1,"freeNum":0},"5":{"id":1008,"num":10,"buyNum":0,"totalNum":1,"freeNum":0},"6":{"id":1010,"num":2,"buyNum":0,"totalNum":1,"freeNum":0},"7":{"id":1013,"num":2,"buyNum":0,"totalNum":1,"freeNum":0},"8":{"id":1006,"num":10,"buyNum":0,"totalNum":1,"freeNum":0}},"passWave":0,"videoDiamondNum":0,"curWeatherWave":21,"plantDatas":[{"id":3,"lv":5},{"id":4,"lv":5},{"id":1,"lv":5},{"id":5,"lv":6},{"id":7,"lv":6},{"id":8,"lv":6},{"id":10,"lv":4}],"startGameRights":false,"unlockPlantIds":[4,1,5,7,8,10],"versionStr":"1.0.4","gameCourseData":{"curId":8,"completeId":8,"isComplete":false},"gameModel":2,"boxData":{"cdTime":1758564005412,"bigState":0,"level":3,"exp":1030},"goldData":{"videoNum":0,"mfNum":0},"endlessData":{"maxWave":23,"isReceive":1,"myRank":2,"playNum":0},"rewardBox":[null,{"1":1,"2":1,"3":1},{"1":1,"2":1,"3":1},{"1":1,"2":1,"3":1},{"1":1,"2":1,"3":1},{"1":1,"2":1,"3":1},{"1":1,"2":1,"3":1},{"1":1,"2":1,"3":1},{"1":1,"2":1,"3":1}],"roundReward":[null,1],"weatherRewardBox":[null,1,1]}',GuardingData:'{"btnStartTime":1758334345450,"unlockLevels":[1],"unlocklookAd":{}}',STJData:'{"reliveCnt":1,"hurtMulti":1,"btnStartTime":1758347022964,"unlockLevels":[1],"unlocklookAd":{},"stageLoseNum":{}}',RelicsData:'{"lookAdNum":0,"relicsMap":{},"radomNum":0}',SetData:'{"isOpenShake":true,"musicVolume":0.2766085052042199,"effectVolume":0.2944965878946196}'},realnameAge:0}};_.CommonUtil.print("\u767b\u9646\u6210\u529f\uff1a",n),this._resData=n.data,y.DataManager.playerId=n.data.playerId;var r=n.data.endlessRank;r&&(v.userDataProxy.mYesterdayRank=r),e()},e.prototype.setIsNewPlayer=function(t){y.DataManager.instance.mCreateTime=t;var e=new Date,a=b.TimeUtil.getCalendarDaysBetweenTimestamps(t,e.getTime());y.DataManager.instance.mIsNewPlayer=0==a,console.log("isNewPlayer:",y.DataManager.instance.mIsNewPlayer)},e.prototype.update=function(t){var e,a,i,o,n;this._isNet&&this._progress<this._maxProgress&&(this._progress=Number((this._progress+t).toFixed(2)),this._progressTag=!0),(null===(a=null===(e=this.progressBar)||void 0===e?void 0:e.node)||void 0===a?void 0:a.active)&&this._progressTag&&(this.progressBar.fillRange=this._progress),(null===(o=null===(i=this.progressLabel)||void 0===i?void 0:i.node)||void 0===o?void 0:o.active)&&this._msgTag&&(this.progressLabel.string=this._msg),(null===(n=this.progressBlock)||void 0===n?void 0:n.active)&&this._progressTag&&(this.progressBlock.x=this.progressBar.fillRange*this.progressBar.node.width-this.progressBar.node.width/2)},e.prototype.loginDeal=function(){return __awaiter(this,void 0,Promise,function(){return __generator(this,function(){return[2,new Promise(function(t){l.ResUtil.loadAsset({path:"uis/YZLLLoading",type:cc.Prefab,bundleName:d.Bundles.RES}).then(function(e){e.addRef();var a=cc.instantiate(e);a.active=!1,u.topNode.addChild(a),a.zIndex=cc.macro.MAX_ZINDEX,h.SceneManager.instance.setLoading(a),t()})})]})})},e.prototype.gameConfig=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return this.setProgress("\u8bfb\u53d6\u914d\u7f6e\u4e2d...",this._maxProgress),this._maxProgress=.8,g.RobotJSON.instance.loadJson(),P.default.loadConfigCsv(),[4,this.gameConfigRes({})];case 1:return t.sent(),[2]}})})},e.prototype.getUserData=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return this.setProgress("\u7528\u6237\u6570\u636e\u52a0\u8f7d\u4e2d...",this._maxProgress),this._maxProgress=.9,[4,this.userDataRes(this._resData)];case 1:return t.sent(),this.loadRes(),[2]}})})},e.prototype.loadRes=function(){this._jumpNext=!0,this.loadBundle()},e.prototype.preloadRes=function(){this.loadBundle()},e.prototype.loadBundle=function(){return __awaiter(this,void 0,void 0,function(){var t,e=this;return __generator(this,function(a){switch(a.label){case 0:return 0!==this.bundles.length?[3,3]:this._jumpNext?[4,this.resComplete()]:[3,2];case 1:a.sent(),this.nextScene(),a.label=2;case 2:return[2];case 3:return this._bundleLoading?[2]:(this._bundleLoading=!0,t=this.bundles[0],l.ResUtil.loadBundle({bundleName:t}).then(function(){t===e.nextSceneBundle&&cc.director.preloadScene(e.nextSceneName);for(var a=e.dirs.length-1;a>=0;a--)e.dirs[a].bundleName===t&&(l.ResUtil.preloadDir(e.dirs[a]),e.dirs.splice(a,1));e.bundles.shift(),e._bundleLoading=!1,e.loadBundle()}).catch(function(){e._bundleLoading=!1,e.loadBundle()}),[2])}})})},e.prototype.nextScene=function(){var t,e=this;(null===(t=this.progressLabel)||void 0===t?void 0:t.node)&&(this.progressLabel.node.active=!1),cc.director.getPhysicsManager().enabled=!0,cc.director.getPhysicsManager().enabledAccumulator=!0,cc.PhysicsManager.FIXED_TIME_STEP=.02,cc.PhysicsManager.VELOCITY_ITERATIONS=8,cc.PhysicsManager.POSITION_ITERATIONS=8,console.log("yzll.gameConfig.isZB:",yzll.gameConfig.isZB),yzll.gameConfig.isZB&&(v.userDataProxy.userData.gameCourseData.curId=99,v.userDataProxy.userData.gameCourseData.completeId=99,v.userDataProxy.userData.gameCourseData.isComplete=!0),v.userDataProxy.userData.curChapter=v.userDataProxy.userData.passChapter+1,v.userDataProxy.userData.curChapter<1&&(v.userDataProxy.userData.curChapter=1);var a=v.userDataProxy.userData.gameCourseData.curId;if(v.userDataProxy.userData.passChapter>=1&&a<3&&(a=99,v.userDataProxy.userData.gameCourseData.curId=99,v.userDataProxy.userData.gameCourseData.completeId=99,v.userDataProxy.userData.gameCourseData.isComplete=!0),a<3){var i=v.userDataProxy.userData.gameCourseData;i.curId=0,i.completeId=0,i.isComplete=!1,v.userDataProxy.userData.curWave=1,h.SceneManager.instance.runScene("Game","",function(){s.EventManager.instance.emit(c.AppEvent.ENTER_GAME),e.loadComplete()})}else h.SceneManager.instance.runScene(this.nextSceneName,"",function(){s.EventManager.instance.emit(c.AppEvent.ENTER_GAME),e.loadComplete()})},e.prototype.setProgress=function(t,e,a){void 0===a&&(a=!1),null!=this.progressLabel&&null!=t&&(this._msg=t,this._msgTag=!0),(a||e>this._progress)&&(this._progress=e,this._progressTag=!0)},e.prototype.resComplete=function(){return Promise.resolve(!0)},e.prototype.loadComplete=function(){},__decorate([C({type:cc.Sprite})],e.prototype,"progressBar",void 0),__decorate([C({type:cc.Label})],e.prototype,"progressLabel",void 0),__decorate([C({type:cc.Node})],e.prototype,"progressBlock",void 0),__decorate([C({tooltip:""})],e.prototype,"nextSceneBundle",void 0),__decorate([C({tooltip:""})],e.prototype,"nextSceneName",void 0),__decorate([S],e)}(r.ComponentBase);n.LoadUIBase=E,cc._RF.pop(),cc._RF.pop()},{}],LoadUI:[function(t,e,a){"use strict";cc._RF.push(e,"dd1eak42EZIy6KBDLnbWxBX","LoadUI");var i=t,o=e,n=a;cc._RF.push(o,"c7fddIecQRLHZsETuM8hTgv","LoadUI"),Object.defineProperty(n,"__esModule",{value:!0}),n.LoadUI=void 0;var r=i("LoadUIBase"),s=i("HomeEnum"),c=i("DataManager"),l=i("GameGlobal");i("game.config"),cc.dynamicAtlasManager.maxFrameSize=512,cc.macro.CLEANUP_IMAGE_CACHE=!1,cc.dynamicAtlasManager.enabled=!0;var u=cc._decorator,p=u.ccclass,h=(u.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this),l.GGC&&l.GGC.registerEvents(),this.bundles.push(s.Bundles.RES,s.Bundles.RES_JSON,s.Bundles.GAME)},e.prototype.loginComplete=function(){},e.prototype.gameConfigRes=function(){return new Promise(function(t){c.DataManager.instance.initConfig(t)})},e.prototype.userDataRes=function(t){return __awaiter(this,void 0,void 0,function(){var e=this;return __generator(this,function(){return c.DataManager.instance.init(),[2,new Promise(function(a){return __awaiter(e,void 0,void 0,function(){return __generator(this,function(){return c.DataManager.instance.initGameDataBase(t),a(),[2]})})})]})})},e.prototype.loadComplete=function(){},e.prototype.update=function(e){t.prototype.update.call(this,e)},__decorate([p],e)}(r.LoadUIBase));n.LoadUI=h,cc._RF.pop(),cc._RF.pop()},{}],Logger:[function(t,e,a){"use strict";cc._RF.push(e,"5850d7hyy9EFqAI5B2kSOeB","Logger");var i=e,o=a;cc._RF.push(i,"375c6Qf47RD6bmYoC6pXCjk","Logger");var n,r=function(t,e){var a="function"==typeof Symbol&&t[Symbol.iterator];if(!a)return t;var i,o,n=a.call(t),r=[];try{for(;(void 0===e||e-- >0)&&!(i=n.next()).done;)r.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(a=n.return)&&a.call(n)}finally{if(o)throw o.error}}return r},c=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(r(arguments[e]));return t};Object.defineProperty(o,"__esModule",{value:!0}),o.Logger=o.LoggerLevel=void 0,function(t){t[t.OFF=0]="OFF",t[t.ERROR=1]="ERROR",t[t.WARN=2]="WARN",t[t.INFO=3]="INFO",t[t.DEBUG=4]="DEBUG",t[t.ALL=5]="ALL"}(n=o.LoggerLevel||(o.LoggerLevel={})),function(t){var e="[ZS]",a=0;function i(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];a===n.ALL&&console.log.apply(console,__decorate([e],t))}function o(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];a>=n.DEBUG&&console.debug.apply(console,__decorate([e],t))}function r(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];a>=n.INFO&&console.info.apply(console,__decorate([e],t))}function s(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];a>=n.WARN&&console.warn.apply(console,__decorate([e],t))}function l(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];a>=n.ERROR&&console.error.apply(console,__decorate([e],t))}t.setLoggerLevel=function(t){a=t},t.log=i,t.debug=o,t.info=r,t.warn=s,t.error=l,t.v=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];i.apply(void 0,c(t))},t.d=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];o.apply(void 0,c(t))},t.i=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];r.apply(void 0,c(t))},t.w=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];s.apply(void 0,c(t))},t.e=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];l.apply(void 0,c(t))},t.realtimeDebug=function(){},t.realtimeInfo=function(){},t.realtimeWarn=function(){},t.realtimeError=function(){},t.setRealtimeFilterMsg=function(){},t.addRealtimeFilterMsg=function(){}}(o.Logger||(o.Logger={})),cc._RF.pop(),cc._RF.pop()},{}],LongPress:[function(t,e,a){"use strict";cc._RF.push(e,"cdd2b3Id4NAIoDzvNuM7sS0","LongPress");var i,o=e,n=a;cc._RF.push(o,"55568ffC3BEoKVBe435WJEO","LongPress"),Object.defineProperty(n,"__esModule",{value:!0}),n.LONG_PRESS="longpress",function(t){t[t.Immediately=1]="Immediately",t[t.AfterLoosing=2]="AfterLoosing",t[t.Duration=3]="Duration"}(i=n.TriggerWay||(n.TriggerWay={}));var r=cc._decorator,s=r.ccclass,c=r.property,l=r.menu,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.triggerTime=2,e.trggerDelayTime=.05,e.trggerWay=i.Immediately,e.longPressEvents=[],e.hasAccomplished=!1,e._isComplateLongPress=!1,e.durationTime=0,e}return __extends(e,t),e.prototype.onEnable=function(){this._isComplateLongPress=!1,this.registerNodeEvent(),this.unscheduleAllCallbacks()},e.prototype.onDisable=function(){this._isComplateLongPress=!1,this.unregisterNodeEvent(),this.unscheduleAllCallbacks()},e.prototype.registerNodeEvent=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchCancel,this)},e.prototype.unregisterNodeEvent=function(){this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this.onTouchCancel,this)},e.prototype.onTouchStart=function(){this.durationTime=0,this.hasAccomplished=!1,this._isComplateLongPress=!1,this.scheduleOnce(this.onPressAccomplished.bind(this),this.triggerTime)},e.prototype.onTouchEnd=function(){this.hasAccomplished&&(this.hasAccomplished=!1,this.trigger()),this._isComplateLongPress=!1,this.unscheduleAllCallbacks()},e.prototype.onTouchCancel=function(){this.hasAccomplished&&(this.hasAccomplished=!1,this.trigger()),this._isComplateLongPress=!1,this.unscheduleAllCallbacks()},e.prototype.update=function(t){this._isComplateLongPress&&this.trggerWay==i.Duration&&(this.durationTime-=t,this.durationTime<=0&&(this.trigger(),this.durationTime=this.trggerDelayTime))},e.prototype.onPressAccomplished=function(){this.trggerWay===i.Immediately?this.trigger():this.trggerWay===i.AfterLoosing&&(this.hasAccomplished=!0),this._isComplateLongPress=!0},e.prototype.trigger=function(){cc.Component.EventHandler.emitEvents(this.longPressEvents,this),this.node.emit(n.LONG_PRESS,this)},e.prototype.isComplateLongPress=function(){return this._isComplateLongPress},__decorate([c({tooltip:!1})],e.prototype,"triggerTime",void 0),__decorate([c({tooltip:!1})],e.prototype,"trggerDelayTime",void 0),__decorate([c({type:cc.Enum(i),tooltip:!1})],e.prototype,"trggerWay",void 0),__decorate([c({type:cc.Component.EventHandler,tooltip:!1})],e.prototype,"longPressEvents",void 0),__decorate([s,l("Utils/Components/LongPress")],e)}(cc.Component);n.default=u,cc._RF.pop(),cc._RF.pop()},{}],MBFailPopup:[function(t,e,a){"use strict";cc._RF.push(e,"a00fcZnDGFGcoKYw5A1gbGO","MBFailPopup");var i=t,o=e,n=a;cc._RF.push(o,"cb366V7EbpMEboqH0cLyhfc","MBFailPopup");var r=i("AudioManager"),s=i("PopupBase"),c=i("SceneManager"),l=i("AdsMgr"),u=i("MBGameDataProxy"),p=cc._decorator,h=p.ccclass,d=(p.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.init=function(){u.mbGameDataProxy.fail(),u.mbGameDataProxy.btnStartTime=(new Date).getTime(),r.AudioManager.instance.playEffectPath("sounds/fail","res_MB")},e.prototype.onClickBtnBack=function(){this.removeUI(),c.SceneManager.instance.runScene("Home","")},e.prototype.onClickBtnRestart=function(){var t=this;l.default.showVideoAds({id:1,eventId:"mb_game_enter",success:function(){t.removeUI(),c.SceneManager.instance.runScene("mb","")},fail:function(t){return console.log(t)},error:function(t){return console.log(t)}},!0)},__decorate([h],e)}(s.PopupBase));n.default=d,cc._RF.pop(),cc._RF.pop()},{}],MBGameDataProxy:[function(t,e,a){"use strict";cc._RF.push(e,"aceddRpKwNHcIIN9pREqVvQ","MBGameDataProxy");var i=t,o=e,n=a;cc._RF.push(o,"bd925TIU1BBb5+iyFbj9qow","MBGameDataProxy"),Object.defineProperty(n,"__esModule",{value:!0}),n.mbGameDataProxy=n.MBGameDataProxy=n.MBGameData=void 0;var r=i("ProxyBase"),s=i("DataManager"),c=function(){this.failCount=0,this.weaponRefreshCDData={},this.btnStartTime=0};n.MBGameData=c;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"failCount",{get:function(){return this._data.failCount},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"btnStartTime",{get:function(){return this._data.btnStartTime},set:function(t){this._data.btnStartTime=t,this.saveData()},enumerable:!1,configurable:!0}),e.prototype.enterGame=function(){for(var t in this._data.weaponRefreshCDData)--this._data.weaponRefreshCDData[t],this._data.weaponRefreshCDData[t]<=0&&delete this._data.weaponRefreshCDData[t];this.saveData()},e.prototype.isEquipCd=function(t){return this._data.weaponRefreshCDData[t]&&this._data.weaponRefreshCDData[t]>0},e.prototype.getEquipCD=function(t){return this._data.weaponRefreshCDData[t]||0},e.prototype.enterCD=function(t,e){this._data.weaponRefreshCDData[t]=e,this.saveData()},e.prototype.saveData=function(){s.DataManager.instance.writeGameDataBase(r.ProxyKey.MBData,this._data)},e.prototype.fail=function(){this._data.failCount++,this._data.btnStartTime=(new Date).getTime(),this.saveData()},e.prototype.win=function(){this._data.failCount=0,this._data.btnStartTime=(new Date).getTime(),this.saveData()},e}(r.ProxyBase);n.MBGameDataProxy=l,n.mbGameDataProxy=new l(c),cc._RF.pop(),cc._RF.pop()},{}],MBScene:[function(t,e,a){"use strict";cc._RF.push(e,"8992efrcx1CNbBwK/kc4aXW","MBScene");var i=t,o=e,n=a;cc._RF.push(o,"e70d0zByqJCZYHIEdWOObAy","MBScene");var r=i("AudioManager"),s=i("PopupManager"),c=i("SceneBase"),l=i("HomeEnum"),u=i("DataManager"),p=i("NodePoolManager"),h=i("BattleDataProxy"),d=i("MBGameDataProxy"),m=i("MB_AttrUI"),f=i("MB_BagUI"),_=i("MB_BagView"),y=i("MB_BattleView"),g=cc._decorator,v=g.ccclass,P=g.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bagView=null,e.battleView=null,e.bagUI=null,e.attrUI=null,e.nGameCarema=null,e.isRounding=!1,e._curStage=0,e._maxStage=0,e}var a;return __extends(e,t),a=e,Object.defineProperty(e,"instance",{get:function(){return a._instance},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"curStage",{get:function(){return this._curStage},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxStage",{get:function(){return this._maxStage},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this.isRounding=!1,d.mbGameDataProxy.enterGame(),a._instance=this},e.prototype.start=function(){r.AudioManager.instance.playBgmPath("sounds/battleBGM",l.Bundles.RES),this.init()},e.prototype.update=function(t){for(var e in h.battleDataProxy.audioFilterInfo)h.battleDataProxy.audioFilterInfo[e].time-=t},e.prototype.onDestroy=function(){t.prototype.onDestroy.call(this),a._instance=null,p.default.instance.clearAllPoolPrefab()},e.prototype.init=function(){this._curStage=1;var t=0;for(var e in u.DataManager.instance.eData.data_bagstage)t++;this._maxStage=t,this.bagView.init(),this.battleView.init(),this.attrUI.init(),this.enterReady()},e.prototype.enterReady=function(){this.bagView.onEnterReady(),this.battleView.onEnterReady(),this.bagUI.onEnterReady(),this.isRounding=!1},e.prototype.enterBattle=function(){this.isRounding=!0,this.bagView.onEnterBattle(),this.battleView.onEnterBattle(),this.bagUI.onEnterBattle()},e.prototype.win=function(){this._curStage++,this._curStage>this._maxStage?s.PopupManager.instance.show({bundleName:"res_MB",path:"popups/MBWinPopup",keep:!0,params:{}}):this.enterReady()},e.prototype.fail=function(){s.PopupManager.instance.show({bundleName:"res_MB",path:"popups/MBFailPopup",keep:!0,params:{}})},e._instance=null,__decorate([P(_.default)],e.prototype,"bagView",void 0),__decorate([P(y.default)],e.prototype,"battleView",void 0),__decorate([P(f.default)],e.prototype,"bagUI",void 0),__decorate([P(m.default)],e.prototype,"attrUI",void 0),__decorate([P(cc.Node)],e.prototype,"nGameCarema",void 0),a=__decorate([v],e)}(c.SceneBase);n.default=b,cc._RF.pop(),cc._RF.pop()},{}],MBSettingPopup:[function(t,e,a){"use strict";cc._RF.push(e,"cda3alh76BHJKLraPOoI30y","MBSettingPopup");var i=t,o=e,n=a;cc._RF.push(o,"f8f64suQ/1He75bgbmgeAL/","MBSettingPopup");var r=i("GameUIManager"),s=i("AudioManager"),c=i("EventManager"),l=i("AppProxy"),u=i("PopupBase"),p=i("SceneManager"),h=i("MBGameDataProxy"),d=i("UserSetDataProxy"),m=i("MBScene"),f=cc._decorator,_=f.ccclass,y=f.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nShake=null,e.musicVolumeSlider=null,e.musicVolumePro=null,e.effectVolumeSlider=null,e.effectVolumePro=null,e.mMusicVolumeLab=null,e.mEffectVolumeLab=null,e.mShakeLab=null,e}return __extends(e,t),e.prototype.init=function(){c.EventManager.instance.on(s.EAudioEvent.BACKGROUND_AUDIO_SWITCH_CHANGE,this.updateView,this),c.EventManager.instance.on(s.EAudioEvent.EFFECT_AUDIO_SWITCH_CHANGE,this.updateView,this),this.updateView()},e.prototype.onDisable=function(){c.EventManager.instance.off(s.EAudioEvent.BACKGROUND_AUDIO_SWITCH_CHANGE,this.updateView,this),c.EventManager.instance.off(s.EAudioEvent.EFFECT_AUDIO_SWITCH_CHANGE,this.updateView,this),t.prototype.onDisable.call(this),d.userSetDataProxy.saveData()},e.prototype.updateView=function(){this.musicVolumeSlider.progress=d.userSetDataProxy.setData.musicVolume,this.musicVolumePro.fillRange=d.userSetDataProxy.setData.musicVolume,this.effectVolumeSlider.progress=d.userSetDataProxy.setData.effectVolume,this.effectVolumePro.fillRange=d.userSetDataProxy.setData.effectVolume;var t=d.userSetDataProxy.setData.isOpenShake;this.nShake.getChildByName("Close").active=!t,this.nShake.getChildByName("Open").active=t,this.mShakeLab.string=t?"\u5f00":"\u5173",this.mMusicVolumeLab.string=(100*d.userSetDataProxy.setData.musicVolume).toFixed(0),this.mEffectVolumeLab.string=(100*d.userSetDataProxy.setData.effectVolume).toFixed(0)},e.prototype.onClickBtnEffectAudio=function(){},e.prototype.onClickBtnMusicAudio=function(){},e.prototype.onMusicVolumeSlider=function(t){this.musicVolumeSlider.progress=t.progress,this.musicVolumePro.fillRange=t.progress,s.AudioManager.instance.setBgmVolume(t.progress),d.userSetDataProxy.setData.musicVolume=t.progress,this.mMusicVolumeLab.string=(100*d.userSetDataProxy.setData.musicVolume).toFixed(0)},e.prototype.onEffectVolumeSlider=function(t){this.effectVolumeSlider.progress=t.progress,this.effectVolumePro.fillRange=t.progress,s.AudioManager.instance.setEffectVolume(t.progress),d.userSetDataProxy.setData.effectVolume=t.progress,this.mEffectVolumeLab.string=(100*d.userSetDataProxy.setData.effectVolume).toFixed(0)},e.prototype.onClickBtnShake=function(){d.userSetDataProxy.setVibrate(!d.userSetDataProxy.setData.isOpenShake),this.updateView()},e.prototype.onClickBtnBack=function(){m.default.instance.isRounding?r.gameUIMgr.showTips("\u56de\u5408\u7ed3\u675f\u540e\u624d\u80fd\u9000\u51fa"):(h.mbGameDataProxy.btnStartTime=(new Date).getTime(),this.removeUI(),p.SceneManager.instance.runScene("Home","",function(){c.EventManager.instance.emit(l.AppEvent.ENTER_GAME)}))},e.prototype.onClickBtnClose=function(){this.removeUI()},__decorate([y(cc.Node)],e.prototype,"nShake",void 0),__decorate([y(cc.Slider)],e.prototype,"musicVolumeSlider",void 0),__decorate([y(cc.Sprite)],e.prototype,"musicVolumePro",void 0),__decorate([y(cc.Slider)],e.prototype,"effectVolumeSlider",void 0),__decorate([y(cc.Sprite)],e.prototype,"effectVolumePro",void 0),__decorate([y(cc.Label)],e.prototype,"mMusicVolumeLab",void 0),__decorate([y(cc.Label)],e.prototype,"mEffectVolumeLab",void 0),__decorate([y(cc.Label)],e.prototype,"mShakeLab",void 0),__decorate([_],e)}(u.PopupBase);n.default=g,cc._RF.pop(),cc._RF.pop()},{}],MBWinPopup:[function(t,e,a){"use strict";cc._RF.push(e,"73d7artX2tLKJQIdGvtLq1t","MBWinPopup");var i=t,o=e,n=a;cc._RF.push(o,"be07fLfi9pDHJ14yhVUOC/K","MBWinPopup");var r=i("AnimationMgr"),s=i("AudioManager"),c=i("ResUtil"),l=i("PopupBase"),u=i("SceneManager"),p=i("AdsMgr"),h=i("HomeEnum"),d=i("DataManager"),m=i("MBGameDataProxy"),f=i("UserDataProxy"),_=cc._decorator,y=_.ccclass,g=_.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mTips1=null,e.mTips2=null,e.mItemLayout=null,e._reawards=[],e._isCanClick=!0,e}return __extends(e,t),e.prototype.init=function(e){t.prototype.init.call(this,e),m.mbGameDataProxy.btnStartTime=(new Date).getTime();var a=[];s.AudioManager.instance.playEffectPath("sounds/win","res_MB");var i=Math.floor(1e3*Math.random())%3+1,o=d.DataManager.instance.eData.datasettlement[1]["des"+i].split("|");this.mTips1.string=o[0],this.mTips2.string=o[1],this._reawards=a;for(var n=d.DataManager.instance.eData.datapara[1804].num.split("|"),r=0,l=n.length;r<l;r++){var u=n[r].split("_");a.push({id:parseInt(u[0]),num:parseInt(u[1])})}a.length;var p=function(t){var e=d.DataManager.instance.eData.dataitem[a[t].id],i=f.mItemLayout.children[t];i||((i=cc.instantiate(f.mItemLayout.children[0])).parent=f.mItemLayout),i.active=!0;var o=i.getChildByName("itemBg").getComponent(cc.Sprite);c.ResUtil.loadAsset({path:"textures/public/item_bg"+e.qulity,type:cc.SpriteFrame,bundleName:h.Bundles.GAME}).then(function(t){o.spriteFrame=t}).catch(function(t){console.log("error:",t)});var n=i.getChildByName("itemImg").getComponent(cc.Sprite);c.ResUtil.loadAsset({path:"textures/item/"+e.icon,type:cc.SpriteFrame,bundleName:h.Bundles.GAME}).then(function(t){n.spriteFrame=t}).catch(function(t){console.log("error:",t)}),i.getChildByName("itemNum").getComponent(cc.Label).string="x"+a[t].num},f=this;for(r=0,l=a.length;r<l;r++)p(r);m.mbGameDataProxy.win()},e.prototype.toHome=function(){var t=this;this._isCanClick=!1;for(var e=this.node.getChildByName("layout"),a=0,i=this._reawards.length,o=i>0?2:0,n=function(o){var n=e.children[o];if(!n.active)return"continue";var c=s._reawards[a];s.scheduleOnce(function(){c&&(n.active=!1,r.default.instance.showAwardAni(c,t.node,n,0,cc.v3(-250,c.id>6?-850:850)),f.userDataProxy.addProp(c.id,c.num,a+1==i))},.1*a),a++},s=this,c=0;c<e.children.length;++c)n(c);this.scheduleOnce(function(){u.SceneManager.instance.runScene("Home",""),t.removeUI()},.1*a+o)},e.prototype.resetGame=function(){var t=this;this._isCanClick=!1;for(var e=this.node.getChildByName("layout"),a=0,i=this._reawards.length,o=i>0?2:0,n=function(o){var n=e.children[o];if(!n.active)return"continue";var c=s._reawards[a];s.scheduleOnce(function(){c&&(n.active=!1,r.default.instance.showAwardAni(c,t.node,n,0,cc.v3(-250,c.id>6?-850:850)),f.userDataProxy.addProp(c.id,c.num,a+1==i))},.1*a),a++},s=this,c=0;c<e.children.length;++c)n(c);this.scheduleOnce(function(){u.SceneManager.instance.runScene("mb",""),t.removeUI()},.1*a+o)},e.prototype.onClickBtnClose=function(){this._isCanClick&&this.toHome()},e.prototype.onClickBtnRestart=function(){var t=this;this._isCanClick&&p.default.showVideoAds({id:1,eventId:"mb_game_enter",success:function(){t.resetGame()},fail:function(t){return console.log(t)},error:function(t){return console.log(t)}},!0)},__decorate([g(cc.Label)],e.prototype,"mTips1",void 0),__decorate([g(cc.Label)],e.prototype,"mTips2",void 0),__decorate([g(cc.Node)],e.prototype,"mItemLayout",void 0),__decorate([y],e)}(l.PopupBase);n.default=v,cc._RF.pop(),cc._RF.pop()},{}],MB_Actor:[function(t,e,a){"use strict";cc._RF.push(e,"5e3bdc70IVMCboBSk5IFSnt","MB_Actor");var i=t,o=e,n=a;cc._RF.push(o,"3acf4gMXgNF0qFRrNlw3mSv","MB_Actor");var r=i("AudioManager"),s=i("EventManager"),c=i("RandomUtil"),l=i("Util"),u=i("NumericData"),p=i("E_AttrType"),h=i("MB_GameEnum"),d=i("MB_PopHurt"),m=i("MBScene"),f=cc._decorator,_=f.ccclass,y=f.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nHpView=null,e.spRecoverAnim=null,e.spStunAnim=null,e._hp=0,e._actorAttribute=null,e._team=h.E_MB_ActorTeam.PLAYER,e._isStun=!1,e.attackTarget=null,e}return __extends(e,t),e.prototype.onLoad=function(){},e.prototype.onDestroy=function(){},e.prototype.init=function(){this.nHpView.getChildByName("HpChange").getComponent(cc.Sprite).fillRange=1,this.nHpView.getChildByName("HpChange").active=!1,this.nHpView.getChildByName("HpValue").getComponent(cc.Sprite).fillRange=1,this.initAttribute(),this._hp=this.getAttribute(p.E_AttrType.HP).value,this.onInit()},e.prototype.initAttribute=function(){this._actorAttribute=new u.NumericData,this._actorAttribute.init(p.E_AttrType)},e.prototype.onInit=function(){},e.prototype.onEnterReady=function(){},e.prototype.onEnterBattle=function(){this._hp=this.getAttribute(p.E_AttrType.HP).value},e.prototype.startRound=function(){return __awaiter(this,void 0,Promise,function(){return __generator(this,function(t){switch(t.label){case 0:return s.EventManager.instance.emit(h.E_MB_BattleEvent.ROUND_START,this._team),[4,l.default.promiseDelay(.1*m.default.instance.battleView.gameSpeed)];case 1:return t.sent(),this._isStun?(this._isStun=!1,this.spStunAnim.clearTracks(),this.spStunAnim.node.active=!1,[2,Promise.resolve()]):[4,this.dealRecove()];case 2:return t.sent(),[4,this.dealAttack()];case 3:return t.sent(),[4,this.dealCombo()];case 4:return t.sent(),[4,this.dealCounterAttack()];case 5:return t.sent(),[4,l.default.promiseDelay(.1)];case 6:return t.sent(),[2,Promise.resolve()]}})})},e.prototype.dealRecove=function(){return __awaiter(this,void 0,Promise,function(){var t,e;return __generator(this,function(a){switch(a.label){case 0:return t=this.getAttribute(p.E_AttrType.RECOVER).value,e=this.getAttribute(p.E_AttrType.HP).value,this._hp<e&&t>0&&c.RandomUtil.randomInt(0,1e3)<200?(this.beRecover(this.getAttribute(p.E_AttrType.HP).value*t/100),[4,l.default.promiseDelay(.1*m.default.instance.battleView.gameSpeed)]):[3,2];case 1:a.sent(),a.label=2;case 2:return[2,Promise.resolve()]}})})},e.prototype.dealAttack=function(){return __awaiter(this,void 0,Promise,function(){var t=this;return __generator(this,function(e){switch(e.label){case 0:return[4,l.default.promiseDelay(.1*m.default.instance.battleView.gameSpeed)];case 1:return e.sent(),[2,new Promise(function(e){t.attackTarget.isDead()?e():t.playAttackAnim(function(){t.playIdleAnim(),e()})})]}})})},e.prototype.dealCombo=function(){return __awaiter(this,void 0,Promise,function(){var t=this;return __generator(this,function(e){switch(e.label){case 0:return c.RandomUtil.randomInt(0,1e3)<10*this.getAttribute(p.E_AttrType.COMBO).value?[4,l.default.promiseDelay(.1*m.default.instance.battleView.gameSpeed)]:[3,2];case 1:return e.sent(),[2,new Promise(function(e){t.attackTarget.isDead()?e():(m.default.instance.battleView.popHurt(0,t.node.getPosition().add(cc.v2(0,200)),d.EBattlePopHurtType.COMBO),t.playAttackAnim(function(){t.playIdleAnim(),e()}))})];case 2:return[2,Promise.resolve()]}})})},e.prototype.dealCounterAttack=function(){return __awaiter(this,void 0,Promise,function(){var t=this;return __generator(this,function(e){switch(e.label){case 0:return!this._isStun&&!this.attackTarget.isDead()&&c.RandomUtil.randomInt(0,1e3)<10*this.attackTarget.getAttribute(p.E_AttrType.REBATE).value?[4,l.default.promiseDelay(.1*m.default.instance.battleView.gameSpeed)]:[3,2];case 1:return e.sent(),[2,new Promise(function(e){m.default.instance.battleView.popHurt(0,t.attackTarget.node.getPosition().add(cc.v2(0,200)),d.EBattlePopHurtType.REBATE),t.attackTarget.playAttackAnim(function(){e()})})];case 2:return[2,Promise.resolve()]}})})},e.prototype.endRound=function(){s.EventManager.instance.emit(h.E_MB_BattleEvent.ROUND_END,this._team)},e.prototype.updateHpView=function(t,e){var a=this;if(0!=e){var i=t/e,o=this.nHpView.getChildByName("HpValue").getComponent(cc.Sprite);if(o.fillRange<i)cc.tween(o).to(.1,{fillRange:i}).start();else{o.fillRange=i;var n=this.nHpView.getChildByName("HpChange").getComponent(cc.Sprite);n.node.active=!0;var r=Math.abs(i-n.fillRange);cc.tween(n).to(r,{fillRange:i}).call(function(){n.node.active=!1,i<=0&&(a.nHpView.active=!1)}).start()}}},e.prototype.beHurt=function(t,e){var a=t.getAttribute(p.E_AttrType.ATK).value-this.getAttribute(p.E_AttrType.DEF).value;a<=0&&(a=1),c.RandomUtil.randomInt(0,1e3)<10*this.getAttribute(p.E_AttrType.DODGE).value?m.default.instance.battleView.popHurt(0,this.node.getPosition().add(cc.v2(0,180)),d.EBattlePopHurtType.EVASION):(c.RandomUtil.randomInt(0,1e3)<10*t.getAttribute(p.E_AttrType.STUN).value&&(this._isStun=!0,this.spStunAnim.node.active=!0,this.spStunAnim.clearTracks(),this.spStunAnim.setAnimation(0,"start",!0)),e&&(a*=2),t.beRecover(a*t.getAttribute(p.E_AttrType.BLOOD).value/100),this._hp-=a,m.default.instance.battleView.popHurt(a,this.node.getPosition().add(cc.v2(0,c.RandomUtil.randomInt(200,250))),e?d.EBattlePopHurtType.CRIT:d.EBattlePopHurtType.COMMON),this._hp<0&&(this._hp=0),this.playHitAnim(),this.beRepel(this._team==h.E_MB_ActorTeam.PLAYER,20),this.updateHpView(this._hp,this.getAttribute(p.E_AttrType.HP).value),this.isDead()&&this.playDeadAnim())},e.prototype.beRepel=function(t,e){var a=this,i=this.node.x,o=this.node.x+(t?-e:e);cc.tween(this.node).to(.2,{x:o},{easing:"quintOut"}).call(function(){a.node.x=i}).start()},e.prototype.beRecover=function(t){var e=this;if(!(this.isDead()||t<=0)){t=Math.floor(t);var a=this.getAttribute(p.E_AttrType.HP).value;this._hp=Math.min(this._hp+t,a),this.updateHpView(this._hp,a),r.AudioManager.instance.playEffectPath("sounds/se_recover","res_MB"),this.spRecoverAnim&&(this.spRecoverAnim.node.active=!0,this.spRecoverAnim.clearTracks(),this.spRecoverAnim.setAnimation(0,"start",!1),this.spRecoverAnim.setCompleteListener(function(){e.spRecoverAnim.setCompleteListener(null),e.spRecoverAnim.node.active=!1})),m.default.instance.battleView.popHurt(t,this.node.getPosition().add(cc.v2(0,200)),d.EBattlePopHurtType.RECOVER)}},e.prototype.playIdleAnim=function(){},e.prototype.playAttackAnim=function(){},e.prototype.playDeadAnim=function(){},e.prototype.playMoveAnim=function(){},e.prototype.isDead=function(){return this._hp<=0},e.prototype.getAttribute=function(t){return this._actorAttribute.getNumeric(t)},e.prototype.playHitAnim=function(){},__decorate([y(cc.Node)],e.prototype,"nHpView",void 0),__decorate([y(sp.Skeleton)],e.prototype,"spRecoverAnim",void 0),__decorate([y(sp.Skeleton)],e.prototype,"spStunAnim",void 0),__decorate([_],e)}(cc.Component);n.default=g,cc._RF.pop(),cc._RF.pop()},{}],MB_AttrMgr:[function(t,e,a){"use strict";cc._RF.push(e,"ef8fbRaEydMto8UgWLY0aGH","MB_AttrMgr");var i=t,o=e,n=a;cc._RF.push(o,"83890kT2WxOabp/h86fScLQ","MB_AttrMgr");var r=function(t,e){var a="function"==typeof Symbol&&t[Symbol.iterator];if(!a)return t;var i,o,n=a.call(t),r=[];try{for(;(void 0===e||e-- >0)&&!(i=n.next()).done;)r.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(a=n.return)&&a.call(n)}finally{if(o)throw o.error}}return r};Object.defineProperty(n,"__esModule",{value:!0}),n.MB_AttrMgr=void 0;var c=i("DataManager"),l=i("E_AttrType"),u=function(){function t(){this.attrNames=["","\u653b\u51fb","\u9632\u5fa1","\u751f\u547d","\u901f\u5ea6","\u95ea\u907f","\u51fb\u6655","\u53cd\u51fb","\u8fde\u51fb","\u5438\u8840","\u66b4\u51fb","\u6062\u590d"]}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t.prototype.getPlayerAttrMap=function(t){var e=r(c.DataManager.instance.eData.datapara[1803].num.split("|").map(Number),4),a=e[0],i=e[1],o=e[2],n=e[3],s=new Map([[l.E_AttrType.ATK,a],[l.E_AttrType.DEF,i],[l.E_AttrType.HP,o],[l.E_AttrType.SPD,n]]),u=new Map([[l.E_AttrType.ATK,"atk"],[l.E_AttrType.DEF,"def"],[l.E_AttrType.HP,"hp"],[l.E_AttrType.SPD,"speed"],[l.E_AttrType.DODGE,"att1"],[l.E_AttrType.STUN,"att2"],[l.E_AttrType.REBATE,"att3"],[l.E_AttrType.COMBO,"att4"],[l.E_AttrType.BLOOD,"att5"],[l.E_AttrType.CRIT,"att6"],[l.E_AttrType.RECOVER,"att7"]]);return t.forEach(function(t){var e=c.DataManager.instance.eData.data_bagweapon[t];u.forEach(function(t,a){var i=Number((e[t]*(a>4?100:1)).toFixed(2));i>0&&(s.has(a)?s.set(a,s.get(a)+i):s.set(a,i))})}),s},t.prototype.getEquipAttrMap=function(t){var e=new Map,a=new Map([[l.E_AttrType.ATK,"atk"],[l.E_AttrType.DEF,"def"],[l.E_AttrType.HP,"hp"],[l.E_AttrType.SPD,"speed"],[l.E_AttrType.DODGE,"att1"],[l.E_AttrType.STUN,"att2"],[l.E_AttrType.REBATE,"att3"],[l.E_AttrType.COMBO,"att4"],[l.E_AttrType.BLOOD,"att5"],[l.E_AttrType.CRIT,"att6"],[l.E_AttrType.RECOVER,"att7"]]),i=c.DataManager.instance.eData.data_bagweapon[t];return a.forEach(function(t,a){var o=i[t]*(a>4?100:1);o>0&&(e.has(a)?e.set(a,e.get(a)+o):e.set(a,o))}),e},t}();n.MB_AttrMgr=u,cc._RF.pop(),cc._RF.pop()},{}],MB_AttrUI:[function(t,e,a){"use strict";cc._RF.push(e,"3266bjCaWZL1pgMWsW8klkM","MB_AttrUI");var i=t,o=e,n=a;cc._RF.push(o,"3d57139mn5PqYUIx9m3k4LV","MB_AttrUI");var r=i("MathUtil"),s=i("E_AttrType"),c=i("MB_AttrMgr"),l=i("MBScene"),u=cc._decorator,p=u.ccclass,h=u.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nTotalAttrView=null,e.nEquipAttrView=null,e._initTotalY=0,e._initEquipY=0,e}return __extends(e,t),e.prototype.init=function(){this._initTotalY=this.nTotalAttrView.y,this._initEquipY=this.nEquipAttrView.y,this.nTotalAttrView.y=this._initEquipY-700,this.nEquipAttrView.y=this._initTotalY-700,this.nEquipAttrView.opacity=0,this.nTotalAttrView.opacity=0,this.nEquipAttrView.active=!1,this.nTotalAttrView.active=!1,this.node.active=!1},e.prototype.showTotalAttr=function(){this.node.active=!0,this.nTotalAttrView.active=!0;var t=c.MB_AttrMgr.instance.getPlayerAttrMap(l.default.instance.bagView.eqiupedIds),e=[s.E_AttrType.ATK,s.E_AttrType.DEF,s.E_AttrType.HP,s.E_AttrType.SPD];this.nTotalAttrView.getChildByName("BaseAttrView").children.forEach(function(a,i){a.getChildByName("Name").getComponent(cc.Label).string=c.MB_AttrMgr.instance.attrNames[e[i]],a.getChildByName("Value").getComponent(cc.Label).string=r.MathUtil.formatValue(t.get(e[i])),t.delete(e[i])});for(var a=this.nTotalAttrView.getChildByName("ExAttrView"),i=t.size-a.childrenCount;i>0;){var o=cc.instantiate(a.children[0]);a.addChild(o),i--}var n=Array.from(t.keys());a.children.forEach(function(e,a){if(e.active=n.length>a,e.active){var i=n[a];e.getChildByName("Name").getComponent(cc.Label).string=c.MB_AttrMgr.instance.attrNames[i],e.getChildByName("Value").getComponent(cc.Label).string=r.MathUtil.formatNumber(t.get(i),2)+"%"}}),cc.tween(this.nTotalAttrView).to(.3,{y:this._initTotalY,opacity:255},{easing:"backOut"}).start()},e.prototype.showEquipAttr=function(t){this.node.active=!0,this.showTotalAttr(),this.nEquipAttrView.active=!0;var e=c.MB_AttrMgr.instance.getEquipAttrMap(t),a=[s.E_AttrType.ATK,s.E_AttrType.DEF,s.E_AttrType.HP,s.E_AttrType.SPD];this.nEquipAttrView.getChildByName("BaseAttrView").children.forEach(function(t,i){t.getChildByName("Name").getComponent(cc.Label).string=c.MB_AttrMgr.instance.attrNames[a[i]],t.getChildByName("Value").getComponent(cc.Label).string=r.MathUtil.formatValue(e.get(a[i])),e.delete(a[i])});for(var i=this.nEquipAttrView.getChildByName("ExAttrView"),o=e.size-i.childrenCount;o>0;){var n=cc.instantiate(i.children[0]);i.addChild(n),o--}var l=Array.from(e.keys());i.children.forEach(function(t,a){if(t.active=l.length>a,t.active){var i=l[a];t.getChildByName("Name").getComponent(cc.Label).string=c.MB_AttrMgr.instance.attrNames[i],t.getChildByName("Value").getComponent(cc.Label).string=r.MathUtil.formatNumber(e.get(i),2)+"%"}}),cc.tween(this.nEquipAttrView).to(.3,{y:this._initEquipY,opacity:255},{easing:"backOut"}).start()},e.prototype.hideView=function(){this.node.active=!1,this.nTotalAttrView.y=this._initEquipY-700,this.nEquipAttrView.y=this._initTotalY-700,this.nEquipAttrView.opacity=0,this.nTotalAttrView.opacity=0,this.nEquipAttrView.active=!1,this.nTotalAttrView.active=!1},e.prototype.onClickClose=function(){this.hideView()},__decorate([h(cc.Node)],e.prototype,"nTotalAttrView",void 0),__decorate([h(cc.Node)],e.prototype,"nEquipAttrView",void 0),__decorate([p],e)}(cc.Component);n.default=d,cc._RF.pop(),cc._RF.pop()},{}],MB_BagUI:[function(t,e,a){"use strict";cc._RF.push(e,"f7496YiBylFpKHOT9hSr+ug","MB_BagUI");var i=t,o=e,n=a;cc._RF.push(o,"72057ZWyaxIOLbU65TI9KjB","MB_BagUI");var r=i("EventManager"),s=i("PopupManager"),c=i("MB_GameEnum"),l=i("MBScene"),u=cc._decorator,p=u.ccclass,h=u.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nBtns=null,e.lStage=null,e.nTips=null,e}return __extends(e,t),e.prototype.start=function(){r.EventManager.instance.on(c.E_MB_BattleEvent.MONSTER_LOADED,this.onMonsterLoaded,this),this.nTips.active=yzll.gameConfig.isZB||yzll.gameConfig.debug},e.prototype.onDestroy=function(){r.EventManager.instance.off(c.E_MB_BattleEvent.MONSTER_LOADED,this.onMonsterLoaded,this)},e.prototype.onEnterReady=function(){this.lStage.string=l.default.instance.curStage+"/"+l.default.instance.maxStage+"\u6ce2",this.nBtns.y=-500,this.nBtns.active=!0},e.prototype.onMonsterLoaded=function(){cc.tween(this.nBtns).to(.5,{y:0}).start()},e.prototype.onEnterBattle=function(){var t=this;cc.tween(this.nBtns).to(.2,{y:-500}).call(function(){t.nBtns.active=!1}).start()},e.prototype.onClickBtnStart=function(){l.default.instance.enterBattle()},e.prototype.onClickBtnAttrView=function(){l.default.instance.attrUI.showTotalAttr()},e.prototype.onClickBtnSet=function(){s.PopupManager.instance.show({bundleName:"res_MB",path:"popups/MBSettingPopup",keep:!0})},__decorate([h(cc.Node)],e.prototype,"nBtns",void 0),__decorate([h(cc.Label)],e.prototype,"lStage",void 0),__decorate([h(cc.Node)],e.prototype,"nTips",void 0),__decorate([p],e)}(cc.Component);n.default=d,cc._RF.pop(),cc._RF.pop()},{}],MB_BagView:[function(t,e,a){"use strict";cc._RF.push(e,"304c2vVZJpOQ5PVNbZ+8DNL","MB_BagView");var i=t,o=e,n=a;cc._RF.push(o,"0f5a6BQSgpI5Kz7o6ziNqxh","MB_BagView");var r=i("AudioManager"),s=i("EventManager"),c=i("MathUtil"),l=i("RandomUtil"),u=i("ResUtil"),p=i("DataManager"),h=i("MBGameDataProxy"),d=i("Util"),m=i("MB_GameEnum"),f=i("MB_EquipItem"),_=i("MB_GridItem"),y=i("MB_Const"),g=i("MBScene"),v=cc._decorator,P=v.ccclass,b=v.property,D=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nGrids=null,e.nEquips=null,e.nPrepares=null,e.nPrepareLayout=null,e.nDraw=null,e.nTouchLock=null,e._gridMap=new Map,e._selectEquipNode=null,e._selectEquipMoveResult=!1,e}return __extends(e,t),Object.defineProperty(e.prototype,"eqiupedIds",{get:function(){return this.nEquips.children.map(function(t){return t.getComponent(f.default).equipId})},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},e.prototype.onDestroy=function(){this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},e.prototype.init=function(){this.initGrid()},e.prototype.onEnterReady=function(){this.nTouchLock.active=!1,this.refreshEquip()},e.prototype.onEnterBattle=function(){this.nPrepareLayout.destroyAllChildren(),this.nTouchLock.active=!0},e.prototype.initGrid=function(){this._gridMap.clear(),this._gridMap.set("0&0",this.nGrids.children[0]);for(var t=y.MB_GRID_ROW*y.MB_GRID_COL,e=1;e<t;++e){var a=cc.instantiate(this.nGrids.children[0]);this.nGrids.addChild(a),this._gridMap.set(Math.floor(e/y.MB_GRID_COL)+"&"+e%y.MB_GRID_COL,a)}this._gridMap.forEach(function(t){t.getComponent(_.default).setState(_.EMB_GridState.NONE)})},e.prototype.refreshEquip=function(){var t=this;if(this.nPrepareLayout.destroyAllChildren(),1!=g.default.instance.curStage){for(var e=p.DataManager.instance.eData.data_bagstage[g.default.instance.curStage],a=c.MathUtil.weightedRandom(e.numWeight.split("|").map(Number))+2,i=[],o=0;o<a;++o){var n=c.MathUtil.weightedRandom(e.levelWeight.split("|").map(Number))+1,r=[];for(var s in p.DataManager.instance.eData.data_bagweapon)(m=p.DataManager.instance.eData.data_bagweapon[s]).type<8&&m.level==n&&r.push(m.id);var d=r[l.RandomUtil.randomInt(0,r.length)];i.push(d)}for(var o in console.log("MB_\u8fde\u8d25\u6b21\u6570:",h.mbGameDataProxy.failCount),console.log("MB_\u5f53\u524d\u5173\u5361:",g.default.instance.curStage),p.DataManager.instance.eData.data_bagweapon){var m;if((m=p.DataManager.instance.eData.data_bagweapon[o]).type>=8){var _=__read(m.refresh.split("|").map(Number),4),y=_[0],v=_[1],P=_[2],b=_[3];if(console.log("MB_\u51b7\u5374\u5c40\u6570"+m.id+":",h.mbGameDataProxy.getEquipCD(m.id)),h.mbGameDataProxy.failCount<y)continue;if(g.default.instance.curStage<v)continue;if(h.mbGameDataProxy.isEquipCd(m.id))continue;if(l.RandomUtil.randomInt(0,100)<P){i.push(m.id),h.mbGameDataProxy.enterCD(m.id,b);break}}}console.log(i),i.forEach(function(e){var a=p.DataManager.instance.eData.data_bagweapon[e];u.ResUtil.loadAsset({bundleName:"res_MB",path:"prefabs/equips/MB_Equip_"+a.type,type:cc.Prefab}).then(function(a){if(t.nPrepareLayout&&t.nPrepareLayout.isValid){var i=cc.instantiate(a);t.nPrepareLayout.addChild(i),t.updatePrepareLayout(),i.setPosition(0,0),i.getComponent(f.default).init(e,"",t)}})})}},e.prototype.setGirdsHight=function(t){this._gridMap.forEach(function(e,a){t&&t.indexOf(a)>=0?e.getComponent(_.default).setState(_.EMB_GridState.RIGHT):e.getComponent(_.default).setState(_.EMB_GridState.NONE)})},e.prototype.updateSelectEquipMove=function(){var t=this,e=this._selectEquipNode.getComponent(f.default).occupyRowCols,a=!0;e.length<=0?a=!1:e.forEach(function(e){a&&(t.isValidGrid(e)||(a=!1))}),a?this.setGirdsHight(e):this.setGirdsHight(),this._selectEquipMoveResult=a},e.prototype.onTouchStart=function(t){var e=this.findTouchEquipNode(t.getLocation());e&&(this._selectEquipNode=e)},e.prototype.onTouchMove=function(t){if(this._selectEquipNode&&!(cc.Vec2.distance(t.getLocation(),t.getStartLocation())<10)){if(this._selectEquipNode.parent!=this.nDraw){var e=d.default.nodeParentChangeLocalPos(this._selectEquipNode,this.nDraw);this._selectEquipNode.parent=this.nDraw,this._selectEquipNode.getComponent(f.default).onSelectedAnim(),this._selectEquipNode.getComponent(f.default).setPos(cc.v2(e.x,e.y)),this.updatePrepareLayout()}var a=this.nDraw.convertToNodeSpaceAR(t.getLocation());this._selectEquipNode.getComponent(f.default).setPos(a),this.updateSelectEquipMove()}},e.prototype.onTouchEnd=function(t){var e=this;if(this._selectEquipNode){if(cc.Vec2.distance(t.getLocation(),t.getStartLocation())<10&&this._selectEquipNode.parent!=this.nDraw)return g.default.instance.attrUI.showEquipAttr(this._selectEquipNode.getComponent(f.default).equipId),void(this._selectEquipNode=null);if(this._selectEquipNode.parent!=this.nDraw)return void(this._selectEquipNode=null);if(!this._selectEquipMoveResult){for(var a=this._selectEquipNode.convertToWorldSpaceAR(cc.v2()),i=new cc.Rect(a.x-this._selectEquipNode.width/2,a.y-this._selectEquipNode.height/2,this._selectEquipNode.width,this._selectEquipNode.height),o=this._selectEquipNode.getComponent(f.default),n=this.nPrepareLayout,r=!1,s=0;s<n.children.length;++s){var c=n.children[s],l=c.getComponent(f.default),u=c.convertToWorldSpaceAR(cc.v2()),p=new cc.Rect(u.x-c.width/2,u.y-c.height/2,c.width,c.height);if(o.canUpLv&&l.canUpLv&&o.equipId==l.equipId&&i.intersects(p)){r=!0,l.upLv(),console.log("\u5347\u7ea7"),this._selectEquipNode.destroy();break}}return r||this.backPrepare(this._selectEquipNode),void(this._selectEquipNode=null)}var h=[],d=this._selectEquipNode.getComponent(f.default);if(d.occupyRowCols.forEach(function(t){var a=e.getGridEquip(t);a&&!h.includes(a)&&h.push(a)}),h.length>0){for(r=!1,s=0;s<h.length;++s)if((l=(m=h[s]).getComponent(f.default)).canUpLv&&l.equipId==d.equipId){r=!0,d.node.destroy(),l.upLv();break}if(!r){for(s=0;s<h.length;++s){var m=h[s];this.backPrepare(m)}this.downEquip(this._selectEquipNode)}}else this.downEquip(this._selectEquipNode);this.setGirdsHight(),this._selectEquipNode=null}},e.prototype.backPrepare=function(t){var e=this,a=d.default.nodeParentChangeLocalPos(t,this.nDraw);t.parent=this.nDraw,t.setPosition(a);var i=d.default.nodeParentChangeLocalPos(this.nPrepares,this.nDraw),o=cc.Vec2.distance(a,i);if(o<100)return t.parent=this.nPrepareLayout,t.y=0,this.updatePrepareLayout(),t.getComponent(f.default).setPos(this.node.getPosition()),t.getComponent(f.default).onDownAnim(),void s.EventManager.instance.emit(m.E_MB_BattleEvent.UPDATE_PLAYER_ANIMATION);cc.tween(t).to(o/2e3,{x:i.x,y:i.y}).call(function(){t.parent=e.nPrepareLayout,t.y=0,e.updatePrepareLayout(),t.getComponent(f.default).setPos(e.node.getPosition()),t.getComponent(f.default).onDownAnim(),s.EventManager.instance.emit(m.E_MB_BattleEvent.UPDATE_PLAYER_ANIMATION)}).start()},e.prototype.updatePrepareLayout=function(){var t=this.nPrepareLayout.getComponent(cc.Layout),e=this.nPrepareLayout.childrenCount;t.spacingX=2==e?50:3==e?20:5,t.updateLayout()},e.prototype.downEquip=function(t){var e=t.getComponent(f.default);console.log("\u690d\u7269\u884c\u5217:",e.rowCol);var a=this.getPosByRowCol(e.rowCol);if(console.log("\u653e\u4e0b\u690d\u7269"),!a)return console.log("\u70b9\u4e0d\u5b58\u5728"),void this.backPrepare(t);t.parent=this.nEquips,e.onDownAnim(),r.AudioManager.instance.playEffectPath("sounds/se_put","res_MB"),e.setPosByGrid(a),s.EventManager.instance.emit(m.E_MB_BattleEvent.UPDATE_PLAYER_ANIMATION)},e.prototype.findTouchEquipNode=function(t){for(var e=this.nPrepareLayout,a=0;a<e.children.length;++a){var i=e.children[a],o=i.convertToWorldSpaceAR(cc.v2());if(new cc.Rect(o.x-i.width/2,o.y-i.height/2,i.width,i.height).contains(t))return i}var n=this.getRowColByPos(this.node.convertToNodeSpaceAR(t));return this.getGridEquip(n)},e.prototype.isValidGrid=function(t){return this._gridMap.has(t)},e.prototype.getGrid=function(t){return this.isValidGrid(t)?this._gridMap.get(t):null},e.prototype.getGridEquip=function(t){for(var e=this.nEquips.children,a=0;a<e.length;++a){var i=e[a];if(i.getComponent(f.default).occupyRowCols.indexOf(t)>=0)return i}return null},e.prototype.getRowColByPos=function(t){var e=this.node.convertToWorldSpaceAR(t),a=this.nGrids.convertToNodeSpaceAR(e),i=cc.v2(a.x+this.nGrids.width/2,-a.y),o=this.nGrids.width/6;return Math.floor(i.y/o)+"&"+Math.floor(i.x/o)},e.prototype.getPosByRowCol=function(t){var e=__read(t.split("&").map(Number),2),a=e[0],i=e[1],o=this.nGrids.children[a*y.MB_GRID_COL+i];return o?o.getPosition():null},__decorate([b(cc.Node)],e.prototype,"nGrids",void 0),__decorate([b(cc.Node)],e.prototype,"nEquips",void 0),__decorate([b(cc.Node)],e.prototype,"nPrepares",void 0),__decorate([b(cc.Node)],e.prototype,"nPrepareLayout",void 0),__decorate([b(cc.Node)],e.prototype,"nDraw",void 0),__decorate([b(cc.Node)],e.prototype,"nTouchLock",void 0),__decorate([P],e)}(cc.Component);n.default=D,cc._RF.pop(),cc._RF.pop()},{}],MB_BattleView:[function(t,e,a){"use strict";cc._RF.push(e,"cc5ffwxtLRAZ6WpX8UWa78+","MB_BattleView");var i=t,o=e,n=a;cc._RF.push(o,"a35a54HsT5KuaZQ+QR/HxcK","MB_BattleView");var r=i("EventManager"),s=i("ResUtil"),c=i("DataManager"),l=i("NodePoolManager"),u=i("MB_Enemy"),p=i("MB_Player"),h=i("E_AttrType"),d=i("MB_GameEnum"),m=i("MB_PopHurt"),f=i("MBScene"),_=cc._decorator,y=_.ccclass,g=_.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nActors=null,e.nPopHurts=null,e.nBullets=null,e.player=null,e._enemy=null,e._curRoundTeam=d.E_MB_ActorTeam.PLAYER,e._initEnemyPos=cc.v2(274,380),e._gameSpeed=1,e}return __extends(e,t),Object.defineProperty(e.prototype,"gameSpeed",{get:function(){return this._gameSpeed},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){r.EventManager.instance.on(d.E_MB_BattleEvent.ROUND_START,this.onRoundStart,this),r.EventManager.instance.on(d.E_MB_BattleEvent.ROUND_END,this.onRoundEnd,this)},e.prototype.onDestroy=function(){r.EventManager.instance.off(d.E_MB_BattleEvent.ROUND_START,this.onRoundStart,this),r.EventManager.instance.off(d.E_MB_BattleEvent.ROUND_END,this.onRoundEnd,this)},e.prototype.init=function(){this.player.init(),this._initEnemyPos=this.player.node.getPosition().clone(),this._initEnemyPos.x=-this._initEnemyPos.x},e.prototype.setGameSpeed=function(t){this._gameSpeed=t},e.prototype.onEnterReady=function(){var t=this;this._enemy=null,this.player.attackTarget=null,this.player.onEnterReady();var e=c.DataManager.instance.eData.data_bagstage[f.default.instance.curStage],a=c.DataManager.instance.eData.datamonster[e.monster];s.ResUtil.loadAsset({bundleName:"res_MB",path:"prefabs/enemys/"+a.modeName,type:cc.Prefab}).then(function(e){if(t.nActors&&t.nActors.isValid){var a=cc.instantiate(e);t.nActors.addChild(a),a.setPosition(t._initEnemyPos.add(cc.v2(500))),t._enemy=a.getComponent(u.default),t._enemy.init(),t._enemy.onEnterReady()}})},e.prototype.onEnterBattle=function(){var t=this;this.player.attackTarget=this._enemy,this._enemy.attackTarget=this.player,this.player.onEnterBattle(),this._enemy.onEnterBattle(),console.log("player speed: "+this.player.getAttribute(h.E_AttrType.SPD).value),console.log("enemy speed: "+this._enemy.getAttribute(h.E_AttrType.SPD).value),this.player.getAttribute(h.E_AttrType.SPD).value>=this._enemy.getAttribute(h.E_AttrType.SPD).value?(this._curRoundTeam=d.E_MB_ActorTeam.PLAYER,this.player.startRound().then(function(){t.player.endRound()})):(this._curRoundTeam=d.E_MB_ActorTeam.ENEMY,this._enemy.startRound().then(function(){t._enemy.endRound()}))},e.prototype.onRoundStart=function(){},e.prototype.onRoundEnd=function(t){var e=this;this._enemy.isDead()?f.default.instance.win():this.player.isDead()?f.default.instance.fail():(this._curRoundTeam=t===d.E_MB_ActorTeam.PLAYER?d.E_MB_ActorTeam.ENEMY:d.E_MB_ActorTeam.PLAYER,this._curRoundTeam===d.E_MB_ActorTeam.PLAYER?this.player.startRound().then(function(){e.player&&e.player.endRound()}):this._enemy.startRound().then(function(){e._enemy&&e._enemy.endRound()}))},e.prototype.popHurt=function(t,e,a){var i=this,o=l.default.instance.getPoolPrefab("MB_PopHurt");if(o){var n=l.default.instance.getNode(o);this.nPopHurts.addChild(n),n.setPosition(e),n.getComponent(m.default).popup(t,a)}else s.ResUtil.loadAsset({bundleName:"res_MB",path:"prefabs/MB_PopHurt",type:cc.Prefab,success:function(o){l.default.instance.addPoolPrefab(o),i.popHurt(t,e,a)}})},__decorate([g(cc.Node)],e.prototype,"nActors",void 0),__decorate([g(cc.Node)],e.prototype,"nPopHurts",void 0),__decorate([g(cc.Node)],e.prototype,"nBullets",void 0),__decorate([g(p.default)],e.prototype,"player",void 0),__decorate([y],e)}(cc.Component);n.default=v,cc._RF.pop(),cc._RF.pop()},{}],MB_Const:[function(t,e,a){"use strict";cc._RF.push(e,"eab4alHdSpDTr4eDiqGHbOK","MB_Const");var i=e,o=a;cc._RF.push(i,"1de79ysHK1LE4jioL/bcnmB","MB_Const"),Object.defineProperty(o,"__esModule",{value:!0}),o.MB_EQUIP_FORM=o.MB_GRID_COL=o.MB_GRID_ROW=void 0,o.MB_GRID_ROW=3,o.MB_GRID_COL=6,o.MB_EQUIP_FORM={1:{grids:[[0,0],[1,0]]},2:{grids:[[0,0]]},3:{grids:[[0,0]]},4:{grids:[[0,0],[0,1],[0,2]]},5:{grids:[[0,0],[0,1]]},6:{grids:[[0,0],[0,1]]},7:{grids:[[0,0],[0,1],[1,0],[1,1]]},8:{grids:[[0,0]]},9:{grids:[[0,0],[0,1],[1,0],[1,1]]},10:{grids:[[0,0],[1,0]]},11:{grids:[[0,0],[0,1]]}},cc._RF.pop(),cc._RF.pop()},{}],MB_Enemy:[function(t,e,a){"use strict";cc._RF.push(e,"35a65pyE+hL9awerB3l2txk","MB_Enemy");var i=t,o=e,n=a;cc._RF.push(o,"1ff04LJnEJHfqLi53LiYpV1","MB_Enemy");var r=i("AudioManager"),s=i("EventManager"),c=i("RandomUtil"),l=i("ResUtil"),u=i("ShimmerWhite"),p=i("DataManager"),h=i("SpAnimCtrl"),d=i("E_AttrType"),m=i("MB_GameEnum"),f=i("MBScene"),_=i("MB_Actor"),y=cc._decorator,g=y.ccclass,v=y.property,P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAnimCtrl=null,e.nBullet=null,e.nShootPos=null,e._isAttack=!1,e._atkAnimFrameNums=[],e._onAttackComplete=null,e._isLoadedAnim=!1,e}return __extends(e,t),e.prototype.initAttribute=function(){t.prototype.initAttribute.call(this);var e=p.DataManager.instance.eData.data_bagstage[f.default.instance.curStage];this._actorAttribute.getNumeric(d.E_AttrType.ATK).setFixBase(e.atk),this._actorAttribute.getNumeric(d.E_AttrType.DEF).setFixBase(e.def),this._actorAttribute.getNumeric(d.E_AttrType.HP).setFixBase(e.hp),this._actorAttribute.getNumeric(d.E_AttrType.SPD).setFixBase(e.speed),this._actorAttribute.getNumeric(d.E_AttrType.DODGE).setFixBase(100*e.att1),this._actorAttribute.getNumeric(d.E_AttrType.STUN).setFixBase(100*e.att2),this._actorAttribute.getNumeric(d.E_AttrType.REBATE).setFixBase(100*e.att3),this._actorAttribute.getNumeric(d.E_AttrType.COMBO).setFixBase(100*e.att4),this._actorAttribute.getNumeric(d.E_AttrType.BLOOD).setFixBase(100*e.att5),this._actorAttribute.getNumeric(d.E_AttrType.CRIT).setFixBase(100*e.att6),this._actorAttribute.getNumeric(d.E_AttrType.RECOVER).setFixBase(100*e.att7)},e.prototype.onInit=function(){var t=this,e=p.DataManager.instance.eData.data_bagstage[f.default.instance.curStage],a=p.DataManager.instance.eData.datamonster[e.monster];this._atkAnimFrameNums="0"==a.atkFrame?[]:a.atkFrame.split("|").map(Number),this._isLoadedAnim=!1,this._team=m.E_MB_ActorTeam.ENEMY,s.EventManager.instance.emit(m.E_MB_BattleEvent.MONSTER_LOADED),this.spAnimCtrl.init(),this.spAnimCtrl.registerFrameEvent(this.onSpAnimAnimEvent,this),cc.tween(this.node).by(.2,{x:-500}).call(function(){t.playIdleAnim()}).start()},e.prototype.playIdleAnim=function(){this.spAnimCtrl.playAnim("move",1.5,!0)},e.prototype.playMoveAnim=function(){this.spAnimCtrl.playAnim("move",1.5,!0)},e.prototype.playDeadAnim=function(){var t=this;r.AudioManager.instance.playEffectPath("sounds/monster_death2","res_MB"),this.spAnimCtrl.playAnim("die",1,!1,function(){t.node.destroy()})},e.prototype.playAttackAnim=function(t){var e=this;this._onAttackComplete=t;var a=this.node.x;this.playMoveAnim();var i="atk";if(this._atkAnimFrameNums[0],this._atkAnimFrameNums.length>1){var o=Math.floor(1e3*Math.random())%this._atkAnimFrameNums.length;i="atk"+(o+1),this._atkAnimFrameNums[o+1]}2==p.DataManager.instance.eData.datamonster[p.DataManager.instance.eData.data_bagstage[f.default.instance.curStage].monster].atkType?this.spAnimCtrl.playAnim(i,1,!1,function(){e.playIdleAnim()}):cc.tween(this.node).to(.2*f.default.instance.battleView.gameSpeed,{x:a-300},{easing:"sineIn"}).delay(.2).call(function(){e.spAnimCtrl.clearAnim(),e.spAnimCtrl.playAnim(i,1,!1,function(){cc.tween(e.node).to(.1*f.default.instance.battleView.gameSpeed,{x:a},{easing:"sineIn"}).call(function(){e.playIdleAnim(),e._onAttackComplete&&e._onAttackComplete()}).start()})}).start()},e.prototype.onSpAnimAnimEvent=function(t,e){var a=this;if("atk"==e&&t.includes("atk")){var i=p.DataManager.instance.eData.datamonster[p.DataManager.instance.eData.data_bagstage[f.default.instance.curStage].monster];if(2==i.atkType){var o=cc.instantiate(this.nBullet);o.parent=f.default.instance.battleView.nBullets,o.active=!0;var n=this.node.getPosition().add(this.nShootPos.getPosition());o.setPosition(n),l.ResUtil.setSpritFrame(o.getChildByName("Icon").getComponent(cc.Sprite),"Game","textures/enemyBullet/"+i.modeName+"_zidan"),cc.tween(o).to(.2*f.default.instance.battleView.gameSpeed,{x:n.x-500},{easing:"sineIn"}).call(function(){o.destroy();var t=c.RandomUtil.randomInt(0,1e3)<10*a.getAttribute(d.E_AttrType.CRIT).value;r.AudioManager.instance.playEffectPath("sounds/boss_atk1","res_MB"),a.attackTarget.beHurt(a,t),a._onAttackComplete&&a._onAttackComplete()}).start()}else{r.AudioManager.instance.playEffectPath("sounds/dao","res_MB");var s=c.RandomUtil.randomInt(0,1e3)<10*this.getAttribute(d.E_AttrType.CRIT).value;this.attackTarget.beHurt(this,s)}}},e.prototype.playHitAnim=function(){this.spAnimCtrl.getComponent(u.default).show(.3)},__decorate([v(h.default)],e.prototype,"spAnimCtrl",void 0),__decorate([v(cc.Node)],e.prototype,"nBullet",void 0),__decorate([v(cc.Node)],e.prototype,"nShootPos",void 0),__decorate([g],e)}(_.default);n.default=P,cc._RF.pop(),cc._RF.pop()},{}],MB_EquipItem:[function(t,e,a){"use strict";cc._RF.push(e,"105f0LUEUdPyKYkYf6VXy7Y","MB_EquipItem");var i=t,o=e,n=a;cc._RF.push(o,"bb73aHk0VNN64jyyKbtHI6C","MB_EquipItem");var r=i("AudioManager"),s=i("AnimUtils"),c=i("DataManager"),l=i("Util"),u=i("MB_Const"),p=cc._decorator,h=p.ccclass,d=p.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nAnchor=null,e.formId=0,e._equipId=0,e._rowCol="",e._occupyRowCols=[],e._formGrids=null,e._mbView=null,e}return __extends(e,t),Object.defineProperty(e.prototype,"anchorPos",{get:function(){return this.node.getPosition().add(this.nAnchor.getPosition())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rowCol",{get:function(){return this._rowCol},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"occupyRowCols",{get:function(){return this._occupyRowCols.slice()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canUpLv",{get:function(){return this.cfgEquip.level<4},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"equipId",{get:function(){return this._equipId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cfgEquip",{get:function(){return c.DataManager.instance.eData.data_bagweapon[this._equipId]},enumerable:!1,configurable:!0}),e.prototype.init=function(t,e,a){this._equipId=t,this._rowCol=e,this._mbView=a,this._formGrids=u.MB_EQUIP_FORM[this.formId].grids.slice(),this._occupyRowCols=[],this.updateIcon()},e.prototype.setPosByGrid=function(t){var e=l.default.nodeParentChangeLocalPos(this.nAnchor,this.node),a=t.sub(cc.v2(e.x,e.y));this.setPos(a)},e.prototype.setPos=function(t){this.node.setPosition(t),this.updateRowCol(),this.updateOccupyGrids()},e.prototype.onSelectedAnim=function(){var t=this.node.getChildByName("Info");cc.tween(t).to(.1,{scale:.9},{easing:"sineIn"}).start()},e.prototype.onDownAnim=function(){var t=this.node.getChildByName("Info");cc.tween(t).to(.2,{scale:1},{easing:"sineIn"}).start()},e.prototype.updateRowCol=function(){var t=this.node.convertToWorldSpaceAR(this.nAnchor.getPosition());this._rowCol=this._mbView.getRowColByPos(this._mbView.node.convertToNodeSpaceAR(t));var e=__awaiter(this._rowCol.split("&").map(Number),2),a=e[0],i=e[1];(a<0||a>=u.MB_GRID_ROW||i<0||i>=u.MB_GRID_COL)&&(this._rowCol="")},e.prototype.updateOccupyGrids=function(){if(this._occupyRowCols=[],""!=this._rowCol)for(var t=this._rowCol.split("&").map(Number),e=0;e<this._formGrids.length;e++){var a=this._formGrids[e];this._occupyRowCols.push(t[0]+a[0]+"&"+(t[1]+a[1]))}},e.prototype.updateIcon=function(){var t=this;this.node.getChildByName("Info").getChildByName("Quality").children.forEach(function(e,a){e.active=t.cfgEquip.level==a+1})},e.prototype.upLv=function(){this._equipId++,this.updateIcon(),r.AudioManager.instance.playEffectPath("sounds/se_synthesis","res_MB"),s.AnimUtil.shakeAngle(this.node.getChildByName("Info"))},__decorate([d(cc.Node)],e.prototype,"nAnchor",void 0),__decorate([d(cc.Integer)],e.prototype,"formId",void 0),__decorate([h],e)}(cc.Component);n.default=m,cc._RF.pop(),cc._RF.pop()},{}],MB_GameEnum:[function(t,e,a){"use strict";cc._RF.push(e,"a33faJcTKxOX5q6uokGcvop","MB_GameEnum");var i=e,o=a;cc._RF.push(i,"4371bD0UJRBLreAq9QXJ8pK","MB_GameEnum"),Object.defineProperty(o,"__esModule",{value:!0}),o.E_MB_BattleEvent=o.E_MB_ActorTeam=void 0,function(t){t[t.PLAYER=0]="PLAYER",t[t.ENEMY=1]="ENEMY"}(o.E_MB_ActorTeam||(o.E_MB_ActorTeam={})),function(t){t.ROUND_START="ROUND_START",t.ROUND_END="ROUND_END",t.MONSTER_LOADED="MONSTER_LOADED",t.UPDATE_PLAYER_ANIMATION="UPDATE_PLAYER_ANIMATION"}(o.E_MB_BattleEvent||(o.E_MB_BattleEvent={})),cc._RF.pop(),cc._RF.pop()},{}],MB_GridItem:[function(t,e,a){"use strict";cc._RF.push(e,"03cb1quTWtI9L63pEjTFBdt","MB_GridItem");var i=e,o=a,n=t("./helpers/typeof");cc._RF.push(i,"3c0bbCq/2pAdrv3/Iq6u2cE","MB_GridItem");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),c=function(t,e,a,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,a):i;if("object"==("undefined"==typeof Reflect?"undefined":n(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,a,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(s=(r<3?o(s):r>3?o(e,a,s):o(e,a))||s);return r>3&&s&&Object.defineProperty(e,a,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.EMB_GridState=void 0;var l,u=cc._decorator,p=u.ccclass;u.property,function(t){t[t.NONE=0]="NONE",t[t.RIGHT=1]="RIGHT"}(l=o.EMB_GridState||(o.EMB_GridState={}));var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.setState=function(t){this.node.getChildByName("Right").active=t==l.RIGHT},c([p],e)}(cc.Component);o.default=h,cc._RF.pop(),cc._RF.pop()},{"./helpers/typeof":"typeof"}],MB_Player:[function(t,e,a){"use strict";cc._RF.push(e,"88aa91AL0RJQYeS34E2fVlD","MB_Player");var i=t,o=e,n=a;cc._RF.push(o,"fef2e99CLxCVYzGd5oUKB0C","MB_Player");var r=i("MB_AttrMgr"),s=i("E_AttrType"),c=i("MB_GameEnum"),l=i("MBScene"),u=i("MB_Actor"),p=i("RandomUtil"),h=i("AudioManager"),d=i("EventManager"),m=i("DataManager"),f=i("SpAnimCtrl"),_=i("BulletHit"),y=i("ResUtil"),g=i("MathUtil"),v=i("BulletHit6"),P=i("HomeEnum"),b=cc._decorator,D=b.ccclass,S=b.property,C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAnimCtrl=null,e.nPlantBullet=null,e.nSelfBullet=null,e.nSelfShootPos=null,e.spHitAnimCtrl=null,e.spUp=null,e._onAttackComplete=null,e._curEquipTypeIds=[],e}return __extends(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this),d.EventManager.instance.on(c.E_MB_BattleEvent.UPDATE_PLAYER_ANIMATION,this.updatePlayerAnim,this)},e.prototype.onDestroy=function(){t.prototype.onDestroy.call(this),d.EventManager.instance.off(c.E_MB_BattleEvent.UPDATE_PLAYER_ANIMATION,this.updatePlayerAnim,this)},e.prototype.initAttribute=function(){t.prototype.initAttribute.call(this),this.updateAttr()},e.prototype.onInit=function(){t.prototype.onInit.call(this),this._team=c.E_MB_ActorTeam.PLAYER,this.spAnimCtrl.registerFrameEvent(this.onAnimEvent,this),this.playIdleAnim(),this.updatePlayerAnim()},e.prototype.updateAttr=function(){var t=r.MB_AttrMgr.instance.getPlayerAttrMap(l.default.instance.bagView.eqiupedIds);for(var e in s.E_AttrType)if(!isNaN(e)){var a=t.has(Number(e))?t.get(Number(e)):0;this._actorAttribute.getNumeric(Number(e)).setFixBase(a)}},e.prototype.onEnterReady=function(){t.prototype.onEnterReady.call(this);var e=this.getAttribute(s.E_AttrType.HP).value;this._hp=e,this.updateHpView(this._hp,e)},e.prototype.onEnterBattle=function(){this.updateAttr(),t.prototype.onEnterBattle.call(this)},e.prototype.updatePlayerAnim=function(){var t=this,e=new Map([[1,"plant1"],[2,"plant8"],[3,"plant3"],[4,"plant6"],[5,"plant14"],[6,"plant11"],[7,"plant13"],[8,"CWplant3"],[9,"CWplant4"],[10,"CWplant5"],[11,"plant12"]]),a=!1,i=l.default.instance.bagView.eqiupedIds.map(function(t){return m.DataManager.instance.eData.data_bagweapon[t].type});i.forEach(function(e){a||t._curEquipTypeIds.includes(e)||(a=!0)}),this._curEquipTypeIds=i,e.forEach(function(e,a){i.includes(a)?t.spAnimCtrl.spAnim.findBone(e).active=!0:t.spAnimCtrl.spAnim.findBone(e).active=!1}),a&&(this.spUp.node.active=!0,this.spUp.clearAnim(),this.spUp.playAnim("level up",1,!1,function(){t.spUp.node.active=!1})),this.spAnimCtrl.spAnim.findBone("muma").active=!i.includes(11)},e.prototype.playAttackAnim=function(t){var e=this;this.node.x,this.node.zIndex=cc.macro.MAX_ZINDEX,h.AudioManager.instance.playEffectPath("sounds/se_launch","res_MB"),this._onAttackComplete=t,this.spAnimCtrl.playAnim("atk",1,!1,function(){e.playIdleAnim()})},e.prototype.onAnimEvent=function(t,e){if("atk"==e){var a=l.default.instance.bagView.eqiupedIds.map(function(t){return m.DataManager.instance.eData.data_bagweapon[t].type});a.length>0?this.shootPlantBullet(a):this.shootSelfBullet()}},e.prototype.shootSelfBullet=function(){var t=this,e=this.attackTarget.node.getPosition().add(cc.v2(0,60)),a=cc.instantiate(this.nSelfBullet);a.parent=l.default.instance.battleView.nBullets,a.active=!0;var i=this.node.getPosition().add(this.nSelfShootPos.getPosition());a.setPosition(i),cc.tween(a).to(.4,{x:e.x,y:e.y}).call(function(){var e=a.getChildByName("Hit").getComponent(f.default);a.getChildByName("Icon").active=!1,e.node.active=!0,e.playAnim("broken1",1,!1,function(){a.destroy()}),h.AudioManager.instance.playEffectPath("sounds/hit1","res_MB");var i=p.RandomUtil.randomInt(0,1e3)<10*t.getAttribute(s.E_AttrType.CRIT).value;t.attackTarget.beHurt(t,i),t._onAttackComplete&&t._onAttackComplete()}).start()},e.prototype.shootPlantBullet=function(t){var e=this,a=this.attackTarget.node.getPosition().add(cc.v2(0,60)),i=new Map([[1,"plant1"],[2,"plant8"],[3,"plant3"],[4,"plant6"],[5,"plant14"],[6,"plant11"],[7,"plant13"],[8,"CWplant3"],[9,"CWplant4"],[10,"CWplant5"],[11,"plant12"]]),o=new Map([[1,0],[2,0],[3,0],[4,700],[5,-300],[6,550],[7,0],[8,0],[9,500],[10,0],[11,200]]);t.forEach(function(t){var n=i.get(t);if(n){var r=new cc.Node;e.spAnimCtrl.generateSomeNodes(n,r),e.scheduleOnce(function(){var i=r.convertToWorldSpaceAR(cc.v2()),c=l.default.instance.battleView.nBullets.convertToNodeSpaceAR(i);e.spAnimCtrl.destroySomeNodes(n);var u=cc.instantiate(e.nPlantBullet);u.parent=l.default.instance.battleView.nBullets,u.active=!0,u.setPosition(c),u.angle=180*cc.Vec2.RIGHT_R.signAngle(a.sub(c).normalize())/Math.PI;var d=""+n.replace("plant","zidan"),m=Number(n.match(/\d+/)[0]);y.ResUtil.loadAsset({path:"textures/bulletHit/BulletHit",type:cc.SpriteAtlas,bundleName:P.Bundles.GAME}).then(function(t){u.getChildByName("Icon").getComponent(cc.Sprite).spriteFrame=t.getSpriteFrame(d)}).catch(function(t){console.log("error:",t)});var f=o.get(t);e.bezierTo(u,a,f,function(){var t=null;if(t=6==m?u.getChildByName("BulletHit6").getComponent(v.default):u.getChildByName("BulletHit").getComponent(_.default),u.getChildByName("Icon").active=!1,t.node.active=!0,e._onAttackComplete){h.AudioManager.instance.playEffectPath("sounds/hit1","res_MB");var a=p.RandomUtil.randomInt(0,1e3)<10*e.getAttribute(s.E_AttrType.CRIT).value;e.attackTarget.beHurt(e,a),e._onAttackComplete(),e._onAttackComplete=null}t.initBulletHit(m,1),e.scheduleOnce(function(){u.destroy()},.5)})})}})},e.prototype.lineTo=function(t,e,a){cc.tween(t).to(.4,{x:e.x,y:e.y}).call(function(){a&&a()}).start()},e.prototype.bezierTo=function(t,e,a,i){var o=t.getPosition(),n=o.add(e).mul(.5),r=g.MathUtil.getPerpendicularVector(e.sub(o).normalize().mul(a),n);g.MathUtil.bezierTo(t,.6,o,r,e,function(e){var a=e.x-t.x,i=e.y-t.y,o=cc.v2(a,i).normalizeSelf();0==o.x&&0==o.y||(t.angle=g.MathUtil.radians2Angle(cc.v2(1,0).signAngle(o)))}).call(function(){i&&i()}).start()},e.prototype.playDeadAnim=function(){this.spAnimCtrl.playAnim("die",1,!1)},e.prototype.playIdleAnim=function(){this.spAnimCtrl.playAnim("stand",1,!0)},e.prototype.playMoveAnim=function(){},e.prototype.playHitAnim=function(){var t=this;this.scheduleOnce(function(){t.spHitAnimCtrl.node.active=!0,t.spHitAnimCtrl.clearAnim(),t.spHitAnimCtrl.playAnim("hit",1,!1,function(){t.spHitAnimCtrl.node.active=!1})},.05),this.spAnimCtrl.playAnim("hit",1,!1)},__decorate([S(f.default)],e.prototype,"spAnimCtrl",void 0),__decorate([S(cc.Node)],e.prototype,"nPlantBullet",void 0),__decorate([S(cc.Node)],e.prototype,"nSelfBullet",void 0),__decorate([S(cc.Node)],e.prototype,"nSelfShootPos",void 0),__decorate([S(f.default)],e.prototype,"spHitAnimCtrl",void 0),__decorate([S(f.default)],e.prototype,"spUp",void 0),__decorate([D],e)}(u.default);n.default=C,cc._RF.pop(),cc._RF.pop()},{}],MB_PopHurt:[function(t,e,a){"use strict";cc._RF.push(e,"03f0dILlz5BrreXfGaByi6b","MB_PopHurt");var i=t,o=e,n=a;cc._RF.push(o,"20f2fv7XW9C3ZVfCNV6uaXx","MB_PopHurt");var r,s=i("MathUtil"),c=i("NodePoolManager"),l=cc._decorator,u=l.ccclass,p=l.property;(function(t){t[t.COMMON=0]="COMMON",t[t.CRIT=1]="CRIT",t[t.RECOVER=2]="RECOVER",t[t.EVASION=3]="EVASION",t[t.COMBO=4]="COMBO",t[t.REBATE=5]="REBATE"})(r=n.EBattlePopHurtType||(n.EBattlePopHurtType={}));var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lHurt=null,e.lCirt=null,e.nPop=null,e}return __extends(e,t),e.prototype.popup=function(t,e){this.nPop.y=0,this.nPop.scale=1,this.nPop.opacity=255,this.lCirt.node.color=cc.Color.WHITE,this.lHurt.node.color=cc.Color.WHITE,e==r.CRIT?(this.lCirt.node.active=!0,this.lHurt.node.active=!1,this.lCirt.string=s.MathUtil.formatValue(t),this.lCirt.node.color=(new cc.Color).fromHEX("#FFA800")):e==r.COMMON?(this.lCirt.node.active=!1,this.lHurt.node.active=!0):e==r.RECOVER?(this.lCirt.node.active=!1,this.lHurt.node.active=!0,this.lHurt.node.color=cc.Color.GREEN):e==r.EVASION?(this.lCirt.node.active=!1,this.lHurt.node.active=!0,this.lHurt.node.color=(new cc.Color).fromHEX("#00DBFF")):e==r.COMBO?(this.lCirt.node.active=!1,this.lHurt.node.active=!0,this.lHurt.node.color=(new cc.Color).fromHEX("#5900FF")):e==r.REBATE&&(this.lCirt.node.active=!1,this.lHurt.node.active=!0,this.lHurt.node.color=(new cc.Color).fromHEX("#FFEE00"));var a=s.MathUtil.formatValue(t);if(this.lHurt.node.active)switch(e){case r.EVASION:this.lHurt.string="\u95ea\u907f";break;case r.COMBO:this.lHurt.string="\u8fde\u51fb";break;case r.REBATE:this.lHurt.string="\u53cd\u51fb";break;default:this.lHurt.string=a}this.lCirt.node.active&&(this.lCirt.string=a),this.playAnim(e)},e.prototype.playAnim=function(t){var e=this;t!=r.COMMON?t!=r.CRIT?t!=r.RECOVER?(this.nPop.scale=3.25,cc.tween(this.nPop).to(.6,{scale:1},{easing:"backOut"}).delay(.2).call(function(){e.remove()}).start()):cc.tween(this.nPop).by(.4,{y:60}).call(function(){e.remove()}).start():cc.tween(this.nPop).to(.1,{scale:1.6},{easing:"backOut"}).to(.05,{scale:1}).delay(.05).to(.2,{y:20}).parallel(cc.tween().by(.4,{y:20}),cc.tween().to(.3,{opacity:0})).call(function(){e.remove()}).start():cc.tween(this.nPop).to(.1,{scale:1.4},{easing:"backOut"}).to(.05,{scale:1}).delay(.05).to(.2,{y:20}).parallel(cc.tween().by(.4,{y:20}),cc.tween().to(.3,{opacity:0})).call(function(){e.remove()}).start()},e.prototype.remove=function(){cc.Tween.stopAllByTarget(this.nPop),c.default.instance.putNode(this.node,!0)},e.prototype.onDestroy=function(){cc.Tween.stopAllByTarget(this.nPop)},__decorate([p(cc.Label)],e.prototype,"lHurt",void 0),__decorate([p(cc.Label)],e.prototype,"lCirt",void 0),__decorate([p(cc.Node)],e.prototype,"nPop",void 0),__decorate([u],e)}(cc.Component);n.default=h,cc._RF.pop(),cc._RF.pop()},{}],MakeParameters:[function(t,e,a){"use strict";cc._RF.push(e,"39e0aW8QrhGtI+bczX50yOp","MakeParameters");var i=e,o=a;cc._RF.push(i,"a7d41XIN+hICYLn/H/y0DXv","MakeParameters"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function t(){}return t.make=function(){return null},t}();o.default=n,cc._RF.pop(),cc._RF.pop()},{}],MapBlockEffect:[function(t,e,a){"use strict";cc._RF.push(e,"ab09bppIEJGuq5p/sFBpPkz","MapBlockEffect");var i=t,o=e,n=a;cc._RF.push(o,"54e84mveeRCaanXGiVHDNTM","MapBlockEffect"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("GameEnum"),s=i("BattleDataProxy"),c=cc._decorator,l=c.ccclass,u=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mSpine=null,e.mSnowEffect=null,e}return __extends(e,t),e.prototype.onLoad=function(){var t=this;this.mSpine.setCompleteListener(function(e){e.animation&&e.animation.name,t.node.destroy(),t.node.removeFromParent()}),this.mSnowEffect&&(this.mSnowEffect.setCompleteListener(function(e){e.animation&&e.animation.name,t.node.destroy(),t.node.removeFromParent()}),this.mSnowEffect.node.active=s.battleDataProxy.weatherType==r.WeatherType.IceAndSnow),this.mSpine.node.active=s.battleDataProxy.weatherType!=r.WeatherType.IceAndSnow},e.prototype.play=function(t,e){e&&this.mSnowEffect?(this.mSnowEffect.node.active=!0,this.mSpine.node.active=!1,this.mSnowEffect.setAnimation(0,"hit"+t,!1),this.mSnowEffect.timeScale=2):(this.mSnowEffect&&(this.mSnowEffect.node.active=!1),this.mSpine.node.active=!0,this.mSpine.setAnimation(0,"broken"+t,!1),this.mSpine.timeScale=2)},__decorate([u(sp.Skeleton)],e.prototype,"mSpine",void 0),__decorate([u(sp.Skeleton)],e.prototype,"mSnowEffect",void 0),__decorate([l],e)}(cc.Component);n.default=p,cc._RF.pop(),cc._RF.pop()},{}],MapBlockItem:[function(t,e,a){"use strict";cc._RF.push(e,"364d3YL6LBNX6apa/HAhmFU","MapBlockItem");var i=t,o=e,n=a;cc._RF.push(o,"d1b76drqQ9DCKI6ZIMvO227","MapBlockItem"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("EventManager"),c=i("ResUtil"),l=i("GameEnum"),u=i("HomeEnum"),p=i("NodePoolManager"),h=i("BattleDataProxy"),d=i("Util"),m=i("AnimationMgr"),f=i("DestroyAllBlockEffect"),_=i("MapBlockEffect"),y=i("WeatherIceBroken"),g=cc._decorator,v=g.ccclass,P=g.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mBlockImg=null,e.mMapBlockEffectPb=null,e.mWeatherIceBrokenPb=null,e._stoneHp=0,e._stoneSun=0,e._maxHp=0,e._holdGrid="",e._isPlayIceBroken=!0,e._stageChapter=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"holdGrid",{get:function(){return this._holdGrid},set:function(t){this._holdGrid=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stoneHp",{get:function(){return this._stoneHp},enumerable:!1,configurable:!0}),e.prototype.initMapBlockItem=function(t,e,a){if(this._stoneHp=t,this._maxHp=e,this._stoneSun=a,this._isPlayIceBroken=h.battleDataProxy.weatherType==l.WeatherType.IceAndSnow,this.node.getChildByName("snowImg").active=h.battleDataProxy.weatherType==l.WeatherType.IceAndSnow,h.battleDataProxy.weatherType!=l.WeatherType.NONE)this._stageChapter=1;else{var i=h.battleDataProxy.getStageRewardCfg().monsterList;this._stageChapter=Number(i.replace("stage",""))}this.changeBlockImg()},e.prototype.ballCollisionEnter=function(t){if(this.node&&this.node.isValid&&h.battleDataProxy.isStartFight&&!(this._stoneHp<=0))if(this._stoneHp--,this._stoneHp<=0||h.battleDataProxy.testBlock){this._stoneHp=0;var e=h.battleDataProxy.mapBlockNum;e-=1,h.battleDataProxy.mapBlockNum=e;var a=d.default.nodeWorldPos(this.node);this.addMapBlockEffect(cc.v2(a),2),s.EventManager.instance.emit(h.EBattleEvent.MAP_BLOCK_DESTROY,this._holdGrid),e<=0&&h.battleDataProxy.getStageRewardCfg().AllSun>0&&(this._stoneSun+=h.battleDataProxy.getStageRewardCfg().AllSun,this.addDestroyAllBlockEffect());var i=h.battleDataProxy.sunshineRoot,o=h.battleDataProxy.battleView.convertToNodeSpaceAR(i.parent.convertToWorldSpaceAR(i.position)),n=h.battleDataProxy.gameCamera;m.default.instance.showAwardAni({id:8,num:this._stoneSun},h.battleDataProxy.battleView,this.node,0,o.addSelf(n.position));var c=h.battleDataProxy.sunshineNum;c+=this._stoneSun,h.battleDataProxy.sunshineNum=c,r.AudioManager.instance.playEffectPath("sounds/blockSmash",u.Bundles.RES),this.node.destroy(),this.node.removeFromParent()}else{if(h.battleDataProxy.weatherType==l.WeatherType.IceAndSnow)if(this._isPlayIceBroken)if(Math.floor(this._stoneHp/this._maxHp/.2)<=3){this._isPlayIceBroken=!1;var p=cc.instantiate(this.mWeatherIceBrokenPb);h.battleDataProxy.blockLayout.addChild(p,1),p.getComponent(y.default).show(null),p.position=this.node.position.clone().subtract(h.battleDataProxy.gameCamera.position)}else this.addMapBlockEffect(t);else this.addMapBlockEffect(t);else this.addMapBlockEffect(t);r.AudioManager.instance.playEffectPath("sounds/blockCollision",u.Bundles.RES),this.changeBlockImg()}},e.prototype.addMapBlockEffect=function(t,e){var a=this;void 0===e&&(e=1);var i=h.battleDataProxy.blockLayout.convertToNodeSpaceAR(cc.v3(t));this.getBlockEffectPb(function(t){if(h.battleDataProxy.blockLayout&&h.battleDataProxy.blockLayout.isValid){var o=p.default.instance.getNode(t);h.battleDataProxy.blockLayout.addChild(o,1),o.position=i,o.getComponent(_.default).play(e,a._isPlayIceBroken)}})},e.prototype.getBlockEffectPb=function(t){1==this._stageChapter?t&&t(this.mMapBlockEffectPb):c.ResUtil.loadAsset({path:"prefabs/effect/MapBlockEffect"+this._stageChapter,type:cc.Prefab,bundleName:u.Bundles.GAME}).then(function(e){t&&t(e)}).catch(function(e){console.log("error:",e),t&&t(null)})},e.prototype.addDestroyAllBlockEffect=function(){c.ResUtil.loadAsset({path:"prefabs/effect/DestroyAllBlockEffect",type:cc.Prefab,bundleName:u.Bundles.GAME}).then(function(t){var e=cc.instantiate(t);h.battleDataProxy.top1.addChild(e),e.position=cc.v3(70,175),e.getComponent(f.default).play()}).catch(function(t){console.log("error:",t)})},e.prototype.changeBlockImg=function(){var t=this,e=Math.floor(this._stoneHp/this._maxHp/.2);e<1?e=1:e>4&&(e=4),c.ResUtil.loadAsset({path:"textures/mapAdorn/MapAdorn",type:cc.SpriteAtlas,bundleName:u.Bundles.GAME}).then(function(a){t.mBlockImg.spriteFrame=a.getSpriteFrame("pic_ditu"+t._stageChapter+"zhuan_"+e)}).catch(function(t){console.log("error:",t)});var a=this.node.getChildByName("snowImg");a.active&&e<=3&&(a.active=!1)},__decorate([P(cc.Sprite)],e.prototype,"mBlockImg",void 0),__decorate([P(cc.Prefab)],e.prototype,"mMapBlockEffectPb",void 0),__decorate([P(cc.Prefab)],e.prototype,"mWeatherIceBrokenPb",void 0),__decorate([v],e)}(cc.Component);n.default=b,cc._RF.pop(),cc._RF.pop()},{}],MapGridItem:[function(t,e,a){"use strict";cc._RF.push(e,"484ffl9tiNEC7H90VoURaUZ","MapGridItem");var i=t,o=e,n=a;cc._RF.push(o,"a7240vTAWhA6Irv9aPa3TL0","MapGridItem"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("ResUtil"),s=i("GameEnum"),c=i("HomeEnum"),l=i("BattleDataProxy"),u=cc._decorator,p=u.ccclass,h=u.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mFrame=null,e.mBG=null,e.mState=null,e.mAdd=null,e.Course=null,e._rowcol=null,e._bgStatus=s.GridBgStatus.NONE,e._gridStatus=s.GridStatus.NORMAL,e._belongTo=null,e._size=0,e._bValid=!1,e._isBlackHole=!1,e}return __extends(e,t),Object.defineProperty(e.prototype,"rowCol",{get:function(){return this._rowcol},set:function(t){this._rowcol=t;var e=this.node.getChildByName("test");e.getComponent(cc.Label).string=this._rowcol,e.active=!1},enumerable:!1,configurable:!0}),e.prototype.showTest=function(){this.node.getChildByName("test").active=!0},Object.defineProperty(e.prototype,"belongTo",{get:function(){return this._belongTo},set:function(t){this._belongTo=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bValid",{get:function(){return this._bValid},set:function(t){this._bValid=t,t&&(this.mBG.active=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isBlackHole",{get:function(){return this._isBlackHole},set:function(t){this._isBlackHole=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gridSize",{get:function(){return this._size},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){var t=this;this._size=this.node.getContentSize().width;var e="";l.battleDataProxy.weatherType==s.WeatherType.IceAndSnow?e="textures/weather/pic_gezi_tianqi5":l.battleDataProxy.weatherType==s.WeatherType.SandWind&&(e="textures/weather/pic_gezi_tianqi4"),""!=e&&r.ResUtil.loadAsset({path:e,type:cc.SpriteFrame,bundleName:c.Bundles.GAME}).then(function(e){t.mBG.getComponent(cc.Sprite).spriteFrame=e}).catch(function(t){console.log("error:",t)})},e.prototype.onDestroy=function(){},e.prototype.setBgStatus=function(t){if(t!=this._bgStatus){this._bgStatus=t;var e=null;switch(t){case s.GridBgStatus.NONE:e=s.GridColor.COLOR_NORMAL,this.mState.active=!1;break;case s.GridBgStatus.CHECK_EMPTY:e=s.GridColor.COLOR_EMPTY,this.mState.active=!0;break;case s.GridBgStatus.CHECK_HOLD:e=s.GridColor.COLOR_HOLD,this.mState.active=!0}this.mState.color=cc.color(e)}},e.prototype.setGridStatus=function(t){if(t!=this._gridStatus)switch(this._gridStatus=t,t){case s.GridStatus.NORMAL:this.mAdd.active=!1;break;case s.GridStatus.Add:this.mAdd.active=!0}},e.prototype.checkBorderShow=function(t){var e,a,i,o,n;if(this.bValid){for(var r=this.rowCol.split("-").map(Number),s=r[0],c=r[1],l=[[0,-1],[0,1],[-1,0],[1,0]],u=0;u<l.length;++u){var p=l[u],h=((null===(e=t[s+p[0]])||void 0===e?void 0:e[c+p[1]])||0)<=0;if(this.mFrame.children[u].active=h,2==u)if(h){var d=((null===(a=t[s+(f=l[0])[0]])||void 0===a?void 0:a[c+f[1]])||0)<=0;this.mFrame.getChildByName("point1").active=d;var m=((null===(i=t[s+(_=l[1])[0]])||void 0===i?void 0:i[c+_[1]])||0)<=0;this.mFrame.getChildByName("point2").active=m}else this.mFrame.getChildByName("point1").active=!1,this.mFrame.getChildByName("point2").active=!1;else if(3==u)if(h){var f,_;d=((null===(o=t[s+(f=l[0])[0]])||void 0===o?void 0:o[c+f[1]])||0)<=0,this.mFrame.getChildByName("point3").active=d,m=((null===(n=t[s+(_=l[1])[0]])||void 0===n?void 0:n[c+_[1]])||0)<=0,this.mFrame.getChildByName("point4").active=m}else this.mFrame.getChildByName("point3").active=!1,this.mFrame.getChildByName("point4").active=!1}for(u=0;u<t.length;u++)for(var y=0;y<t[u].length;y++)this.mBG.active=!0}},e.prototype.showFrame=function(t){this.mFrame.active=t},__decorate([h(cc.Node)],e.prototype,"mFrame",void 0),__decorate([h(cc.Node)],e.prototype,"mBG",void 0),__decorate([h(cc.Node)],e.prototype,"mState",void 0),__decorate([h(cc.Node)],e.prototype,"mAdd",void 0),__decorate([h(cc.Node)],e.prototype,"Course",void 0),__decorate([p],e)}(cc.Component);n.default=d,cc._RF.pop(),cc._RF.pop()},{}],MathUtil:[function(t,e,a){"use strict";cc._RF.push(e,"e6edbIdRmdH65RRxYBZH4Kk","MathUtil");var i=t,o=e,n=a;cc._RF.push(o,"2e69egQo1NClb5CPwh2qA5g","MathUtil");var r=function(t,e){var a="function"==typeof Symbol&&t[Symbol.iterator];if(!a)return t;var i,o,n=a.call(t),r=[];try{for(;(void 0===e||e-- >0)&&!(i=n.next()).done;)r.push(i.value)}catch(u){o={error:u}}finally{try{i&&!i.done&&(a=n.return)&&a.call(n)}finally{if(o)throw o.error}}return r},s=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(r(arguments[e]));return t};Object.defineProperty(n,"__esModule",{value:!0}),n.MathUtil=n.SortAlgorithm=n.SortOrder=void 0;var c,l,u=i("RandomUtil");(function(t){t[t.ASC=0]="ASC",t[t.DESC=1]="DESC"})(c=n.SortOrder||(n.SortOrder={})),function(t){t[t.SYSTEM=0]="SYSTEM",t[t.BUBBLE=1]="BUBBLE",t[t.DICHOTOMY=2]="DICHOTOMY",t[t.INSERTION=3]="INSERTION"}(l=n.SortAlgorithm||(n.SortAlgorithm={}));var p=function(){function t(){}return t.GetCoinString=function(t,e){var a="",i=t.split("-"),o=i.length,n=(o=o>this.coinType.length?this.coinType.length:o)-e;n=n<0?0:n;for(var r=[],s=o-1;s>=n;s--)r.push(this.coinType[s]);for(s=0;s<r.length;s++){var c=Number(i[s]);0!=c&&(a+=c+r[s])}return a+(a?"":"0")},t.GetCoinStringDot=function(t,e,a){void 0===a&&(a=1);var i="",o=t.split("-"),n=o.length,r=(n=n>this.coinType.length?this.coinType.length:n)-e;r=r<0?0:r;for(var s=this.coinType[r],c=Math.min(o.length,2),l=0;l<c;l++){var u=Number(o[l]);if((0!=u||0!==l)&&(0===l&&(i+=u+(c>1?".":"")),1===l)){var p="";1==a?p=(u/1e3).toString().match(/^-?\d+(?:\.\d{0,1})?/)[0]:(p=(u/1e3).toString().match(/^-?\d+(?:\.\d{0,2})?/)[0]).length<=1&&(p+="0");var h=p;p.includes(".")&&(h=p.split(".")[1]),i+=h}}if(i){if(i.includes(".")){var d=i.split(".");d[0].length>=3?i=i.substring(0,3):d[0].length+d[1].length>3&&(i=d[0]+"."+d[1].substring(0,3-d[0].length))}i+=s}else i+="0";return i},t.formatValue=function(t,e,a){if(void 0===e&&(e=1),void 0===a&&(a=3),isNaN(t))return"0";if((t=Number(t))<1e4)return this.formatNumber(t);var i=1,o=t%1e3;o<1e3&&0!=o&&(i=2);var n=(t=Math.floor(t)).toString();t>=1e20&&(n=this.toNonExponential(t));for(var r=n.split(""),s="",c=0,l=r.length-1;l>=0;l--)0!=c&&c%a==0&&(s="-"+s),s=r[l]+s,c++;return t>=1e4?this.GetCoinStringDot(s,e,i):t.toString()},t.toNonExponential=function(t){t==1/0&&(t=99e306);var e=t.toExponential().split("e"),a=0;e[0].split(".").length>1&&(a=e[0].split(".")[1].length),a&&(e[0]=e[0].replace(".",""));for(var i=Number(e[1].replace("+","")),o=a;o<i;o++)e[0]+="0";return e[0]},t.sort=function(t,e,a,i){if(void 0===e&&(e=null),void 0===a&&(a=c.ASC),void 0===i&&(i=l.SYSTEM),t.length<=1)return t;if(l.SYSTEM===i)return t.sort(function(t,i){var o=t&&e?t[e]:t||0,n=i&&e?i[e]:i||0;return c.ASC===a?o-n:n-o});if(l.BUBBLE===i){for(var o=P=t.length,n=0;n<P;n++){for(var r=t[0]&&e?t[0][e]:t[0]||0,u=!0,p=o-1,h=0;h<p;h++){var d=t[h+1]&&e?t[h+1][e]:t[h+1]||0;if(c.ASC===a&&r>d||c.DESC===a&&r<d){var m=t[h];t[h]=t[h+1],t[h+1]=m,u=!1,o=h+1}else r=d}if(u)break}return t}if(l.DICHOTOMY===i){var f=t.length>>1,_=t[f]&&e?t[f][e]:t[f]||0,y=[],g=[];for(n=0;n<t.length;n++)if(n!==f){var v=t[n]&&e?t[n][e]:t[n]||0;v===_?n<f?y.push(t[n]):g.push(t[n]):c.ASC===a&&v>_||c.DESC===a&&v<_?g.push(t[n]):y.push(t[n])}return s(this.sort(y,e,a,i),[t[f]],this.sort(g,e,a,i))}if(l.INSERTION===i){var P=t.length;for(n=1;n<P;n++)if(r=t[n]&&e?t[n][e]:t[n]||0,c.ASC===a){for(o=0,h=n-1;h>=0;h--)if(r>=(d=t[h]&&e?t[h][e]:t[h]||0)){o=h+1;break}m=t[n];for(var b=n;b>o;b--)t[b]=t[b-1];t[o]=m}else{for(o=n,h=0;h<n;h++)if(r<(d=t[h]&&e?t[h][e]:t[h]||0)){o=h;break}for(m=t[n],b=n;b>o;b--)t[b]=t[b-1];t[o]=m}return t}return t},t.toFixed=function(t,e){return Number(t.toFixed(e))},t.toFloor=function(t,e){var a=Math.pow(10,e);return Math.floor(t*a)/a},t.toCeil=function(t,e){var a=Math.pow(10,e);return Math.ceil(t*a)/a},t.formatNumber=function(t,e){return void 0===e&&(e=1),t?t%1==0?t.toFixed(0):t.toFixed(e):"0"},t.getMinRotate=function(t){return t>=360?(t-=360,this.getMinRotate(t)):t<0?(t+=360,this.getMinRotate(t)):t},t.angle2Radians=function(t){return Math.PI/180*t},t.radians2Angle=function(t){return 180/Math.PI*t},t.numToChinese=function(t){if(!/^\d*(\.\d*)?$/.test(t))return alert("Number is wrong!"),"Number is wrong!";for(var e=new Array("\u96f6","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d","\u4e03","\u516b","\u4e5d"),a=new Array("","\u5341","\u767e","\u5343","\u4e07","\u4ebf","\u70b9",""),i=(""+t).replace(/(^0*)/g,"").split("."),o=0,n="",r=i[0].length-1;r>=0;r--){switch(o){case 0:n=a[7]+n;break;case 4:new RegExp("0{4}\\d{"+(i[0].length-r-1)+"}$").test(i[0])||(n=a[4]+n);break;case 8:n=a[5]+n,a[7]=a[5],o=0}o%4==2&&0!=Number(i[0].charAt(r+2))&&0==Number(i[0].charAt(r+1))&&(n=e[0]+n),0!=Number(i[0].charAt(r))&&(n=e[i[0].charAt(r)]+a[o%4]+n),o++}if(i.length>1)for(n+=a[6],r=0;r<i[1].length;r++)n+=e[i[1].charAt(r)];return n},t.lerp=function(t,e,a){return t+(e-t)*a},t.slerp=function(e,a,i){var o=t.getMinRotate(e)*Math.PI/180,n=t.getMinRotate(a)*Math.PI/180,r=Math.acos(Math.cos(o)*Math.cos(n)+Math.sin(o)*Math.sin(n)),s=Math.sin(r);return Math.sin((1-i)*r)/s*e+Math.sin(i*r)/s*a},t.bezier=function(t,e,a,i,o){var n=1-o;return n*(n*(t+(3*e-t)*o)+3*a*o*o)+i*o*o*o},t.bezierTo=function(e,a,i,o,n,r,s){void 0===s&&(s="");var c=i.x,l=i.y,u=o.x,p=o.y,h=Object.create(null);return h.progress=function(e,a,i,o){return i.x=t.bezier(e.x,c,u,a.x,o),i.y=t.bezier(e.y,l,p,a.y,o),r&&r(i,o),i},""!=s&&(h.easing=s),cc.tween(e).to(a,{position:n},h)},t.transProbByWeight=function(t,e){return t/e.reduce(function(t,e){return t+e},0)},t.objectWeightedRandom=function(t,e){if(void 0===e&&(e="Weight"),!t||0==t.length)return-1;if(1==t.length)return 0;var a=0;t.forEach(function(t){a+=t[""+e]});for(var i=u.RandomUtil.randomInt(0,a),o=0;o<t.length;++o){if(i<t[o][""+e])return o;i-=t[o][""+e]}return-1},t.weightedRandom=function(t){if(!t||0==t.length)return-1;if(1==t.length)return 0;var e=0;t.forEach(function(t){e+=t});for(var a=u.RandomUtil.randomInt(0,e),i=0;i<t.length;++i){if(a<t[i])return i;a-=t[i]}return-1},t.getRadian=function(t){return 3.1415926/180*t},t.getAngle=function(t){return Math.floor(cc.misc.radiansToDegrees(t))},t.getDoublPointRadian=function(t,e){var a=t.sub(e),i=cc.v2(1,0);return-cc.v2(a).signAngle(i)},t.distance=function(t,e){var a=t.x-e.x,i=t.y-e.y;return Math.sqrt(a*a+i*i)},t.getPerpendicularVector=function(t,e){return cc.v2(-t.y,t.x).add(e)},t.coinType=["","k","m","b","t","aa","ab","ac","ad","ae","af","ag","ah","ai","aj","ak","al","am","an","ao","ap","aq","ar","as","at","au","av","aw","ax","ay","az"],t}();n.MathUtil=p,cc._RF.pop(),cc._RF.pop()},{}],Md5:[function(t,e,a){"use strict";cc._RF.push(e,"fd91aPZq2lIBLiykQYLGegT","Md5");var i=e,o=a;cc._RF.push(i,"db7daerdrBF9IGZbr4xKwiE","Md5"),Object.defineProperty(o,"__esModule",{value:!0}),o.md5=void 0,o.md5=function(t){var e=function(t,e){return t<<e|t>>>32-e},a=function(t,e){var a,i,o,n,r;return o=2147483648&t,n=2147483648&e,r=(1073741823&t)+(1073741823&e),(a=1073741824&t)&(i=1073741824&e)?2147483648^r^o^n:a|i?1073741824&r?3221225472^r^o^n:1073741824^r^o^n:r^o^n},i=function(t,e,a){return t&e|~t&a},o=function(t,e,a){return t&a|e&~a},n=function(t,e,a){return t^e^a},r=function(t,e,a){return e^(t|~a)},s=function(t,o,n,r,s,c,l){return t=a(t,a(a(i(o,n,r),s),l)),a(e(t,c),o)},c=function(t,i,n,r,s,c,l){return t=a(t,a(a(o(i,n,r),s),l)),a(e(t,c),i)},l=function(t,i,o,r,s,c,l){return t=a(t,a(a(n(i,o,r),s),l)),a(e(t,c),i)},u=function(t,i,o,n,s,c,l){return t=a(t,a(a(r(i,o,n),s),l)),a(e(t,c),i)},p=function(t){for(var e,a=t.length,i=a+8,o=16*((i-i%64)/64+1),n=Array(o-1),r=0,s=0;s<a;)r=s%4*8,n[e=(s-s%4)/4]=n[e]|t.charCodeAt(s)<<r,s++;return r=s%4*8,n[e=(s-s%4)/4]=n[e]|128<<r,n[o-2]=a<<3,n[o-1]=a>>>29,n},h=function(t){var e,a="",i="";for(e=0;e<=3;e++)a+=(i="0"+(t>>>8*e&255).toString(16)).substr(i.length-2,2);return a},d=function(t){t=t.toString().replace(/\x0d\x0a/g,"\n");for(var e="",a=0;a<t.length;a++){var i=t.charCodeAt(a);i<128?e+=String.fromCharCode(i):i>127&&i<2048?(e+=String.fromCharCode(i>>6|192),e+=String.fromCharCode(63&i|128)):(e+=String.fromCharCode(i>>12|224),e+=String.fromCharCode(i>>6&63|128),e+=String.fromCharCode(63&i|128))}return e};return function(t){var e,i,o,n,r,m,f,_,y,g=Array();for(t=d(t),g=p(t),m=1732584193,f=4023233417,_=2562383102,y=271733878,e=0;e<g.length;e+=16)i=m,o=f,n=_,r=y,m=s(m,f,_,y,g[e+0],7,3614090360),y=s(y,m,f,_,g[e+1],12,3905402710),_=s(_,y,m,f,g[e+2],17,606105819),f=s(f,_,y,m,g[e+3],22,3250441966),m=s(m,f,_,y,g[e+4],7,4118548399),y=s(y,m,f,_,g[e+5],12,1200080426),_=s(_,y,m,f,g[e+6],17,2821735955),f=s(f,_,y,m,g[e+7],22,4249261313),m=s(m,f,_,y,g[e+8],7,1770035416),y=s(y,m,f,_,g[e+9],12,2336552879),_=s(_,y,m,f,g[e+10],17,4294925233),f=s(f,_,y,m,g[e+11],22,2304563134),m=s(m,f,_,y,g[e+12],7,1804603682),y=s(y,m,f,_,g[e+13],12,4254626195),_=s(_,y,m,f,g[e+14],17,2792965006),f=s(f,_,y,m,g[e+15],22,1236535329),m=c(m,f,_,y,g[e+1],5,4129170786),y=c(y,m,f,_,g[e+6],9,3225465664),_=c(_,y,m,f,g[e+11],14,643717713),f=c(f,_,y,m,g[e+0],20,3921069994),m=c(m,f,_,y,g[e+5],5,3593408605),y=c(y,m,f,_,g[e+10],9,38016083),_=c(_,y,m,f,g[e+15],14,3634488961),f=c(f,_,y,m,g[e+4],20,3889429448),m=c(m,f,_,y,g[e+9],5,568446438),y=c(y,m,f,_,g[e+14],9,3275163606),_=c(_,y,m,f,g[e+3],14,4107603335),f=c(f,_,y,m,g[e+8],20,1163531501),m=c(m,f,_,y,g[e+13],5,2850285829),y=c(y,m,f,_,g[e+2],9,4243563512),_=c(_,y,m,f,g[e+7],14,1735328473),f=c(f,_,y,m,g[e+12],20,2368359562),m=l(m,f,_,y,g[e+5],4,4294588738),y=l(y,m,f,_,g[e+8],11,2272392833),_=l(_,y,m,f,g[e+11],16,1839030562),f=l(f,_,y,m,g[e+14],23,4259657740),m=l(m,f,_,y,g[e+1],4,2763975236),y=l(y,m,f,_,g[e+4],11,1272893353),_=l(_,y,m,f,g[e+7],16,4139469664),f=l(f,_,y,m,g[e+10],23,3200236656),m=l(m,f,_,y,g[e+13],4,681279174),y=l(y,m,f,_,g[e+0],11,3936430074),_=l(_,y,m,f,g[e+3],16,3572445317),f=l(f,_,y,m,g[e+6],23,76029189),m=l(m,f,_,y,g[e+9],4,3654602809),y=l(y,m,f,_,g[e+12],11,3873151461),_=l(_,y,m,f,g[e+15],16,530742520),f=l(f,_,y,m,g[e+2],23,3299628645),m=u(m,f,_,y,g[e+0],6,4096336452),y=u(y,m,f,_,g[e+7],10,1126891415),_=u(_,y,m,f,g[e+14],15,2878612391),f=u(f,_,y,m,g[e+5],21,4237533241),m=u(m,f,_,y,g[e+12],6,1700485571),y=u(y,m,f,_,g[e+3],10,2399980690),_=u(_,y,m,f,g[e+10],15,4293915773),f=u(f,_,y,m,g[e+1],21,2240044497),m=u(m,f,_,y,g[e+8],6,1873313359),y=u(y,m,f,_,g[e+15],10,4264355552),_=u(_,y,m,f,g[e+6],15,2734768916),f=u(f,_,y,m,g[e+13],21,1309151649),m=u(m,f,_,y,g[e+4],6,4149444226),y=u(y,m,f,_,g[e+11],10,3174756917),_=u(_,y,m,f,g[e+2],15,718787259),f=u(f,_,y,m,g[e+9],21,3951481745),m=a(m,i),f=a(f,o),_=a(_,n),y=a(y,r);return(h(m)+h(f)+h(_)+h(y)).toLowerCase()}(t)},cc._RF.pop(),cc._RF.pop()},{}],MessagePopup:[function(t,e,a){"use strict";cc._RF.push(e,"e0da76jibtP5bZnnZ3DCGHU","MessagePopup");var i=t,o=e,n=a;cc._RF.push(o,"f4cb4anhUdAIZ4esX+fixOj","MessagePopup"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("PopupBase"),s=i("BattleDataProxy"),c=cc._decorator,l=c.ccclass,u=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mVideoIcon=null,e.mTitle=null,e.mTips=null,e._closeFunc=null,e}return __extends(e,t),e.prototype.init=function(t){var e=t.title,a=t.tips,i=t.isVideo,o=t.isGameVideo,n=t.closeLab,r=t.sltLab,c=t.hideClose;this._closeFunc=t.callBack,e&&""!=e&&(this.mTitle.string=e),a&&""!=a&&(this.mTips.string=a),this.mVideoIcon.active=i,i&&o&&s.battleDataProxy.setVideoCardIcon(this.mVideoIcon,1,1.2),n&&""!=n&&(this.node.getChildByName("btnClose").getChildByName("lab").getComponent(cc.Label).string=n),r&&""!=r&&(this.mVideoIcon.parent.getChildByName("lab").getComponent(cc.Label).string=r),c&&(this.node.getChildByName("btnClose").active=!1,this.node.getChildByName("btnAgain").x=0)},e.prototype.onBtnClose=function(){this._closeFunc&&this._closeFunc(!1),this.removeUI()},e.prototype.onBtnAgain=function(){this._closeFunc&&this._closeFunc(!0),this.removeUI()},__decorate([u(cc.Node)],e.prototype,"mVideoIcon",void 0),__decorate([u(cc.Label)],e.prototype,"mTitle",void 0),__decorate([u(cc.Label)],e.prototype,"mTips",void 0),__decorate([l],e)}(r.PopupBase);n.default=p,cc._RF.pop(),cc._RF.pop()},{}],MotionTrail:[function(t,e,a){"use strict";cc._RF.push(e,"3848drlpYZCoZOyJ8aBGyRs","MotionTrail");var i=e,o=a;cc._RF.push(i,"3d7e6uCAmFKwYsy7vP78Ci9","MotionTrail"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc.gfx,r=function(){this.x=0,this.y=0,this.dis=0,this.cos=0,this.sin=0},s=cc._decorator,c=s.ccclass,l=s.property,u=s.playOnFocus,p=s.menu,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.atlas=null,e._spriteFrame=null,e._active=!0,e._isWorldXY=!0,e.offset=cc.v2(0,0),e._length=20,e._headWidth=100,e._tailWidth=0,e._headOpacity=255,e._tailOpacity=0,e.renderData=null,e.meshID=0,e.capacity=0,e.verticesCount=0,e.indicesCount=0,e.$flush=null,e.$xyOffset=1e8,e.$uvOffset=1e8,e.$colorOffset=1e8,e.$step=0,e.trailData=[],e.$getVData=function(){return e.renderData.vDatas[e.meshID]},e.$getUintVData=function(){return e.renderData.uintVDatas[e.meshID]},e.$getIData=function(){return e.renderData.iDatas[e.meshID]},e}return __extends(e,t),Object.defineProperty(e.prototype,"$spriteFrame",{get:function(){return this._spriteFrame},set:function(t){this._spriteFrame=t,this.$updateSpriteFrame()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"active",{get:function(){return this._active},set:function(t){this._active=t,this.enabled=t,this.$updateActive()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$isWorldXY",{get:function(){return this._isWorldXY},set:function(t){this._isWorldXY=t,this.$updateXY()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._length},set:function(t){this._length=Math.max(t,0),this.updateLength(),this.updateWidth(),this.$updateUV(),this.$updateColor(),this.resetPos()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"headWidth",{get:function(){return this._headWidth},set:function(t){this._headWidth=Math.max(t,0),this.updateWidth()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tailWidth",{get:function(){return this._tailWidth},set:function(t){this._tailWidth=Math.max(t,0),this.updateWidth()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"headOpacity",{get:function(){return this._headOpacity},set:function(t){this._headOpacity=t,this.$updateColor()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tailOpacity",{get:function(){return this._tailOpacity},set:function(t){this._tailOpacity=t,this.$updateColor()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$vDataLength",{get:function(){return this.verticesCount*this.$step},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$iDataLength",{get:function(){return this.indicesCount},enumerable:!1,configurable:!0}),e.prototype._resetAssembler=function(){var t=this._assembler=new d;t.init(this),t.updateRenderData=this.$onFlushed.bind(this),this.$flush=this.setVertsDirty;var e=this.renderData=new cc.RenderData;e.init(t),this.meshID=e.meshCount,this.$init()},e.prototype.$init=function(){this.$setVFmt(),this.updateLength(),this.updateWidth(),this.node.on(cc.Node.EventType.COLOR_CHANGED,this.$updateColor,this),this.resetPos()},e.prototype.start=function(){this.$updateSpriteFrame(),cc.director.once(cc.Director.EVENT_AFTER_DRAW,this.$updateColor,this)},e.prototype.initMotionTrail=function(){this.active=!0},e.prototype.$setVFmt=function(t){void 0===t&&(t=new n.VertexFormat([{name:n.ATTR_POSITION,type:n.ATTR_TYPE_FLOAT32,num:2},{name:n.ATTR_UV0,type:n.ATTR_TYPE_FLOAT32,num:2},{name:n.ATTR_COLOR,type:n.ATTR_TYPE_UINT8,num:4,normalize:!0}]));var e=this._assembler;cc.sys.isNative&&e.setVertexFormat(t);for(var a=t._elements,i=a.length-1;i>-1;--i)this.$step+=a[i].bytes>>2;var o=t._attr2el;this.$xyOffset=o[n.ATTR_POSITION].offset>>2,this.$uvOffset=o[n.ATTR_UV0].offset>>2,this.$colorOffset=o[n.ATTR_COLOR].offset>>2},e.prototype.$createBuffer=function(t,e,a){void 0===e&&(e=t-2),void 0===a&&(a=2),a=Math.max(a,1.5);var i=this.renderData;this.verticesCount=Math.max(t,0),this.indicesCount=Math.max(3*e,0);var o=!i.vDatas[this.meshID];if(this.verticesCount>this.capacity?(this.capacity=~~Math.max(this.capacity*a,this.verticesCount),o=!0):this.verticesCount<this.capacity/a&&(this.capacity=~~Math.max(this.capacity/a,this.verticesCount),o=!0),o){var n=new Float32Array(this.verticesCount*this.$step),r=new Uint16Array(this.indicesCount);i.updateMesh(this.meshID,n,r)}this.$updateIndice()},e.prototype.update=function(){cc.sys.isNative&&this.$updateColor(),this.$flush()},e.prototype.$onFlushed=function(){if(!1!==this.active&&null!==this.$spriteFrame&&0!==this.length){for(var t=this.trailData,e=this.length-1;e>0;--e){var a=t[e],i=t[e-1];a.x=i.x,a.y=i.y,a.sin=i.sin,a.cos=i.cos}if(this.$isWorldXY){var o=this.node._worldMatrix.m;this.node._updateWorldMatrix(),t[0].x=this.offset.x+o[12],t[0].y=this.offset.y+o[13]}else t[0].x=this.offset.x+this.node.x,t[0].y=this.offset.y+this.node.y;this.$updateXY()}},e.prototype.$updateActive=function(){this.active&&this.resetPos()},e.prototype.$updateSpriteFrame=function(){var t=this.$spriteFrame,e=this.getMaterial(0)||cc.Material.getBuiltinMaterial("2d-sprite");e.define("USE_TEXTURE",!0),e.setProperty("texture",t?t.getTexture():null),this.$updateUV()},e.prototype.$updateXY=function(){var t=this.$getVData(),e=null,a=null,i=0,o=0,n=0,r=0,s=0,c=this.$step,l=0,u=0;this.$isWorldXY||(l=this.node.x,u=this.node.y);for(var p=this.trailData,h=0,d=this.length-1;h<d;++h){if(e=p[h],a=p[h+1],i=e.x-l,o=e.y-u,n=a.x-l,r=a.y-u,0===h){var m=Math.atan2(r-o,n-i);e.sin=Math.sin(m),e.cos=Math.cos(m)}t[s]=i+e.dis*e.sin,t[s+1]=o-e.dis*e.cos,t[s+=c]=i-e.dis*e.sin,t[s+1]=o+e.dis*e.cos,s+=c}t[s]=n+a.dis*e.sin,t[s+1]=r-a.dis*e.cos,t[s+=c]=n-a.dis*e.sin,t[s+1]=r+a.dis*e.cos},e.prototype.$updateUV=function(){if(null!==this.$spriteFrame){for(var t=this.$getVData(),e=this.$step,a=1/(this.trailData.length-1),i=this.$uvOffset,o=0,n=this.$vDataLength;i<n;i+=e,++o)t[i]=1&o,t[i+1]=1-a*(o>>1);this.$fitUV()}},e.prototype.$updateColor=function(){for(var t=this.$getUintVData(),e=this.length,a=this.headOpacity,i=(a-this.tailOpacity)/(e-1),o=this.node.opacity/255,n=this.node.color.b<<16|this.node.color.g<<8|this.node.color.r,r=0,s=this.$colorOffset,c=this.$step;r<e;++r){var l=(a-i*r)*o<<24|n;t[s]=l,t[s+=c]=l,s+=c}},e.prototype.$updateIndice=function(){for(var t=this.$getIData(),e=0,a=0,i=this.$iDataLength;e<i;++a)t[e++]=a,t[e++]=a+1,t[e++]=a+2},e.prototype.updateLength=function(){var t=this.length;this.trailData=[];for(var e=0;e<t;++e)this.trailData[e]=new r;this.$createBuffer(t<<1)},e.prototype.updateWidth=function(){for(var t=this.trailData,e=this.length,a=.5*this.headWidth,i=(a-.5*this.tailWidth)/(e-1),o=0;o<e;++o)t[o].dis=a-i*o},e.prototype.resetPos=function(){var t=this.trailData,e=this.offset.x,a=this.offset.y;if(this.$isWorldXY){var i=this.node._worldMatrix.m;this.node._updateWorldMatrix(),e+=i[12],a+=i[13]}else e+=this.node.x,a+=this.node.y;for(var o=this.length-1;o>-1;--o)t[o].x=e,t[o].y=a;for(var n=this.$getVData(),r=this.$step,s=(o=0,this.$vDataLength);o<s;o+=r)n[o]=e,n[o+1]=a},e.prototype.$fitUV=function(){if(null!==this.$spriteFrame){var t=this.$step,e=this.$spriteFrame.getTexture().width,a=this.$spriteFrame.getTexture().height,i=this.$spriteFrame.getRect(),o=this.$getVData();if(this.$spriteFrame._rotated)for(var n=this.$uvOffset,r=0,s=this.$vDataLength;n<s;n+=t,++r){var c=o[n];o[n]=((1-o[n+1])*i.height+i.x)/e,o[n+1]=(c*i.width+i.y)/a}else for(n=this.$uvOffset,r=0,s=this.$vDataLength;n<s;n+=t,++r)o[n]=(o[n]*i.width+i.x)/e,o[n+1]=(o[n+1]*i.height+i.y)/a}},e.prototype.onDestroy=function(){this.node.targetOff(this)},__decorate([l({type:cc.SpriteAtlas,editorOnly:!0,readonly:!0,displayName:!1})],e.prototype,"atlas",void 0),__decorate([l],e.prototype,"_spriteFrame",void 0),__decorate([l({type:cc.SpriteFrame,displayName:!1})],e.prototype,"$spriteFrame",null),__decorate([l],e.prototype,"_active",void 0),__decorate([l({displayName:!1,tooltip:!1})],e.prototype,"active",null),__decorate([l],e.prototype,"_isWorldXY",void 0),__decorate([l({displayName:!1,tooltip:!1})],e.prototype,"$isWorldXY",null),__decorate([l({displayName:!1})],e.prototype,"offset",void 0),__decorate([l],e.prototype,"_length",void 0),__decorate([l({type:cc.Integer,displayName:!1})],e.prototype,"length",null),__decorate([l],e.prototype,"_headWidth",void 0),__decorate([l({displayName:!1})],e.prototype,"headWidth",null),__decorate([l],e.prototype,"_tailWidth",void 0),__decorate([l({displayName:!1})],e.prototype,"tailWidth",null),__decorate([l],e.prototype,"_headOpacity",void 0),__decorate([l({type:cc.Integer,min:0,max:255,slide:!0,displayName:!1})],e.prototype,"headOpacity",null),__decorate([l],e.prototype,"_tailOpacity",void 0),__decorate([l({type:cc.Integer,min:0,max:255,slide:!0,displayName:!1})],e.prototype,"tailOpacity",null),__decorate([c,u,p("Comp/MotionTrail")],e)}(cc.RenderComponent);o.default=h;var d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.fillBuffers=function(t){var e=t.renderData.vDatas[t.meshID],a=t.renderData.iDatas[t.meshID],i=cc.renderer._handle._meshBuffer,o=i.request(t.verticesCount,t.indicesCount),n=o.byteOffset>>2,r=i._vData;e.length+n>r.length?r.set(e.subarray(0,r.length-n),n):r.set(e,n);for(var s=i._iData,c=o.indiceOffset,l=o.vertexOffset,u=0,p=a.length;u<p;u++)s[c++]=l+a[u]},e}(cc.Assembler);cc._RF.pop(),cc._RF.pop()},{}],MyWScoket:[function(t,e,a){"use strict";cc._RF.push(e,"5db14QoJElC3pcxMbXf3vAd","MyWScoket");var i=t,o=e,n=a;cc._RF.push(o,"11a63G9cfFPI4fmBmpqmxau","MyWScoket"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("CommonUtil"),s=function(){function t(t){this._name=t,this._isConn=!1,this._client=null}return t.prototype.conn=function(t){var e=this,a=null;if(cc.sys.isNative&&cc.sys.os==cc.sys.OS_ANDROID){var i=cc.url.raw("resources/cacert.pem");cc.loader.md5Pipe&&(i=cc.loader.md5Pipe.transformURL(i)),a=new WebSocket(t,null,i)}else a=new WebSocket(t);this._client=a,a.binaryType="arraybuffer",a.onopen=function(t){e._isConn=!0,e._socketSink.onopen(t)},a.onmessage=function(t){t&&t.data&&t.data instanceof ArrayBuffer?e._socketSink.onmessage(t.data):r.CommonUtil.print("onmessage error",t)},a.onclose=function(t){r.CommonUtil.print("====ws\u65ad\u5f00\u8fde\u63a5\uff01 name = ",e._name),e._isConn=!1,e._socketSink.onclose(t)},a.onerror=function(t){r.CommonUtil.print("====ws\u8fde\u63a5\u9519\u8bef\uff01 name = "+e._name," code="+t.errcode),e._isConn=!1,e._socketSink.onerror(t)},a.ontimeout=function(){r.CommonUtil.print("ws\u8fde\u63a5\u8d85\u65f6---ontimeout")}},t.prototype.send=function(t){try{this.isOpen()&&this._client.send(t)}catch(o){}},t.prototype.connect=function(t){return this.disconnect(),this.conn(t),0},t.prototype.disconnect=function(){this.isOpen()&&this._client.close()},t.prototype.isOpen=function(){return!!this._client&&this._isConn},t.prototype.setSocketSink=function(t){this._socketSink=t},t}();n.default=s,cc._RF.pop(),cc._RF.pop()},{}],NodePoolManager:[function(t,e,a){"use strict";cc._RF.push(e,"bcb7dhEfl1NR5kyTQU0hC4j","NodePoolManager");var i=e,o=a;cc._RF.push(i,"39169E6eFtIV5AxpMdeYfMG","NodePoolManager"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function t(){this.poolListMap=new Map,this.poolPrefabMap=new Map}return Object.defineProperty(t,"instance",{get:function(){return null==t._instance&&(t._instance=new t),t._instance},enumerable:!1,configurable:!0}),t.prototype.checkNodePoolVaild=function(t){this.poolListMap.has(t)||this.poolListMap.set(t,new cc.NodePool(t))},t.prototype.getNode=function(t){this.checkNodePoolVaild(t.name);var e=null,a=this.poolListMap.get(t.name);return(e=a&&a.size()>0?a.get():cc.instantiate(t)).active=!0,e},t.prototype.putNode=function(t,e,a){void 0===a&&(a=!0),this.checkNodePoolVaild(t.name),a&&(t.active=!1),e&&t.setPosition(-9999,-9999),this.poolListMap.get(t.name).put(t)},t.prototype.clearNodePool=function(t){this.poolListMap.has(t.name)&&(this.poolListMap.get(t.name).clear(),this.poolListMap.delete(t.name))},t.prototype.addPoolPrefab=function(t){this.poolPrefabMap.set(t.name,t),t.addRef()},t.prototype.getPoolPrefab=function(t){return this.poolPrefabMap.has(t)?this.poolPrefabMap.get(t):null},t.prototype.removePoolPrefab=function(t){this.poolPrefabMap.has(t)&&this.poolPrefabMap.get(t).decRef(),this.poolPrefabMap.delete(t)},t.prototype.clearAllPoolPrefab=function(){this.poolPrefabMap.forEach(function(t){t.decRef()}),this.poolPrefabMap.clear()},t._instance=null,t}();o.default=n,cc._RF.pop(),cc._RF.pop()},{}],NumericData:[function(t,e,a){"use strict";cc._RF.push(e,"dc6ceH9wRdJvpd7AB/4VhVA","NumericData");var i=t,o=e,n=a;cc._RF.push(o,"ac935/MOh5BLq4TVoCm8RKk","NumericData"),Object.defineProperty(n,"__esModule",{value:!0}),n.NumericData=void 0;var r=i("Numeric"),s=function(){function t(){this.propertyMap=new Map}return t.prototype.init=function(t){for(var e in t)isNaN(e)||this.propertyMap.set(Number(e),new r.default)},t.prototype.getNumeric=function(t){return this.propertyMap.has(t)?this.propertyMap.get(t):null},t.prototype.clear=function(){this.propertyMap.forEach(function(t){t.clear()}),this.propertyMap.clear()},t}();n.NumericData=s,cc._RF.pop(),cc._RF.pop()},{}],Numeric:[function(t,e,a){"use strict";cc._RF.push(e,"81bc92eQuJN3J768jsfXr7Y","Numeric");var i=e,o=a;cc._RF.push(i,"e4cc0zDPoNLC40Gcx6td8kJ","Numeric"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function t(){this.isFloor=!1,this.isCeil=!1,this._value=0,this._baseValue=0,this._addBaseValue=0,this._percentAdd=0,this._addValue=0,this._multiplyValue=1,this._limitPercentAdd=Number.MAX_SAFE_INTEGER,this._limitValue=Number.MAX_SAFE_INTEGER,this._getBaseValueFunc=null,this._getPercentAddFunc=null;var t=this;t._value=t._baseValue=t._addBaseValue=t._percentAdd=t._addValue=0}return Object.defineProperty(t.prototype,"value",{get:function(){return(this._getBaseValueFunc||this._getPercentAddFunc)&&this.update(),this._value=Math.min(this._value,this._limitValue),this._value},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"baseValue",{get:function(){return this._getBaseValueFunc?this._getBaseValueFunc():this._baseValue},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"addBaseValue",{get:function(){return this._addBaseValue},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rightBaseValue",{get:function(){return this.baseValue+this.addBaseValue},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"percentAdd",{get:function(){var t=this._percentAdd;return this._getPercentAddFunc&&(t=this._getPercentAddFunc()),Math.min(t,this._limitPercentAdd)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"addValue",{get:function(){return this._addValue},enumerable:!1,configurable:!0}),t.prototype.setBaseGetValueFunc=function(t){t&&(this._getBaseValueFunc=t,this.update())},t.prototype.setFixBase=function(t){this._baseValue=t,this._getBaseValueFunc=null,this.update()},t.prototype.changeAddBaseValue=function(t){this._addBaseValue+=t,this.update()},t.prototype.changePercentAdd=function(t){this._percentAdd+=t,this._getPercentAddFunc=null,this.update()},t.prototype.setPercentAddGetValueFunc=function(t){t&&(this._getPercentAddFunc=t,this.update())},t.prototype.changeAddValue=function(t){this._addValue+=t,this.update()},t.prototype.changeMultiplyValue=function(t,e){void 0===e&&(e=!0),t<=0||(e?this._multiplyValue*=t:this._multiplyValue/=t,this.update())},t.prototype.setLimitPercentAdd=function(t){this._limitPercentAdd=t},t.prototype.setLimitValue=function(t){this._limitValue=t},t.prototype.update=function(){var t=this,e=t.rightBaseValue*(1+t.percentAdd/100)*this._multiplyValue+t._addValue;t._value=t.isFloor?Math.floor(e):t.isCeil?Math.ceil(e):e},t.prototype.clear=function(){this._getBaseValueFunc=null},t}();o.default=n,cc._RF.pop(),cc._RF.pop()},{}],Objectvalues:[function(t,e){"use strict";cc._RF.push(e,"728e7NNYGNH65Q0JiW1o6P8","Objectvalues"),Object.values||(Object.values=function(t){if(t!==Object(t))throw new TypeError("Object.values called on a non-object");var e,a=[];for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&a.push(t[e]);return a}),cc._RF.pop()},{}],OtherDataProxy:[function(t,e,a){"use strict";cc._RF.push(e,"c1690B4bhxAppTUZsDm0WGK","OtherDataProxy");var i=t,o=e,n=a;cc._RF.push(o,"da372ZkkjNM7bQCLrvjezgt","OtherDataProxy"),Object.defineProperty(n,"__esModule",{value:!0}),n.otherDataProxy=n.OtherData=n.ConditionKey=n.EOtherDataEvent=void 0;var r=i("ProxyBase"),s=i("DataManager");(function(t){t.OLINE_UPDATE="EOtherDataEvent.OlineUpdate",t.TASK_UPDATE="EOtherDataEvent.TaskUpdate",t.CUMULATIVE_REWARD_UPDATE="EOtherDataEvent.CumulativeRewardUpdate",t.SIGN_UPDATE="EOtherDataEvent.SignUpdate"})(n.EOtherDataEvent||(n.EOtherDataEvent={})),function(t){t[t.MUTOU=1]="MUTOU",t[t.TIANFU=2]="TIANFU",t[t.SLAY=3]="SLAY",t[t.BUILD=4]="BUILD",t[t.LOOKAD=5]="LOOKAD",t[t.DRAWWW=6]="DRAWWW",t[t.UPGRADE=7]="UPGRADE",t[t.BATTLE=8]="BATTLE",t[t.RESETSKILL=9]="RESETSKILL"}(n.ConditionKey||(n.ConditionKey={}));var c=function(){this.onlineData=[],this.taskData=[],this.condition={},this.starNum=0,this.cumulativeRewardData={onlineSecond:0},this.signData={signDay:0,signTime:0,isTodaySign:!1}};n.OtherData=c;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"otherData",{get:function(){return this._data},enumerable:!1,configurable:!0}),e.prototype.addCondition=function(t,e){void 0===e&&(e=1),this.otherData.condition[t]+=e,this.saveData()},e.prototype.saveData=function(){s.DataManager.instance.writeGameDataBase(r.ProxyKey.OtherData,this.otherData)},e.prototype.resetData=function(){this._data=new c,s.DataManager.instance.saveGame()},e}(r.ProxyBase);n.default=l,n.otherDataProxy=new l(c),cc._RF.pop(),cc._RF.pop()},{}],PlacePlantEffect:[function(t,e,a){"use strict";cc._RF.push(e,"a8e65Yb+aZKiZL5hhkY6PiB","PlacePlantEffect");var i=t,o=e,n=a;cc._RF.push(o,"ac4b9dBSNBBBIhIK3wWjkjV","PlacePlantEffect"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("NodePoolManager"),s=cc._decorator,c=s.ccclass,l=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mPlaceSp=null,e}return __extends(e,t),e.prototype.onLoad=function(){var t=this;this.mPlaceSp.setCompleteListener(function(){r.default.instance.putNode(t.node)})},e.prototype.play=function(){this.mPlaceSp.setAnimation(0,"bang",!1)},__decorate([l(sp.Skeleton)],e.prototype,"mPlaceSp",void 0),__decorate([c],e)}(cc.Component);n.default=u,cc._RF.pop(),cc._RF.pop()},{}],PlantEquip10:[function(t,e,a){"use strict";cc._RF.push(e,"08c08PvlIhJmb+ZCDFYT9p8","PlantEquip10");var i=t,o=e,n=a;cc._RF.push(o,"0d9eetlaydFO61ECroB3lqe","PlantEquip10"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("GameEnum"),s=i("BattleDataProxy"),c=i("Util"),l=i("BulletBase"),u=i("EquipmentItem"),p=cc._decorator,h=p.ccclass,d=p.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mSuperBulletPb=null,e._checkSdTime=0,e}return __extends(e,t),e.prototype.update=function(e){t.prototype.update.call(this,e),s.battleDataProxy.gameState==r.GameState.PLAYING&&(this._checkSdTime+=e,this._checkSdTime)},e.prototype.ballCollisionEnter=function(){if(this.getCollisionIsValid()&&this.getIsCanAtk())if(t.prototype.ballCollisionEnter.call(this),this.addSuperTriggerCounter()){var e=cc.instantiate(this.mSuperBulletPb);s.battleDataProxy.bulletView.addChild(e,1e3);var a=c.default.convertToTargetNodeSpace(this.node,e);e.position=a.clone().addSelf(cc.v3(0,-72)),e.getComponent(l.default).atkRate=this.getAtkRate(),e.getComponent(l.default).superRate=this._superPlantData.damage1,e.getComponent(l.default).setOneAtkTargetNum(this._oneAtkTargetNum),e.getComponent(l.default).initBullet(this.mEquipId,this._atkTarget,this._level,this._atkCount)}else this.addTriggerCounter()&&this.openFire()},e.prototype.getIsCanAtk=function(){if(s.battleDataProxy.getIsSuperPlant(10)&&s.battleDataProxy.isActiveSuperPlant)return!0;if(10==this.equipId&&this._level<5){if(!this._isShukuchi)return!0;if(!s.battleDataProxy.checkHasSkill(100004))return!1}return!0},__decorate([d(cc.Prefab)],e.prototype,"mSuperBulletPb",void 0),__decorate([h],e)}(u.default);n.default=m,cc._RF.pop(),cc._RF.pop()},{}],PlantEquip11:[function(t,e,a){"use strict";cc._RF.push(e,"2ff1cEgCbZEraejJgUMaCcJ","PlantEquip11");var i=t,o=e,n=a;cc._RF.push(o,"3f57eY5TpRDnrpzpGAx5i5B","PlantEquip11"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("BattleDataProxy"),s=i("Util"),c=i("BulletBase"),l=i("BulletPlant11"),u=i("SuperBulletPlant11"),p=i("EquipmentItem"),h=i("EnemyBase"),d=cc._decorator,m=d.ccclass,f=d.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mSuperBulletPb=null,e}return __extends(e,t),e.prototype.ballCollisionEnter=function(){var e=this;if(this.getCollisionIsValid())if(t.prototype.ballCollisionEnter.call(this),this.addSuperTriggerCounter())for(var a=Number(this._superPlantData.num),i=r.battleDataProxy.getBulletPathPoints(this._atkTarget.position),o=0,n=function(){if(++o==Math.ceil(a/2))for(var t=r.battleDataProxy.enemyNodes.slice(),n=0;n<t.length;++n){var s=t[n];if(s&&s.isValid&&e.getIsAtk(i,s)){var c=s.getComponent(h.default).monsterCfg,l=e._superPlantData.damage1,u=r.battleDataProxy.getBulletHarm(c.type,e.mEquipId,e.level,e._atkCount,e._oneAtkTargetNum,e._superPlantData.damage,l);s.getComponent(h.default).beAttack(u,e.mEquipId),s.getComponent(h.default).ice()}}},l=0;l<a;++l){var p=Math.floor(100*Math.random())%i.length,d=i[p],m=Math.floor(1e3*Math.random())%d.width,f=Math.floor(1e3*Math.random())%d.height,_=d.x+(-d.width/2+m),y=d.y+(-d.height/2+f),g=cc.instantiate(this.mSuperBulletPb);r.battleDataProxy.bulletView.addChild(g,1e3);var v=s.default.convertToTargetNodeSpace(this.node,g);g.position=v,g.getComponent(c.default).atkRate=this.getAtkRate(),g.getComponent(c.default).setOneAtkTargetNum(this._oneAtkTargetNum),g.getComponent(c.default).initBullet(this.mEquipId,this._atkTarget,this._level,this._atkCount,this._isRage),g.getComponent(c.default).setAtkPos(cc.v3(_,y)),g.getComponent(u.default).startMove(function(){e.node&&e.node.isValid&&n&&n()})}else this.addTriggerCounter()&&this.openFire()},e.prototype.openFire=function(){if(this._atkTarget&&this._atkTarget.isValid){var t=this._atkTarget.x,e=this._atkTarget.y+this._atkTarget.height,a=cc.instantiate(this.mBulletPb);r.battleDataProxy.bulletView.addChild(a,1e3);var i=s.default.convertToTargetNodeSpace(this.node,a);a.position=i,a.getComponent(c.default).atkRate=this.getAtkRate(),a.getComponent(c.default).setOneAtkTargetNum(this._oneAtkTargetNum),a.getComponent(c.default).initBullet(this.mEquipId,this._atkTarget,this._level,this._atkCount,this._isRage),a.getComponent(c.default).setAtkPos(cc.v3(t,e)),a.getComponent(l.default).startMove(this._atkTarget)}},e.prototype.getIsAtk=function(t,e){for(var a=0;a<t.length;++a)if(t[a].getBoundingBox().contains(e.getPosition()))return!0;return!1},__decorate([f(cc.Prefab)],e.prototype,"mSuperBulletPb",void 0),__decorate([m],e)}(p.default);n.default=_,cc._RF.pop(),cc._RF.pop()},{}],PlantEquip12:[function(t,e,a){"use strict";cc._RF.push(e,"8ce08iEN+BBjrL0hnSti0rI","PlantEquip12");var i=t,o=e,n=a;cc._RF.push(o,"1da2fIf24hCYYjeA1gWS2aV","PlantEquip12"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("EquipmentItem"),s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.ballCollisionEnter=function(){this.getCollisionIsValid()&&(t.prototype.ballCollisionEnter.call(this),this.addSuperTriggerCounter()?this.openFire():this.addTriggerCounter()&&this.openFire())},__decorate([c],e)}(r.default));n.default=l,cc._RF.pop(),cc._RF.pop()},{}],PlantEquip14:[function(t,e,a){"use strict";cc._RF.push(e,"cfbd09AqSFA76CBjOE+FDnQ","PlantEquip14");var i=t,o=e,n=a;cc._RF.push(o,"f6b12LsXB1FhoiTXgO3RxZq","PlantEquip14"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("BattleDataProxy"),s=i("Util"),c=i("BulletBase"),l=i("BulletPlant14"),u=i("SuperBulletPlant14"),p=i("EquipmentItem"),h=cc._decorator,d=h.ccclass,m=h.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mSuperBulletPb=null,e}return __extends(e,t),e.prototype.ballCollisionEnter=function(){if(this.getCollisionIsValid())if(t.prototype.ballCollisionEnter.call(this),this.addSuperTriggerCounter()){if(!this._atkTarget)return;var e=r.battleDataProxy.getEnemyPathPoint(this._atkTarget.position);if(!e.nearestPoint)return void console.log("\u6ca1\u6709\u6700\u8fd1\u7684\u65b9\u5757");var a=cc.instantiate(this.mSuperBulletPb);r.battleDataProxy.bulletView.addChild(a,1e3);var i=s.default.convertToTargetNodeSpace(e.nearestPoint,a);a.position=i,a.getComponent(c.default).atkRate=this.getAtkRate(),a.getComponent(c.default).setOneAtkTargetNum(this._oneAtkTargetNum),a.getComponent(c.default).initBullet(this.mEquipId,this._atkTarget,this._level,this._atkCount),a.getComponent(u.default).initOrientation(e.nearestIdx)}else this.addTriggerCounter()&&this.openFire()},e.prototype.openFire=function(){var t=1,e=0,a=r.battleDataProxy.checkHasSkill(140001),i=r.battleDataProxy.checkHasSkill(140004);a&&(e=100*a.skillData.probability),i&&(e=100*i.skillData.probability),Math.floor(1e3*Math.random())%100+1<=e&&(t=2);for(var o=0;o<t;++o){var n=this._atkTargets[0];if(!n||!n.isValid)return;var u=n.x,p=n.y+n.height,h=cc.instantiate(this.mBulletPb);r.battleDataProxy.bulletView.addChild(h,1e3);var d=s.default.convertToTargetNodeSpace(this.node,h);h.position=d,h.getComponent(c.default).atkRate=this.getAtkRate(),h.getComponent(c.default).setOneAtkTargetNum(this._oneAtkTargetNum),h.getComponent(c.default).initBullet(this.mEquipId,n,this._level,this._atkCount),h.getComponent(c.default).setAtkPos(cc.v3(u,p)),h.getComponent(l.default).startMove(n,o)}},__decorate([m(cc.Prefab)],e.prototype,"mSuperBulletPb",void 0),__decorate([d],e)}(p.default);n.default=f,cc._RF.pop(),cc._RF.pop()},{}],PlantEquip15:[function(t,e,a){"use strict";cc._RF.push(e,"c4f0dVBnr9EY6fQb39OKY81","PlantEquip15");var i=t,o=e,n=a;cc._RF.push(o,"6c5a1b9B0hF+6Zk6pZwU308","PlantEquip15"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("MathUtil"),s=i("BattleDataProxy"),c=i("Util"),l=i("SuperBulletPlant15"),u=i("EquipmentItem"),p=cc._decorator,h=p.ccclass,d=p.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mSuperBulletPlantPb=null,e}return __extends(e,t),e.prototype.ballCollisionEnter=function(){if(this.getCollisionIsValid())if(t.prototype.ballCollisionEnter.call(this),this.addSuperTriggerCounter()){if(!this._atkTargets[0]||!this._atkTargets[0].isValid)return;var e=cc.instantiate(this.mSuperBulletPlantPb);s.battleDataProxy.bulletView.addChild(e,1e3);var a=c.default.convertToTargetNodeSpace(this.mFireNode,e),i=r.MathUtil.getDoublPointRadian(a,this._atkTargets[0].position.clone()),o=Math.floor(cc.misc.radiansToDegrees(i+Math.PI));e.position=a,e.angle=o+180,e.getComponent(l.default).initBulletFire(this.level)}else this.addTriggerCounter()&&this.openFire()},__decorate([d(cc.Prefab)],e.prototype,"mSuperBulletPlantPb",void 0),__decorate([h],e)}(u.default);n.default=m,cc._RF.pop(),cc._RF.pop()},{}],PlantEquip1:[function(t,e,a){"use strict";cc._RF.push(e,"64edf121KNF6JjnhpAC8+6E","PlantEquip1");var i=t,o=e,n=a;cc._RF.push(o,"8da25jIoW1LwqsaS64RSkmS","PlantEquip1"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("GameEnum"),s=i("BattleDataProxy"),c=i("EquipmentItem"),l=i("EnemyBase"),u=cc._decorator,p=u.ccclass,h=(u.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._continuousAtkMaxTime=0,e._continuousAtkTime=0,e._continuousAtkCd=0,e}return __extends(e,t),e.prototype.update=function(e){t.prototype.update.call(this,e),s.battleDataProxy.gameState!=r.GameState.PLAYING&&s.battleDataProxy.gameState!=r.GameState.READY||(this._continuousAtkMaxTime>0?(this._continuousAtkCd+=e,this._continuousAtkCd>=this._continuousAtkTime&&(this._continuousAtkCd=0,this.addBulletNode(this._atkTarget,null,!0),this.setAtkTarget()),this._continuousAtkMaxTime-=e,this._continuousAtkMaxTime<=0&&(this._superIsAtkFinish=!0,this._continuousAtkMaxTime=0)):this._continuouFireNum>0&&(this._continuouFireTime+=e,this._continuouFireTime>=.1&&(this._continuouFireNum--,this._continuouFireTime=0,this.addBulletNode(this._atkTarget))))},e.prototype.setAtkTarget=function(){var t=!1;if(this._atkTarget&&this._atkTarget.isValid?this._atkTarget.getComponent(l.default).getIsDie()&&(t=!0):t=!0,t){var e=s.battleDataProxy.getPlantAtkTargets(1,this.mEquipId,this._isCharm);e.length>0&&(this._atkTarget=e[0])}},e.prototype.frenzyCollisionEnter=function(){this._continuousAtkMaxTime=0,this._continuouFireNum=0,this._superIsAtkFinish=!0,t.prototype.frenzyCollisionEnter.call(this)},e.prototype.ballCollisionEnter=function(){this._superIsAtkFinish&&!this._isIce&&(t.prototype.ballCollisionEnter.call(this),this.addSuperTriggerCounter()?(this._continuouFireNum=0,this._continuouFireTime=0,this._superIsAtkFinish=!1,this._continuousAtkMaxTime=Number(this._superPlantData.num)*this._superPlantData.CD,this._continuousAtkTime=this._superPlantData.CD,this._continuousAtkCd=0):this.addTriggerCounter()&&this.openFire())},__decorate([p],e)}(c.default));n.default=h,cc._RF.pop(),cc._RF.pop()},{}],PlantEquip2:[function(t,e,a){"use strict";cc._RF.push(e,"a7265u5KAJE2bCATukGL73E","PlantEquip2");var i=t,o=e,n=a;cc._RF.push(o,"88bc3KZxhFCF4Jt6XM/bt09","PlantEquip2"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("BattleDataProxy"),s=i("Util"),c=i("BulletBase"),l=i("EquipmentItem"),u=cc._decorator,p=u.ccclass,h=u.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mSuperBulletPb=null,e._bulletNum=0,e._atkCd=0,e._bulletIdx=0,e}return __extends(e,t),e.prototype.update=function(e){t.prototype.update.call(this,e),this._bulletNum>0&&(this._atkCd+=e,this._atkCd>=this._superPlantData.CD&&(this._atkCd=0,this._bulletNum--,this.addSuperBullet(),this._bulletNum<=0&&(this._superIsAtkFinish=!0)))},e.prototype.addSuperBullet=function(){if(this._atkTargets=r.battleDataProxy.getPlantAtkTargets(5,this.mEquipId,this._isCharm),!(this._atkTargets.length<=0)){var t=this._atkTargets[this._bulletIdx];t||(t=this._atkTargets[0]);var e=cc.instantiate(this.mSuperBulletPb);r.battleDataProxy.bulletView.addChild(e,1e3);var a=s.default.convertToTargetNodeSpace(this.mFireNode,e);e.position=a,e.getComponent(c.default).atkRate=this.getAtkRate(),e.getComponent(c.default).superRate=this._superPlantData.damage1,e.getComponent(c.default).setOneAtkTargetNum(this._oneAtkTargetNum),e.getComponent(c.default).initBullet(this.mEquipId,t,this._level,this._atkCount),this._bulletIdx++}},e.prototype.ballCollisionEnter=function(){this.getCollisionIsValid()&&(t.prototype.ballCollisionEnter.call(this),this.addSuperTriggerCounter()?(this._superIsAtkFinish=!1,this._bulletIdx=0,this._bulletNum=Number(this._superPlantData.num)-1,this.addSuperBullet()):this.addTriggerCounter()&&this.openFire())},__decorate([h(cc.Prefab)],e.prototype,"mSuperBulletPb",void 0),__decorate([p],e)}(l.default);n.default=d,cc._RF.pop(),cc._RF.pop()},{}],PlantEquip3:[function(t,e,a){"use strict";cc._RF.push(e,"98470REASVN5q0rjZZtEVjg","PlantEquip3");var i=t,o=e,n=a;cc._RF.push(o,"e9a6c9qZnVEAaAR8kKXz4jV","PlantEquip3"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("MathUtil"),s=i("Util"),c=i("BulletBase"),l=i("EquipmentItem"),u=cc._decorator,p=u.ccclass,h=(u.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.ballCollisionEnter=function(){if(this.getCollisionIsValid())if(t.prototype.ballCollisionEnter.call(this),this.addSuperTriggerCounter())for(var e=Number(this._superPlantData.num),a=360/e,i=0;i<e;++i){var o=this.addBulletNode(this._atkTargets[0],this._superPlantData.damage,!0);if(o){var n=a*i;o.angle=n;var l=r.MathUtil.getRadian(n),u=s.default.convertToTargetNodeSpace(this.node,o),p=u.x+cc.winSize.height*Math.cos(l),h=u.y+cc.winSize.height*Math.sin(l);o.getComponent(c.default).setAtkPos(cc.v3(p,h))}}else this.addTriggerCounter()&&this.openFire()},__decorate([p],e)}(l.default));n.default=h,cc._RF.pop(),cc._RF.pop()},{}],PlantEquip4:[function(t,e,a){"use strict";cc._RF.push(e,"adaa28jGv5LXoyQcSPLgN5d","PlantEquip4");var i=t,o=e,n=a;cc._RF.push(o,"f16c3KnYMxIaZv53swWLpgP","PlantEquip4"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("BattleDataProxy"),s=i("Util"),c=i("BulletBase"),l=i("BulletPlant4"),u=i("SuperBulletPlant4"),p=i("EquipmentItem"),h=i("EnemyBase"),d=cc._decorator,m=d.ccclass,f=d.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mSuperBulletPb=null,e}return __extends(e,t),e.prototype.ballCollisionEnter=function(){var e=this;if(this.getCollisionIsValid())if(t.prototype.ballCollisionEnter.call(this),this.addSuperTriggerCounter())for(var a=Number(this._superPlantData.num),i=r.battleDataProxy.getBulletPathPoints(this._atkTarget.position),o=0,n=function(){if(++o==Math.ceil(a/2))for(var t=r.battleDataProxy.enemyNodes.slice(),n=0;n<t.length;++n){var s=t[n];if(s&&s.isValid&&e.getIsAtk(i,s)){var c=s.getComponent(h.default).monsterCfg,l=e._superPlantData.damage1,u=r.battleDataProxy.getBulletHarm(c.type,e.mEquipId,e.level,e._atkCount,e._oneAtkTargetNum,e._superPlantData.damage,l);s.getComponent(h.default).beAttack(u,e.mEquipId)}}},l=0;l<a;++l){var p=Math.floor(100*Math.random())%i.length,d=i[p],m=Math.floor(1e3*Math.random())%d.width,f=Math.floor(1e3*Math.random())%d.height,_=d.x+(-d.width/2+m),y=d.y+(-d.height/2+f),g=cc.instantiate(this.mSuperBulletPb);r.battleDataProxy.bulletView.addChild(g,1e3);var v=s.default.convertToTargetNodeSpace(this.node,g);g.position=v,g.getComponent(c.default).atkRate=this.getAtkRate(),g.getComponent(c.default).setOneAtkTargetNum(this._oneAtkTargetNum),g.getComponent(c.default).initBullet(this.mEquipId,this._atkTarget,this._level,this._atkCount),g.getComponent(c.default).setAtkPos(cc.v3(_,y)),g.getComponent(u.default).startMove(function(){e.node&&e.node.isValid&&n&&n()})}else this.addTriggerCounter()&&this.openFire()},e.prototype.openFire=function(){for(var t=0;t<this._atkTargetNum;++t){var e=this._atkTargets[t];if(e&&e.isValid){var a=e.x,i=e.y+e.height,o=cc.instantiate(this.mBulletPb);r.battleDataProxy.bulletView.addChild(o,1e3);var n=s.default.convertToTargetNodeSpace(this.node,o);o.position=n,o.getComponent(c.default).atkRate=this.getAtkRate(),o.getComponent(c.default).setOneAtkTargetNum(this._oneAtkTargetNum),o.getComponent(c.default).initBullet(this.mEquipId,e,this._level,this._atkCount),o.getComponent(c.default).setAtkPos(cc.v3(a,i)),o.getComponent(l.default).startMove(e)}}},e.prototype.getIsAtk=function(t,e){for(var a=0;a<t.length;++a)if(t[a].getBoundingBox().contains(e.getPosition()))return!0;return!1},e.prototype.getSuperBulletAtkPos=function(){},__decorate([f(cc.Prefab)],e.prototype,"mSuperBulletPb",void 0),__decorate([m],e)}(p.default);n.default=_,cc._RF.pop(),cc._RF.pop()},{}],PlantEquip5:[function(t,e,a){"use strict";cc._RF.push(e,"90d87PW+55Jd6mqlw+WcaSd","PlantEquip5");var i=t,o=e,n=a;cc._RF.push(o,"f94a18Ld8dCwL4p3rMfkGOo","PlantEquip5"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("MathUtil"),s=i("BattleDataProxy"),c=i("Util"),l=i("BulletBase"),u=i("BulletTornado"),p=i("EquipmentItem"),h=cc._decorator,d=h.ccclass,m=h.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mSuperBulletPb=null,e.mBulletTornadoPb=null,e}return __extends(e,t),e.prototype.ballCollisionEnter=function(){if(this.getCollisionIsValid())if(t.prototype.ballCollisionEnter.call(this),this.addSuperTriggerCounter())for(var e=this.getTargetRadian(this._atkTargets[0]),a=Math.floor(cc.misc.radiansToDegrees(e+Math.PI)),i=Number(this._superPlantData.num),o=0;o<i;++o){var n=cc.instantiate(this.mSuperBulletPb);s.battleDataProxy.bulletView.addChild(n,1e3);var u=c.default.convertToTargetNodeSpace(this.mFireNode,n);n.position=u,n.getComponent(l.default).atkRate=this.getAtkRate(),n.getComponent(l.default).superRate=this._superPlantData.damage1,n.getComponent(l.default).setOneAtkTargetNum(this._oneAtkTargetNum),n.getComponent(l.default).initBullet(this.mEquipId,this._atkTarget,this._level,this._atkCount);var p=this.getBulletStartAngleEx(i,o,a);n.angle=p;var h=r.MathUtil.getRadian(p),d=c.default.convertToTargetNodeSpace(this.node,n),m=d.x+cc.winSize.height*Math.cos(h),f=d.y+cc.winSize.height*Math.sin(h);n.getComponent(l.default).setAtkPos(cc.v3(m,f))}else this.addTriggerCounter()&&this.openFire()},e.prototype.getBulletStartAngleEx=function(t,e,a){var i=45/t;return a+Math.floor(t/2)*i-i*e},e.prototype.fireBulletTornado=function(t){if(s.battleDataProxy.getIsSuperPlant(this.mEquipId)){var e=s.battleDataProxy.getPlantAtkTargets(1,this.mEquipId,this._isCharm)[0];if(!e){var a=s.battleDataProxy.pathPointView.children;e=a[Math.floor(1e3*Math.random())%a.length]}if(e&&e.isValid){var i=cc.instantiate(this.mBulletTornadoPb);s.battleDataProxy.bulletView.addChild(i);var o=c.default.convertToTargetNodeSpace(t,i);i.position=o,i.getComponent(u.default).initBulletTornado(e.position.clone(),this.level)}}},e.prototype.beWindUp=function(t){this.fireBulletTornado(t)},__decorate([m(cc.Prefab)],e.prototype,"mSuperBulletPb",void 0),__decorate([m(cc.Prefab)],e.prototype,"mBulletTornadoPb",void 0),__decorate([d],e)}(p.default);n.default=f,cc._RF.pop(),cc._RF.pop()},{}],PlantEquip6:[function(t,e,a){"use strict";cc._RF.push(e,"b25c2h8zpVJhb08Y0/Zcgnu","PlantEquip6");var i=t,o=e,n=a;cc._RF.push(o,"d2af17ADTNA04f9i0GPcm4H","PlantEquip6"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("BattleDataProxy"),s=i("Util"),c=i("BulletBase"),l=i("BulletPlant6"),u=i("SuperBullet6"),p=i("EquipmentItem"),h=cc._decorator,d=h.ccclass,m=h.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mSuperBulletPb=null,e.mSuperBulletPbEx=null,e}return __extends(e,t),e.prototype.ballCollisionEnter=function(){if(this.getCollisionIsValid())if(t.prototype.ballCollisionEnter.call(this),this.addSuperTriggerCounter())for(var e=r.battleDataProxy.getBulletPathPointsEx(this._atkTarget.position),a=0;a<3;++a){var i=e[a];if(i){var o=cc.instantiate(this.mSuperBulletPbEx);r.battleDataProxy.bulletView.addChild(o,1e3),o.position=i.position,o.getComponent(u.default).initBullet(this._level,this._superPlantData.damage1)}}else this.addTriggerCounter()&&this.openFire()},e.prototype.lightningStroke=function(){},e.prototype.openFire=function(){if(this._atkTarget&&this._atkTarget.isValid){var t=this._atkTarget.x,e=this._atkTarget.y+this._atkTarget.height,a=null;a=r.battleDataProxy.isActiveSuperPlant&&6==r.battleDataProxy.battleData.superPlantId?cc.instantiate(this.mSuperBulletPb):cc.instantiate(this.mBulletPb),r.battleDataProxy.bulletView.addChild(a,1e3);var i=s.default.convertToTargetNodeSpace(this.node,a);a.position=i,a.getComponent(c.default).atkRate=this.getAtkRate(),a.getComponent(c.default).setOneAtkTargetNum(this._oneAtkTargetNum),a.getComponent(c.default).initBullet(this.mEquipId,this._atkTarget,this._level,this._atkCount),a.getComponent(c.default).setAtkPos(cc.v3(t,e)),a.getComponent(l.default).startMove(this._atkTarget)}},__decorate([m(cc.Prefab)],e.prototype,"mSuperBulletPb",void 0),__decorate([m(cc.Prefab)],e.prototype,"mSuperBulletPbEx",void 0),__decorate([d],e)}(p.default);n.default=f,cc._RF.pop(),cc._RF.pop()},{}],PlantEquip7:[function(t,e,a){"use strict";cc._RF.push(e,"4a021iCABFMd6FlKVov5QZf","PlantEquip7");var i=t,o=e,n=a;cc._RF.push(o,"7fe2fjuUlZFuqcw8jM7mWOE","PlantEquip7"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("BattleDataProxy"),s=i("Util"),c=i("BulletBase"),l=i("BulletPlant7"),u=i("SuperBulletPlant7"),p=i("EquipmentItem"),h=i("EnemyBase"),d=cc._decorator,m=d.ccclass,f=d.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mSuperBulletPb=null,e}return __extends(e,t),e.prototype.ballCollisionEnter=function(){var e=this;if(this.getCollisionIsValid())if(t.prototype.ballCollisionEnter.call(this),this.addSuperTriggerCounter())for(var a=Number(this._superPlantData.num),i=r.battleDataProxy.getBulletPathPoints(this._atkTarget.position),o=0,n=function(){if(++o==Math.ceil(a/2))for(var t=r.battleDataProxy.enemyNodes.slice(),n=0;n<t.length;++n){var s=t[n];if(s&&s.isValid&&e.getIsAtk(i,s)){var c=s.getComponent(h.default).monsterCfg,l=e._superPlantData.damage1,u=r.battleDataProxy.getBulletHarm(c.type,e.mEquipId,e.level,e._atkCount,e._oneAtkTargetNum,e._superPlantData.damage,l);s.getComponent(h.default).beAttack(u,e.mEquipId),s.getComponent(h.default).isBeTemptation=!0}}},l=0;l<a;++l){var p=Math.floor(100*Math.random())%i.length,d=i[p],m=Math.floor(1e3*Math.random())%d.width,f=Math.floor(1e3*Math.random())%d.height,_=d.x+(-d.width/2+m),y=d.y+(-d.height/2+f),g=cc.instantiate(this.mSuperBulletPb);r.battleDataProxy.bulletView.addChild(g,1e3);var v=s.default.convertToTargetNodeSpace(this.node,g);g.position=v,g.getComponent(c.default).atkRate=this.getAtkRate(),g.getComponent(c.default).setOneAtkTargetNum(this._oneAtkTargetNum),g.getComponent(c.default).initBullet(this.mEquipId,this._atkTarget,this._level,this._atkCount),g.getComponent(c.default).setAtkPos(cc.v3(_,y)),g.getComponent(u.default).startMove(function(){e.node&&e.node.isValid&&n&&n()})}else this.addTriggerCounter()&&this.openFire()},e.prototype.openFire=function(){if(this._atkTarget&&this._atkTarget.isValid){var t=this._atkTarget.x,e=this._atkTarget.y+this._atkTarget.height,a=cc.instantiate(this.mBulletPb);r.battleDataProxy.bulletView.addChild(a,1e3);var i=s.default.convertToTargetNodeSpace(this.node,a);a.position=i,a.getComponent(c.default).atkRate=this.getAtkRate(),a.getComponent(c.default).setOneAtkTargetNum(this._oneAtkTargetNum),a.getComponent(c.default).initBullet(this.mEquipId,this._atkTarget,this._level,this._atkCount),a.getComponent(c.default).setAtkPos(cc.v3(t,e)),a.getComponent(l.default).startMove(this._atkTarget)}},e.prototype.getIsAtk=function(t,e){for(var a=0;a<t.length;++a)if(t[a].getBoundingBox().contains(e.getPosition()))return!0;return!1},e.prototype.beWindUp=function(){},__decorate([f(cc.Prefab)],e.prototype,"mSuperBulletPb",void 0),__decorate([m],e)}(p.default);n.default=_,cc._RF.pop(),cc._RF.pop()},{}],PlantEquip8:[function(t,e,a){"use strict";cc._RF.push(e,"776648thmxNo6H4xyg2cRLo","PlantEquip8");var i=t,o=e,n=a;cc._RF.push(o,"edf03DcbbNNLp1ITrxB733b","PlantEquip8"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("BattleDataProxy"),s=i("BulletBase"),c=i("EquipmentItem"),l=cc._decorator,u=l.ccclass,p=(l.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.ballCollisionEnter=function(){if(this.getCollisionIsValid())if(t.prototype.ballCollisionEnter.call(this),this.addSuperTriggerCounter())for(var e=Number(this._superPlantData.num),a=r.battleDataProxy.getPlantAtkTargets(5,this.mEquipId,this._isCharm),i=0;i<e;++i){var o=a[i];if(o&&o.isValid){var n=this.addBulletNode(o,this._superPlantData.damage,!0);n&&n.getComponent(s.default).setCatapultNumber(5)}}else this.addTriggerCounter()&&this.openFire()},__decorate([u],e)}(c.default));n.default=p,cc._RF.pop(),cc._RF.pop()},{}],PlantEquip9:[function(t,e,a){"use strict";cc._RF.push(e,"1c9e6wYKBpElqsI5D4wKbbo","PlantEquip9");var i=t,o=e,n=a;cc._RF.push(o,"55284bf/CBOmLOuZJdJBE7W","PlantEquip9"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("ResUtil"),c=i("GameEnum"),l=i("HomeEnum"),u=i("BattleDataProxy"),p=i("BulletBase"),h=i("BulletPlant13"),d=i("EquipmentItem"),m=cc._decorator,f=m.ccclass,_=m.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mSuperBulletPb=null,e._thunderTime=0,e._equipRageEffect=null,e}return __extends(e,t),e.prototype.ballCollisionEnter=function(){this.getCollisionIsValid()&&(t.prototype.ballCollisionEnter.call(this),this.addSuperTriggerCounter()?this.addSuperBullet(!0):this.addTriggerCounter()&&this.openFireEx())},e.prototype.openFireEx=function(){u.battleDataProxy.getIsSuperPlant(this.mEquipId)||this._isRage?this.addSuperBullet(!1):this.openFire()},e.prototype.addSuperBullet=function(t){if(this._atkTarget&&this._atkTarget.isValid){var e=cc.instantiate(this.mSuperBulletPb);u.battleDataProxy.bulletView.addChild(e,1e3),e.position=this._atkTarget.position,e.getComponent(p.default).atkRate=this.getAtkRate(),e.getComponent(p.default).superRate=this._superPlantData.damage1,e.getComponent(p.default).initBullet(this.mEquipId,this._atkTarget,this._level,this._atkCount,this._isRage),e.getComponent(h.default).play(t)}else console.log("\u76ee\u6807\u4e22\u5931!")},e.prototype.lightningStroke=function(){13==u.battleDataProxy.battleData.superPlantId?(this.addEquipRageEffect(),this._thunderTime=10,u.battleDataProxy.getIsSuperPlant(13)||r.AudioManager.instance.playEffectPath("sounds/getPlant",l.Bundles.RES)):this.addEquipDizziness()},e.prototype.addEquipRageEffect=function(){var t=this;this._isRage||(this._equipRageEffect&&this._equipRageEffect.isValid?this._equipRageEffect.active=!0:s.ResUtil.loadAsset({path:"prefabs/effect/EquipRageEffect",type:cc.Prefab,bundleName:l.Bundles.GAME}).then(function(e){t.node&&t.node.isValid&&(t._equipRageEffect=cc.instantiate(e),t._root.addChild(t._equipRageEffect),t._equipRageEffect.position=cc.v3(0,0,0),t.setSuperPlantIcon())}).catch(function(t){console.log("error:",t)})),this._isRage=!0,this.setSuperPlantIcon()},e.prototype.update=function(e){t.prototype.update.call(this,e),u.battleDataProxy.gameState==c.GameState.PLAYING&&this._isRage&&(this._thunderTime-=e,this._thunderTime<=0&&(this._thunderTime=0,this._isRage=!1,this._equipRageEffect&&this._equipRageEffect.isValid&&(this._equipRageEffect.active=!1),this.setSuperPlantIcon()))},__decorate([_(cc.Prefab)],e.prototype,"mSuperBulletPb",void 0),__decorate([f],e)}(d.default);n.default=y,cc._RF.pop(),cc._RF.pop()},{}],PlantEquipDetailsPopup:[function(t,e,a){"use strict";cc._RF.push(e,"1d43bauPLZC77ndik/zNX3i","PlantEquipDetailsPopup");var i=t,o=e,n=a;cc._RF.push(o,"32d0d5dC25OBIZqE6fV5xuo","PlantEquipDetailsPopup"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("List"),c=i("EventManager"),l=i("ResUtil"),u=i("PopupBase"),p=i("HomeEnum"),h=i("DataManager"),d=i("BattleDataProxy"),m=i("UserDataProxy"),f=i("GameUIManager"),_=i("RedDotMgr"),y=cc._decorator,g=y.ccclass,v=y.property,P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mGreadBg=null,e.mPlantName=null,e.mPlantImg=null,e.mLvLab=null,e.mAtkNum=null,e.mAddNum=null,e.mBar=null,e.mBarNum=null,e.mPriceLab=null,e.mMyLiset=null,e.mUpGradeEffect=null,e._plantData=null,e._skillIds=[],e._unlockLvs=[],e._needGlod=0,e._needNum=0,e._isWear=!1,e._idx=0,e}return __extends(e,t),e.prototype.init=function(t){var e=this;this._plantData=t.plantData,this._isWear=t.isWear,this._idx=t.idx,this.mUpGradeEffect.setCompleteListener(function(){e.mUpGradeEffect.node.active=!1}),l.ResUtil.loadAsset({path:"textures/public/pic_dazhiwukuang_"+this._plantData.qulity,type:cc.SpriteFrame,bundleName:p.Bundles.GAME}).then(function(t){e.mGreadBg.spriteFrame=t}).catch(function(t){console.log("error:",t)}),l.ResUtil.loadAsset({path:"textures/botanyIcon/pic_plant"+this._plantData.id,type:cc.SpriteFrame,bundleName:p.Bundles.GAME}).then(function(t){e.mPlantImg.spriteFrame=t}).catch(function(t){console.log("error:",t)});var a=this.node.getChildByName("BtnWear"),i=a.getChildByName("upBg"),o=a.getChildByName("lab");i.active=this._isWear,o.getComponent(cc.Label).string=this._isWear?"\u4e0a\u9635":"\u4e0b\u9635",a.active=t.isShowWear,a.active||(this.node.getChildByName("BtnUpgrade").x=0),this.initData()},e.prototype.initData=function(){this.mPlantName.string=this._plantData.name;var t=m.userDataProxy.getPlantData(this._plantData.id).lv;this.mLvLab.string="Lv."+t;var e=m.userDataProxy.getPropDatas(this._plantData.needItem),a=Number(this._plantData.needNum.split("|")[t-1]);this.mBar.fillRange=e/a,this.mBarNum.string=e+"/"+a;var i=d.battleDataProxy.getPlantAtk(this._plantData.id,1);this.mAtkNum.string=""+i;var o=this.mBar.node.parent.getChildByName("arrow"),n=this.node.getChildByName("maxLevel"),r=this.node.getChildByName("BtnUpgrade");if(o.active=e>=a,o.y=-29.115,cc.Tween.stopAllByTarget(o),this.mAddNum.node.active=o.active,n.active=!1,r.active=!0,n.position=r.position,o.active){var s=cc.tween(o).by(.3,{position:cc.v3(0,5)}).by(.3,{position:cc.v3(0,-5)}).delay(.15);cc.tween(o).repeatForever(s).start();var c=d.battleDataProxy.getPlantAtk(this._plantData.id,1,t+1);c>0?(this.mAddNum.string="+"+(c-i),n.active=!1):(this.mBar.fillRange=1,o.active=!1,this.mAddNum.node.active=!1,n.active=!0,this.mBarNum.string="Max",r.active=!1)}this.setNeedNum()},e.prototype.setNeedNum=function(){var t=m.userDataProxy.getPlantData(this._plantData.id).lv;this._needNum=Number(this._plantData.needNum.split("|")[t-1]),this._needGlod=Number(this._plantData.needGold.split("|")[t-1]),this._needGlod>m.userDataProxy.userData.gold?this.mPriceLab.node.color=cc.Color.RED:this.mPriceLab.node.color=cc.Color.WHITE,this.mPriceLab.string=""+this._needGlod},e.prototype.onShow=function(){if(this.updateSkillItem(),6==m.userDataProxy.userData.gameCourseData.curId){var t={courseId:0,isGame:!1};t.courseId=7,t.targetNode=this.node.getChildByName("BtnUpgrade"),m.userDataProxy.showCourse(t)}},e.prototype.onDestroy=function(){t.prototype.onDestroy.call(this),c.EventManager.instance.emit(m.EUserDataEvent.CLOSE_EQUIP_DETAILS)},e.prototype.updateSkillItem=function(){this._skillIds=this._plantData.skillId.split("|").map(Number),this._unlockLvs=this._plantData.unlockLv.split("|").map(Number),this.mMyLiset.numItems=this._skillIds.length},e.prototype.onUpdateItem=function(t,e){var a=h.DataManager.instance.eData.dataskill[this._skillIds[e]],i=t.getChildByName("gradeImg"),o=t.getChildByName("gradeBg"),n=t.getChildByName("skillIcon"),r=t.getChildByName("skillDes");l.ResUtil.loadAsset({path:"textures/skill/skillkuang_lv"+(a.quality-1),type:cc.SpriteFrame,bundleName:p.Bundles.GAME}).then(function(t){i.getComponent(cc.Sprite).spriteFrame=t}).catch(function(t){console.log("error:",t)}),l.ResUtil.loadAsset({path:"textures/public/pic_yeqian_"+a.quality,type:cc.SpriteFrame,bundleName:p.Bundles.GAME}).then(function(t){o.getComponent(cc.Sprite).spriteFrame=t}).catch(function(t){console.log("error:",t)}),l.ResUtil.loadAsset({path:"textures/skillIcon/"+a.icon,type:cc.SpriteFrame,bundleName:p.Bundles.GAME}).then(function(t){n.getComponent(cc.Sprite).spriteFrame=t}).catch(function(t){console.log("error:",t)});var s=t.getChildByName("lockMask"),c=this._unlockLvs[e],u=m.userDataProxy.getPlantData(this._plantData.id).lv;c>u&&(s.getChildByName("unlockTips").getComponent(cc.Label).string="\u7b49\u7ea7"+c+"\u89e3\u9501"),r.getComponent(cc.Label).string=a.des,s.active=c>u},e.prototype.onBtnUpgrade=function(){if(6==m.userDataProxy.userData.gameCourseData.curId&&(m.userDataProxy.completeCourse(7),c.EventManager.instance.emit(d.EBattleEvent.LOSE_COURSE_VIEW)),m.userDataProxy.getProp(this._plantData.needItem)<this._needNum)f.gameUIMgr.showTips("\u788e\u7247\u4e0d\u591f\uff01");else if(this._needGlod>m.userDataProxy.userData.gold)f.gameUIMgr.showTips("\u91d1\u5e01\u4e0d\u591f\uff01");else{m.userDataProxy.changeGold(-this._needGlod),m.userDataProxy.addProp(this._plantData.needItem,-1*this._needNum);var t=m.userDataProxy.getPlantData(this._plantData.id).lv;t+=1,m.userDataProxy.updatePlantLv(this._plantData.id,t),this.initData(),this.updateSkillItem(),r.AudioManager.instance.playEffectPath("sounds/getPlant",p.Bundles.RES),this.mUpGradeEffect.node.active=!0,this.mUpGradeEffect.setAnimation(0,"level up",!1);var e=this.mAddNum.node.parent.parent.getChildByName("pic_atk"),a=this.mAddNum.node.parent;cc.Tween.stopAllByTarget(e),cc.Tween.stopAllByTarget(a),cc.tween(e).to(.15,{scale:1.5}).to(.15,{scale:1}).start(),cc.tween(a).to(.15,{scale:1.5}).to(.15,{scale:1}).start(),c.EventManager.instance.emit(m.EUserDataEvent.UPDATE_PLANT_LEVEL),_.default.instance.updateRedDotState([p.HOME_REDDOT.PLANTRED]),m.userDataProxy.saveData()}},e.prototype.onBtnWear=function(){if(this._isWear){for(var t=-1,e=0;e<4&&m.userDataProxy.getWearItemIsUnlock(e).isUnlock;++e)if(!m.userDataProxy.combatEqus[e]||0==m.userDataProxy.combatEqus[e]){t=e;break}if(-1==t)return void f.gameUIMgr.showTips("\u6ca1\u6709\u4f4d\u7f6e\u4e86");m.userDataProxy.userData.combatEqus[t]=this._plantData.id,m.userDataProxy.saveData(),4==m.userDataProxy.userData.gameCourseData.curId&&(m.userDataProxy.completeCourse(5),c.EventManager.instance.emit(d.EBattleEvent.LOSE_COURSE_VIEW)),c.EventManager.instance.emit(m.EUserDataEvent.UPDATE_WEAR_PLANT),c.EventManager.instance.emit(m.EUserDataEvent.UPDATE_UNLOCK_PLANT)}else{if(m.userDataProxy.userData.gameCourseData.curId<=7)return void console.log("\u6559\u7a0b\u4e2d\u4e0d\u80fd\u4e0b\u690d\u7269");m.userDataProxy.userData.combatEqus[this._idx]=0,m.userDataProxy.saveData(),c.EventManager.instance.emit(m.EUserDataEvent.UPDATE_UNLOCK_PLANT,this._idx)}this.removeUI()},__decorate([v(cc.Sprite)],e.prototype,"mGreadBg",void 0),__decorate([v(cc.Label)],e.prototype,"mPlantName",void 0),__decorate([v(cc.Sprite)],e.prototype,"mPlantImg",void 0),__decorate([v(cc.Label)],e.prototype,"mLvLab",void 0),__decorate([v(cc.Label)],e.prototype,"mAtkNum",void 0),__decorate([v(cc.Label)],e.prototype,"mAddNum",void 0),__decorate([v(cc.Sprite)],e.prototype,"mBar",void 0),__decorate([v(cc.Label)],e.prototype,"mBarNum",void 0),__decorate([v(cc.Label)],e.prototype,"mPriceLab",void 0),__decorate([v(s.default)],e.prototype,"mMyLiset",void 0),__decorate([v(sp.Skeleton)],e.prototype,"mUpGradeEffect",void 0),__decorate([g],e)}(u.PopupBase);n.default=P,cc._RF.pop(),cc._RF.pop()},{}],PlantEquipItem:[function(t,e,a){"use strict";cc._RF.push(e,"5e220Y1mHRPprWthohYRbA2","PlantEquipItem");var i=t,o=e,n=a;cc._RF.push(o,"7afeeOxh59KtKGid7ynXy7i","PlantEquipItem"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("EventManager"),s=i("ResUtil"),c=i("HomeEnum"),l=i("BattleDataProxy"),u=i("UserDataProxy"),p=i("Util"),h=i("GameUIManager"),d=cc._decorator,m=d.ccclass,f=d.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mGreadBg=null,e.mPlantImg=null,e.mPlantName=null,e.mLvLab=null,e.mBtnDetails=null,e.mBtnRemove=null,e.mBar=null,e.mBarNum=null,e.mLockTips=null,e.mLock=null,e._isUnlock=!1,e._plantData=null,e._isShowWear=!1,e}return __extends(e,t),e.prototype.initPlantEquipItem=function(t,e,a){var i=this;this._plantData=t,this._isUnlock=e,this.node.getComponent(cc.Button).interactable=e,this.mBtnRemove.active=!!e&&a,this._isShowWear=a,this.mBtnDetails.active=!1,this.mBtnDetails.zIndex=1,this.mBtnRemove.zIndex=1,s.ResUtil.loadAsset({path:"textures/public/pic_zhiwukuang_"+this._plantData.qulity,type:cc.SpriteFrame,bundleName:c.Bundles.GAME}).then(function(t){i.mGreadBg.spriteFrame=t}).catch(function(t){console.log("error:",t)}),s.ResUtil.loadAsset({path:"textures/botanyIcon/pic_plant"+this._plantData.id,type:cc.SpriteFrame,bundleName:c.Bundles.GAME}).then(function(t){i.mPlantImg.spriteFrame=t}).catch(function(t){console.log("error:",t)}),this.updatePlantLevel(),this.mLockTips.active=!e,this.mLock.active=!e,e?(p.default.setSpriteNormalMaterial(this.mGreadBg),p.default.setSpriteNormalMaterial(this.mPlantImg),this.mLvLab.node.active=!0,this.mBar.node.parent.active=!0,this.mPlantName.node.color=cc.color(u.userDataProxy.mPlantColors[this._plantData.qulity-2]),this.mLvLab.node.color=cc.color(u.userDataProxy.mPlantColors[this._plantData.qulity-2])):(p.default.setSpriteGrayMaterial(this.mGreadBg),p.default.setSpriteGrayMaterial(this.mPlantImg),this.mPlantName.node.color=cc.color(75,75,75),this.mLvLab.node.active=!1,this.mBar.node.parent.active=!1,this.mLock.getChildByName("unlockTips").getComponent(cc.Label).string="\u901a\u8fc7\u7b2c"+this._plantData.stageID+"\u7ae0\u540e\u89e3\u9501")},e.prototype.setIsShowWear=function(t){this._isUnlock?this.mBtnRemove.active=t:this.mBtnRemove.active=!1},e.prototype.onItemClick=function(){h.gameUIMgr.showPlantEquipDetailsPopup(this._plantData,!0,0,this._isShowWear)},e.prototype.onBtnDetails=function(){h.gameUIMgr.showPlantEquipDetailsPopup(this._plantData,!0,0,this._isShowWear)},e.prototype.onBtnRemove=function(){for(var t=-1,e=0;e<4&&u.userDataProxy.getWearItemIsUnlock(e).isUnlock;++e)if(!u.userDataProxy.combatEqus[e]||0==u.userDataProxy.combatEqus[e]){t=e;break}-1!=t?(u.userDataProxy.userData.combatEqus[t]=this._plantData.id,u.userDataProxy.saveData(),4==u.userDataProxy.userData.gameCourseData.curId&&(u.userDataProxy.completeCourse(5),r.EventManager.instance.emit(l.EBattleEvent.LOSE_COURSE_VIEW)),r.EventManager.instance.emit(u.EUserDataEvent.UPDATE_WEAR_PLANT),r.EventManager.instance.emit(u.EUserDataEvent.UPDATE_UNLOCK_PLANT)):h.gameUIMgr.showTips("\u6ca1\u6709\u4f4d\u7f6e\u4e86")},e.prototype.updatePlantLevel=function(){this.mPlantName.string=this._plantData.name;var t=u.userDataProxy.getPlantData(this._plantData.id).lv;this.mLvLab.string="Lv."+t;var e=u.userDataProxy.getPropDatas(this._plantData.needItem),a=Number(this._plantData.needNum.split("|")[t-1]);this.mBar.fillRange=e/a,this.mBarNum.string=e+"/"+a;var i=this.mBar.node.parent.getChildByName("arrow");if(i.active=e>=a,i.y=6.529,cc.Tween.stopAllByTarget(i),i.active){var o=cc.tween(i).by(.3,{position:cc.v3(0,5)}).by(.3,{position:cc.v3(0,-5)}).delay(.15);cc.tween(i).repeatForever(o).start()}this.checkMax()},e.prototype.checkMax=function(){var t=u.userDataProxy.getPlantData(this._plantData.id).lv;l.battleDataProxy.getPlantAtk(this._plantData.id,1,t+1)<=0&&(this.mBar.fillRange=1,this.mBarNum.string="Max",this.mBar.node.parent.getChildByName("arrow").active=!1)},__decorate([f(cc.Sprite)],e.prototype,"mGreadBg",void 0),__decorate([f(cc.Sprite)],e.prototype,"mPlantImg",void 0),__decorate([f(cc.Label)],e.prototype,"mPlantName",void 0),__decorate([f(cc.Label)],e.prototype,"mLvLab",void 0),__decorate([f(cc.Node)],e.prototype,"mBtnDetails",void 0),__decorate([f(cc.Node)],e.prototype,"mBtnRemove",void 0),__decorate([f(cc.Sprite)],e.prototype,"mBar",void 0),__decorate([f(cc.Label)],e.prototype,"mBarNum",void 0),__decorate([f(cc.Node)],e.prototype,"mLockTips",void 0),__decorate([f(cc.Node)],e.prototype,"mLock",void 0),__decorate([m],e)}(cc.Component);n.default=_,cc._RF.pop(),cc._RF.pop()},{}],PlantIceEffect:[function(t,e,a){"use strict";cc._RF.push(e,"05f2dcxEhVKRadwX4Rll0Jg","PlantIceEffect");var i=t,o=e,n=a;cc._RF.push(o,"cc491ZBDzFDJaSxUYOuiB+k","PlantIceEffect"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("ResUtil"),s=i("HomeEnum"),c=cc._decorator,l=c.ccclass,u=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mIceSpr=null,e}return __extends(e,t),e.prototype.initPlantIceEffect=function(t){var e=this;r.ResUtil.loadAsset({path:"textures/boxIce/"+t.frame,type:cc.SpriteFrame,bundleName:s.Bundles.GAME}).then(function(a){e.mIceSpr.spriteFrame=a,e.mIceSpr.node.scaleX=t.scaleX,e.mIceSpr.node.scaleY=t.scaleY,e.mIceSpr.node.angle=t.angle}).catch(function(t){console.log("error:",t)})},e.prototype.updateState=function(t){this.mIceSpr.node.opacity=100*t+155},__decorate([u(cc.Sprite)],e.prototype,"mIceSpr",void 0),__decorate([l],e)}(cc.Component);n.default=p,cc._RF.pop(),cc._RF.pop()},{}],Platform4399:[function(t,e,a){"use strict";cc._RF.push(e,"11a80303M9EjLYLa2pDE9Ar","Platform4399");var i=t,o=e,n=a;cc._RF.push(o,"5959cv0Uz1G55M4Mo/qPo56","Platform4399");var r=__decorate;Object.defineProperty(n,"__esModule",{value:!0}),n.Platform4399=n.EditInputParams=void 0;var s=i("GameUIManager"),c=i("OtherDataProxy"),l=i("AudioManager"),u=cc._decorator,p=u.ccclass,h=(u.property,function(){this.defaultText=null,this.keyboardStateCllback=null,this.textChangeCllback=null,this.textCompleteCllback=null,this.keyboardDeleteCallback=null,this.maxLength=1e3,this.inputType="text"});n.EditInputParams=h;var d=function(){function t(){this.versionStr="1.0.1",this.versionCode=101,this.adUintId={},console.log("4399")}var e;return e=t,Object.defineProperty(t,"Inst",{get:function(){return this.inst||(this.inst=new this)},enumerable:!1,configurable:!0}),t.prototype.getChannelId=function(){return 0},t.prototype.login=function(t){h5api.login(function(e){t&&t(e.uId,e.userName)})},t.prototype.getUserInfo=function(t){t&&t()},t.prototype.getPlatform=function(){return cc.sys.os},t.prototype.authorize=function(){},t.prototype.setKeepScreenOn=function(){},t.prototype.requestSubscribeMessage=function(){},t.prototype.createGameClubButton=function(){},t.prototype.hideGameClubButton=function(){},t.prototype.showToast=function(t){s.gameUIMgr.showTips(t)},t.prototype.showLoading=function(t){s.gameUIMgr.showTips(t)},t.prototype.hideLoading=function(){},t.prototype.shareAppMessage=function(){},t.prototype.startVibrate=function(t){void 0===t&&(t=!1)},t.prototype.review=function(){},t.initSDK=function(t){this._ohayooInitCallback=t},t.initSDKResult=function(){this._ohayooInitCallback&&this._ohayooInitCallback()},t.showAgeTips=function(){},t.showPrivacyPolicy=function(){},t.prototype.preloadAds=function(){},t.prototype.showBanner=function(){},t.prototype.hideBanner=function(){},t.prototype.showInterstitial=function(){h5api.playInterstitialAd()},t.prototype.setClipboardData=function(){},t.prototype.restartMiniProgramSync=function(){},t.prototype.showVideoAds=function(t){e._eventId=t.eventId,e.isRequestVideo=!0,e._successCallback=t.success,e._failCallback=t.fail,e._errorCallback=t.error,h5api.playAd(function(t){console.log("\u4ee3\u7801:"+t.code+",\u6d88\u606f:"+t.message),1e4===t.code?(console.log("\u5f00\u59cb\u64ad\u653e"),l.AudioManager.instance.isOpenBackgroundAudio&&cc.audioEngine.pauseAll(),cc.game.pause()):10001===t.code?(console.log("\u64ad\u653e\u7ed3\u675f"),e.appVideoCompleted()):(console.log("\u5e7f\u544a\u5f02\u5e38"),e.appVideoError())})},t.appVideoCompleted=function(){var t=this;cc.game.resume(),console.log("=====\u5e7f\u544a\u56de\u8c03\u6210\u529f"),this.isRequestVideo=!1,setTimeout(function(){c.otherDataProxy.addCondition(c.ConditionKey.LOOKAD),t._successCallback&&t._successCallback(),t._successCallback=null,t._errorCallback=null,l.AudioManager.instance.isOpenBackgroundAudio&&cc.audioEngine.resumeAll()},10)},t.appVideoClose=function(){var t=this;cc.game.resume(),console.log("=====\u5e7f\u544a\u672a\u770b\u5b8c"),this.isRequestVideo=!1,setTimeout(function(){t._failCallback&&t._failCallback(),t._failCallback=null,t._errorCallback=null,l.AudioManager.instance.isOpenBackgroundAudio&&cc.audioEngine.resumeAll()},10)},t.appVideoError=function(){cc.game.resume(),console.log("=====\u5e7f\u544a\u56de\u8c03\u5931\u8d25"),this.isRequestVideo=!1,this._errorCallback&&this._errorCallback(),this._errorCallback=null,this._successCallback=null,this._failCallback=null,l.AudioManager.instance.isOpenBackgroundAudio&&cc.audioEngine.resumeAll()},t.resultFeedError=function(){},t.resultSplash=function(){},t.prototype.uploadEvent=function(){},t.exitGame=function(){cc.game.end()},t.ohayooSdkInitFail=function(t){console.log(" ------------ errorMsg:",t),this.mInitOhayooSdkCallback&&this.mInitOhayooSdkCallback(t),this.mInitOhayooSdkCallback=null},t.loginComplete=function(t,e,a){console.log(" ------------ \u767b\u5f55\u56de\u8c03\u56de\u6765:","nikeName:"+t+"---openId:"+e+"---avatar:"+a),this.mLoginComplete(t,e,a),this.mLoginComplete=null},t.prototype.addShortcut=function(){},t.prototype.umaTrackEvent=function(){},t.inst=null,t._ohayooInitCallback=null,t._successCallback=null,t._failCallback=null,t._errorCallback=null,t.isAntiAddictionOK=!1,t.mInitOhayooSdkCallback=null,t.mLoginComplete=null,t.isRequestVideo=!1,t._eventId="",e=r([p],t)}();n.Platform4399=d,window.Platform4399=d,cc._RF.pop(),cc._RF.pop()},{}],PlatformApp:[function(t,e,a){"use strict";cc._RF.push(e,"23236llRg5EgqK82w0boZHV","PlatformApp");var i=t,o=e,n=a;cc._RF.push(o,"24581/aco9NJrZkXCz3COwY","PlatformApp");var r=__decorate;Object.defineProperty(n,"__esModule",{value:!0}),n.PlatformApp=n.EditInputParams=void 0;var s=i("GameUIManager"),c=i("AudioManager"),l=cc._decorator,u=l.ccclass,p=(l.property,function(){this.defaultText=null,this.keyboardStateCllback=null,this.textChangeCllback=null,this.textCompleteCllback=null,this.keyboardDeleteCallback=null,this.maxLength=1e3,this.inputType="text"});n.EditInputParams=p;var h=function(){function t(){this.versionStr="1.0.0",this.versionCode=100,this.adUintId={},console.log("\u8fd0\u884c\u73af\u5883\uff1aapp")}var e;return e=t,Object.defineProperty(t,"Inst",{get:function(){return this.inst||(this.inst=new this)},enumerable:!1,configurable:!0}),t.prototype.getChannelId=function(){return 0},t.prototype.login=function(t){t&&t(!1,null)},t.prototype.getUserInfo=function(t){t&&t()},t.prototype.getPlatform=function(){return cc.sys.os},t.prototype.requestSubscribeMessage=function(){},t.prototype.createGameClubButton=function(){},t.prototype.hideGameClubButton=function(){},t.prototype.showToast=function(t){s.gameUIMgr.showTips(t)},t.prototype.showLoading=function(t){s.gameUIMgr.showTips(t)},t.prototype.hideLoading=function(){},t.prototype.shareAppMessage=function(){},t.prototype.startVibrate=function(t){switch(void 0===t&&(t=!1),cc.sys.os){case"Android":t?jsb.reflection.callStaticMethod("org/cocos2dx/javascript/Utils","vibrateLong","()V"):jsb.reflection.callStaticMethod("org/cocos2dx/javascript/Utils","vibrateShort","()V")}},t.prototype.review=function(){switch(cc.sys.os){case"Android":jsb.reflection.callStaticMethod("org/cocos2dx/javascript/Utils","review","()V")}},t.initSDK=function(t){this._ohayooInitCallback=t,cc.sys.os},t.initSDKResult=function(){this._ohayooInitCallback&&this._ohayooInitCallback()},t.showAgeTips=function(){cc.sys.os},t.showPrivacyPolicy=function(){cc.sys.os},t.prototype.preloadAds=function(){},t.prototype.showBanner=function(){},t.prototype.hideBanner=function(){},t.prototype.showInterstitial=function(){},t.prototype.setClipboardData=function(){},t.prototype.restartMiniProgramSync=function(){},t.prototype.showVideoAds=function(t){if(yzll.gameConfig.isTest||yzll.gameConfig.isGM)t.success&&t.success();else switch(e._eventId=t.eventId,e.isRequestVideo=!0,e._successCallback=t.success,e._failCallback=t.fail,e._errorCallback=t.error,cc.sys.os){case"Android":var a=jsb.reflection.callStaticMethod("org/cocos2dx/javascript/AdsMgr","videoIsReady","()Z");console.log("zb hasReward",a),a&&(cc.game.pause(),jsb.reflection.callStaticMethod("org/cocos2dx/javascript/AdsMgr","showVideo","()V"));break;case"iOS":cc.audioEngine.pauseAll()}},t.appVideoCompleted=function(){var t=this;cc.game.resume(),console.log("=====\u5e7f\u544a\u56de\u8c03\u6210\u529f"),this.isRequestVideo=!1,setTimeout(function(){t._successCallback&&t._successCallback(),t._successCallback=null,t._errorCallback=null,c.AudioManager.instance.isOpenBackgroundAudio&&cc.audioEngine.resumeAll()},10)},t.appVideoClose=function(){var t=this;cc.game.resume(),console.log("=====\u5e7f\u544a\u672a\u770b\u5b8c"),this.isRequestVideo=!1,setTimeout(function(){t._failCallback&&t._failCallback(),t._failCallback=null,t._errorCallback=null,c.AudioManager.instance.isOpenBackgroundAudio&&cc.audioEngine.resumeAll()},10)},t.appVideoError=function(){cc.game.resume(),console.log("=====\u5e7f\u544a\u56de\u8c03\u5931\u8d25"),this.isRequestVideo=!1,this._errorCallback&&this._errorCallback(),this._errorCallback=null,this._successCallback=null,this._failCallback=null,c.AudioManager.instance.isOpenBackgroundAudio&&cc.audioEngine.resumeAll()},t.resultFeedError=function(){},t.resultSplash=function(){},t.prototype.uploadEvent=function(){},t.exitGame=function(){cc.game.end()},t.ohayooSdkInitFail=function(t){console.log(" ------------ errorMsg:",t),this.mInitOhayooSdkCallback&&this.mInitOhayooSdkCallback(t),this.mInitOhayooSdkCallback=null},t.loginComplete=function(t,e,a){console.log(" ------------ \u767b\u5f55\u56de\u8c03\u56de\u6765:","nikeName:"+t+"---openId:"+e+"---avatar:"+a),this.mLoginComplete(t,e,a),this.mLoginComplete=null},t.prototype.umaTrackEvent=function(){},t.prototype.addShortcut=function(){},t.prototype.authorize=function(){},t.inst=null,t._ohayooInitCallback=null,t._successCallback=null,t._failCallback=null,t._errorCallback=null,t.isAntiAddictionOK=!1,t.mInitOhayooSdkCallback=null,t.mLoginComplete=null,t.isRequestVideo=!1,t._eventId="",e=r([u],t)}();n.PlatformApp=h,window.PlatformApp=h,cc._RF.pop(),cc._RF.pop()},{}],PlatformKS:[function(t,e,a){"use strict";cc._RF.push(e,"d5175fRhUlMxLjzbikH0Kt6","PlatformKS");var i=t,o=e,n=a;cc._RF.push(o,"1ec5aRXI39M6bZ40M0qXLHU","PlatformKS"),Object.defineProperty(n,"__esModule",{value:!0}),n.PlatformKS=void 0;var r=i("GameUIManager"),s=i("AudioManager"),c=i("CommonUtil"),l=i("SceneManager"),u=function(){function t(){this.versionStr="1.0.1",this.versionCode=101,this.mVideo=null,this.systemInfo=null,this.launchInfo=null,this.shareTitle="[\u6709\u4eba@\u6211]\u52a0\u73ed\uff0c\u52a0\u73ed\uff0c\u6211\u8981\u52a0\u73ed\uff01",this.shareImageUrl=null,this.adUintId={Video:{1:"2300020179_01",2:"2300020179_01",3:"2300020179_01"},Banner:{1:"adunit-81db461af35a9730"},Interstitial:{1:"adunit-c7d874d483204568"}},this.gameClubButton=null,this.shareTime=0,this.shareSuccess=null,this.shareFail=null,this.shareComplete=null,this.bannerCache={},this.interstitial=null,this._adsId=1,this.ttVideoObj=null,c.CommonUtil.print("\u8fd0\u884c\u73af\u5883\uff1aks"),this.systemInfo=wx.getSystemInfoSync(),this.launchInfo=wx.getLaunchOptionsSync(),cc.game.on(cc.game.EVENT_SHOW,this.shareResult,this)}return t.prototype.getPlatform=function(){return"wx"},t.compareVersion=function(t){var e=wx.getSystemInfoSync().SDKVersion,a=/\d+.\d+.\d+/;if(!a.test(t)||!a.test(e))return console.warn("SDKVersion\u53d6\u503c\u5f02\u5e38"),!1;for(var i=e.split("."),o=t.split("."),n=0;n<3;n++){var r=parseInt(i[n]),s=parseInt(o[n]);if(r>s)return!0;if(r<s)return!1}return!0},t.prototype.getRandomNum=function(t,e,a){void 0===a&&(a=!0);var i=e-t,o=Math.random()*i+t;return a&&(o=Math.round(o)),o},t.prototype.showToast=function(t,e,a){wx.showToast({title:t,icon:e,duration:a?1500:500})},t.prototype.showLoading=function(t){wx.showLoading({title:t})},t.prototype.hideLoading=function(){wx.hideLoading()},t.prototype.getChannelId=function(){return 1},t.prototype.login=function(t){wx.login({success:function(e){t&&t(!0,e)},fail:function(){c.CommonUtil.print("wx.login fail"),t&&t(!1,null)}})},t.prototype.authorize=function(t){var e=this;wx.getSetting({success:function(a){if(a.authSetting[t.scope])"scope.userInfo"!=t.scope?t.success&&t.success():wx.getUserInfo({withCredentials:!0,lang:"zh_CN",success:function(e){t.success&&t.success(e)}});else if("scope.userInfo"!=t.scope)wx.authorize({scope:t.scope,success:function(){t.success&&t.success()},fail:function(){t.fail&&t.fail()}});else if(e.compareVersion("2.0.7")){var i=wx.createUserInfoButton({withCredentials:!0,type:"text",text:"",style:{left:0,top:0,width:cc.winSize.width,height:cc.winSize.height,backgroundColor:"#00000000",fontSize:16,lineHeight:20,color:"#000000",textAlign:"center",borderRadius:0}}),o=!0;i.onTap(function(e){e.userInfo?(c.CommonUtil.print("\u7528\u6237\u6388\u6743"),i.destroy(),o&&(o=!1,t.success&&t.success(e))):(c.CommonUtil.print("\u62d2\u7edd\u6388\u6743\u7528\u6237\u4fe1\u606f"),i.destroy(),t.fail&&t.fail())})}else wx.showModal({title:"\u6e29\u99a8\u63d0\u793a",content:"\u5f53\u524d\u5fae\u4fe1\u7248\u672c\u8fc7\u4f4e\uff0c\u8bf7\u5347\u7ea7\u5230\u6700\u65b0\u7248\u5fae\u4fe1\u540e\u91cd\u8bd5!"})},fail:function(){c.CommonUtil.print("wx.getSetting fail"),t.fail&&t.fail()}})},t.prototype.createGameClubButton=function(t){if(this.gameClubButton)this.gameClubButton.show();else{var e=cc.size(t.width+10,t.height+10),a=cc.view.getFrameSize(),i=cc.director.getWinSize(),o=(.5*i.width+t.x-.5*e.width)/i.width*a.width,n=(.5*i.height-t.y-.5*e.height)/i.height*a.height,r=e.width/i.width*a.width,s=e.height/i.height*a.height;this.gameClubButton=wx.createGameClubButton({type:"text",text:"  ",style:{left:o,top:n,width:r,height:s}})}},t.prototype.hideGameClubButton=function(){this.gameClubButton&&this.gameClubButton.hide()},t.prototype.getUserInfo=function(t){var e=this;wx.login({success:function(a){c.CommonUtil.print("\u767b\u5f55\u6210\u529f:",a),e.authorize({scope:"scope.userInfo",success:function(){wx.getUserInfo({success:function(e){c.CommonUtil.print("getUserInfo \u8c03\u7528\u6210\u529f",e.userInfo),t&&t(e.userInfo)},fail:function(e){c.CommonUtil.print("getUserInfo \u8c03\u7528\u5931\u8d25",e.errMsg),t&&t()}})},fail:function(){t&&t()}})},fail:function(e){c.CommonUtil.print("\u767b\u5f55\u5931\u8d25",e.errMsg),t&&t()}})},t.prototype.shareAppMessage=function(t){t||(t={title:null,imageUrl:null,query:null,camera:null,success:null,fail:null,complete:null}),this.shareTime=Date.now(),this.shareSuccess=null==t?void 0:t.success,this.shareFail=null==t?void 0:t.fail,this.shareComplete=null==t?void 0:t.complete,t.title=(null==t?void 0:t.title)||(null==this?void 0:this.shareTitle),(null==t?void 0:t.camera)?t.imageUrl=this.getImageUrlByCamera(t.camera):(null==t?void 0:t.imageUrl)?t.imageUrl=t.imageUrl:t.imageUrl=this.getImageUrlFromCanvasCenter();var e=["[\u6709\u4eba@\u6211]\u50f5\u5c38\u6765\u4e86\uff0c\u5feb\u4e0a\u8f66\uff01","[\u6709\u4eba@\u6211]\u6211\u88ab\u50f5\u5c38\u5403\u6389\u4e86~","[\u6709\u4eba@\u6211]\u5e26\u597d\u88c5\u5907\uff0c\u51fa\u53d1\uff01"];c.CommonUtil.print("\u5206\u4eab\u51fa\u53bb\uff1a",t.query);var a=this.getRandomNum(0,e.length-1);wx.shareAppMessage({title:e[a],imageUrl:cc.url.raw("resources/share/"+["share_img_1","share_img_2","share_img_3"][a]+".png"),query:t.query})},t.prototype.shareResult=function(){s.AudioManager.instance.resumeBgm(),Date.now()-this.shareTime>3500?this.shareSuccess&&this.shareSuccess():this.shareFail&&this.shareFail(),this.shareComplete&&this.shareComplete(),this.shareTime=0,this.shareSuccess=null,this.shareFail=null,this.shareComplete=null},t.prototype.getImageUrlFromCanvasCenter=function(){var t,e,a,i,o=cc.game.canvas.getContext("2d")||cc.game.canvas.getContext("webgl",{preserveDrawingBuffer:!0});return cc.winSize.width>cc.winSize.height?a=(i=o.drawingBufferHeight)/4*5:i=(a=o.drawingBufferWidth)/5*4,t=(o.drawingBufferWidth-a)/2,e=(o.drawingBufferHeight-i)/2,o.canvas.toTempFilePathSync({x:t,y:e,width:a,height:i,destWidth:500,destHeight:400})},t.prototype.getImageUrlByCamera=function(t){var e=new cc.RenderTexture,a=cc.game._renderContext;e.initWithSize(500,400,a.STENCIL_INDEX8),t.targetTexture=e,t.render(null);var i=e.readPixels(),o=document.createElement("canvas"),n=o.getContext("2d"),r=o.width=e.width,s=o.height=e.height;o.width=e.width,o.height=e.height;for(var c=4*r,l=0;l<s;l++){for(var u=s-1-l,p=n.createImageData(r,1),h=u*r*4,d=0;d<c;d++)p.data[d]=i[h+d];n.putImageData(p,0,l)}return o.toTempFilePathSync()},t.prototype.showShareMenu=function(){wx.showShareMenu({showShareItems:["qq","qzone","wechatFriends","wechatMoment"],withShareTicket:!0}),wx.onShareAppMessage(function(){var t=Math.round(2*Math.random());return{title:["[\u6709\u4eba@\u6211]\u50f5\u5c38\u6765\u4e86\uff0c\u5feb\u4e0a\u8f66\uff01","[\u6709\u4eba@\u6211]\u6211\u88ab\u50f5\u5c38\u5403\u6389\u4e86~","[\u6709\u4eba@\u6211]\u5e26\u597d\u88c5\u5907\uff0c\u51fa\u53d1\uff01"][t],imageUrl:cc.url.raw("resources/share/"+["share_img_1","share_img_2","share_img_3"][t]+".png"),query:""}})},t.prototype.preloadAds=function(){},t.prototype.addBanner=function(t){var e=this,a=t.id,i=t.posNode,o=t.width,n=t.sCnt,r=t.preload,s=this.adUintId.Banner[a];o=cc.misc.clampf(o,300,this.systemInfo.screenHeight),n=t.sCnt||5,this.hideAllBanner();var l=function(t){t.style.top=i?e.systemInfo.screenHeight*(1-i.getBoundingBoxToWorld().yMin/cc.winSize.height):e.systemInfo.screenHeight-Math.ceil(t.style.realHeight)-2};if(!this.bannerCache[s]||this.bannerCache[s].sCnt<=0){this.bannerCache[s]&&this.bannerCache[s].banner.destroy();var u=(this.systemInfo.screenWidth-o)/2,p=wx.createBannerAd({adUnitId:s,style:{left:u,top:this.systemInfo.screenHeight,width:o}});p.onError(function(t){c.CommonUtil.print(t)}),p.onResize(function(){l(p)}),this.bannerCache[s]={banner:p,sCnt:n}}else l(this.bannerCache[s].banner);r||(this.bannerCache[s].banner.show(),this.bannerCache[s].sCnt-=1)},t.prototype.showBanner=function(){this.addBanner({id:1,width:300})},t.prototype.hideBanner=function(){this.hideAllBanner()},t.prototype.hideAllBanner=function(){for(var t in this.bannerCache)this.bannerCache[t].banner.hide()},t.prototype.showInterstitial=function(){this.addInterstitial(1)},t.prototype.addInterstitial=function(t){var e=this,a=this.adUintId.Interstitial[t];this.compareVersion("2.6.0")&&(this.interstitial||(this.interstitial=wx.createInterstitialAd({adUnitId:a})),this.interstitial.load().then(function(){e.interstitial.show()}).catch(function(t){console.error(t)}))},t.prototype.hideInterstitial=function(){this.interstitial&&this.interstitial.destroy()},t.prototype.setClipboardData=function(){},t.prototype.restartMiniProgramSync=function(){},t.prototype.showVideoAds=function(t){var e=this;if(yzll.gameConfig.isTest||yzll.gameConfig.isGM)return t.success&&t.success(),void this.umaTrackEvent("video",{userA:t.eventId});this._adsId=1,this.ttVideoObj=t;var a=this.adUintId.Video[this._adsId];0!==a.length?(this.mVideo||(this.mVideo=wx.createRewardedVideoAd({adUnitId:a}),this.mVideo.onClose(function(a){console.log("onClose::"),console.log(JSON.stringify(a)),l.SceneManager.instance.hideLoading(),setTimeout(function(){a.isEnded?(r.gameUIMgr.showTips("\u89c6\u9891\u64ad\u653e\u5b8c\u6bd5!"),e.umaTrackEvent("video",{userA:t.eventId}),e.ttVideoObj.success&&e.ttVideoObj.success()):(r.gameUIMgr.showTips("\u89c6\u9891\u672a\u64ad\u653e\u5b8c\u6bd5!"),e.ttVideoObj.fail&&e.ttVideoObj.fail()),s.AudioManager.instance.resumeBgm()},10),e._adsId++,e._adsId>3&&(e._adsId=1)}),this.mVideo.onError(function(t){l.SceneManager.instance.hideLoading(),console.log("onError::"),console.log(JSON.stringify(t)),c.CommonUtil.print(JSON.stringify(t)),e.ttVideoObj.error&&e.ttVideoObj.error(),e._adsId++,e._adsId>3&&(e._adsId=1)})),this.mVideo&&(l.SceneManager.instance.showLoading(),this.mVideo.load().then(function(){e.mVideo.show().then(function(){l.SceneManager.instance.hideLoading(),c.CommonUtil.print("\u89c6\u9891\u5e7f\u544a\u663e\u793a\u6210\u529f")})}))):this.ttVideoObj.error&&this.ttVideoObj.error()},t.prototype.compareVersion=function(t){var e=this.systemInfo.SDKVersion,a=/\d+.\d+.\d+/;if(!a.test(t)||!a.test(e))return console.warn("SDKVersion\u53d6\u503c\u5f02\u5e38"),!1;for(var i=e.split("."),o=t.split("."),n=0;n<3;n++){var r=parseInt(i[n]),s=parseInt(o[n]);if(r>s)return!0;if(r<s)return!1}return!0},t.prototype.checkUpdate=function(){var t=wx.getUpdateManager();t.onUpdateReady(function(){wx.showModal({title:"\u66f4\u65b0\u63d0\u793a",content:"\u65b0\u7248\u672c\u5df2\u51c6\u5907\u597d\uff0c\u662f\u5426\u91cd\u542f\u5e94\u7528\uff1f",success:function(e){e.confirm&&t.applyUpdate()}})})},t.prototype.review=function(){},t.prototype.startVibrate=function(t){void 0===t&&(t=!1),t&&wx.vibrateLong({type:"medium",success:function(){},fail:function(){},complete:function(){}}),!t&&wx.vibrateShort({type:"medium",success:function(){},fail:function(){},complete:function(){}})},t.prototype.uploadEvent=function(){},t.prototype.requestSubscribeMessage=function(t,e){wx.requestSubscribeMessage({tmplIds:t,success:function(t){e&&e(!0,t)},fail:function(t){e&&e(!1,t)}})},t.prototype.umaTrackEvent=function(t,e){yzll.gameConfig.bUseUma&&t&&wx.uma.trackEvent(t,e)},t.prototype.addShortcut=function(){wx.checkShortcut({success:function(t){t.installed?r.gameUIMgr.showTips("\u5df2\u6dfb\u52a0\u684c\u9762!"):wx.addShortcut({success:function(){r.gameUIMgr.showTips("\u6dfb\u52a0\u684c\u9762\u6210\u529f!")},fail:function(t){-10005===t.code?r.gameUIMgr.showTips("\u6682\u4e0d\u652f\u6301\u8be5\u529f\u80fd!"):r.gameUIMgr.showTips("\u6dfb\u52a0\u684c\u9762\u5931\u8d25!")}})},fail:function(t){-10005===t.code?r.gameUIMgr.showTips("\u6682\u4e0d\u652f\u6301\u8be5\u529f\u80fd"):r.gameUIMgr.showTips("\u68c0\u67e5\u5feb\u6377\u65b9\u5f0f\u5931\u8d25")}})},t}();n.PlatformKS=u,cc._RF.pop(),cc._RF.pop()},{}],PlatformQGame:[function(t,e,a){"use strict";cc._RF.push(e,"4e2e3CbfzZG2YVvZ1juGN0g","PlatformQGame");var i=e,o=a;cc._RF.push(i,"20a3f/aU6NGXr8pMogySa1t","PlatformQGame");var n=__decorate;Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,s=r.ccclass,c=(r.property,function(){function t(){this.versionStr="1.0.0",this.versionCode=100,this.adUintId={Video:{vivo:["78b82a87fe3a47ff847a934fc668a41f"],oppo:["1193597","1193612"]},Banner:{vivo:"3b98818308914b3fb1bcbf554e10b16f",oppo:"119860"},Interstitial:{vivo:"625e4b9d373641c8a528decba67e1f08",oppo:"119862"},Custom:{vivo1:"",vivo2:"",oppo:"1060870"},Box:{vivo:"3b98818308914b3fb1bcbf554e10b16f",oppo:"1193590"}},this.shortVibrateTime=0,this.longVibrateTime=0,this.bannerAd=null,this.rewardedAd=null,this.interstitialAd=null,this.customAd=null,this.boxBannerAd=null,this.videoIdIndex=0,this.ttVideoObj=null,this.preloadAds()}var e;return e=t,t.prototype.getChannelId=function(){return 0},t.prototype.login=function(t){switch(cc.sys.platform){case cc.sys.OPPO_GAME:qg.getSystemInfoSync().platformVersionCode>=1040?qg.login({success:function(e){var a=JSON.stringify(e.data);console.log("===oppo\u767b\u9646\u6210\u529f\uff1a"+a),t&&t(!0,{code:e.data.token})},fail:function(e){console.log("===oppo\u767b\u9646\u5931\u8d25\uff1a"+JSON.stringify(e)),t&&t(!1,0)}}):t&&t(!1,0);break;case cc.sys.VIVO_GAME:qg.getSystemInfoSync().platformVersionCode>=1063?qg.login().then(function(e){var a=JSON.stringify(e.data);console.log("===vivo\u767b\u9646\u6210\u529f\uff1a"+a),t&&t(!0,{code:e.data.token})},function(e){console.log("===vivo\u767b\u9646\u5931\u8d25\uff1a"+JSON.stringify(e)),t&&t(!1,0)}):t&&t(!1,0)}},t.prototype.getUserInfo=function(t){cc.sys.platform===cc.sys.OPPO_GAME?t&&t():cc.sys.platform===cc.sys.VIVO_GAME&&(qg.getSystemInfoSync().platformVersionCode>=1063?qg.getUserInfo().then(function(e){console.log("\u5f53\u524d\u7528\u6237\u4fe1\u606f: ",e),e.data?t&&t({nickName:e.data.nickName}):t&&t()},function(e){console.log("\u83b7\u53d6\u7528\u6237\u4fe1\u606f\u5931\u8d25",e),t&&t()}):t&&t())},t.prototype.getPlatform=function(){return"qGame"},t.prototype.requestSubscribeMessage=function(t,e){e&&e(!1)},t.prototype.createGameClubButton=function(){},t.prototype.hideGameClubButton=function(){},t.prototype.showToast=function(t,e,a){cc.sys.platform===cc.sys.OPPO_GAME?qg.showToast({title:t,icon:"none",duration:a?2e3:1e3}):cc.sys.platform===cc.sys.VIVO_GAME&&qg.showToast({message:t,duration:a?1:0})},t.prototype.showLoading=function(t){cc.sys.platform===cc.sys.OPPO_GAME?qg.showLoading({title:t}):cc.sys.platform===cc.sys.VIVO_GAME&&qg.showLoading({message:t})},t.prototype.hideLoading=function(){qg.hideLoading()},t.prototype.review=function(){},t.prototype.shareAppMessage=function(){},t.prototype.startVibrate=function(t){if(void 0===t&&(t=!1),t){if((this.longVibrateTime&&(new Date).getTime()-this.longVibrateTime)<800)return;qg.vibrateLong&&qg.vibrateLong(),this.longVibrateTime=(new Date).getTime()}else{if((this.shortVibrateTime&&(new Date).getTime()-this.shortVibrateTime)<60)return;qg.vibrateShort&&qg.vibrateShort(),this.shortVibrateTime=(new Date).getTime()}},t.prototype.preloadAds=function(){this.createVideoAd(),this.createCustomAd(),this.createBox()},t.prototype.createBannerAd=function(){var t=this;if(qg.getSystemInfoSync().platformVersionCode>=1031){var a=null;cc.sys.platform===cc.sys.OPPO_GAME?a=this.adUintId.Banner.oppo:cc.sys.platform===cc.sys.VIVO_GAME&&(a=this.adUintId.Banner.vivo),this.bannerAd=qg.createBannerAd({posId:a,style:{}}),this.bannerAd.onLoad(function(){console.log("=========Banner\u5e7f\u544a\u52a0\u8f7d\u6210\u529f"),e.isShowBanner&&t.showBanner()}),this.bannerAd.onError(function(e){console.log("=======Banner\u5e7f\u544a\u52a0\u8f7d\u5931\u8d25:",e),3e4==e.errCode&&(t.bannerAd=qg.createBannerAd({posId:a,style:{}}))})}},t.prototype.showBanner=function(){switch(e.isShowBanner=!0,cc.sys.platform){case cc.sys.OPPO_GAME:case cc.sys.VIVO_GAME:this.showBox()}},t.prototype.hideBanner=function(){switch(e.isShowBanner=!1,cc.sys.platform){case cc.sys.OPPO_GAME:case cc.sys.VIVO_GAME:this.hideBox()}},t.prototype.createInterstitialAd=function(){if(qg.getSystemInfoSync().platformVersionCode>=1031){var t=null;cc.sys.platform===cc.sys.OPPO_GAME?t=this.adUintId.Interstitial.oppo:cc.sys.platform===cc.sys.VIVO_GAME&&(t=this.adUintId.Interstitial.vivo),this.interstitialAd=qg.createInterstitialAd({posId:t})}},t.prototype.showInterstitial=function(){this.interstitialAd&&this.interstitialAd.show().then(function(){console.log("\u63d2\u5c4f\u5e7f\u544a\u5c55\u793a\u5b8c\u6210")}).catch(function(t){console.log("\u63d2\u5c4f\u5e7f\u544a\u5c55\u793a\u5931\u8d25",JSON.stringify(t))})},t.prototype.createCustomAd=function(){var t=this;if(cc.sys.platform===cc.sys.OPPO_GAME){if(qg.getSystemInfoSync().platformVersionCode<1103)return;console.log("====screenWidth:",qg.getSystemInfoSync().screenWidth);var e=this.adUintId.Custom.oppo;this.customAd=qg.createCustomAd({adUnitId:e,style:{}}),this.customAd.onLoad(function(){console.log("customAd\u5e7f\u544a\u52a0\u8f7d\u6210\u529f")}),this.customAd.onError(function(t){console.log("customAd\u9519\u8bef\u76d1\u542c\uff1a",JSON.stringify(t))}),this.customAd.onHide(function(){console.log("customAd\u5e7f\u544a\u9690\u85cf"),t.customAd.destroy(),t.customAd=null,t.createCustomAd()})}else cc.sys.platform,cc.sys.VIVO_GAME},t.prototype.showCustomAd=function(){this.customAd?this.customAd.show().then(function(){console.log("customAd show success")}).catch(function(t){console.log("customAd show fail with:"+t.errCode+","+t.errMsg)}):this.createCustomAd()},t.prototype.hideCustomAd=function(){this.customAd&&this.customAd.hide()},t.showPointCustomAd=function(t){if(qg.createCustomAd){var a=null,i=null,o=!1;switch(cc.sys.platform){case cc.sys.OPPO_GAME:switch(t){case 1:a="1193583";break;case 2:a="1193592";break;case 2:a="1193593"}(i=qg.createCustomAd({adUnitId:a,style:{top:qg.getSystemInfoSync().screenHeight/4}})).onLoad(function(){console.log("customAd\u5e7f\u544a\u52a0\u8f7d\u6210\u529f")}),i.onError(function(t){console.log("customAd\u9519\u8bef\u76d1\u542c\uff1a",JSON.stringify(t))}),i.onHide(function(){console.log("customAd\u5e7f\u544a\u9690\u85cf"),o&&mm.platform.showBanner()}),i.show().then(function(){console.log("customAd show success"),o&&mm.platform.hideBanner()}).catch(function(t){console.log("customAd show fail with:"+t.errCode+","+t.errMsg)});break;case cc.sys.VIVO_GAME:switch(t){case 1:a="baf0fb8b1dd84fd0b376ba4b33667b6b";break;case 2:a="bc39b1a50abc45f5ab2e6cfb7d896076";break;case 3:a="af938dbb2ff94103b3f98fce8eaab8b3"}(i=qg.createCustomAd({posId:a,style:{top:qg.getSystemInfoSync().screenHeight/4}})).onLoad(function(){console.log("\u539f\u751f\u6a21\u677f\u5e7f\u544a\u52a0\u8f7d\u6210\u529f")}),i.onClose(function(){console.log("\u539f\u751f\u6a21\u677f\u5e7f\u544a\u5173\u95ed"),o&&mm.platform.showBanner()}),i.onError(function(t){console.log("\u539f\u751f\u6a21\u677f\u5e7f\u544a\u52a0\u8f7d\u5931\u8d25",t)}),i.show().then(function(){console.log("\u539f\u751f\u6a21\u677f\u5e7f\u544a\u5c55\u793a\u5b8c\u6210"),(o=e.isShowBanner)&&mm.platform.hideBanner()}).catch(function(t){console.log("\u539f\u751f\u6a21\u677f\u5e7f\u544a\u5c55\u793a\u5931\u8d25",t)})}}},t.prototype.createBox=function(){switch(cc.sys.platform){case cc.sys.OPPO_GAME:if(qg.createGameBannerAd){var t=this.adUintId.Box.oppo;this.boxBannerAd=qg.createGameBannerAd({adUnitId:t,style:{top:qg.getSystemInfoSync().screenHeight-300,left:0,orientation:"horizontal"}}),this.boxBannerAd.onLoad(function(){console.log("\u76d2\u5b50\u6a2a\u5e45\u5e7f\u544a\u52a0\u8f7d\u6210\u529f")}),this.boxBannerAd.onError(function(t){console.log("\u76d2\u5b50\u6a2a\u5e45\u5e7f\u544a\u52a0\u8f7d\u5931\u8d25",t)})}else console.log("\u6682\u4e0d\u652f\u6301\u4e92\u63a8\u76d2\u5b50\u76f8\u5173 API");break;case cc.sys.VIVO_GAME:qg.createBoxBannerAd?(t=this.adUintId.Box.vivo,this.boxBannerAd=qg.createBoxBannerAd({posId:t}),this.boxBannerAd.onLoad(function(){console.log("\u76d2\u5b50\u6a2a\u5e45\u5e7f\u544a\u52a0\u8f7d\u6210\u529f")}),this.boxBannerAd.onError(function(t){console.log("\u76d2\u5b50\u6a2a\u5e45\u5e7f\u544a\u52a0\u8f7d\u5931\u8d25",t)})):console.log("\u6682\u4e0d\u652f\u6301\u4e92\u63a8\u76d2\u5b50\u76f8\u5173 API")}},t.prototype.showBox=function(){var t=this;switch(cc.sys.platform){case cc.sys.OPPO_GAME:qg.createGameBannerAd&&(this.boxBannerAd?this.boxBannerAd.show().then(function(){console.log("show success:",t.boxBannerAd)}).catch(function(t){console.log("show fail with:"+t.errCode+","+t.errMsg)}):this.createBox());break;case cc.sys.VIVO_GAME:qg.createBoxBannerAd&&(this.boxBannerAd?this.boxBannerAd.show().then(function(){console.log("show success")}).catch(function(t){console.log("show fail with:"+t.errCode+","+t.errMsg)}):this.createBox())}},t.prototype.hideBox=function(){switch(cc.sys.platform){case cc.sys.OPPO_GAME:qg.createGameBannerAd&&this.boxBannerAd&&this.boxBannerAd.hide().then(function(){console.log("hide success")}).catch(function(t){console.log("hide fail with:"+t.errCode+","+t.errMsg)});break;case cc.sys.VIVO_GAME:qg.createBoxBannerAd&&this.boxBannerAd&&this.boxBannerAd.hide().then(function(){console.log("hide success")}).catch(function(t){console.log("hide fail with:"+t.errCode+","+t.errMsg)})}},t.prototype.createVideoAd=function(){if(qg.getSystemInfoSync().platformVersionCode>=1041){var t=null,e=null;if(cc.sys.platform===cc.sys.OPPO_GAME){e=(t=this.adUintId.Video.oppo)[this.videoIdIndex],console.log("=====\u89c6\u9891\u5e7f\u544aID:",t,e),this.rewardedAd=qg.createRewardedVideoAd({adUnitId:e});var a=this.rewardedAd.load();a&&a.then(function(){console.log("=====\u89c6\u9891\u5e7f\u544a\u52a0\u8f7d\u6210\u529f")}).catch(function(t){console.log("=====\u89c6\u9891\u5e7f\u544a\u52a0\u8f7d\u5931\u8d25\uff1a",t)})}else cc.sys.platform===cc.sys.VIVO_GAME&&(e=(t=this.adUintId.Video.vivo)[this.videoIdIndex],this.rewardedAd=qg.createRewardedVideoAd({posId:e}));this.videoIdIndex++,this.videoIdIndex>=t.length&&(this.videoIdIndex=0)}},t.prototype.setClipboardData=function(){},t.prototype.restartMiniProgramSync=function(){},t.prototype.showVideoAds=function(t){t.success&&t.success()},t.prototype.uploadEvent=function(){},t.prototype.umaTrackEvent=function(){},t.prototype.addShortcut=function(){},t.prototype.authorize=function(){},t.customAd1=null,t.customAd2=null,t.isShowBanner=!1,e=n([s],t)}());o.default=c,cc._RF.pop(),cc._RF.pop()},{}],PlatformTT:[function(t,e,a){"use strict";cc._RF.push(e,"4f20eK+aqJPpZkmJ8q61IeW","PlatformTT");var i=t,o=e,n=a;cc._RF.push(o,"b5a38jagPBIvo4NUA3/dmTW","PlatformTT"),Object.defineProperty(n,"__esModule",{value:!0}),n.PlatformTT=void 0;var r=i("GameUIManager"),s=i("GameEnum"),c=i("DataManager"),l=i("BattleDataProxy"),u=i("OtherDataProxy"),p=i("UserDataProxy"),h=i("AudioManager"),d=i("EventManager"),m=i("CommonUtil"),f=i("AppProxy"),_=i("SceneManager"),y=function(){function t(){var t=this;this.versionStr="1.0.2",this.versionCode=102,this.systemInfo=null,this.launchInfo=null,this.shareTitle="[\u6709\u4eba@\u6211]\u52a0\u73ed\uff0c\u52a0\u73ed\uff0c\u6211\u8981\u52a0\u73ed\uff01",this.shareImageUrl=null,this.recorder=null,this.recorderVideoPath=null,this.recorderStopCallback=null,this.recorderErrorMsg=null,this.isStopRecorder=!1,this.adUintId={Video:{1:"8kfh1gc08mmf1188b7",2:"a3f0phsn9e37gl0gjc"},Banner:{1:"4552986c79mi702kcm"},Interstitial:{1:"adunit-c7d874d483204568"}},this.shareTime=0,this.shareSuccess=null,this.shareFail=null,this.shareComplete=null,this.bannerCache={},this.interstitial=null,this.ttVideoAd=null,this.ttVideoObj=null,this._adsId=1,m.CommonUtil.print("\u8fd0\u884c\u73af\u5883\uff1att"),this.systemInfo=tt.getSystemInfoSync(),this.launchInfo=tt.getLaunchOptionsSync(),this.showShareMenu({}),this.checkUpdate(),cc.game.on(cc.game.EVENT_HIDE,this.shareResult,this);var e=c.DataManager.instance.getTTchannelId();0==e?c.DataManager.instance.setTTchannelId(this.launchInfo.scene):c.DataManager.instance.mTTchannelId=e,"021036"==this.launchInfo.scene&&"homepage"===this.launchInfo.launch_from&&"sidebar_card"===this.launchInfo.location&&(console.log("\u73a9\u5bb6\u662f\u4ece\u4fa7\u8fb9\u680f\u8fdb\u5165\u7684"),c.DataManager.isSidebarCardInGameForTT=!0),tt.onShow(function(e){m.CommonUtil.print("game_on_show callback = ",e),"021036"===e.scene&&"homepage"===e.launch_from&&"sidebar_card"===e.location&&(c.DataManager.isSidebarCardInGameForTT=!0),d.EventManager.instance.emit(f.AppEvent.GAME_SHOW);var a=c.DataManager.instance.getTTchannelId();0==a?c.DataManager.instance.setTTchannelId(t.launchInfo.scene):c.DataManager.instance.mTTchannelId=a}),tt.onHide(function(){d.EventManager.instance.emit(f.AppEvent.GAME_HIDE)})}return Object.defineProperty(t,"Inst",{get:function(){return this.inst||(this.inst=new this)},enumerable:!1,configurable:!0}),t.prototype.getPlatform=function(){return"tt"},t.prototype.restartMiniProgramSync=function(){try{tt.restartMiniProgramSync()}catch(t){console.log("restartMiniProgramSync\u8c03\u7528\u5931\u8d25",t)}},t.prototype.getRandomNum=function(t,e,a){void 0===a&&(a=!0);var i=e-t,o=Math.random()*i+t;return a&&(o=Math.round(o)),o},t.prototype.showToast=function(t,e,a){tt.showToast({title:t,icon:e,duration:a?1500:500})},t.prototype.showLoading=function(t){tt.showLoading({title:t})},t.prototype.hideLoading=function(){tt.hideLoading()},t.prototype.getChannelId=function(){return 3},t.prototype.login=function(t){tt.login({success:function(e){t&&t(!0,e)},fail:function(){m.CommonUtil.print("tt.login fail"),t&&t(!1,null)}})},t.prototype.authorize=function(t){tt.getSetting({success:function(e){e.authSetting[t.scope]?(console.log("\u5df2\u7ecf\u6388\u6743\u8fc7\u4e86"),tt.getUserInfo({withCredentials:!1,lang:"zh_CN",success:function(e){console.log("\u83b7\u53d6\u5230\u4e86\u7528\u6237\u4fe1\u606f"),t.success&&t.success(e)},fail:function(){console.log("\u83b7\u53d6\u7528\u6237\u4fe1\u606f\u5931\u8d25"),t.fail&&t.fail(null)}})):(console.log("\u6ca1\u6388\u6743\u8fc7\uff0c\u5f00\u59cb\u8bf7\u6c42\u6388\u6743"),tt.authorize({scope:t.scope,success:function(){tt.getUserInfo({withCredentials:!1,lang:"zh_CN",success:function(e){console.log("\u83b7\u53d6\u5230\u4e86\u7528\u6237\u4fe1\u606f"),t.success&&t.success(e)},fail:function(){console.log("\u83b7\u53d6\u7528\u6237\u4fe1\u606f\u5931\u8d25"),t.fail&&t.fail(null)}})},fail:function(){t.fail&&t.fail(null)}}))},fail:function(){m.CommonUtil.print("tt.getSetting fail"),t.fail&&t.fail(null)}})},t.prototype.getUserInfo=function(t){tt.login({success:function(e){m.CommonUtil.print("\u767b\u5f55\u6210\u529f:",e),tt.getUserInfo({success:function(e){m.CommonUtil.print("getUserInfo \u8c03\u7528\u6210\u529f",e.userInfo),t&&t({nickName:e.userInfo.nickName,avatarUrl:e.userInfo.avatarUrl})},fail:function(e){m.CommonUtil.print("getUserInfo \u8c03\u7528\u5931\u8d25",e.errMsg),t&&t()}})},fail:function(e){m.CommonUtil.print("\u767b\u5f55\u5931\u8d25",e.errMsg),t&&t()}})},t.prototype.shareAppMessage=function(t){t||(t={title:null,imageUrl:null,query:null,camera:null,success:null,fail:null,complete:null}),this.shareTime=Date.now(),this.shareSuccess=null==t?void 0:t.success,this.shareFail=null==t?void 0:t.fail,this.shareComplete=null==t?void 0:t.complete,t.title=(null==t?void 0:t.title)||(null==this?void 0:this.shareTitle),(null==t?void 0:t.camera)?t.imageUrl=this.getImageUrlByCamera(t.camera):(null==t?void 0:t.imageUrl)?t.imageUrl=t.imageUrl:t.imageUrl=this.getImageUrlFromCanvasCenter();var e=["[\u6709\u4eba@\u6211]\u4f60\u77e5\u9053\u9493\u9c7c\u7684\u4e50\u8da3\u662f\u4ec0\u4e48\u5417\uff1f","[\u6709\u4eba@\u6211]\u597d\u5144\u5f1f\uff0c\u4e00\u8d77\u6765\u9493\u9c7c\u554a\uff1f","[\u6709\u4eba@\u6211]\u6211\u53c8\u5237\u65b0\u4e86\u4e16\u754c\u9493\u9c7c\u8bb0\u5f55\uff0c\u6765\u770b\u770b\u4f60\u5728\u7b2c\u51e0\u540d"];tt.shareAppMessage({channel:"invite",title:e[this.getRandomNum(0,e.length-1)],imageUrl:null,query:t.query,success:function(e){m.CommonUtil.print("\u5206\u4eab\u6210\u529f"+JSON.stringify(e)),t.success&&t.success()},fail:function(){m.CommonUtil.print("\u5206\u4eab\u5931\u8d25"),t.fail&&t.fail()}})},t.prototype.shareResult=function(){Date.now()-this.shareTime>3500?this.shareSuccess&&this.shareSuccess():this.shareFail&&this.shareFail(),this.shareComplete&&this.shareComplete(),this.shareTime=0,this.shareSuccess=null,this.shareFail=null,this.shareComplete=null},t.prototype.getImageUrlFromCanvasCenter=function(){var t,e,a,i,o=cc.game.canvas.getContext("2d")||cc.game.canvas.getContext("webgl",{preserveDrawingBuffer:!0});return cc.winSize.width>cc.winSize.height?a=(i=o.drawingBufferHeight)/4*5:i=(a=o.drawingBufferWidth)/5*4,t=(o.drawingBufferWidth-a)/2,e=(o.drawingBufferHeight-i)/2,o.canvas.toTempFilePathSync({x:t,y:e,width:a,height:i,destWidth:500,destHeight:400})},t.prototype.getImageUrlByCamera=function(t){var e=new cc.RenderTexture,a=cc.game._renderContext;e.initWithSize(500,400,a.STENCIL_INDEX8),t.targetTexture=e,t.render(null);var i=e.readPixels(),o=document.createElement("canvas"),n=o.getContext("2d"),r=o.width=e.width,s=o.height=e.height;o.width=e.width,o.height=e.height;for(var c=4*r,l=0;l<s;l++){for(var u=s-1-l,p=n.createImageData(r,1),h=u*r*4,d=0;d<c;d++)p.data[d]=i[h+d];n.putImageData(p,0,l)}return o.toTempFilePathSync()},t.prototype.showShareMenu=function(){tt.showShareMenu({showShareItems:["qq","qzone","wechatFriends","wechatMoment"],withShareTicket:!0}),tt.onShareAppMessage(function(){var t=Math.round(2*Math.random());return{title:["[\u6709\u4eba@\u6211]\u50f5\u5c38\u6765\u4e86\uff0c\u5feb\u4e0a\u8f66\uff01","[\u6709\u4eba@\u6211]\u6211\u88ab\u50f5\u5c38\u5403\u6389\u4e86~","[\u6709\u4eba@\u6211]\u5e26\u597d\u88c5\u5907\uff0c\u51fa\u53d1\uff01"][t],imageUrl:cc.url.raw("resources/share/"+["share_img_1","share_img_2","share_img_3"][t]+".png"),query:""}})},t.prototype.preloadAds=function(){},t.prototype.addBanner=function(t){var e=this,a=t.id,i=t.posNode,o=t.width,n=t.sCnt,r=t.preload,s=this.adUintId.Banner[a];o=cc.misc.clampf(o,300,this.systemInfo.screenHeight),n=t.sCnt||3,this.hideAllBanner();var c=function(t){t.style.top=i?e.systemInfo.screenHeight*(1-i.getBoundingBoxToWorld().yMin/cc.winSize.height):e.systemInfo.screenHeight-Math.ceil(t.style.realHeight)-2};if(!this.bannerCache[s]||this.bannerCache[s].sCnt<=0){this.bannerCache[s]&&this.bannerCache[s].banner.destroy();var l=(this.systemInfo.screenWidth-o)/2,u=tt.createBannerAd({adUnitId:s,style:{left:l,top:this.systemInfo.screenHeight,width:o}});u.onError(function(t){m.CommonUtil.print(t)}),u.onResize(function(){c(u)}),this.bannerCache[s]={banner:u,sCnt:n}}else c(this.bannerCache[s].banner);r||(this.bannerCache[s].banner.show(),this.bannerCache[s].sCnt-=1)},t.prototype.showBanner=function(){},t.prototype.hideBanner=function(){},t.prototype.hideAllBanner=function(){for(var t in this.bannerCache)this.bannerCache[t].banner.hide()},t.prototype.showInterstitial=function(){this.addInterstitial(1)},t.prototype.addInterstitial=function(t){var e=this,a=this.adUintId.Interstitial[t];this.compareVersion("2.6.0")&&(this.interstitial||(this.interstitial=tt.createInterstitialAd({adUnitId:a})),this.interstitial.load().then(function(){e.interstitial.show()}).catch(function(t){console.error(t)}))},t.prototype.hideInterstitial=function(){this.interstitial&&this.interstitial.destroy()},t.prototype.setClipboardData=function(t){tt.setClipboardData({data:t,success:function(){r.gameUIMgr.showTips("\u590d\u5236\u6210\u529f~")},fail:function(){r.gameUIMgr.showTips("\u590d\u5236\u5931\u8d25~")}})},t.prototype.showVideoAds=function(t){var e=this;if(yzll.gameConfig.isTest||yzll.gameConfig.isGM)return t.success&&t.success(),this.umaTrackEvent("video",{userA:t.eventId}),void this.umaTrackEvent("pay",{userA:this.ttVideoObj.eventId+"_"+p.userDataProxy.userData.curChapter});this.ttVideoObj=t;var a=this.adUintId.Video[this._adsId];if(a||(a=this.adUintId.Video[1]),0===a.length)return r.gameUIMgr.showTips("\u5e7f\u544a\u52a0\u8f7d\u5931\u8d25!"),void(this.ttVideoObj.error&&this.ttVideoObj.error());this.ttVideoAd||(this.ttVideoAd=tt.createRewardedVideoAd({adUnitId:a}),this.ttVideoAd.offClose(),this.ttVideoAd.offError(),this.ttVideoAd.onClose(function(t){_.SceneManager.instance.hideLoading(),setTimeout(function(){t.isEnded?(r.gameUIMgr.showTips("\u89c6\u9891\u64ad\u653e\u5b8c\u6bd5!"),e.umaTrackEvent("video",{userA:e.ttVideoObj.eventId}),e.umaTrackEvent("pay",{userA:e.ttVideoObj.eventId+"_"+p.userDataProxy.userData.curChapter}),u.otherDataProxy.addCondition(u.ConditionKey.LOOKAD),e.ttVideoObj&&e.ttVideoObj.success&&e.ttVideoObj.success()):(r.gameUIMgr.showTips("\u89c6\u9891\u672a\u64ad\u653e\u5b8c\u6bd5!"),e.ttVideoObj.fail&&e.ttVideoObj.fail()),h.AudioManager.instance.resumeBgm()},10),e._adsId++,e._adsId>2&&(e._adsId=1)},10),this.ttVideoAd.onError(function(t){_.SceneManager.instance.hideLoading(),m.CommonUtil.print(t),e.ttVideoObj.error&&e.ttVideoObj.error(),e._adsId++,e._adsId>2&&(e._adsId=1),r.gameUIMgr.showTips("\u5e7f\u544a\u52a0\u8f7d\u5931\u8d25!")})),this.ttVideoAd?(_.SceneManager.instance.showLoading(),this.ttVideoAd.load().then(function(){e.ttVideoAd.show().then(function(){h.AudioManager.instance.pauseBgm(),m.CommonUtil.print("\u89c6\u9891\u5e7f\u544a\u663e\u793a\u6210\u529f"),_.SceneManager.instance.hideLoading(),Date.now()}).catch(function(){r.gameUIMgr.showTips("\u5e7f\u544a\u52a0\u8f7d\u5931\u8d25!"),e.ttVideoObj.error&&e.ttVideoObj.error(),_.SceneManager.instance.hideLoading()})}).catch(function(){r.gameUIMgr.showTips("\u5e7f\u544a\u52a0\u8f7d\u5931\u8d25!"),e.ttVideoObj.error&&e.ttVideoObj.error(),_.SceneManager.instance.hideLoading()})):(r.gameUIMgr.showTips("\u5e7f\u544a\u52a0\u8f7d\u5931\u8d25!"),this.ttVideoObj.error&&this.ttVideoObj.error()),setTimeout(function(){_.SceneManager.instance.hideLoading()},2e3)},t.prototype.compareVersion=function(t){var e=this.systemInfo.SDKVersion,a=/\d+.\d+.\d+/;if(!a.test(t)||!a.test(e))return console.warn("SDKVersion\u53d6\u503c\u5f02\u5e38"),!1;for(var i=e.split("."),o=t.split("."),n=0;n<3;n++){var r=parseInt(i[n]),s=parseInt(o[n]);if(r>s)return!0;if(r<s)return!1}return!0},t.prototype.checkUpdate=function(){var t=tt.getUpdateManager();t.onUpdateReady(function(){tt.showModal({title:"\u66f4\u65b0\u63d0\u793a",content:"\u65b0\u7248\u672c\u5df2\u51c6\u5907\u597d\uff0c\u662f\u5426\u91cd\u542f\u5e94\u7528\uff1f",success:function(e){e.confirm&&t.applyUpdate()}})})},t.prototype.review=function(){},t.prototype.startVibrate=function(t){void 0===t&&(t=!1),t&&tt.vibrateLong({success:function(){},fail:function(){}}),!t&&tt.vibrateShort({success:function(){},fail:function(){}})},t.prototype.uploadEvent=function(){},t.prototype.recorderStart=function(t,e){var a=this;if(!this.recorder){if(tt&&tt.getGameRecorderManager()&&(this.recorder=tt.getGameRecorderManager()),!this.recorder)return;m.CommonUtil.print("\u5f00\u59cb\u5f55\u5236"),this.recorder.onStart(function(t){m.CommonUtil.print("\u5f55\u5c4f\u5f00\u59cb"),a.isStopRecorder=!1,a.recorderVideoPath="",e&&e(!0,t)}),this.recorder.onPause(function(){m.CommonUtil.print("\u5f55\u5c4f\u6682\u505c")}),this.recorder.onResume(function(){m.CommonUtil.print("\u5f55\u5c4f\u6062\u590d")}),this.recorder.onStop(function(t){a.isStopRecorder=!0,m.CommonUtil.print("\u5f55\u5c4f\u505c\u6b62\uff0c\u6587\u4ef6\u4fdd\u5b58\u5728\uff1a",t.videoPath),a.recorderVideoPath=t.videoPath,m.CommonUtil.print("\u5f55\u5c4f\u505c\u6b62\uff0cthis.recorderStopCallback\uff1a",a.recorderStopCallback),a.recorderStopCallback&&a.recorderStopCallback(!0)}),this.recorder.onError(function(t){m.CommonUtil.print("\u5f55\u5c4f\u5931\u8d25\uff0cerrMsg\uff1a"+t),a.recorderErrorMsg=t,a.recorderStopCallback&&a.recorderStopCallback(!1)})}this.recorder.start({duration:t})},t.prototype.recordPause=function(){this.recorder&&this.recorder.pause()},t.prototype.recordResume=function(){this.recorder&&this.recorder.resume()},t.prototype.recordStop=function(t){void 0===t&&(t=null),m.CommonUtil.print("\u505c\u6b62\u5f55\u5236\uff1a",!this.recorder+""+this.isStopRecorder),this.recorder&&(this.isStopRecorder?t&&t():(this.recorderStopCallback=t,this.isStopRecorder=!0,m.CommonUtil.print("\u8c03\u505c\u6b62\u5f55\u5236\u63a5\u53e3"),this.recorder.stop()))},t.prototype.recorderShare=function(t){if(!this.recorder)return m.CommonUtil.print("\u5206\u4eab\u5f55\u5c4f\u5931\u8d251"),void(t&&t(!1,"\u5f55\u5c4f\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5"));if(""==this.recorderVideoPath)return m.CommonUtil.print("\u5206\u4eab\u5f55\u5c4f\u5931\u8d252"),void(t&&t(!1,this.recorderErrorMsg));var e=this.recorderVideoPath;tt.shareAppMessage({channel:"video",extra:{videoPath:e,videoTopics:["\u8fdb\u6211\u9c7c\u5858","\u8fdb\u6211\u9c7c\u5858\u5c0f\u6e38\u620f"]},success:function(e){m.CommonUtil.print("\u5206\u4eab\u6210\u529f\uff1a",e),h.AudioManager.instance.resumeBgm(),setTimeout(function(){t&&t(!0,e)},10)},fail:function(e){m.CommonUtil.print("\u5206\u4eab\u5931\u8d25\uff1a",e),h.AudioManager.instance.resumeBgm(),setTimeout(function(){t&&t(!1,e)},10)}})},t.prototype.checkFollowState=function(t){tt.checkFollowState({success:function(e){m.CommonUtil.print(e.result),t&&t(e.result)}})},t.prototype.followOfficialAccount=function(t){tt.followOfficialAccount({success:function(e){0===e.errCode?(m.CommonUtil.print("\u5173\u6ce8\u6210\u529f"),t&&t(!0)):(m.CommonUtil.print(e.errMsg),t&&t(!1))}})},t.prototype.checkGroupInfo=function(t){var e=!1;try{var a=tt.getSystemInfoSync();m.CommonUtil.print("\u624b\u673a\u578b\u53f7\u4e3a "+a.model),e="Douyin"==a.appName||"douyin_lite"==a.appName}catch(r){m.CommonUtil.print("\u83b7\u53d6\u7cfb\u7edf\u4fe1\u606f\u5931\u8d25"),t&&t(!1)}t&&t(e)},t.prototype.joinGroup=function(t,e){m.CommonUtil.print("\u52a0\u5165\u7fa4id:",t),tt.joinGroup({groupid:t,success:function(t){m.CommonUtil.print(t),e&&e(!0)},fail:function(t){m.CommonUtil.print(t),e&&e(!1)}})},t.prototype.checkFollowAwemeState=function(t){var e=!1;try{var a=tt.getSystemInfoSync();m.CommonUtil.print("\u624b\u673a\u578b\u53f7\u4e3a "+a.model),e="Douyin"==a.appName||"douyin_lite"==a.appName}catch(r){m.CommonUtil.print("\u83b7\u53d6\u7cfb\u7edf\u4fe1\u606f\u5931\u8d25"),t&&t(!1)}e?t&&t(!0):t&&t(!1)},t.prototype.openAwemeUserProfile=function(t){tt.openAwemeUserProfile({success:function(e){m.CommonUtil.print("\u8c03\u7528\u6210\u529f",e),t&&t(!0)},fail:function(e){m.CommonUtil.print("\u8c03\u7528\u5931\u8d25",e),t&&t(!1)}})},t.prototype.requestSubscribeMessage=function(t,e){tt.requestSubscribeMessage({tmplIds:t,success:function(t){e&&e(!0,t)},fail:function(t){e&&e(!1,t)}})},t.prototype.createGameClubButton=function(){},t.prototype.hideGameClubButton=function(){},t.prototype.umaTrackEvent=function(t,e){if((!l.battleDataProxy.isEndless&&l.battleDataProxy.weatherType==s.WeatherType.NONE||"video"==t||"pay"==t||"time"==t)&&yzll.gameConfig.bUseUma){m.CommonUtil.print("\u53cb\u76df trackEvent::",t);var a=e.userA,i=this.versionStr;p.userDataProxy.userData.versionStr&&""!=p.userDataProxy.userData.versionStr&&(i=p.userDataProxy.userData.versionStr),a&&(a=i+"_"+a),console.log("\u53cb\u76df\u4e0a\u4f20\u6570\u636e:",a);var o={};"a"==c.DataManager.instance.userVersion?(t&&sfdata.SfTrackData.instance.trackEvent(t,"userA",a),o.userA=a):"b"==c.DataManager.instance.userVersion?(t&&sfdata.SfTrackData.instance.trackEvent(t,"userB",a),o.userB=a):(t&&sfdata.SfTrackData.instance.trackEvent(t,"userD",a),o.userD=a),t&&tt.uma.trackEvent(t,o)}},t.prototype.addShortcut=function(){tt.checkShortcut({success:function(t){console.log("res.installed:",t),t.installed?r.gameUIMgr.showTips("\u5df2\u6dfb\u52a0\u684c\u9762!"):tt.addShortcut({success:function(){r.gameUIMgr.showTips("\u6dfb\u52a0\u684c\u9762\u6210\u529f!")},fail:function(t){console.log("\u6dfb\u52a0\u684c\u9762\u5931\u8d25:",t),r.gameUIMgr.showTips("\u6dfb\u52a0\u684c\u9762\u5931\u8d25!")}})},fail:function(t){-10005===t.code?r.gameUIMgr.showTips("\u6682\u4e0d\u652f\u6301\u8be5\u529f\u80fd"):r.gameUIMgr.showTips("\u68c0\u67e5\u5feb\u6377\u65b9\u5f0f\u5931\u8d25")}})},t.inst=null,t}();n.PlatformTT=y,cc._RF.pop(),cc._RF.pop()},{}],PlatformWX:[function(t,e,a){"use strict";cc._RF.push(e,"bab7abp6lpAvaDnv8xyB2Ka","PlatformWX");var i=t,o=e,n=a;cc._RF.push(o,"65d98kO+KlB+bGjabTJoVXy","PlatformWX"),Object.defineProperty(n,"__esModule",{value:!0}),n.PlatformWX=void 0;var r=i("GameUIManager"),s=i("GameEnum"),c=i("DataManager"),l=i("BattleDataProxy"),u=i("UserDataProxy"),p=i("AudioManager"),h=i("CommonUtil"),d=i("SceneManager"),m=function(){function t(){this.versionStr="1.0.4",this.versionCode=104,this.systemInfo=null,this.launchInfo=null,this.shareTitle="[\u6709\u4eba@\u6211]\u52a0\u73ed\uff0c\u52a0\u73ed\uff0c\u6211\u8981\u52a0\u73ed\uff01",this.shareImageUrl=null,this.adUintId={Video:{1:"adunit-d161000c9864147b",2:"adunit-d161000c9864147b",3:"adunit-d161000c9864147b"},Banner:{1:"adunit-81db461af35a9730"},Interstitial:{1:"adunit-c7d874d483204568"}},this.gameClubButton=null,this.shareTime=0,this.shareSuccess=null,this.shareFail=null,this.shareComplete=null,this.bannerCache={},this.interstitial=null,this._adsId=1,this.ttVideoObj=null,h.CommonUtil.print("\u8fd0\u884c\u73af\u5883\uff1awx"),this.systemInfo=wx.getSystemInfoSync(),this.launchInfo=wx.getLaunchOptionsSync(),this.showShareMenu({}),this.checkUpdate(),cc.game.on(cc.game.EVENT_SHOW,this.shareResult,this)}return t.prototype.getPlatform=function(){return"wx"},t.compareVersion=function(t){var e=wx.getSystemInfoSync().SDKVersion,a=/\d+.\d+.\d+/;if(!a.test(t)||!a.test(e))return console.warn("SDKVersion\u53d6\u503c\u5f02\u5e38"),!1;for(var i=e.split("."),o=t.split("."),n=0;n<3;n++){var r=parseInt(i[n]),s=parseInt(o[n]);if(r>s)return!0;if(r<s)return!1}return!0},t.prototype.getRandomNum=function(t,e,a){void 0===a&&(a=!0);var i=e-t,o=Math.random()*i+t;return a&&(o=Math.round(o)),o},t.prototype.showToast=function(t,e,a){wx.showToast({title:t,icon:e,duration:a?1500:500})},t.prototype.showLoading=function(t){wx.showLoading({title:t})},t.prototype.hideLoading=function(){wx.hideLoading()},t.prototype.getChannelId=function(){return 1},t.prototype.login=function(t){wx.login({success:function(e){t&&t(!0,e)},fail:function(){h.CommonUtil.print("wx.login fail"),t&&t(!1,null)}})},t.prototype.authorize=function(t){var e=this;wx.getSetting({success:function(a){if(a.authSetting[t.scope])"scope.userInfo"!=t.scope?t.success&&t.success():wx.getUserInfo({withCredentials:!0,lang:"zh_CN",success:function(e){t.success&&t.success(e)}});else if("scope.userInfo"!=t.scope)wx.authorize({scope:t.scope,success:function(){t.success&&t.success()},fail:function(){t.fail&&t.fail()}});else if(e.compareVersion("2.0.7")){var i=wx.createUserInfoButton({withCredentials:!0,type:"text",text:"",style:{left:0,top:0,width:cc.winSize.width,height:cc.winSize.height,backgroundColor:"#00000000",fontSize:16,lineHeight:20,color:"#000000",textAlign:"center",borderRadius:0}}),o=!0;i.onTap(function(e){e.userInfo?(h.CommonUtil.print("\u7528\u6237\u6388\u6743"),i.destroy(),o&&(o=!1,t.success&&t.success(e))):(h.CommonUtil.print("\u62d2\u7edd\u6388\u6743\u7528\u6237\u4fe1\u606f"),i.destroy(),t.fail&&t.fail())})}else wx.showModal({title:"\u6e29\u99a8\u63d0\u793a",content:"\u5f53\u524d\u5fae\u4fe1\u7248\u672c\u8fc7\u4f4e\uff0c\u8bf7\u5347\u7ea7\u5230\u6700\u65b0\u7248\u5fae\u4fe1\u540e\u91cd\u8bd5!"})},fail:function(){h.CommonUtil.print("wx.getSetting fail"),t.fail&&t.fail()}})},t.prototype.createGameClubButton=function(t){if(this.gameClubButton)this.gameClubButton.show();else{var e=cc.size(t.width+10,t.height+10),a=cc.view.getFrameSize(),i=cc.director.getWinSize(),o=(.5*i.width+t.x-.5*e.width)/i.width*a.width,n=(.5*i.height-t.y-.5*e.height)/i.height*a.height,r=e.width/i.width*a.width,s=e.height/i.height*a.height;this.gameClubButton=wx.createGameClubButton({type:"text",text:"  ",style:{left:o,top:n,width:r,height:s}})}},t.prototype.hideGameClubButton=function(){this.gameClubButton&&this.gameClubButton.hide()},t.prototype.getUserInfo=function(t){var e=this;wx.login({success:function(a){h.CommonUtil.print("\u767b\u5f55\u6210\u529f:",a),e.authorize({scope:"scope.userInfo",success:function(){wx.getUserInfo({success:function(e){h.CommonUtil.print("getUserInfo \u8c03\u7528\u6210\u529f",e.userInfo),t&&t(e.userInfo)},fail:function(e){h.CommonUtil.print("getUserInfo \u8c03\u7528\u5931\u8d25",e.errMsg),t&&t()}})},fail:function(){t&&t()}})},fail:function(e){h.CommonUtil.print("\u767b\u5f55\u5931\u8d25",e.errMsg),t&&t()}})},t.prototype.shareAppMessage=function(t){t||(t={title:null,imageUrl:null,query:null,camera:null,success:null,fail:null,complete:null}),this.shareTime=Date.now(),this.shareSuccess=null==t?void 0:t.success,this.shareFail=null==t?void 0:t.fail,this.shareComplete=null==t?void 0:t.complete,t.title=(null==t?void 0:t.title)||(null==this?void 0:this.shareTitle),(null==t?void 0:t.camera)?t.imageUrl=this.getImageUrlByCamera(t.camera):(null==t?void 0:t.imageUrl)?t.imageUrl=t.imageUrl:t.imageUrl=this.getImageUrlFromCanvasCenter();var e=["[\u6709\u4eba@\u6211]\u50f5\u5c38\u6765\u4e86\uff0c\u5feb\u4e0a\u8f66\uff01","[\u6709\u4eba@\u6211]\u6211\u88ab\u50f5\u5c38\u5403\u6389\u4e86~","[\u6709\u4eba@\u6211]\u5e26\u597d\u88c5\u5907\uff0c\u51fa\u53d1\uff01"];h.CommonUtil.print("\u5206\u4eab\u51fa\u53bb\uff1a",t.query);var a=this.getRandomNum(0,e.length-1);wx.shareAppMessage({title:e[a],imageUrl:cc.url.raw("resources/share/"+["share_img_1","share_img_2","share_img_3"][a]+".png"),query:t.query})},t.prototype.shareResult=function(){p.AudioManager.instance.resumeBgm(),Date.now()-this.shareTime>3500?this.shareSuccess&&this.shareSuccess():this.shareFail&&this.shareFail(),this.shareComplete&&this.shareComplete(),this.shareTime=0,this.shareSuccess=null,this.shareFail=null,this.shareComplete=null},t.prototype.getImageUrlFromCanvasCenter=function(){var t,e,a,i,o=cc.game.canvas.getContext("2d")||cc.game.canvas.getContext("webgl",{preserveDrawingBuffer:!0});return cc.winSize.width>cc.winSize.height?a=(i=o.drawingBufferHeight)/4*5:i=(a=o.drawingBufferWidth)/5*4,t=(o.drawingBufferWidth-a)/2,e=(o.drawingBufferHeight-i)/2,o.canvas.toTempFilePathSync({x:t,y:e,width:a,height:i,destWidth:500,destHeight:400})},t.prototype.getImageUrlByCamera=function(t){var e=new cc.RenderTexture,a=cc.game._renderContext;e.initWithSize(500,400,a.STENCIL_INDEX8),t.targetTexture=e,t.render(null);var i=e.readPixels(),o=document.createElement("canvas"),n=o.getContext("2d"),r=o.width=e.width,s=o.height=e.height;o.width=e.width,o.height=e.height;for(var c=4*r,l=0;l<s;l++){for(var u=s-1-l,p=n.createImageData(r,1),h=u*r*4,d=0;d<c;d++)p.data[d]=i[h+d];n.putImageData(p,0,l)}return o.toTempFilePathSync()},t.prototype.showShareMenu=function(){wx.showShareMenu({showShareItems:["qq","qzone","wechatFriends","wechatMoment"],withShareTicket:!0}),wx.onShareAppMessage(function(){var t=Math.round(2*Math.random());return{title:["[\u6709\u4eba@\u6211]\u50f5\u5c38\u6765\u4e86\uff0c\u5feb\u4e0a\u8f66\uff01","[\u6709\u4eba@\u6211]\u6211\u88ab\u50f5\u5c38\u5403\u6389\u4e86~","[\u6709\u4eba@\u6211]\u5e26\u597d\u88c5\u5907\uff0c\u51fa\u53d1\uff01"][t],imageUrl:cc.url.raw("resources/share/"+["share_img_1","share_img_2","share_img_3"][t]+".png"),query:""}})},t.prototype.preloadAds=function(){},t.prototype.addBanner=function(t){var e=this,a=t.id,i=t.posNode,o=t.width,n=t.sCnt,r=t.preload,s=this.adUintId.Banner[a];o=cc.misc.clampf(o,300,this.systemInfo.screenHeight),n=t.sCnt||5,this.hideAllBanner();var c=function(t){t.style.top=i?e.systemInfo.screenHeight*(1-i.getBoundingBoxToWorld().yMin/cc.winSize.height):e.systemInfo.screenHeight-Math.ceil(t.style.realHeight)-2};if(!this.bannerCache[s]||this.bannerCache[s].sCnt<=0){this.bannerCache[s]&&this.bannerCache[s].banner.destroy();var l=(this.systemInfo.screenWidth-o)/2,u=wx.createBannerAd({adUnitId:s,style:{left:l,top:this.systemInfo.screenHeight,width:o}});u.onError(function(t){h.CommonUtil.print(t)}),u.onResize(function(){c(u)}),this.bannerCache[s]={banner:u,sCnt:n}}else c(this.bannerCache[s].banner);r||(this.bannerCache[s].banner.show(),this.bannerCache[s].sCnt-=1)},t.prototype.showBanner=function(){this.addBanner({id:1,width:300})},t.prototype.hideBanner=function(){this.hideAllBanner()},t.prototype.hideAllBanner=function(){for(var t in this.bannerCache)this.bannerCache[t].banner.hide()},t.prototype.showInterstitial=function(){this.addInterstitial(1)},t.prototype.addInterstitial=function(t){var e=this,a=this.adUintId.Interstitial[t];this.compareVersion("2.6.0")&&(this.interstitial||(this.interstitial=wx.createInterstitialAd({adUnitId:a})),this.interstitial.load().then(function(){e.interstitial.show()}).catch(function(t){console.error(t)}))},t.prototype.hideInterstitial=function(){this.interstitial&&this.interstitial.destroy()},t.prototype.setClipboardData=function(t){wx.requirePrivacyAuthorize({success:function(e){console.log("\u6388\u6743\u6210\u529f",e),wx.setClipboardData({data:t,success:function(){r.gameUIMgr.showTips("\u590d\u5236\u6210\u529f~")},fail:function(t){r.gameUIMgr.showTips("\u590d\u5236\u5931\u8d25~"),console.log("setClipboardData\u8c03\u7528\u5931\u8d25",t)}})},fail:function(t){console.log("\u6388\u6743\u5931\u8d25",t),r.gameUIMgr.showTips("\u6388\u6743\u5931\u8d25~")},complete:function(){}})},t.prototype.restartMiniProgramSync=function(){},t.prototype.showVideoAds=function(t){var e=this;if(!yzll.gameConfig.isTest&&!yzll.gameConfig.isGM){this._adsId=1,this.ttVideoObj=t;var a=this.adUintId.Video[this._adsId];if(0!==a.length){var i=wx.createRewardedVideoAd({adUnitId:a});i&&(d.SceneManager.instance.showLoading(),i.offClose(),i.offError(),i.load().then(function(){i.show().then(function(){d.SceneManager.instance.hideLoading(),h.CommonUtil.print("\u89c6\u9891\u5e7f\u544a\u663e\u793a\u6210\u529f")}).catch(function(){r.gameUIMgr.showTips("\u5e7f\u544a\u52a0\u8f7d\u5931\u8d25!"),e.ttVideoObj.error&&e.ttVideoObj.error(),d.SceneManager.instance.hideLoading()})}).catch(function(){r.gameUIMgr.showTips("\u5e7f\u544a\u52a0\u8f7d\u5931\u8d25!"),e.ttVideoObj.error&&e.ttVideoObj.error(),d.SceneManager.instance.hideLoading()}),i.onClose(function(t){d.SceneManager.instance.hideLoading(),setTimeout(function(){t.isEnded?(r.gameUIMgr.showTips("\u89c6\u9891\u64ad\u653e\u5b8c\u6bd5!"),e.umaTrackEvent("video",{userA:e.ttVideoObj.eventId}),e.umaTrackEvent("pay",{userA:e.ttVideoObj.eventId+"_"+u.userDataProxy.userData.curChapter}),e.ttVideoObj.success&&e.ttVideoObj.success()):(r.gameUIMgr.showTips("\u89c6\u9891\u672a\u64ad\u653e\u5b8c\u6bd5!"),e.ttVideoObj.fail&&e.ttVideoObj.fail()),p.AudioManager.instance.resumeBgm()},10),e._adsId++,e._adsId>3&&(e._adsId=1)}),i.onError(function(t){d.SceneManager.instance.hideLoading(),h.CommonUtil.print(t),e.ttVideoObj.error&&e.ttVideoObj.error(),e._adsId++,e._adsId>3&&(e._adsId=1)}))}else this.ttVideoObj.error&&this.ttVideoObj.error()}},t.prototype.compareVersion=function(t){var e=this.systemInfo.SDKVersion,a=/\d+.\d+.\d+/;if(!a.test(t)||!a.test(e))return console.warn("SDKVersion\u53d6\u503c\u5f02\u5e38"),!1;for(var i=e.split("."),o=t.split("."),n=0;n<3;n++){var r=parseInt(i[n]),s=parseInt(o[n]);if(r>s)return!0;if(r<s)return!1}return!0},t.prototype.checkUpdate=function(){var t=wx.getUpdateManager();t.onUpdateReady(function(){wx.showModal({title:"\u66f4\u65b0\u63d0\u793a",content:"\u65b0\u7248\u672c\u5df2\u51c6\u5907\u597d\uff0c\u662f\u5426\u91cd\u542f\u5e94\u7528\uff1f",success:function(e){e.confirm&&t.applyUpdate()}})})},t.prototype.review=function(){},t.prototype.startVibrate=function(t){void 0===t&&(t=!1),t&&wx.vibrateLong({type:"medium",success:function(){},fail:function(){},complete:function(){}}),!t&&wx.vibrateShort({type:"medium",success:function(){},fail:function(){},complete:function(){}})},t.prototype.uploadEvent=function(){},t.prototype.requestSubscribeMessage=function(t,e){wx.requestSubscribeMessage({tmplIds:t,success:function(t){e&&e(!0,t)},fail:function(t){e&&e(!1,t)}})},t.prototype.umaTrackEvent=function(t,e){if((!l.battleDataProxy.isEndless&&l.battleDataProxy.weatherType==s.WeatherType.NONE||"video"==t||"pay"==t||"time"==t)&&yzll.gameConfig.bUseUma){h.CommonUtil.print("\u53cb\u76df trackEvent::",t);var a=e.userA,i=this.versionStr;u.userDataProxy.userData.versionStr&&""!=u.userDataProxy.userData.versionStr&&(i=u.userDataProxy.userData.versionStr),a&&(a=i+"_"+a),console.log("\u53cb\u76df\u4e0a\u4f20\u6570\u636e:",a);var o={};"a"==c.DataManager.instance.userVersion?(t&&sfdata.SfTrackData.instance.trackEvent(t,"userA",a),o.userA=a):"b"==c.DataManager.instance.userVersion?(t&&sfdata.SfTrackData.instance.trackEvent(t,"userB",a),o.userB=a):(t&&sfdata.SfTrackData.instance.trackEvent(t,"userD",a),o.userD=a),t&&wx.uma.trackEvent(t,o)}},t.prototype.addShortcut=function(){},t}();n.PlatformWX=m,cc._RF.pop(),cc._RF.pop()},{}],Platform:[function(t,e,a){"use strict";cc._RF.push(e,"38c1cSS2nZKJI9WKPGiTqLe","Platform");var i=t,o=e,n=a;cc._RF.push(o,"774caUDRyFIr5CBBtTCmkq1","Platform"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("GameUIManager"),s=i("CommonUtil"),c=i("Platform4399"),l=i("PlatformApp"),u=i("PlatformKS"),p=i("PlatformQGame"),h=i("PlatformTT"),d=(i("PlatformWX"),function(){function t(){this.versionStr="1.0.0",this.versionCode=100,this.adUintId={},console.log("Runtime\uff1adev")}return t.prototype.getChannelId=function(){return 0},t.prototype.login=function(t){t&&t(!1,null)},t.prototype.getUserInfo=function(t){t&&t()},t.prototype.getPlatform=function(){return"dev"},t.prototype.startVibrate=function(){},t.prototype.preloadAds=function(){},t.prototype.showBanner=function(){},t.prototype.hideBanner=function(){},t.prototype.showInterstitial=function(){},t.prototype.createGameClubButton=function(){},t.prototype.hideGameClubButton=function(){},t.prototype.umaTrackEvent=function(t,e){yzll.gameConfig.bUseUma&&(s.CommonUtil.print("\u53cb\u76df trackEvent id::",t),s.CommonUtil.print("\u53cb\u76df trackEvent data::",e))},t.prototype.showVideoAds=function(t){t.success&&t.success()},t.prototype.uploadEvent=function(){},t.prototype.showToast=function(t,e,a,i){void 0===i&&(i=null)},t.prototype.showLoading=function(t){r.gameUIMgr.showTips(t)},t.prototype.hideLoading=function(){},t.prototype.shareAppMessage=function(t){t.success&&t.success()},t.prototype.requestSubscribeMessage=function(t,e){e&&e(!1)},t.prototype.review=function(){},t.prototype.setClipboardData=function(){},t.prototype.restartMiniProgramSync=function(){},t.prototype.addShortcut=function(){},t.prototype.authorize=function(){},t}());window.mm={},cc.game.once(cc.game.EVENT_GAME_INITED,function(){mm.config={env:1};var t,e=cc.view.getFrameSize();mm.orientation=e.width<e.height?1:2,mm.screen=Math.max(e.width,e.height)/Math.min(e.width,e.height)<1.78?1:2,mm.lang=((t=cc.sys.localStorage.getItem("SysLanguage")||cc.sys.languageCode).includes("zh")&&(t="zh"),console.log("Lang:",t," LanguageCode:",cc.sys.languageCode),t),mm.platform=yzll.gameConfig.is4399?new c.Platform4399:cc.sys.platform==cc.sys.WECHAT_GAME?new u.PlatformKS:cc.sys.platform==cc.sys.BYTEDANCE_GAME?new h.PlatformTT:cc.sys.platform==cc.sys.ANDROID||cc.sys.os==cc.sys.OS_IOS?new l.PlatformApp:cc.sys.platform==cc.sys.OPPO_GAME||cc.sys.platform==cc.sys.VIVO_GAME?new p.default:new d}),cc._RF.pop(),cc._RF.pop()},{}],PopupBase:[function(t,e,a){"use strict";cc._RF.push(e,"76aefCYn6pEsI85XjZtMP+D","PopupBase");var i=t,o=e,n=a;cc._RF.push(o,"1a97aeelsFNyrUpPJYTYvo5","PopupBase"),Object.defineProperty(n,"__esModule",{value:!0}),n.PopupBase=n.AnimType=void 0;var r,s=i("PopupManager"),c=i("EventManager"),l=i("AppProxy"),u=i("ComponentBase"),p=i("ResUtil"),h=i("HomeEnum"),d=cc._decorator,m=d.ccclass,f=d.property;(function(t){t[t.NONE=0]="NONE",t[t.SCALE=1]="SCALE",t[t.FADE=2]="FADE",t[t.CUSTOM=3]="CUSTOM",t[t.SCALE_EASING=4]="SCALE_EASING"})(r=n.AnimType||(n.AnimType={}));var _=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.transBack=!0,e.blockInput=!0,e.bgColor=cc.color(0,0,0,200),e.anim=!0,e.hideAnim=!0,e.animType=r.SCALE,e.closeTime=.1,e._fullScreen=!1,e.mWidgets=[],e._popupName="",e.bannerPosition=null,e.nativePosition=null,e.align=!1,e._bgNode=null,e._closePosition=null,e._isShow=!1,e._showComplete=!1,e}return __extends(e,t),Object.defineProperty(e.prototype,"fullScreen",{get:function(){return this._fullScreen},set:function(t){this._fullScreen=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"popupName",{get:function(){return this._popupName},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){var e=this;t.prototype.onLoad.call(this);var a=cc.view.getVisibleSize();if(this.transBack){this._bgNode=new cc.Node("BgNode");var i=this._bgNode.addComponent(cc.Sprite);p.ResUtil.loadAsset({path:"textures/transback",type:cc.SpriteFrame,bundleName:h.Bundles.RES}).then(function(t){i.spriteFrame=t,e._bgNode.color=new cc.Color(e.bgColor.r,e.bgColor.g,e.bgColor.b),e._bgNode.setContentSize(a.width,a.height)}).catch(function(){}),i.type=cc.Sprite.Type.SLICED,i.sizeMode=cc.Sprite.SizeMode.CUSTOM,this.node.addChild(this._bgNode,-1),this._bgNode.opacity=0}this.blockInput&&(this.node.setContentSize(a),this.node.addComponent(cc.BlockInputEvents))},e.prototype._init=function(t,e,a){this._popupName=t,this._closePosition=e,this.init(a)},e.prototype._show=function(){return __awaiter(this,void 0,Promise,function(){return __generator(this,function(t){switch(t.label){case 0:return this._bgNode&&(cc.Tween.stopAllByTarget(this._bgNode),cc.tween(this._bgNode).to(.25,{opacity:this.bgColor.a}).start()),this._isShow=!0,c.EventManager.instance.emit(l.AppEvent.POPUP_SHOW,this._popupName),this.node.active=!0,cc.Tween.stopAllByTarget(this.node),this.node.setPosition(0,0,0),this.anim?r.CUSTOM!==this.animType?[3,2]:[4,this.customShowAnim()]:[3,8];case 1:return t.sent(),[3,8];case 2:return r.SCALE_EASING!==this.animType?[3,4]:[4,this._scaleEasingAnim()];case 3:return t.sent(),[3,8];case 4:return r.SCALE!=this.animType?[3,6]:[4,this._scaleAnim()];case 5:return t.sent(),[3,8];case 6:return r.FADE!=this.animType?[3,8]:[4,this._fadeAnim()];case 7:t.sent(),t.label=8;case 8:return this._showComplete=!0,this.updateAlignment(),this.onShow(),[2]}})})},e.prototype.customShowAnim=function(){return __awaiter(this,void 0,void 0,function(){var t,e=this;return __generator(this,function(){return(t=s.PopupManager.instance.globalAnim)?[2,new Promise(function(a){t.clone(e.node).call(function(){a(!0)}).start()})]:[2,Promise.resolve()]})})},e.prototype._scaleEasingAnim=function(){var t=this;return this.node.scale=0,new Promise(function(e){cc.tween(t.node).to(.35,{scale:1},{easing:"backOut"}).call(function(){e(!0)}).start()})},e.prototype._scaleAnim=function(){var t=this;return this.node.scale=0,new Promise(function(e){cc.tween(t.node).to(.25,{scale:1},{easing:"backOut",onUpdate:function(e){t._bgNode&&(t._bgNode.scale=1/e.scale)}}).call(function(){e(!0)}).start()})},e.prototype._fadeAnim=function(){var t=this;return this.node.opacity=0,new Promise(function(e){cc.tween(t.node).to(.25,{opacity:255}).call(function(){e(!0)}).start()})},e.prototype._hide=function(t){var e=this;if(void 0===t&&(t=!0),c.EventManager.instance.emit(l.AppEvent.POPUP_HIDE,this._popupName),this.onHide(),!this.anim||!this.hideAnim||!t)return this.node.active=!1,Promise.resolve();cc.Tween.stopAllByTarget(this.node);var a=Object.create(null);return r.SCALE===this.animType?a.scale=.5:r.FADE===this.animType&&(a.opacity=0),null!=this._closePosition&&(a.position=this._closePosition),new Promise(function(t){r.FADE!=e.animType?(e._bgNode&&cc.tween(e._bgNode).to(e.closeTime,{opacity:0}).start(),cc.tween(e.node).to(e.closeTime,{scale:.5},{onUpdate:function(t){e._bgNode&&(e._bgNode.scale=1/t.scale)}}).call(function(){e.node.active=!1,t(!0)}).start()):cc.tween(e.node).to(e.closeTime,{opacity:0}).call(function(){e.node.active=!1,t(!0)}).start()})},e.prototype.init=function(){this.mWidgets.forEach(function(t){(null==t?void 0:t.getComponent(cc.Widget))&&(t.width=cc.winSize.width,t.height=cc.winSize.height,t.getComponent(cc.Widget).enabled=!1)})},e.prototype.onShow=function(){this.mWidgets.forEach(function(t){(null==t?void 0:t.getComponent(cc.Widget))&&(t.getComponent(cc.Widget).enabled=!0)})},e.prototype.onHide=function(){},e.prototype.removeUI=function(t,e){void 0===t&&(t=s.PopupCacheMode.ONCE),void 0===e&&(e=!0),s.PopupManager.instance.remove(this.popupName,t,!0,e)},e.prototype.updateAlignment=function(){if(!this.align){var t=this.node.getComponent(cc.Widget);null!=t&&t.updateAlignment()}},__decorate([f({tooltip:"\u662f\u5426\u9700\u8981\u9ed8\u8ba4\u900f\u660e\u80cc\u666f"})],e.prototype,"transBack",void 0),__decorate([f({tooltip:"\u662f\u5426\u4e0d\u80fd\u7a7f\u900f"})],e.prototype,"blockInput",void 0),__decorate([f({tooltip:"\u80cc\u666f\u989c\u8272",visible:function(){return this.transBack}})],e.prototype,"bgColor",void 0),__decorate([f({tooltip:"\u662f\u5426\u9700\u8981\u52a8\u753b"})],e.prototype,"anim",void 0),__decorate([f({tooltip:"\u662f\u5426\u9700\u8981\u5173\u95ed\u52a8\u753b"})],e.prototype,"hideAnim",void 0),__decorate([f({type:cc.Enum(r),tooltip:"\u52a8\u753b\u7c7b\u578b",visible:function(){return this.anim}})],e.prototype,"animType",void 0),__decorate([f({tooltip:"\u5173\u95ed\u52a8\u753b\u6240\u9700\u65f6\u95f4",visible:function(){return this.hideAnim}})],e.prototype,"closeTime",void 0),__decorate([f({tooltip:"\u8be5\u5f39\u6846\u662f\u5426\u8986\u76d6\u4e86\u6574\u4e2a\u5c4f\u5e55"})],e.prototype,"_fullScreen",void 0),__decorate([f({})],e.prototype,"fullScreen",null),__decorate([f({tooltip:"\u64ad\u653escale\u52a8\u753b\u65f6\uff0c\u4e0d\u9700\u8981\u9002\u914d\u7684\u8282\u70b9",type:[cc.Node],visible:function(){return this.animType==r.SCALE}})],e.prototype,"mWidgets",void 0),__decorate([m],e)}(u.ComponentBase);n.PopupBase=_,cc._RF.pop(),cc._RF.pop()},{}],PopupManager:[function(t,e,a){"use strict";cc._RF.push(e,"fe716fTJ45BJo7XV2OZePYw","PopupManager");var i=t,o=e,n=a;cc._RF.push(o,"eab29SwiNpJObbfxwbWSBAY","PopupManager"),Object.defineProperty(n,"__esModule",{value:!0}),n.PopupManager=n.PopupCacheMode=void 0;var r,s=i("AppBase"),c=i("BlockInputManager"),l=i("EventManager"),u=i("ResUtil"),p=i("AppProxy");(function(t){t[t.ONCE=0]="ONCE",t[t.CACHE=1]="CACHE",t[t.CACHE_RES=2]="CACHE_RES",t[t.AWAY=3]="AWAY"})(r=n.PopupCacheMode||(n.PopupCacheMode={}));var h=function(){function t(){this._loadingPopup=[],this._dealing=!1,this._showOptions=[],this.popupNode=null,this._popups=[],this._prefabMap={},this._nodeMap={},this.popupInit=!1,this._globalAnim=null}return Object.defineProperty(t,"instance",{get:function(){return null==this._instance&&(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"popups",{get:function(){return this._popups},enumerable:!1,configurable:!0}),t.prototype.getPopupNode=function(){return this.popupNode},Object.defineProperty(t.prototype,"globalAnim",{get:function(){return this._globalAnim},set:function(t){this._globalAnim=t},enumerable:!1,configurable:!0}),t.prototype.init=function(){this.setParent()},t.prototype.checkDealing=function(){0===this._showOptions.length?(this._dealing=!1,c.BlockInputManager.instance.popupBlockInputNum=0):this.dealQueue(this._showOptions.shift())},t.prototype.dealQueue=function(t){return __awaiter(this,void 0,void 0,function(){var e,a,i,o,n,r,s;return __generator(this,function(l){switch(l.label){case 0:if((e=t.name)===this.getCurrentName())return console.warn(e+"\u5f39\u6846\u5df2\u7ecf\u663e\u793a"),this.checkDealing(),[2];if(this._dealing=!0,c.BlockInputManager.instance.popupBlockInputNum=1,a=t.priority||0,null!=(i=this._nodeMap[e]))return[3,7];if(null!=(o=t.prefab||this._prefabMap[e]))return[3,5];if(null==t.path)throw this.checkDealing(),new Error("\u9996\u6b21\u521b\u5efa\u5fc5\u987b\u4f20\u5165prefab\u6216\u8005path");this._loadingPopup.push(e),n=null,l.label=1;case 1:return l.trys.push([1,3,,4]),[4,u.ResUtil.loadAsset({bundleName:t.bundleName,path:t.path,type:cc.Prefab})];case 2:return n=l.sent(),[3,4];case 3:return r=l.sent(),console.error(r),[3,4];case 4:return null==n?(this.checkDealing(),console.error(t.path+"\u52a0\u8f7d\u5931\u8d25"),[2]):(this._prefabMap[e]||(this._prefabMap[e]=n,n.addRef()),-1===(s=this._loadingPopup.indexOf(e))?(console.warn(e+"\u5df2\u53d6\u6d88\u663e\u793a"),[2]):(this._loadingPopup.splice(s,1),null==e&&(e=n.name),e===this.getCurrentName()?(console.warn(e+"\u5f39\u6846\u5df2\u7ecf\u663e\u793a"),this.checkDealing(),[2]):(i=cc.instantiate(n),[3,6])));case 5:i=cc.instantiate(o),l.label=6;case 6:this._nodeMap[e]=i,l.label=7;case 7:return this._show(e,i,a,t.params,t.keep||!1,t.closePosition,t.parent),[2]}})})},t.prototype.show=function(t){var e;if(!this.popupInit)throw new Error("\u8bf7\u5148\u521d\u59cb\u5316PopupManager");var a=t.name||(null===(e=t.prefab)||void 0===e?void 0:e.name);if(null==a){if(null==t.path)throw new Error("name\u3001prefab\u3001path\u4e0d\u540c\u540c\u65f6\u4e3a\u7a7a");a=cc.path.basename(t.path)}t.name=a,this._dealing?this._showOptions.push(t):this.dealQueue(t)},t.prototype._show=function(t,e,a,i,o,n,r){var s,c=e.getComponent("PopupBase");if(null==c)throw this.checkDealing(),new Error("\u8bf7\u5c06Popup\u7ee7\u627fPopupBase");var l=this._popups.indexOf(t);l>=0&&this._popups.splice(l,1);var u=(null===(s=this.getCurrentPopup())||void 0===s?void 0:s.zIndex)||0;if(a<u){e.active=!1;for(var p=this._popups.length-1;p>=0;p--)if(a<=(this._nodeMap[this._popups[p]].zIndex||0)){this._popups.splice(p,0,t);break}}else if(o)this._popups.push(t);else{for(p=0;p<this._popups.length;p++){var h=this.getPopup(this._popups[p]);h&&(h.active=!1)}this._popups.push(t)}c._init(t,n,i);var d=r||this.popupNode;e.parent!=d&&(e.removeFromParent(),e.parent=d),e.zIndex!=a&&(a>cc.macro.MAX_ZINDEX?a=cc.macro.MAX_ZINDEX:a<cc.macro.MIN_ZINDEX&&(a=cc.macro.MIN_ZINDEX),e.zIndex=a),a>=u?this.showPopup(e):this.checkDealing()},t.prototype.showLast=function(){var t=null;if(this._popups.length>0){var e=this._popups[this._popups.length-1];t=this._nodeMap[e]}if(null!=t)if(t&&t.isValid&&!t.active){t.active=!0;var a=t.getComponent("PopupBase");a._isShow||a._show(),0===this._showOptions.length&&this.checkDealing()}else this.checkDealing();else this.checkDealing()},t.prototype.showPopup=function(t){var e=this,a=t.getComponent("PopupBase"),i=0===this._showOptions.length;a._show().then(function(){i&&e.checkDealing()}),l.EventManager.instance.emit(p.AppEvent.POPUP_CHANGED),i||this.checkDealing()},t.prototype.hidePopup=function(t,e,a){var i=this;void 0===e&&(e=r.ONCE),void 0===a&&(a=!0);var o=this._nodeMap[t];if(o&&o.isValid){e!=r.AWAY&&(this._nodeMap[t]=null);var n=this._prefabMap[t];e!==r.ONCE&&e!==r.CACHE_RES||(this._prefabMap[t]=null);var s=o.getComponent("PopupBase");o.active?(s._hide(a).then(function(){a&&i.removeNode(o,n,e)}).catch(function(){}),a||this.removeNode(o,n,e)):this.removeNode(o,n,e)}else console.warn(t+"\u5df2\u88ab\u9500\u6bc1")},t.prototype.removeNode=function(t,e,a){r.AWAY!==a?(t.destroy(),r.ONCE===a&&e&&e.decRef()):null!=t&&(t.parent=null)},t.prototype.remove=function(t,e,a,i){void 0===e&&(e=r.ONCE),void 0===a&&(a=!0),void 0===i&&(i=!0);var o=this._popups.indexOf(t),n=o===this._popups.length-1;o>=0&&this._popups.splice(o,1),this.hidePopup(t,e,a),n&&i&&(this.showLast(),l.EventManager.instance.emit(p.AppEvent.POPUP_CHANGED))},t.prototype.removeAll=function(t,e){void 0===t&&(t=r.ONCE),void 0===e&&(e=!1);var a=this.getCurrentName();for(var i in this._nodeMap)if(null!=this._nodeMap[i]&&a!==i){var o=this._popups.indexOf(i);-1!==o&&this._popups.splice(o,1),this.hidePopup(i,t,!1)}a?this.remove(a,t,e):l.EventManager.instance.emit(p.AppEvent.POPUP_CHANGED),this.cleanAllPopup()},t.prototype.showAll=function(){for(var t in this._nodeMap)null!=this._nodeMap[t]&&(this._nodeMap[t].active=!0)},t.prototype.hideAll=function(){for(var t in this._nodeMap)null!=this._nodeMap[t]&&(this._nodeMap[t].active=!1)},t.prototype.has=function(t){return-1!==this._popups.indexOf(t)||-1!==this._loadingPopup.indexOf(t)},t.prototype.hasEach=function(){return this._popups.length>0},t.prototype.getCurrentPopup=function(){var t=this.getCurrentName();return null==t?null:this._nodeMap[t]},t.prototype.getCurrentName=function(){return this._popups.length>0?this._popups[this._popups.length-1]:null},t.prototype.getPopup=function(t){return this._nodeMap[t]||null},t.prototype.cleanAllPopup=function(){this._loadingPopup.length=0,this._popups.length=0,this._showOptions.length=0,this.checkDealing()},t.prototype.setParent=function(){this.popupInit||(this.popupNode=new cc.Node("PopupNode"),this.popupNode.width=s.rootNode.width,this.popupNode.height=s.rootNode.height,s.rootNode.addChild(this.popupNode,1),this.popupInit=!0)},t}();n.PopupManager=h,cc._RF.pop(),cc._RF.pop()},{}],PromoteTipsPopup:[function(t,e,a){"use strict";cc._RF.push(e,"d302fImVhNBprHA2F/y3snI","PromoteTipsPopup");var i=t,o=e,n=a;cc._RF.push(o,"13e53rQxJhAC78avDmUBhi8","PromoteTipsPopup"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("EventManager"),s=i("PopupBase"),c=i("GameEnum"),l=i("RedDotMgr"),u=cc._decorator,p=u.ccclass,h=u.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mShopItem=null,e}return __extends(e,t),e.prototype.init=function(){this.mShopItem.active=l.default.instance.getPlantRedIsShow()},e.prototype.onItemClick=function(t,e){r.EventManager.instance.emit(c.EGameEvent.OPEN_HOME_VIEW,Number(e)),this.removeUI()},__decorate([h(cc.Node)],e.prototype,"mShopItem",void 0),__decorate([p],e)}(s.PopupBase);n.default=d,cc._RF.pop(),cc._RF.pop()},{}],ProtocolGameServer:[function(t,e,a){"use strict";cc._RF.push(e,"bbcc19K4stMP5DprdX8MnCK","ProtocolGameServer");var i=e,o=a;cc._RF.push(i,"b093ch2LLxJL4YCj8aVBkVw","ProtocolGameServer"),Object.defineProperty(o,"__esModule",{value:!0}),o.NetEvent=o.CMD_GameServer_Command=void 0,o.CMD_GameServer_Command||(o.CMD_GameServer_Command={}),o.NetEvent||(o.NetEvent={}),cc._RF.pop(),cc._RF.pop()},{}],ProtocolSendManager:[function(t,e){"use strict";cc._RF.push(e,"ed40czWgehMKaOPuV17jKoy","ProtocolSendManager");var a=e;cc._RF.push(a,"73633OP6iJKVZ8rjWdLGwkV","ProtocolSendManager"),cc._RF.pop(),cc._RF.pop()},{}],ProxyBase:[function(t,e,a){"use strict";cc._RF.push(e,"f0532NkYkREA7A5wprPG99/","ProxyBase");var i=e,o=a;cc._RF.push(i,"f77442vyC1EjLVIeiBmsbh6","ProxyBase"),Object.defineProperty(o,"__esModule",{value:!0}),o.ProxyBase=o.ProxyKey=void 0,function(t){t.BattleData="BattleData",t.UserData="UserData",t.SetData="SetData",t.RelicsData="RelicsData",t.OtherData="OtherData",t.MBData="MBData",t.GuardingData="GuardingData",t.STJData="STJData"}(o.ProxyKey||(o.ProxyKey={}));var n=function(){function t(t){this._data=null,this._data=new t,this.onConstructor()}return t.prototype.onConstructor=function(){},t.prototype.init=function(t){if(t){for(var e in t)this._data[e]=t[e];this.initData()}},t.prototype.initData=function(){},t}();o.ProxyBase=n,cc._RF.pop(),cc._RF.pop()},{}],ProxyManager:[function(t,e,a){"use strict";cc._RF.push(e,"6ab2bsF3exNLYmLL3RTDL2U","ProxyManager");var i=t,o=e,n=a,r=t("./helpers/typeof");cc._RF.push(o,"0e4d6qdFg9PWryowWO5no1j","ProxyManager"),Object.defineProperty(n,"__esModule",{value:!0}),n.ProxyManager=void 0;var s=i("ProxyBase"),c=i("BattleDataProxy"),l=i("GuardingDataProxy"),u=i("MBGameDataProxy"),p=i("OtherDataProxy"),h=i("RelicsDataProxy"),d=i("STJDataProxy"),m=i("UserDataProxy"),f=i("UserSetDataProxy"),_=function(){function t(){}return Object.defineProperty(t,"instance",{get:function(){return null==this._instance&&(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t.prototype.readGameDataBase=function(t,e){switch(t){case s.ProxyKey.BattleData:var a=new c.BattleData;this.readDataItem(a,e),c.battleDataProxy.init(a);break;case s.ProxyKey.UserData:var i=new m.UserData;this.readDataItem(i,e),m.userDataProxy.init(i);break;case s.ProxyKey.SetData:var o=new f.SetData;this.readDataItem(o,e),f.userSetDataProxy.init(o);break;case s.ProxyKey.RelicsData:var n=new h.RelicsData;this.readDataItem(n,e),h.relicsDataProxy.init(n);break;case s.ProxyKey.OtherData:var r=new p.OtherData;this.readDataItem(r,e),p.otherDataProxy.init(r);break;case s.ProxyKey.MBData:var _=new u.MBGameData;this.readDataItem(_,e),u.mbGameDataProxy.init(_);break;case s.ProxyKey.GuardingData:var y=new l.GuardingData;this.readDataItem(y,e),l.guardingDataProxy.init(y);break;case s.ProxyKey.STJData:var g=new d.STJData;this.readDataItem(g,e),d.sTJDataProxy.init(g)}},t.prototype.readDataItem=function(t,e){for(var a in e)"object"==r(e[a])&&t[a]?this.readDataItem(t[a],e[a]):t[a]=e[a]},t._instance=null,t}();n.ProxyManager=_,cc._RF.pop(),cc._RF.pop()},{"./helpers/typeof":"typeof"}],PuddlesWater:[function(t,e,a){"use strict";cc._RF.push(e,"7b1e31OleVE7omZcOYsLGF0","PuddlesWater");var i=t,o=e,n=a;cc._RF.push(o,"ecf736yBKtMj4ixmTIOzg8C","PuddlesWater"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("SimplyCircleCollider"),s=i("SimplyRectCollider"),c=i("SimplyCollisionDetector"),l=i("GameEnum"),u=i("BattleDataProxy"),p=i("Util"),h=i("BulletBall"),d=i("EquipmentItem"),m=cc._decorator,f=m.ccclass,_=(m.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._rowcol="",e._isAbsorb=!1,e._isDetection=!1,e._checkTime=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"rowCol",{get:function(){return this._rowcol},set:function(t){this._rowcol=t},enumerable:!1,configurable:!0}),e.prototype.show=function(){var t=this;this.node.scale=.1,cc.tween(this.node).to(1,{scale:1}).call(function(){t._isDetection=!0}).start()},e.prototype.hide=function(){},e.prototype.update=function(t){var e;if(u.battleDataProxy.gameState!=l.GameState.PAUSE&&!this._isAbsorb&&this._isDetection){for(var a=this.node.getComponent(r.default),i=u.battleDataProxy.bulletBalls,o=0;o<i.length;++o){var n=i[o];if(n&&n.isValid){var p=n.getComponent(r.default);p&&(c.default.isCollisionCircleToCircle(p.circle,a.circle)?n.getComponent(h.default).pushCollisionWater(this.node):n.getComponent(h.default).removeCollisionWater(this.node))}}if(this._checkTime+=t,this._checkTime>=.2){this._checkTime=0;var m=(null===(e=u.battleDataProxy.equipRoot)||void 0===e?void 0:e.children)||[];for(o=0;o<m.length;++o){var f=m[o];if(8==f.getComponent(d.default).equipId)for(var _=f.getChildByName("root").getChildByName("collisions").children,y=0;y<_.length;++y){var g=_[y],v=g.getComponent(s.default);if(v&&c.default.isCollisionRectToCircle(v.rect,a.circle)){this._isAbsorb=!0,this.beAbsorb(g);break}}}}}},e.prototype.beAbsorb=function(t){var e=this,a=this.node.position,i=cc.v3(p.default.convertToTargetNodeSpace(t,this.node)),o=(a.sub(i).normalize(),i.sub(a).normalize().mul(.5)),n=this.node.getChildByName("pic_tianqi2_niba");n.setAnchorPoint(cc.v2(.5,.5).add(cc.v2(o))),n.position=cc.v3(o.x*n.width,o.y*n.height),cc.tween(n).to(1,{scale:0}).call(function(){e.node.destroy(),e.node.removeFromParent()}).start();for(var r=u.battleDataProxy.bulletBalls,s=0;s<r.length;++s)r[s].getComponent(h.default).removeCollisionWater(this.node)},__decorate([f],e)}(cc.Component));n.default=_,cc._RF.pop(),cc._RF.pop()},{}],Queue:[function(t,e,a){"use strict";cc._RF.push(e,"8a18cheHvxMVJQOLMf0VDXb","Queue");var i=e,o=a;cc._RF.push(i,"3bc03O3lHhHNoPOWZRkehz2","Queue"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function t(){this.count=0,this.lowestCount=0,this.itemMap=null,this.count=0,this.lowestCount=0,this.itemMap=new Map}return t.prototype.enqueue=function(t){this.itemMap.set(this.count,t),this.count++},t.prototype.dequeue=function(){if(!this.isEmpty()){var t=this.itemMap.get(this.lowestCount);return this.itemMap.delete(this.lowestCount),this.lowestCount++,t}},t.prototype.peek=function(){if(!this.isEmpty())return this.itemMap.get(this.lowestCount)},t.prototype.isEmpty=function(){return 0===this.itemMap.size},t.prototype.size=function(){return this.itemMap.size},t.prototype.clear=function(){this.itemMap.clear(),this.count=0,this.lowestCount=0},t.prototype.toString=function(){if(this.isEmpty())return"";for(var t=""+this.itemMap.get(this.lowestCount),e=this.lowestCount+1;e<this.count;e++)t=t+","+this.itemMap.get(e);return t},t}();o.default=n,cc._RF.pop(),cc._RF.pop()},{}],RadarChart:[function(t,e,a){"use strict";cc._RF.push(e,"cffc0HI30VG/6J3Wu+vZyy6","RadarChart");var i=e,o=a;cc._RF.push(i,"004b6GyfTJFN66E6elM8f5E","RadarChart"),Object.defineProperty(o,"__esModule",{value:!0}),o.RadarChart=void 0;var n=cc._decorator,r=n.ccclass,s=n.property,c=n.executeInEditMode,l=(n.executionOrder,n.help,n.menu,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.target=null,e._axisLength=200,e._axes=6,e._axisScales=3,e._drawAxes=!0,e._gridLineWidth=4,e._innerGridLineWidth=4,e._gridLineColor=cc.Color.GRAY,e._gridFillColor=cc.color(100,100,100,100),e._dataValuesStrings=["0.8,0.5,0.6,0.5,0.8,0.6","0.5,0.9,0.5,0.8,0.5,0.9"],e._dataLineWidths=[5,5],e._dataLineColors=[cc.Color.BLUE,cc.Color.RED],e._dataFillColors=[cc.color(120,120,180,100),cc.color(180,120,120,100)],e._dataJoinColors=[],e._drawDataJoin=!0,e.graphics=null,e.keepUpdating=!1,e.angles=null,e._curDatas=[],e.curTweenRes=null,e}return __extends(e,t),Object.defineProperty(e.prototype,"axisLength",{get:function(){return this._axisLength},set:function(t){this._axisLength=t,this.draw(this.curDatas)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"axes",{get:function(){return this._axes},set:function(t){this._axes=Math.floor(t>=3?t:3),this.draw(this.curDatas)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"axisScales",{get:function(){return this._axisScales},set:function(t){this._axisScales=Math.floor(t>=1?t:1),this.draw(this.curDatas)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"drawAxes",{get:function(){return this._drawAxes},set:function(t){this._drawAxes=t,this.draw(this.curDatas)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gridLineWidth",{get:function(){return this._gridLineWidth},set:function(t){this._gridLineWidth=t,this.draw(this.curDatas)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"innerGridLineWidth",{get:function(){return this._innerGridLineWidth},set:function(t){this._innerGridLineWidth=t,this.draw(this.curDatas)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gridLineColor",{get:function(){return this._gridLineColor},set:function(t){this._gridLineColor=t,this.draw(this.curDatas)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gridFillColor",{get:function(){return this._gridFillColor},set:function(t){this._gridFillColor=t,this.draw(this.curDatas)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dataValuesStrings",{get:function(){return this._dataValuesStrings},set:function(t){this._dataValuesStrings=t,this.drawWithProperties()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dataLineWidths",{get:function(){return this._dataLineWidths},set:function(t){this._dataLineWidths=t,this.drawWithProperties()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dataLineColors",{get:function(){return this._dataLineColors},set:function(t){this._dataLineColors=t,this.drawWithProperties()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dataFillColors",{get:function(){return this._dataFillColors},set:function(t){this._dataFillColors=t,this.drawWithProperties()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dataJoinColors",{get:function(){return this._dataJoinColors},set:function(t){this._dataJoinColors=t,this.drawWithProperties()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"drawDataJoin",{get:function(){return this._drawDataJoin},set:function(t){this._drawDataJoin=t,this.draw(this.curDatas)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"curDatas",{get:function(){return this._curDatas},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){this.init(),this.drawWithProperties()},e.prototype.update=function(){this.keepUpdating&&0!==this._curDatas.length&&this.draw(this._curDatas)},e.prototype.init=function(){this.target||(this.target=this.node),this.graphics=this.target.getComponent(cc.Graphics)||this.target.addComponent(cc.Graphics),this.graphics.lineJoin=cc.Graphics.LineJoin.ROUND,this.graphics.lineCap=cc.Graphics.LineCap.ROUND},e.prototype.drawWithProperties=function(){for(var t=[],e=this.dataValuesStrings,a=this._dataLineWidths,i=this._dataLineColors,o=this._dataFillColors,n=this._dataJoinColors,r=0;r<e.length;r++)t.push({values:this.processValuesString(e[r]),lineWidth:a[r]||u.lineWidth,lineColor:i[r]||u.lineColor,fillColor:o[r]||u.fillColor,joinColor:n[r]||u.joinColor});this.draw(t)},e.prototype.processValuesString=function(t){for(var e=t.split(","),a=[],i=0;i<e.length;i++){var o=parseFloat(e[i]);a.push(isNaN(o)?0:o)}return a},e.prototype.drawBase=function(){var t=this.graphics;t.lineWidth=this._gridLineWidth,t.strokeColor=this._gridLineColor,t.fillColor=this._gridFillColor;for(var e=this.angles=[],a=360/this.axes,i=0;i<this.axes;i++)e.push(a*i);var o=[],n=this._axisLength,r=this._axisScales,s=n/r;for(i=0;i<r;i++){for(var c=[],l=n-s*i,u=0,p=this.angles.length;u<p;u++){var h=Math.PI/180*this.angles[u];c.push(cc.v2(l*Math.cos(h),l*Math.sin(h)))}o.push(c)}var d=o[0];if(this._drawAxes)for(i=0;i<d.length;i++)t.moveTo(0,0),t.lineTo(d[i].x,d[i].y);for(t.moveTo(d[0].x,d[0].y),i=1;i<d.length;i++)t.lineTo(d[i].x,d[i].y);if(t.close(),t.fill(),t.stroke(),o.length>1){for(t.lineWidth=this._innerGridLineWidth,i=1;i<o.length;i++){var m=o[i];for(t.moveTo(m[0].x,m[0].y),u=1;u<m.length;u++)t.lineTo(m[u].x,m[u].y);t.close()}t.stroke()}},e.prototype.draw=function(t){var e=this.graphics;e.clear(),this.drawBase();var a=Array.isArray(t)?t:[t];this._curDatas=a,this.resizeCurDatasValues(0);for(var i=this.axes,o=this.axisLength,n=this.angles,r=0;r<a.length;r++){var s=a[r];e.strokeColor=s.lineColor||u.lineColor,e.fillColor=s.fillColor||u.fillColor,e.lineWidth=s.lineWidth||u.lineWidth;for(var c=[],l=0;l<i;l++){var p=(s.values[l]>1?1:s.values[l])*o,h=Math.PI/180*n[l];c.push(cc.v2(p*Math.cos(h),p*Math.sin(h)))}for(e.moveTo(c[0].x,c[0].y),l=1;l<c.length;l++)e.lineTo(c[l].x,c[l].y);if(e.close(),e.fill(),e.stroke(),this._drawDataJoin)for(l=0;l<c.length;l++){var d=c[l];e.strokeColor=s.lineColor||u.lineColor,e.circle(d.x,d.y,2),e.stroke(),e.strokeColor=s.joinColor||u.joinColor,e.circle(d.x,d.y,.65),e.stroke()}}},e.prototype.to=function(t,e){var a=this;return new Promise(function(i){var o;a.unscheduleAllCallbacks(),a.curTweenRes&&a.curTweenRes(),a.curTweenRes=i;var n=Array.isArray(t)?t:[t];a.keepUpdating=!0;for(var r=0;r<n.length;r++){var s=a._curDatas[r];if(s){for(var c=n[r],l=0;l<s.values.length;l++)cc.tween(s.values).to(e,(o={},o[l]=c.values[l]>1?1:c.values[l],o)).start();cc.tween(s).to(e,{lineWidth:c.lineWidth||s.lineWidth,lineColor:c.lineColor||s.lineColor,fillColor:c.fillColor||s.fillColor,joinColor:c.joinColor||s.joinColor}).start()}}a.scheduleOnce(function(){a.keepUpdating=!1,a.curTweenRes(),a.curTweenRes=null},e)})},e.prototype.resizeCurDatasValues=function(t){void 0===t&&(t=0);for(var e=this._curDatas,a=0;a<e.length;a++){var i=e[a];if(i.values.length<this._axes)for(var o=this._axes-i.values.length,n=0;n<o;n++)i.values.push(t)}},__decorate([s({type:cc.Node,tooltip:!1})],e.prototype,"target",void 0),__decorate([s()],e.prototype,"_axisLength",void 0),__decorate([s({tooltip:!1})],e.prototype,"axisLength",null),__decorate([s()],e.prototype,"_axes",void 0),__decorate([s({tooltip:!1})],e.prototype,"axes",null),__decorate([s()],e.prototype,"_axisScales",void 0),__decorate([s({tooltip:!1})],e.prototype,"axisScales",null),__decorate([s()],e.prototype,"_drawAxes",void 0),__decorate([s({tooltip:!1})],e.prototype,"drawAxes",null),__decorate([s()],e.prototype,"_gridLineWidth",void 0),__decorate([s({tooltip:!1})],e.prototype,"gridLineWidth",null),__decorate([s()],e.prototype,"_innerGridLineWidth",void 0),__decorate([s({tooltip:!1})],e.prototype,"innerGridLineWidth",null),__decorate([s()],e.prototype,"_gridLineColor",void 0),__decorate([s({tooltip:!1})],e.prototype,"gridLineColor",null),__decorate([s()],e.prototype,"_gridFillColor",void 0),__decorate([s({tooltip:!1})],e.prototype,"gridFillColor",null),__decorate([s()],e.prototype,"_dataValuesStrings",void 0),__decorate([s({type:[cc.String],tooltip:!1})],e.prototype,"dataValuesStrings",null),__decorate([s()],e.prototype,"_dataLineWidths",void 0),__decorate([s({type:[cc.Integer],tooltip:!1})],e.prototype,"dataLineWidths",null),__decorate([s()],e.prototype,"_dataLineColors",void 0),__decorate([s({type:[cc.Color],tooltip:!1})],e.prototype,"dataLineColors",null),__decorate([s()],e.prototype,"_dataFillColors",void 0),__decorate([s({type:[cc.Color],tooltip:!1})],e.prototype,"dataFillColors",null),__decorate([s()],e.prototype,"_dataJoinColors",void 0),__decorate([s({type:[cc.Color],tooltip:!1})],e.prototype,"dataJoinColors",null),__decorate([s()],e.prototype,"_drawDataJoin",void 0),__decorate([s({tooltip:!1})],e.prototype,"drawDataJoin",null),__decorate([r,c],e)}(cc.Component));o.RadarChart=l;var u={lineWidth:5,lineColor:cc.Color.BLUE,fillColor:cc.color(120,120,180,100),joinColor:cc.Color.WHITE};cc._RF.pop(),cc._RF.pop()},{}],RandomSuperPlantPopup:[function(t,e,a){"use strict";cc._RF.push(e,"6009ahwuYdPoJgu3XL3Ppwu","RandomSuperPlantPopup");var i=t,o=e,n=a;cc._RF.push(o,"b0ab5cZBbZNrbW7xYmnQo9v","RandomSuperPlantPopup"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("EventManager"),s=i("ResUtil"),c=i("PopupBase"),l=i("AdsMgr"),u=i("HomeEnum"),p=i("DataManager"),h=i("BattleDataProxy"),d=i("UserDataProxy"),m=i("GameUIManager"),f=cc._decorator,_=f.ccclass,y=f.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mSpine=null,e.mPlantName=null,e.mPlantIcon=null,e.mBtnRoot=null,e._showPlantId=0,e._combatEqus=[],e._superFrameDatas=[],e}return __extends(e,t),e.prototype.init=function(){var t=this;this.mSpine.setCompleteListener(function(e){"rotate"==(e.animation?e.animation.name:"")&&(t.mSpine.setAnimation(0,"stand",!0),t.mBtnRoot.active=!0)});var e=0;this.mSpine.setEventListener(function(a,i){"change"==i.data.name&&(e++,t.setSuperData(12==e),12==e&&(t.mPlantIcon.node.scale=.3,cc.tween(t.mPlantIcon.node).to(.3,{scale:1.1}).to(.1,{scale:1}).start(),t.setNormalSpr()))}),this._combatEqus=d.userDataProxy.userData.combatEqus.slice(),this._superFrameDatas=h.battleDataProxy.superFrameDatas.slice(),this.mBtnRoot.active=!1},e.prototype.setNormalSpr=function(){var t=this.node.getChildByName("normalBg"),e=t.getChildByName("normalIcon"),a="textures/botanyIcon/pic_plant"+this._showPlantId;t.active=!0,s.ResUtil.loadAsset({path:a,type:cc.SpriteFrame,bundleName:u.Bundles.GAME}).then(function(t){e.getComponent(cc.Sprite).spriteFrame=t}).catch(function(t){console.log("error:",t)})},e.prototype.onShow=function(){var t=this.mBtnRoot.getChildByName("btnAgain"),e=t.getChildByName("videoIcon");h.battleDataProxy.setVideoCardIcon(e,1),t.active=this._combatEqus.length>1,this.setSuperData(),this._combatEqus.length>1?this.mSpine.setAnimation(0,"rotate",!1):(this.mSpine.setAnimation(0,"stand",!0),this.mBtnRoot.active=!0,this.setNormalSpr())},e.prototype.setSuperData=function(t){var e=this.randSuperId(t);this.mPlantIcon.spriteFrame=e.frame;var a=p.DataManager.instance.eData.dataplant[this._showPlantId];this.mPlantName.string="\u8d85\u7ea7"+a.name},e.prototype.randSuperId=function(t){var e=Math.floor(100*Math.random())%this._superFrameDatas.length,a=this._superFrameDatas[e];if(t){if(a.plantId==h.battleDataProxy.topSuperId)return console.log("\u6700\u540e\u4e00\u6ce2\u4e0d\u80fd\u968f\u5230\u4e0a\u6b21\u9009\u7684"),this.randSuperId(t)}else if(a.plantId==this._showPlantId)return this.randSuperId();return this._showPlantId=a.plantId,a},e.prototype.onBtnClose=function(){this.confirmSelect()},e.prototype.confirmSelect=function(){h.battleDataProxy.battleData.superPlantId=this._showPlantId,r.EventManager.instance.emit(h.EBattleEvent.SELECT_SUPER_PLANT),this.removeUI()},e.prototype.onBtnAgain=function(){var t=this;if(d.userDataProxy.getProp(4)>0)return d.userDataProxy.addProp(4,-1),m.gameUIMgr.showSelectSuperPlantPopup(),void this.removeUI();l.default.showVideoAds({id:1,eventId:"selfSelect_SuperPlant_ad",success:function(){m.gameUIMgr.showSelectSuperPlantPopup(),t.removeUI()},fail:function(){},error:function(t){cc.log(t)}},!0)},__decorate([y(sp.Skeleton)],e.prototype,"mSpine",void 0),__decorate([y(cc.Label)],e.prototype,"mPlantName",void 0),__decorate([y(cc.Sprite)],e.prototype,"mPlantIcon",void 0),__decorate([y(cc.Node)],e.prototype,"mBtnRoot",void 0),__decorate([_],e)}(c.PopupBase);n.default=g,cc._RF.pop(),cc._RF.pop()},{}],RandomUtil:[function(t,e,a){"use strict";cc._RF.push(e,"f4b57dPh1JElKGB1DjFYBzs","RandomUtil");var i=e,o=a;cc._RF.push(i,"1a44d2SSLFFxoEcR+CjNAXE","RandomUtil"),Object.defineProperty(o,"__esModule",{value:!0}),o.RandomUtil=void 0,function(t){var e=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function a(t,e){return null==e&&(e=t,t=0),null==e&&(e=1),t+Math.random()*(e-t)}function i(t,e){return Math.floor(a(t,e))}t.random=a,t.randomInt=i,t.randomWord=function(t,a){void 0===a&&(a=!1);for(var o="",n=0;n<t;n++)o+=a&&0===n?e[10+i(e.length-10)]:e[i(e.length)];return o},t.randomArray=function(t){for(var e=0,i=0;i<t.length;i++)e+=t[i];var o=a(e),n=0;for(i=0;i<t.length;i++)if(o<(n+=t[i]))return i;return-1}}(o.RandomUtil||(o.RandomUtil={})),cc._RF.pop(),cc._RF.pop()},{}],RedDotMgr:[function(t,e,a){"use strict";cc._RF.push(e,"5b6aexMrQBIXaY721r6MPk0","RedDotMgr");var i=t,o=e,n=a;cc._RF.push(o,"ee4cegnc19PU67Lh7FdORIZ","RedDotMgr"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("EventManager"),s=i("HomeEnum"),c=i("DataManager"),l=i("UserDataProxy"),u=function(){function t(){this.mShopRed=null,this.mBattleRed=null,this.mPlantRed=null,this.mHybridRed=null,this.mBaseRed=null,this.mWeatherRed=null,this.mUnlockPlantDatas=[]}return Object.defineProperty(t,"instance",{get:function(){return null==this._instance&&(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t.prototype.initRedState=function(){var t=c.DataManager.instance.eData.dataplant,e=l.userDataProxy.userData.passChapter;for(var a in t){var i=t[a];1==i.use&&i.stageID<e+1&&this.mUnlockPlantDatas.push(i)}this.updateRedDotState([s.HOME_REDDOT.BASERED,s.HOME_REDDOT.BATTLERED,s.HOME_REDDOT.HYBRIDRED,s.HOME_REDDOT.PLANTRED,s.HOME_REDDOT.SHOPRED]),r.EventManager.instance.on(s.EHomeEvent.UPDATE_HOME_REDDOT,this.updateRedDotState,this)},t.prototype.updateRedDotState=function(t){for(var e=0;e<t.length;++e){var a=t[e];a==s.HOME_REDDOT.SHOPRED?this.mShopRed.active=this.getShopRedIsShow():a==s.HOME_REDDOT.BATTLERED?(this.mBattleRed.active=this.getBattleRedIsShow(),1==l.userDataProxy.userData.gameModel?this.mWeatherRed.active=this.getWeatherModelRedIsShow():this.mWeatherRed.active=this.getBattleRedIsShow()):a==s.HOME_REDDOT.PLANTRED?this.mPlantRed.active=this.getPlantRedIsShow():a==s.HOME_REDDOT.HYBRIDRED?this.mHybridRed.active=this.getHybridRedIsShow():a==s.HOME_REDDOT.BASERED&&(this.mBaseRed.active=this.getBaseRedIsShow())}},t.prototype.getBattleRedIsShow=function(){for(var t=l.userDataProxy.userData.passChapter,e=1;e<=t;++e){var a=c.DataManager.instance.eData.datastagereward[e];if(a)for(var i=1;i<4;i++)if(this.getBattleBoxRedIsShow(a,i))return!0}var o=[],n=c.DataManager.instance.eData.datastagereward;for(var r in n)""!=n[r].roundReward&&o.push(n[r]);if(l.userDataProxy.userData.roundReward)for(i=0;i<o.length;++i){var s=o[i];if(!(l.userDataProxy.userData.passChapter>=s.id))break;if(!l.userDataProxy.userData.roundReward[s.round])return!0}return!1},t.prototype.getBattleBoxRedIsShow=function(t,e){l.userDataProxy.userData.rewardBox||(l.userDataProxy.userData.rewardBox=[]);var a=2;return l.userDataProxy.userData.passChapter>=t.id?l.userDataProxy.userData.rewardBox[t.id]&&l.userDataProxy.userData.rewardBox[t.id][e]&&(a=3):l.userDataProxy.userData.passChapter+1==t.id?Number(t.boxWave.split("|")[e-1])>l.userDataProxy.userData.passWave?a=1:l.userDataProxy.userData.rewardBox[l.userDataProxy.userData.passChapter+1]&&l.userDataProxy.userData.rewardBox[l.userDataProxy.userData.passChapter+1][e]?a=3:3==e&&(a=l.userDataProxy.userData.passChapter>=t.id?2:1):a=1,2==a},t.prototype.getShopRedIsShow=function(){var t=l.userDataProxy.userData.boxData;if(!t||0==t.cdTime)return!0;var e=l.userDataProxy.userData.dailyData;if(!e||0==e.freeNum)return!0;var a=l.userDataProxy.userData.goldData;return!a||0==a.mfNum},t.prototype.getPlantRedIsShow=function(){for(var t=0;t<this.mUnlockPlantDatas.length;++t){var e=this.mUnlockPlantDatas[t],a=l.userDataProxy.getPlantData(e.id).lv,i=l.userDataProxy.getPropDatas(e.needItem),o=Number(e.needNum.split("|")[a-1]);if(!(o<0)&&i>=o)return!0}return!1},t.prototype.getHybridRedIsShow=function(){return!1},t.prototype.getBaseRedIsShow=function(){return!1},t.prototype.getWeatherModelRedIsShow=function(){for(var t=1;t<=l.userDataProxy.userData.passWeatherChapter;++t)if(c.DataManager.instance.eData.data_weather[t]&&!l.userDataProxy.userData.weatherRewardBox[t])return!0;return!1},t.prototype.getBattleLeftBtnRedIsShow=function(t){if(1==l.userDataProxy.userData.gameModel){for(var e=1;e<t;++e)if(i=c.DataManager.instance.eData.datastagereward[e])for(var a=1;a<4;++a)if(this.getBattleBoxRedIsShow(i,a))return!0}else for(e=1;e<t;++e){var i;if((i=c.DataManager.instance.eData.data_weather[e])&&!l.userDataProxy.userData.weatherRewardBox[e])return!0}return!1},t.prototype.getBattleRightBtnRedIsShow=function(t){if(1==l.userDataProxy.userData.gameModel){for(var e=l.userDataProxy.userData.passChapter,a=t+1;a<=e;++a)if(o=c.DataManager.instance.eData.datastagereward[a])for(var i=1;i<4;++i)if(this.getBattleBoxRedIsShow(o,i))return!0}else for(e=l.userDataProxy.userData.passWeatherChapter,a=t+1;a<=e;++a){var o;if((o=c.DataManager.instance.eData.data_weather[a])&&!l.userDataProxy.userData.weatherRewardBox[a])return!0}return!1},t._instance=null,t}();n.default=u,cc._RF.pop(),cc._RF.pop()},{}],RedDot:[function(t,e,a){"use strict";cc._RF.push(e,"e4c38/45WhNIZuwUf5II1fg","RedDot");var i=e,o=a;cc._RF.push(i,"23944AkKblPeJ34AMx3zUuk","RedDot"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,r=n.ccclass,s=(n.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),__decorate([r],e)}(cc.Component));o.default=s,cc._RF.pop(),cc._RF.pop()},{}],RedPointMgr:[function(t,e,a){"use strict";cc._RF.push(e,"06af8/45t9ONIUaZXZcPrP1","RedPointMgr");var i=t,o=e,n=a;cc._RF.push(o,"7212331QApK6KOBTxfUief7","RedPointMgr"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("RedPointPathConfig"),s=i("RedPointNode"),c=function(){function t(){this.rootNode=null}return Object.defineProperty(t,"instance",{get:function(){return null==t._instance&&(t._instance=new t),t._instance},enumerable:!1,configurable:!0}),t.prototype.initRedPointTree=function(){for(var t in this.rootNode=new s.default,this.rootNode.init(r.redPointConf[r.ERedPointPathName.GAME].path),r.ERedPointPathName){var e=this.rootNode,a=r.redPointConf[Number(r.ERedPointPathName[t])].path.split(".");if(a[0]==r.redPointConf[r.ERedPointPathName.GAME].path){var i=a.length;if(i>1)for(var o=1;o<i;o++)e&&(e=e.addChild(a[o]))}}},t.prototype.findLastRedPoint=function(t){var e=r.redPointConf[t].path.split(".");if(1==e.length&&e[0]!=r.redPointConf[r.ERedPointPathName.GAME].path)return console.error("error root node "+e[0]),null;for(var a=this.rootNode,i=1,o=e.length;i<o;i++)if(a&&(a=a.getChild(e[i])),i==o-1)return a},t.prototype.registerRedPointChange=function(t,e,a){var i=this.findLastRedPoint(t);i&&i.setNumChangeFunc(e,a)},t.prototype.unRegisterRedPointChange=function(t,e){var a=this.findLastRedPoint(t);a&&a.delNumChangeFunc(e)},t.prototype.setRedPointNum=function(t,e){var a=this.findLastRedPoint(t);a&&a.setRedPointNum(e)},t._instance=null,t}();n.default=c,cc._RF.pop(),cc._RF.pop()},{}],RedPointNode:[function(t,e,a){"use strict";cc._RF.push(e,"530cdv8EVRG77KewJnfl0q5","RedPointNode");var i=t,o=e,n=a;cc._RF.push(o,"3faa5FkPtlGlqwzZ42ZKBDS","RedPointNode"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("RedPointPathConfig"),s=function(){function t(){this._nodeName="",this._redPointNum=0,this.parent=null,this.dictChilds=new Map,this.numChangeFuncMap=new Map}return t.prototype.init=function(t){this._nodeName=t,this.numChangeFuncMap.clear()},Object.defineProperty(t.prototype,"nodeName",{get:function(){return this._nodeName},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"redPointNum",{get:function(){return this._redPointNum},enumerable:!1,configurable:!0}),t.prototype.addChild=function(e){if(this.dictChilds.has(e))return this.dictChilds.get(e);var a=new t;return a._nodeName=e,a.parent=this,this.dictChilds.set(e,a),a},t.prototype.getChild=function(t){return this.dictChilds.has(t)?this.dictChilds.get(t):null},t.prototype.setNumChangeFunc=function(t,e){this.numChangeFuncMap.set(e,t),t&&t.call(e,this)},t.prototype.delNumChangeFunc=function(t){this.numChangeFuncMap.delete(t)},t.prototype.setRedPointNum=function(t){var e=this;e.dictChilds.size>0||e._redPointNum!=t&&(e._redPointNum=t,e.notyfyRedPointNumChange(),e.parent&&e.parent.changeParentRedPointNum())},t.prototype.changeParentRedPointNum=function(){var t=this;if(t._nodeName!=r.redPointConf[r.ERedPointPathName.GAME].path){var e=0;t.dictChilds.forEach(function(t){e+=t._redPointNum}),e!=t._redPointNum&&(t._redPointNum=e,t.notyfyRedPointNumChange(),t.parent&&t.parent.changeParentRedPointNum())}},t.prototype.notyfyRedPointNumChange=function(){var t=this;t.numChangeFuncMap.forEach(function(e,a){e&&e.call(a,t)})},t}();n.default=s,cc._RF.pop(),cc._RF.pop()},{}],RedPointPathConfig:[function(t,e,a){"use strict";cc._RF.push(e,"00274jSNztNsIkvKdmutBVH","RedPointPathConfig");var i,o,n=e,r=a;cc._RF.push(n,"c34e249CMdOJptvNaf/CABZ","RedPointPathConfig"),Object.defineProperty(r,"__esModule",{value:!0}),r.redPointConf=r.ERedPointPathName=void 0,function(t){t[t.GAME=0]="GAME",t[t.GAME_HERO=301]="GAME_HERO",t[t.GAME_TASK=1001]="GAME_TASK",t[t.GAME_TASK_DAILY=1002]="GAME_TASK_DAILY",t[t.GAME_TASK_ACHI=1003]="GAME_TASK_ACHI",t[t.GAME_LAND=2001]="GAME_LAND",t[t.GAME_LAND_TRIAL=2002]="GAME_LAND_TRIAL",t[t.GAME_LAND_LOSE=2003]="GAME_LAND_LOSE",t[t.GAME_LAND_ABS=2004]="GAME_LAND_ABS",t[t.GAME_SHOP=3001]="GAME_SHOP",t[t.GAME_OFFLINEREWARD=1e4]="GAME_OFFLINEREWARD",t[t.GAME_SUMMON=10001]="GAME_SUMMON"}(o=r.ERedPointPathName||(r.ERedPointPathName={})),r.redPointConf=((i={})[o.GAME]={path:"game"},i[o.GAME_HERO]={path:"game.hero"},i[o.GAME_TASK]={path:"game.task"},i[o.GAME_TASK_DAILY]={path:"game.task.daily"},i[o.GAME_TASK_ACHI]={path:"game.task.achi"},i[o.GAME_LAND]={path:"game.land"},i[o.GAME_LAND_TRIAL]={path:"game.land.trial"},i[o.GAME_LAND_LOSE]={path:"game.land.lose"},i[o.GAME_LAND_ABS]={path:"game.land.abs"},i[o.GAME_SHOP]={path:"game.shop"},i[o.GAME_OFFLINEREWARD]={path:"game.offlinereward"},i[o.GAME_SUMMON]={path:"game.summon"},i),cc._RF.pop(),cc._RF.pop()},{}],RedPoint:[function(t,e,a){"use strict";cc._RF.push(e,"79f49NTyjlHBJraMpMyBkl9","RedPoint");var i=t,o=e,n=a;cc._RF.push(o,"5158dlsJFNH5Lbo/GDeTVhh","RedPoint"),Object.defineProperty(n,"__esModule",{value:!0});var r,s=i("RedPointPathConfig"),c=i("RedPointMgr"),l=cc._decorator,u=l.ccclass,p=l.property;(function(t){t[t.BREATHE=0]="BREATHE",t[t.FLOAT=1]="FLOAT"})(r||(r={}));var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.redPointType=s.ERedPointPathName.GAME,e.redPointAnimType=r.BREATHE,e._initScale=0,e._initY=0,e}return __extends(e,t),e.prototype.onLoad=function(){var t=this;t._initScale=t.node.scale,t._initY=t.node.y,t.node.active=!1,c.default.instance.registerRedPointChange(t.redPointType,function(e){t.node.active=e.redPointNum>0;var a=t.node.getChildByName("Num");a&&a.active&&(a.active=!0,a.getComponent(cc.Label).string=""+e.redPointNum)},this)},e.prototype.onEnable=function(){},e.prototype.onDestroy=function(){c.default.instance.unRegisterRedPointChange(this.redPointType,this)},__decorate([p({type:cc.Enum(s.ERedPointPathName)})],e.prototype,"redPointType",void 0),__decorate([p({type:cc.Enum(r)})],e.prototype,"redPointAnimType",void 0),__decorate([u],e)}(cc.Component);n.default=h,cc._RF.pop(),cc._RF.pop()},{}],RelicsDataProxy:[function(t,e,a){"use strict";cc._RF.push(e,"4be3dLAEcNPYrUZhwrNrcUK","RelicsDataProxy");var i=t,o=e,n=a;cc._RF.push(o,"06f88BvAuFAx6Ma+GAyxduo","RelicsDataProxy"),Object.defineProperty(n,"__esModule",{value:!0}),n.relicsDataProxy=n.RelicsData=void 0;var r=i("ProxyBase"),s=i("DataManager"),c=function(){this.lookAdNum=0,this.relicsMap={},this.radomNum=0};n.RelicsData=c;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"relicsData",{get:function(){return this._data},enumerable:!1,configurable:!0}),e.prototype.addRelics=function(t,e){var a=this.relicsData.relicsMap[t];a?a.curNum+=e:(a={id:t,level:1,curNum:e},this.relicsData.relicsMap[t]=a),this.saveData()},e.prototype.getRelicsData=function(t){return this.relicsData.relicsMap[t]},e.prototype.upgradeRelics=function(t){for(var e=s.DataManager.instance.eData.data_artifact[t],a=this.relicsData.relicsMap[t].level,i=Number(e.needNum.split("|")[a-1]);this.relicsData.relicsMap[t].curNum>=i&&this.relicsData.relicsMap[t].level<e.maxLevel;)this.relicsData.relicsMap[t].curNum-=i,this.relicsData.relicsMap[t].level+=1,a=this.relicsData.relicsMap[t].level,i=Number(e.needNum.split("|")[a-1])},e.prototype.addRadomNum=function(t){this.relicsData.radomNum+=t,this.saveData()},e.prototype.addLookAdNum=function(t){this.relicsData.lookAdNum+=t,this.saveData()},e.prototype.newDataReset=function(){this.relicsData.lookAdNum=0,this.saveData()},e.prototype.saveData=function(){s.DataManager.instance.writeGameDataBase(r.ProxyKey.RelicsData,this.relicsData)},e.prototype.resetData=function(){this._data=new c,s.DataManager.instance.saveGame()},e}(r.ProxyBase);n.default=l,n.relicsDataProxy=new l(c),cc._RF.pop(),cc._RF.pop()},{}],RenderUtil:[function(t,e,a){"use strict";cc._RF.push(e,"4008dmNQtJDfb2knN18U/sB","RenderUtil");var i=e,o=a;cc._RF.push(i,"8335cAF6UdHULlbdpRvd3TW","RenderUtil"),Object.defineProperty(o,"__esModule",{value:!0}),o.RenderUtil=void 0;var n=function(){function t(){}return t.getRenderTexture=function(t,e){if(!cc.isValid(t))return null;e&&e instanceof cc.RenderTexture||(e=new cc.RenderTexture);var a=Math.floor(t.width),i=Math.floor(t.height);e.initWithSize(a,i);var o=new cc.Node;o.parent=t;var n=o.addComponent(cc.Camera);return n.clearFlags|=cc.Camera.ClearFlags.COLOR,n.backgroundColor=cc.color(0,0,0,0),n.zoomRatio=cc.winSize.height/i,n.targetTexture=e,n.render(t),o.destroy(),e},t.renderWithMaterial=function(t,e,a){e instanceof cc.Material&&(a=e,e=new cc.RenderTexture);var i=new cc.Node;i.setParent(cc.Canvas.instance.node);var o=i.addComponent(cc.Sprite);o.sizeMode=cc.Sprite.SizeMode.RAW,o.trim=!1,o.spriteFrame=new cc.SpriteFrame(t);var n=t.width,r=t.height;e.initWithSize(n,r),a instanceof cc.Material&&o.setMaterial(0,a);var s=new cc.Node;s.setParent(i);var c=s.addComponent(cc.Camera);return c.clearFlags|=cc.Camera.ClearFlags.COLOR,c.backgroundColor=cc.color(0,0,0,0),c.zoomRatio=cc.winSize.height/r,c.targetTexture=e,c.render(i),s.destroy(),i.destroy(),e},t.getPixelsData=function(t,e){if(void 0===e&&(e=!0),!cc.isValid(t))return null;var a=Math.floor(t.width),i=Math.floor(t.height),o=new cc.Node;o.parent=t;var n=o.addComponent(cc.Camera);n.clearFlags|=cc.Camera.ClearFlags.COLOR,n.backgroundColor=cc.color(0,0,0,0),n.zoomRatio=cc.winSize.height/i;var r=new cc.RenderTexture;r.initWithSize(a,i,cc.RenderTexture.DepthStencilFormat.RB_FMT_S8),n.targetTexture=r,n.render(t);var s=r.readPixels();if(r.destroy(),o.destroy(),e){for(var c=s.length,l=4*a,u=new Uint8Array(c),p=0,h=c-l;p<c;p+=l,h-=l)for(var d=0;d<l;d++)u[p+d]=s[h+d];return u}return s},t.flipY=function(t,e){for(var a=t.length,i=new Uint8Array(a),o=0,n=a-e;o<a;o+=e,n-=e)for(var r=0;r<e;r++)i[o+r]=t[n+r];return i},t}();o.RenderUtil=n,cc._RF.pop(),cc._RF.pop()},{}],ReportInterface:[function(t,e,a){"use strict";cc._RF.push(e,"ac0704Y58JHP4Zc6W0NNEbE","ReportInterface");var i=e,o=a;cc._RF.push(i,"f6761zdz3ZKhL0F6mlwNaSb","ReportInterface"),Object.defineProperty(o,"__esModule",{value:!0}),o.AdEventType=void 0,function(t){t[t.PRELOAD=0]="PRELOAD",t[t.LOAD_START=1]="LOAD_START",t[t.LOAD=2]="LOAD",t[t.PLAY=3]="PLAY",t[t.END=4]="END"}(o.AdEventType||(o.AdEventType={})),cc._RF.pop(),cc._RF.pop()},{}],ResUtil:[function(t,e,a){"use strict";cc._RF.push(e,"0241aqDwkZGipjNnv25mZMt","ResUtil");var i=t,o=e,n=a;cc._RF.push(o,"e2e12pafLtCsKReFl3YzjuO","ResUtil"),Object.defineProperty(n,"__esModule",{value:!0}),n.ResUtil=void 0;var r=i("Logger"),s=i("StringUtil"),c=function(){function t(){}return t.loadRemote=function(t){var e=this;null==t.option&&(t.option={});var a=t.url,i=t.option,o=t.success,n=t.fail,r=t.complete;if(!o)return new Promise(function(t,o){e._loadRemote(a,i,t,o)});this._loadRemote(a,i,o,n,r)},t._loadRemote=function(t,e,a,i,o){cc.assetManager.loadRemote(t,e,function(t,e){t?i&&i({errCode:-1,errMsg:t.message}):a&&a(e),o&&o()})},t.loadAssetAny=function(t){for(var e=[],a=0;a<t.requests.length;a++)e.push(this.loadAsset(t.requests[a]));return Promise.all(e)},t.preload=function(t){this.loadBundle({bundle:t.bundle,bundleName:t.bundleName}).then(function(e){e.preload(t.paths,t.type)}).catch(function(){})},t.loadAssetSync=function(t,e,a){var i;return(i=s.StringUtil.isEmpty(a)?cc.resources:cc.assetManager.getBundle(a))?i.get(t,e):null},t.loadAsset=function(t){var e=this;if(!t.success)return new Promise(function(a,i){e._loadAsset(t.path,t.type,t.bundle,t.bundleName,a,i)});this._loadAsset(t.path,t.type,t.bundle,t.bundleName,t.success,t.fail,t.complete)},t._loadAsset=function(t,e,a,i,o,n,s){this.loadBundle({bundle:a,bundleName:i,success:function(a){var i=a.get(t,e);if(null!=i)return o&&o(i),void(s&&s());a.load(t,e,function(t,e){if(t)return r.Logger.error(t),null==n||n({errCode:-1,errMsg:t.message}),void(null==s||s());o&&o(e),s&&s()})},fail:function(t){r.Logger.error(t),n&&n(t),s&&s()}})},t.loadBundle=function(t){var e=this;if(!t.success)return new Promise(function(a,i){e._loadBundle(t.bundle,t.bundleName,a,i)});this._loadBundle(t.bundle,t.bundleName,t.success,t.fail,t.complete)},t._loadBundle=function(t,e,a,i,o){if(t||(t=s.StringUtil.isEmpty(e)?cc.resources:cc.assetManager.getBundle(e)),t)return a&&a(t),void(o&&o());cc.assetManager.loadBundle(e,function(t,e){if(t)return i&&i({errCode:-1,errMsg:t.message}),void(o&&o());a&&a(e),o&&o()})},t.preloadDir=function(t){this.loadBundle({bundle:t.bundle,bundleName:t.bundleName}).then(function(e){e.preloadDir(t.dir)})},t.loadDir=function(t){var e=this;if(!t.success)return new Promise(function(a,i){e._loadDir(t.dir,t.bundle,t.bundleName,a,i)});this._loadDir(t.dir,t.bundle,t.bundleName,t.success,t.fail,t.complete)},t._loadDir=function(t,e,a,i,o,n){this.loadBundle({bundle:e,bundleName:a,success:function(e){e.loadDir(t,function(t,e){if(t)return o&&o({errCode:-1,errMsg:t.message}),void(n&&n());i&&i(e),n&&n()})},fail:function(t){o&&o(t),n&&n()}})},t.loadAssetAnySequence=function(t){for(var e=[],a=0;a<t.requests.length;a++)e.push(this.loadAsset(t.requests[a]));var i=[],o=0;return new Promise(function(a){if(t.requests.length<=0)return a(i);var n=function(){e[o].then(function(r){if(i.push({asset:r,option:t.requests[o]}),++o===e.length)return a(i);n()})};n()})},t.setSpritFrame=function(t,e,a,i){this.loadAsset({bundleName:e,path:a,type:cc.SpriteFrame}).then(function(e){t.spriteFrame=e,i&&i()}).catch(function(t){console.error(t)})},t}();n.ResUtil=c,cc._RF.pop(),cc._RF.pop()},{}],RobotJSON:[function(t,e,a){"use strict";cc._RF.push(e,"1756fzVk5lPs5w1LInNh6M/","RobotJSON");var i=e,o=a;cc._RF.push(i,"8bb072fzQ1PTbSoEVpIzSik","RobotJSON"),Object.defineProperty(o,"__esModule",{value:!0}),o.RobotJSON=void 0;var n=function(){function t(){this.mRobotInfos=[]}return Object.defineProperty(t,"instance",{get:function(){return null==this._instance&&(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t.prototype.loadJson=function(){},t.prototype.getRobotInfos=function(){return this.mRobotInfos.slice()},t._instance=null,t}();o.RobotJSON=n,cc._RF.pop(),cc._RF.pop()},{}],RollView:[function(t,e,a){"use strict";cc._RF.push(e,"4eeccOXfj9J65lNaj5yZ1Wg","RollView");var i=t,o=e,n=a;cc._RF.push(o,"3e45cNtzwNGqoy9us74m4Tn","RollView"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("UserDataProxy"),s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._farRightBg=null,e._bgMoveSpeed=4,e}return __extends(e,t),e.prototype.update=function(){2==r.userDataProxy.userData.gameModel&&this.updateMapPostion()},e.prototype.onLoad=function(){this.initMapData()},e.prototype.initMapData=function(){var t=this.node.children;this._farRightBg=t[2]},e.prototype.updateMapPostion=function(){for(var t=this.node.children,e=null,a=0;a<t.length;++a){var i=t[a];i.x+=this._bgMoveSpeed/2,i.x<-i.width&&(e=i)}e&&(e.x=this._farRightBg.x+e.width,this._farRightBg=e)},__decorate([c],e)}(cc.Component));n.default=l,cc._RF.pop(),cc._RF.pop()},{}],RushEffect:[function(t,e,a){"use strict";cc._RF.push(e,"60646ZlS9FLA55cP6g3OVEH","RushEffect");var i=t,o=e,n=a;cc._RF.push(o,"cd92eRxaV9KnYjVb6EnkDOg","RushEffect"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AnimationCfgMgr"),s=i("AnimationCtrl"),c=cc._decorator,l=c.ccclass,u=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mAnimCtrl=null,e}return __extends(e,t),e.prototype.play=function(){var t=this;this.mAnimCtrl.loadAnimation(r.AnimationCfgMgr.instance.getRushEffect()).then(function(){t.node&&t.node.isValid&&t.mAnimCtrl.playAnim("rush",!0)})},__decorate([u({type:s.default})],e.prototype,"mAnimCtrl",void 0),__decorate([l],e)}(cc.Component);n.default=p,cc._RF.pop(),cc._RF.pop()},{}],STBattleView:[function(t,e,a){"use strict";function i(t,e){var a="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(a)return(a=a.call(t)).next.bind(a);if(Array.isArray(t)||(a=o(t))||e&&t&&"number"==typeof t.length){a&&(t=a);var i=0;return function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function o(t,e){if(t){if("string"==typeof t)return n(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?n(t,e):void 0}}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,i=new Array(e);a<e;a++)i[a]=t[a];return i}cc._RF.push(e,"60c8d4BRTJJbYISt/9YDhc0","STBattleView");var c=t,l=e,u=a;cc._RF.push(l,"9836cwkQDlEVK2YStLiL3v9","STBattleView"),Object.defineProperty(u,"__esModule",{value:!0});var p=c("GameUIManager"),h=c("AudioManager"),d=c("EventManager"),m=c("ResUtil"),f=c("PopupManager"),_=c("GameEnum"),y=c("HomeEnum"),g=c("DataManager"),v=c("BattleDataProxy"),P=c("STJDataProxy"),b=c("STRoleBase"),D=c("STCardItem"),S=c("STJarBox"),C=c("STMonster"),E=cc._decorator,B=E.ccclass,A=E.property,x=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.jarNode=null,e.monsterFab=null,e.suipianNode=null,e.cuizi=null,e.cardItem=null,e.grids=[],e.rows=10,e.cols=5,e.gridWidth=150,e.gridHeight=120,e.selectNode=null,e.creatorMonster=[],e.gridHighlights=new Map,e}return __extends(e,t),e.prototype.update=function(t){if(P.sTJDataProxy.gameState==_.GameState.PLAYING)for(var e in v.battleDataProxy.audioFilterInfo)v.battleDataProxy.audioFilterInfo[e].time-=t},e.prototype.checkGameEnd=function(){this.areAllJarsBroken()&&this.areAllMonstersDefeated()&&this.onGameWin()},e.prototype.areAllMonstersDefeated=function(){return P.sTJDataProxy.enemySoldiers=P.sTJDataProxy.enemySoldiers.filter(function(t){return t&&t.isValid}),0===P.sTJDataProxy.enemySoldiers.length},e.prototype.areAllJarsBroken=function(){for(var t=0;t<this.grids.length;t++){var e=this.grids[t];if(e&&P.sTJDataProxy.isJarIntact(e.id))return!1}return!0},e.prototype.hasMonsterReachedBottom=function(){for(var t=-cc.winSize.height/2-100,e=0;e<P.sTJDataProxy.enemySoldiers.length;e++){var a=P.sTJDataProxy.enemySoldiers[e];if(a&&a.isValid&&a.y<=t)return!0}return!1},e.prototype.onGameWin=function(){P.sTJDataProxy.gameState===_.GameState.PLAYING&&(P.sTJDataProxy.gameState=_.GameState.OVER,this.scheduleOnce(function(){f.PopupManager.instance.show({bundleName:y.Bundles.SmashTheJar,path:"prefabs/popups/STWinPopup",keep:!0})},.5))},e.prototype.onLoad=function(){P.sTJDataProxy.resetData()},e.prototype.onDestroy=function(){d.EventManager.instance.off(P.STJDataEvent.CHECK_GAME_END,this.checkGameEnd,this)},e.prototype.start=function(){P.sTJDataProxy.effectLayer=this.node.parent.getChildByName("EffectLayer"),P.sTJDataProxy.bulletLayer=this.node.parent.getChildByName("BulletLayer"),P.sTJDataProxy.gridLayer=cc.find("Canvas/mapView/GridLayer"),P.sTJDataProxy.battleView=this.node,this.initGrid(),this.initTouchEvents(),this.scheduleOnce(function(){P.sTJDataProxy.gameState=_.GameState.PLAYING},1)},e.prototype.onEnable=function(){this.node.targetOff(this)},e.prototype.initTouchEvents=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),d.EventManager.instance.on(P.STJDataEvent.CHECK_GAME_END,this.checkGameEnd,this)},e.prototype.onTouchStart=function(){},e.prototype.onTouchMove=function(t){var e=this.node.convertToNodeSpaceAR(t.getLocation()),a=this.getExactGridByPosition(e.x,e.y);if(a&&a.node&&P.sTJDataProxy.isJarIntact(a.id)){if(this.selectNode&&this.selectNode.uuid==a.node.uuid)return;this.addTouchFeedback(a.node)}else this.selectNode&&this.removeTouchFeedback(this.selectNode)},e.prototype.onTouchEnd=function(t){var e=this.node.convertToNodeSpaceAR(t.getLocation()),a=this.getExactGridByPosition(e.x,e.y);a&&a.node&&P.sTJDataProxy.isJarIntact(a.id)&&this.smashJar(a),this.selectNode&&(this.removeTouchFeedback(this.selectNode),this.selectNode=null)},e.prototype.addTouchFeedback=function(t){t&&t.isValid&&(this.selectNode&&this.removeTouchFeedback(this.selectNode),this.selectNode=t,t.getChildByName("liangguanzi").active=!0,t.getChildByName("guanzi").active=!1)},e.prototype.removeTouchFeedback=function(t){t&&t.isValid&&(t.getChildByName("liangguanzi").active=!1,t.getChildByName("guanzi").active=!0)},e.prototype.smashJar=function(t,e){void 0===e&&(e=!0),P.sTJDataProxy.isJarIntact(t.id)&&(e?this.createCuiziEffect(t):(this.createCuiziRole(t),this.createSuipian(t),t.node&&(t.node.destroy(),t.node=null)),P.sTJDataProxy.jarStates.set(t.id,"broken"),this.playSmashAnimation(t))},e.prototype.createSuipian=function(t){var e=cc.instantiate(this.suipianNode);e.parent=P.sTJDataProxy.gridLayer,e.setPosition(cc.v3(t.x,t.y-33,0)),e.active=!0,e.getComponent(sp.Skeleton).setCompleteListener(function(){e.destroy(),e.removeFromParent()}),e.getComponent(sp.Skeleton).setAnimation(0,"broken",!1)},e.prototype.playSmashAnimation=function(t){var e=t.node;if(e){var a=cc.sequence(cc.moveBy(.05,cc.v2(5,0)),cc.moveBy(.05,cc.v2(-10,0)),cc.moveBy(.05,cc.v2(5,0)));e.runAction(a)}},e.prototype.createCuiziEffect=function(t){var e=this;if(this.cuizi){var a=cc.instantiate(this.cuizi);a.parent=P.sTJDataProxy.effectLayer,a.active=!0,a.setPosition(t.x+50,t.y+50);var i=a.getComponent(cc.Animation);i?(h.AudioManager.instance.playEffectPath("sounds/Waving",y.Bundles.SmashTheJar),i.on("finished",function(){e.createSuipian(t),h.AudioManager.instance.playEffectPath("sounds/Knock",y.Bundles.SmashTheJar),e.createCuiziRole(t),a.destroy(),t.node.destroy(),t.node=null},this),i.play()):a.destroy()}},e.prototype.createCuiziRole=function(t){var e=this;if(t.node&&t.node.isValid){var a=t.node.getComponent(S.default).radomId,i=g.DataManager.instance.eData.data_jarmonster[a];if(1==i.type){if(!i)return void console.warn("\u65e0\u6548\u7684\u602a\u7269ID: "+a);var o=cc.instantiate(this.cardItem);if(!o)return void console.error("\u521b\u5efa\u5361\u7247\u5b9e\u4f8b\u5931\u8d25");o.parent=this.node,o.setPosition(t.x,t.y);var n=o.getComponent(D.default);n?n.init(a):console.error("STCardItem\u7ec4\u4ef6\u672a\u627e\u5230"),o.scale=0,cc.tween(o).to(.3,{scale:1},{easing:"backOut"}).start(),this.checkGameEnd()}else if(i.id>2003){var r=g.DataManager.instance.eData.datamonster[i.res];m.ResUtil.loadAsset({bundleName:y.Bundles.SmashTheJar,path:"prefabs/"+r.modeName,type:cc.Prefab}).then(function(a){var o=cc.instantiate(a);o.parent=e.node,o.setPosition(t.x,t.y-50),o.getComponent(C.default).initEnemy(i,t.col,function(){e.checkJarComplete(i,t),o.scale=0,cc.tween(o).to(.2,{scale:1},{easing:"backOut"}).start()}),P.sTJDataProxy.enemySoldiers.push(o,t)})}else{var s=cc.instantiate(this.monsterFab);s.parent=this.node,s.setPosition(t.x,t.y),s.getComponent(C.default).initEnemy(i,t.col,function(){e.checkJarComplete(i,t),s.scale=0,cc.tween(s).to(.2,{scale:1},{easing:"backOut"}).start()}),P.sTJDataProxy.enemySoldiers.push(s,t)}}},e.prototype.checkJarComplete=function(t,e){if(2004==t.id)e&&(p.gameUIMgr.showTips(t.des),h.AudioManager.instance.playEffectPath("sounds/skills",y.Bundles.SmashTheJar),this.smashJarsInArea(e.row,e.col,1));else if(2007==t.id){p.gameUIMgr.showTips(t.des),h.AudioManager.instance.playEffectPath("sounds/skills",y.Bundles.SmashTheJar);var a=t.parm.split("|");P.sTJDataProxy.speedAtkBuff=1+Number(a[0]),clearTimeout(this.timerId),this.timerId=setTimeout(function(){P.sTJDataProxy.speedAtkBuff=1},1e3*Number(a[1]))}},e.prototype.resetAllJars=function(){P.sTJDataProxy.jarStates.clear()},e.prototype.getIntactJarCount=function(){var t=0;return this.grids.forEach(function(e){P.sTJDataProxy.isJarIntact(e.id)&&t++}),t},e.prototype.smashJarsInArea=function(t,e,a){var i=this;void 0===a&&(a=1);for(var o=[],n=t-a;n<=t+a;n++)for(var r=e-a;r<=e+a;r++){var s=this.getGridByRowCol(n,r);s&&P.sTJDataProxy.isJarIntact(s.id)&&o.push(s)}o.forEach(function(t,e){t.node&&t.node.getComponent(S.default).playLight(),i.scheduleOnce(function(){i.smashJar(t,!1)},1+.2*e)})},e.prototype.getRandomIdByProbability=function(t,e){var a,i,o=[],n={},r=t.split("|").map(function(t){var e=t.split("_");return{id:e[0],maxCount:parseInt(e[1]),probability:parseInt(e[2])}});r.forEach(function(t){n[t.id]=0});for(var s=0,c=100*e;o.length<e&&s<c;){s++;var l=r.filter(function(t){return n[t.id]<t.maxCount});if(0===l.length){console.warn("\u6240\u6709\u7269\u54c1\u90fd\u5df2\u8fbe\u5230\u6700\u5927\u6570\u91cf\u9650\u5236");break}var u=l.reduce(function(t,e){return t+e.probability},0);if(0===u){console.warn("\u53ef\u7528\u7269\u54c1\u603b\u6982\u7387\u4e3a0");break}var p=Math.random()*u,h=0;try{for(var d=(a=void 0,__values(l)),m=d.next();!m.done;m=d.next()){var f=m.value;if(p<=(h+=f.probability)){n[f.id]++,o.push(f.id);break}}}catch(P){a={error:P}}finally{try{m&&!m.done&&(i=d.return)&&i.call(d)}finally{if(a)throw a.error}}}return s>=c&&console.warn("\u8fbe\u5230\u6700\u5927\u5c1d\u8bd5\u6b21\u6570\uff0c\u53ef\u80fd\u5b58\u5728\u914d\u7f6e\u95ee\u9898"),o},e.prototype.initGrid=function(){var t=g.DataManager.instance.eData.data_jarstage[P.sTJDataProxy.selectStageId];if(P.sTJDataProxy.stagetAddBuff=t.hp,P.sTJDataProxy.STJData.stageLoseNum[P.sTJDataProxy.selectStageId]){var e=t.num.split("|");P.sTJDataProxy.stagetJianBuff=Number(e[0])*P.sTJDataProxy.STJData.stageLoseNum[P.sTJDataProxy.selectStageId],P.sTJDataProxy.stagetJianBuff>Number(e[1])&&(P.sTJDataProxy.stagetJianBuff=Number(e[1]))}else P.sTJDataProxy.stagetJianBuff=0;var a=-(this.cols-1)*this.gridWidth/2,i=(this.rows-1)*this.gridHeight/2-160;this.grids=[];for(var o=this.getRandomIdByProbability(t.jar,35),n=0,r=0;r<this.rows;r++)for(var s=0;s<this.cols;s++){var c=a+s*this.gridWidth,l=i-r*this.gridHeight,u={id:r*this.cols+s,row:r,col:s,x:c,y:l,node:null};if(this.grids.push(u),this.jarNode&&r<7){var p=cc.instantiate(this.jarNode);p.parent=this.node,p.setPosition(c,l),p.getComponent(S.default).init(o[n]),u.node=p,p.active=!0,p.zIndex=-p.y,n++}else P.sTJDataProxy.jarStates.set(u.id,"broken")}},e.prototype.creatorMosnterNode=function(t,e){if(!(e>2003||this.creatorMonster[e])){var a=g.DataManager.instance.eData.data_jarmonster[e];if(2==a.type){var i=cc.instantiate(this.monsterFab);i.getComponent(C.default).initEnemy(a,t.col,function(){i.destroy()}),this.creatorMonster.push(e)}}},e.prototype.getGridByRowCol=function(t,e){return this.grids.find(function(a){return a.row===t&&a.col===e})},e.prototype.getSurroundingGrids=function(t,e){var a,i,o=[];try{for(var n=r([[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]]),c=n.next();!c.done;c=n.next()){var l=s(c.value,2),u=l[0],p=l[1],h=t+u,d=e+p;if(h>=0&&h<this.rows&&d>=0&&d<this.cols){var m=this.getGridByRowCol(h,d);m&&o.push(m)}}}catch(g){a={error:g}}finally{try{c&&!c.done&&(i=n.return)&&i.call(n)}finally{if(a)throw a.error}}return o},e.prototype.getGridsByColumn=function(t){return t<0||t>=this.cols?(console.warn("\u5217\u7d22\u5f15 "+t+" \u8d85\u51fa\u8303\u56f4 [0, "+(this.cols-1)+"]"),[]):this.grids.filter(function(e){return e.col===t})},e.prototype.getGridsByRow=function(t){return t<0||t>=this.rows?(console.warn("\u884c\u7d22\u5f15 "+t+" \u8d85\u51fa\u8303\u56f4 [0, "+(this.rows-1)+"]"),[]):this.grids.filter(function(e){return e.row===t})},e.prototype.getGridsInRange=function(t,e,a,i){for(var o=[],n=Math.max(0,t);n<=Math.min(this.rows-1,e);n++)for(var r=Math.max(0,a);r<=Math.min(this.cols-1,i);r++){var s=this.getGridByRowCol(n,r);s&&o.push(s)}return o},e.prototype.getExactGridByPosition=function(t,e){var a=this.gridWidth/2,o=this.gridHeight/2;try{for(var n,r=i(this.grids);!(n=r()).done;){var s=n.value,c=Math.abs(s.x-t),l=Math.abs(s.y-e);if(c<=a+10&&l<=o+10)return s}}catch(u){throw console.error("Error in getExactGridByPosition:",u),u}return null},e.prototype.calculateRowColByPosition=function(t,e){var a=-(this.cols-1)*this.gridWidth/2,i=(this.rows-1)*this.gridHeight/2-180,o=Math.round((t-a)/this.gridWidth),n=Math.round((i-e)/this.gridHeight);return n>=0&&n<this.rows&&o>=0&&o<this.cols?{row:n,col:o,valid:!0}:{row:n,col:o,valid:!1}},e.prototype.getGridByPositionCalculated=function(t,e){var a=this.calculateRowColByPosition(t,e);return a.valid?this.getGridByRowCol(a.row,a.col):null},e.prototype.resetJarState=function(t){P.sTJDataProxy.jarStates.set(t.id,"broken")},e.prototype.createDefender=function(t,e){var a=this;m.ResUtil.loadAsset({bundleName:y.Bundles.SmashTheJar,path:"prefabs/roles/Role_"+e.id,type:cc.Prefab}).then(function(i){var o=cc.instantiate(i);o.parent=a.node,o.setPosition(t.x,t.y),P.sTJDataProxy.jarStates.set(t.id,"defender"),o.getComponent(b.default).initRole(e,t),P.sTJDataProxy.soldiers.push(o),o.scale=0,o.zIndex=-o.y,cc.tween(o).to(.3,{scale:1},{easing:"backOut"}).start()})},e.prototype.highlightGrid=function(t,e){var a=new cc.Node("GridHighlight"),i=a.addComponent(cc.Graphics);i.fillColor=e,i.rect(-this.gridWidth/2,-this.gridHeight/2,this.gridWidth,this.gridHeight),i.fill(),a.opacity=100,a.setPosition(t.x,t.y),a.parent=this.node,this.gridHighlights.set(t.id,a)},e.prototype.clearGridHighlight=function(){this.gridHighlights.forEach(function(t){t.destroy()}),this.gridHighlights.clear()},__decorate([A(cc.Node)],e.prototype,"jarNode",void 0),__decorate([A(cc.Prefab)],e.prototype,"monsterFab",void 0),__decorate([A(cc.Node)],e.prototype,"suipianNode",void 0),__decorate([A(cc.Node)],e.prototype,"cuizi",void 0),__decorate([A(cc.Node)],e.prototype,"cardItem",void 0),__decorate([B],e)}(cc.Component);u.default=x,cc._RF.pop(),cc._RF.pop()},{}],STBoss:[function(t,e,a){"use strict";cc._RF.push(e,"e0045y69z5DM59nCQ0Oo4Aq","STBoss");var i=t,o=e,n=a;cc._RF.push(o,"afd995OLZ1B67zqH6F/K/IU","STBoss"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("STMonster"),s=i("STSpAnimCtrl"),c=cc._decorator,l=c.ccclass,u=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAnimCtrl=null,e}return __extends(e,t),e.prototype.playMoveAnim=function(){"zombie_SP2"==this.node.name?this.spAnimCtrl.playAnim("move_shiti",1,!0):this.spAnimCtrl.playAnim("move",1,!0)},e.prototype.playAtkAnim=function(t){this.spAnimCtrl.playAnim("atk",1,!1,function(){t&&t()})},e.prototype.playIdleAnim=function(){"zombie_SP2"==this.node.name?this.spAnimCtrl.playAnim("move_shiti",1,!0):this.spAnimCtrl.playAnim("move",1,!0)},e.prototype.playMoveAnimTS=function(){this.spAnimCtrl.playAnim("move_yinshen",1,!0)},e.prototype.playDeadAnim=function(t){this.spAnimCtrl.playAnim("die",1,!1,function(){t&&t()})},e.prototype.setAnimScaleX=function(t){var e=Math.abs(this.spAnimCtrl.node.scale);this.spAnimCtrl.node.scaleX=t?e:-e},e.prototype.hit=function(){var t=this;this.spAnimCtrl.node.color=cc.Color.RED,this.scheduleOnce(function(){t.spAnimCtrl.node.color=cc.Color.WHITE},.2)},__decorate([u(s.default)],e.prototype,"spAnimCtrl",void 0),__decorate([l],e)}(r.default);n.default=p,cc._RF.pop(),cc._RF.pop()},{}],STBtnCtl:[function(t,e,a){"use strict";cc._RF.push(e,"dcdcdwuMSBAPLFy2GpWgsGj","STBtnCtl");var i=t,o=e,n=a;cc._RF.push(o,"64c628kxYRDNra9BV+aaF+A","STBtnCtl"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("EventManager"),s=i("PopupManager"),c=i("AdsMgr"),l=i("HomeEnum"),u=i("DataManager"),p=i("GuardingDataProxy"),h=i("STJDataProxy"),d=i("UserDataProxy"),m=i("Util"),f=i("GameUIManager"),_=cc._decorator,y=_.ccclass,g=(_.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onEnable=function(){this.updateView(),r.EventManager.instance.on(l.EHomeEvent.CHAPTER_SELECT,this.updateUnlock,this),r.EventManager.instance.on(l.EHomeEvent.UPDATE_MINI_BTN_VIEW,this.updateView,this)},e.prototype.onDisable=function(){r.EventManager.instance.off(l.EHomeEvent.CHAPTER_SELECT,this.updateUnlock,this),r.EventManager.instance.off(l.EHomeEvent.UPDATE_MINI_BTN_VIEW,this.updateView,this)},e.prototype.updateView=function(){u.DataManager.instance.isSubGameOpen(l.ESubGameSwitch.ST)?(this.node.active=!0,this.updateUnlock()):this.node.active=!1},e.prototype.updateUnlock=function(){var t=Number(u.DataManager.instance.eData.datapara[1901].num);this.node.getChildByName("cdTime").active=!1,d.userDataProxy.userData.passChapter>=t?(this.updateTime(),m.default.setSpriteNormalMaterial(this.node.getChildByName("icon_wujing").getComponent(cc.Sprite))):m.default.setSpriteGrayMaterial(this.node.getChildByName("icon_wujing").getComponent(cc.Sprite)),this.node.getChildByName("txt").getComponent(cc.Label).string="\u6572\u7f50\u5b50",this.node.getChildByName("tipLabel").active=d.userDataProxy.userData.passChapter<t,this.node.getChildByName("tipLabel").getComponent(cc.Label).string="\u901a\u8fc7\u7b2c"+t+"\u7ae0\u89e3\u9501"},e.prototype.updateTime=function(){var t=this,e=this.node.getChildByName("cdTime");e.active=!1;var a=p.guardingDataProxy.GuardingData.btnStartTime;if(a>0){var i=6e4*Number(u.DataManager.instance.eData.datapara[1902].num),o=e.getComponent(cc.Label),n=m.default.getTimeLeftTime(a,i);o.string=m.default.formatTimeMS(n,3),this.schedule(function(){(n=m.default.getTimeLeftTime(a,i))<=0&&(t.unscheduleAllCallbacks(),p.guardingDataProxy.GuardingData.btnStartTime=0,t.node.getChildByName("ad").active=!1,e.active=!1),o.string=m.default.formatTimeMS(n,3)},1),e.active=!0}else e.active=!1;this.node.getChildByName("ad").active=a>0},e.prototype.onEnterMiniGame=function(){var t=this,e=Number(u.DataManager.instance.eData.datapara[1901].num);d.userDataProxy.userData.passChapter>=e?p.guardingDataProxy.GuardingData.btnStartTime>0?c.default.showVideoAds({id:1,eventId:"st_game_enter",success:function(){h.sTJDataProxy.STJData.btnStartTime=0,h.sTJDataProxy.saveData(),t.openShootSelectPopup()},fail:function(){},error:function(t){cc.log(t)}},!0):this.openShootSelectPopup():f.gameUIMgr.showTips("\u7b2c"+e+"\u7ae0\u89e3\u9501!")},e.prototype.openShootSelectPopup=function(){s.PopupManager.instance.show({bundleName:l.Bundles.SmashTheJar,path:"prefabs/popups/STSelectPopup"})},__decorate([y],e)}(cc.Component));n.default=g,cc._RF.pop(),cc._RF.pop()},{}],STBulletLight:[function(t,e,a){"use strict";cc._RF.push(e,"d202f85wsFHRosd2dgvwC2p","STBulletLight");var i=t,o=e,n=a;cc._RF.push(o,"a581axToXlI86VFoQN3JFcb","STBulletLight"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("SimplyCircleCollider"),c=i("SimplyCollisionDetector"),l=i("HomeEnum"),u=i("STJDataProxy"),p=i("STMonster"),h=cc._decorator,d=h.ccclass,m=h.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mSpeAni=null,e.mColliderNode=null,e._hurt=null,e}return __extends(e,t),e.prototype.initBulletLight=function(t){this._hurt=t,this.playLight()},e.prototype.playLight=function(){var t=this;return this.scheduleOnce(function(){r.AudioManager.instance.playEffectPath("sounds/huluobo",l.Bundles.SmashTheJar)},.1),this.mSpeAni.once("finished",function(){for(var e=u.sTJDataProxy.enemySoldiers,a=0;a<e.length;++a){var i=e[a];if(i.isValid){var o=i.getChildByName("Collider").getComponent(s.default),n=t.mColliderNode.getComponent(s.default);if(o&&n&&c.default.isCollisionCircleToCircle(o.circle,n.circle)){i.getComponent(p.default).beAttack(t._hurt);break}}}t.node.destroy(),t.node.removeFromParent()},this),this.mSpeAni.play("boom"),!0},__decorate([m(cc.Animation)],e.prototype,"mSpeAni",void 0),__decorate([m(cc.Node)],e.prototype,"mColliderNode",void 0),__decorate([d],e)}(cc.Component);n.default=f,cc._RF.pop(),cc._RF.pop()},{}],STBullet:[function(t,e,a){"use strict";cc._RF.push(e,"ac1c1nLhoBL4Z885+kzkLOx","STBullet");var i=t,o=e,n=a;cc._RF.push(o,"73a2fRjFNNN7Y5kITkOR+nz","STBullet"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("SimplyCircleCollider"),s=i("SimplyCollisionDetector"),c=i("GameEnum"),l=i("STJDataProxy"),u=i("STMonster"),p=cc._decorator,h=p.ccclass,d=p.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mColliderNode=null,e._damage=0,e._speed=1e3,e._direction=null,e._maxY=0,e._isplay=!1,e._roleId=0,e}return __extends(e,t),e.prototype.update=function(t){l.sTJDataProxy.gameState==c.GameState.PLAYING&&this._isplay&&(this.node.y+=this._speed*t*this._direction,this.onMonsterCollider(),Math.abs(this.node.y)>this._maxY&&(this._isplay=!1,this.node.destroy()))},e.prototype.initBullet=function(t,e,a){this._roleId=a,this._damage=t,this._direction=e,this._maxY=cc.winSize.height/2+50,this._isplay=!0},e.prototype.onMonsterCollider=function(){for(var t=l.sTJDataProxy.enemySoldiers,e=0;e<t.length;++e){var a=t[e];if(a.isValid){var i=a.getChildByName("Collider").getComponent(r.default),o=this.mColliderNode.getComponent(r.default);if(i&&o&&s.default.isCollisionCircleToCircle(i.circle,o.circle)){var n={num:this._damage,isCrit:!1};return a.getComponent(u.default).beAttack(n),1003==this._roleId&&a.getComponent(u.default).stopMoveBuff(2,.8),this.node.destroy(),void this.node.removeFromParent()}}}},__decorate([d(cc.Node)],e.prototype,"mColliderNode",void 0),__decorate([h],e)}(cc.Component);n.default=m,cc._RF.pop(),cc._RF.pop()},{}],STCardItem:[function(t,e,a){"use strict";cc._RF.push(e,"71ff2bABdpLLoQvYho2FwWZ","STCardItem");var i=t,o=e,n=a;cc._RF.push(o,"2ab918nqSJErqE1NMb6t/LM","STCardItem"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("ResUtil"),s=i("GameEnum"),c=i("HomeEnum"),l=i("DataManager"),u=i("STJDataProxy"),p=cc._decorator,h=p.ccclass,d=p.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.iconImg=null,e._monsterData=null,e._isDragging=!1,e._dragPreview=null,e._originalPosition=null,e._battleView=null,e._liftTimer=15,e._cardState=3,e}return __extends(e,t),Object.defineProperty(e.prototype,"monsterData",{get:function(){return this._monsterData},enumerable:!1,configurable:!0}),e.prototype.onDisable=function(){this.node.targetOff(this)},e.prototype.update=function(t){u.sTJDataProxy.gameState==s.GameState.PLAYING&&(this._liftTimer-=t,this._liftTimer<=10&&3==this._cardState&&(this._cardState=2,this.playLight()),this._liftTimer<=0&&this._cardState>0&&(this._cardState=0,this.destroyCard(),this._isDragging&&this.cleanupDragState()))},e.prototype.init=function(t){var e=this;this._battleView=u.sTJDataProxy.battleView.getComponent("STBattleView"),this._monsterData=l.DataManager.instance.eData.data_jarmonster[t],r.ResUtil.loadAsset({bundleName:c.Bundles.SmashTheJar,path:"textrues/role/"+this._monsterData.res,type:cc.SpriteFrame}).then(function(t){e.iconImg.spriteFrame=t,e.node.active=!0}),this.addTouchEvents(),this.scheduleOnce(function(){e.createDragPreview()},.1),this._cardState=3,this._liftTimer=15},e.prototype.playLight=function(){cc.tween(this.node).repeatForever(cc.tween().to(.5,{opacity:166}).to(.5,{opacity:255})).start()},e.prototype.addTouchEvents=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},e.prototype.onTouchStart=function(){this._originalPosition=this.node.position.clone(),this._isDragging=!0,this.node.zIndex=1e3,this.node.opacity=180},e.prototype.onTouchMove=function(t){if(t.stopPropagation(),this._isDragging){var e=this.node.parent.convertToNodeSpaceAR(t.getLocation());this.node.setPosition(e),this.updateTargetGridFeedback(e)}},e.prototype.onTouchEnd=function(t){if(t.stopPropagation(),this._isDragging){this._isDragging=!1;var e=this.node.parent.convertToNodeSpaceAR(t.getLocation()),a=this.getValidTargetGrid(e);a?(this.deployDefender(a),this.destroyCard()):this.returnToOriginalPosition(),this.cleanupDragState()}},e.prototype.createDragPreview=function(){var t=this;r.ResUtil.loadAsset({bundleName:c.Bundles.SmashTheJar,path:"prefabs/roles/Role_"+this._monsterData.id,type:cc.Prefab}).then(function(e){t._dragPreview=cc.instantiate(e),t._dragPreview.opacity=100,t._dragPreview.parent=t.node.parent,t._dragPreview.active=!1})},e.prototype.updateTargetGridFeedback=function(t){if(this._battleView){var e=this._battleView.getExactGridByPosition(t.x,t.y);this._battleView.clearGridHighlight(),e&&this.isValidPlacement(e)?this._dragPreview&&(this._dragPreview.setPosition(e.x,e.y),this._dragPreview.active=!0):(this._dragPreview&&(this._dragPreview.active=!1),e&&this._battleView.highlightGrid(e,cc.Color.RED))}},e.prototype.getValidTargetGrid=function(t){if(!this._battleView)return null;var e=this._battleView.getExactGridByPosition(t.x,t.y);return e&&this.isValidPlacement(e)?e:null},e.prototype.isValidPlacement=function(t){return!u.sTJDataProxy.isJarfanzhi(t.id)},e.prototype.deployDefender=function(t){this._battleView&&this._battleView.createDefender(t,this._monsterData)},e.prototype.returnToOriginalPosition=function(){cc.tween(this.node).to(.3,{position:this._originalPosition,opacity:255},{easing:"backOut"}).start()},e.prototype.destroyCard=function(){var t=this;cc.tween(this.node).to(.2,{scale:0,opacity:0}).call(function(){t.node.destroy()}).start()},e.prototype.cleanupDragState=function(){this._isDragging=!1,this.node.zIndex=0,this.node.opacity=255,this._dragPreview&&(this._dragPreview.destroy(),this._dragPreview=null),this._battleView&&this._battleView.clearGridHighlight()},__decorate([d(cc.Sprite)],e.prototype,"iconImg",void 0),__decorate([h],e)}(cc.Component);n.default=m,cc._RF.pop(),cc._RF.pop()},{}],STGameUI:[function(t,e,a){"use strict";cc._RF.push(e,"1aff6V3OO9N6bGP+H6t5TpY","STGameUI");var i=t,o=e,n=a;cc._RF.push(o,"c91d8o5Ek9FB7bF7ybcpfbe","STGameUI"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("EventManager"),c=i("PopupManager"),l=i("HomeEnum"),u=i("DataManager"),p=i("STJDataProxy"),h=i("STTresureItem"),d=i("STBattleView"),m=i("STJarBox"),f=cc._decorator,_=f.ccclass,y=f.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mWoodLab=null,e.tresureLayer=null,e.mFlyItemPb=null,e._maxWood=200,e}return __extends(e,t),e.prototype.start=function(){this.initView(),this.node.getChildByName("zbTips").active=cc.sys.isBrowser&&yzll.gameConfig.isZB,cc.sys.isBrowser&&yzll.gameConfig.gameTestBtn?(this.node.getChildByName("test").active=!0,this.node.getChildByName("test2").active=!0):(this.node.getChildByName("test").active=!1,this.node.getChildByName("test2").active=!1)},e.prototype.onDisable=function(){s.EventManager.instance.off(p.STJDataEvent.WOOD_UPDATE,this.onUpdateWood,this),s.EventManager.instance.off(p.STJDataEvent.WOOD_ADD,this.onFlyItem,this)},e.prototype.initView=function(){s.EventManager.instance.on(p.STJDataEvent.WOOD_UPDATE,this.onUpdateWood,this),s.EventManager.instance.on(p.STJDataEvent.WOOD_ADD,this.onFlyItem,this),this._maxWood=Number(u.DataManager.instance.eData.datapara[1906].num),this.onUpdateItem(0),r.AudioManager.instance.playBgmPath("sounds/bgm_1",l.Bundles.RES,!0)},e.prototype.onUpdateWood=function(){p.sTJDataProxy.curWood>this._maxWood&&(p.sTJDataProxy.curWood=this._maxWood),this.mWoodLab.string=""+Math.floor(p.sTJDataProxy.curWood),this.tresureLayer&&this.tresureLayer.children.forEach(function(t){t.getComponent(h.default)&&t.getComponent(h.default).checkDragCondition()})},e.prototype.onFlyItem=function(t,e){var a=this,i=cc.instantiate(this.mFlyItemPb);p.sTJDataProxy.effectLayer.addChild(i),i.active=!0;var o,n=p.sTJDataProxy.effectLayer.convertToNodeSpaceAR(t);n.y+=50,i.position=n,o=this.mWoodLab.node.parent.position.clone(),i.position=i.position.clone().add(cc.v3(0,-60)),cc.tween(i).by(.1,{position:cc.v3(0,20)}).by(.15,{position:cc.v3(0,-60)}).delay(.25).to(.7,{position:o}).call(function(){a.onUpdateItem(Math.round(e/1)),i.destroy(),i.removeFromParent()}).start()},e.prototype.onUpdateItem=function(t){p.sTJDataProxy.curWood+=t,this.onUpdateWood()},e.prototype.addWood100=function(){p.sTJDataProxy.curWood+=100,this.onUpdateWood()},e.prototype.showTest2=function(){p.sTJDataProxy.battleView.getComponent(d.default).grids.forEach(function(t){p.sTJDataProxy.isJarIntact(t.id)&&t.node&&t.node.getComponent(m.default).showLight()})},e.prototype.openSetUp=function(){c.PopupManager.instance.show({bundleName:l.Bundles.SmashTheJar,path:"prefabs/popups/STSettingPopup",keep:!0})},__decorate([y(cc.Label)],e.prototype,"mWoodLab",void 0),__decorate([y(cc.Node)],e.prototype,"tresureLayer",void 0),__decorate([y(cc.Prefab)],e.prototype,"mFlyItemPb",void 0),__decorate([_],e)}(cc.Component);n.default=g,cc._RF.pop(),cc._RF.pop()},{}],STJDataProxy:[function(t,e,a){"use strict";cc._RF.push(e,"9a430qwUodE1LCRx0jDlCDe","STJDataProxy");var i=t,o=e,n=a;cc._RF.push(o,"ffc98I0Dx5Nb6qRgVT1tijh","STJDataProxy"),Object.defineProperty(n,"__esModule",{value:!0}),n.sTJDataProxy=n.STJDataEvent=n.STJData=void 0;var r=i("ProxyBase"),s=i("GameEnum"),c=i("DataManager"),l=cc._decorator,u=l.ccclass,p=(l.property,function(){this.reliveCnt=1,this.hurtMulti=1,this.btnStartTime=0,this.unlockLevels=[1],this.unlocklookAd={},this.stageLoseNum={}});n.STJData=p,function(t){t.WOOD_UPDATE="WOOD_UPDATE",t.WOOD_ADD="WOOD_ADD",t.Eenter_STJ_GAME="Eenter_STJ_GAME",t.CHECK_GAME_END="CHECK_GAME_END"}(n.STJDataEvent||(n.STJDataEvent={}));var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.gameState=s.GameState.NONE,e.gridLayer=null,e.battleView=null,e.bulletLayer=null,e.effectLayer=null,e.keyboradList=[],e.selectStageId=1,e.soldiers=[],e.enemySoldiers=[],e.curWood=0,e.speedAtkBuff=1,e.stagetAddBuff=1,e.stagetJianBuff=0,e.jarStates=new Map,e}return __extends(e,t),e.prototype.resetData=function(){this.curWood=0,this.soldiers=[],this.enemySoldiers=[],this.jarStates.clear(),this.speedAtkBuff=1},e.prototype.isJarIntact=function(t){return"broken"!==this.jarStates.get(t)&&"defender"!==this.jarStates.get(t)},e.prototype.isJarfanzhi=function(t){return"broken"!==this.jarStates.get(t)},Object.defineProperty(e.prototype,"STJData",{get:function(){return this._data},enumerable:!1,configurable:!0}),e.prototype.saveData=function(){c.DataManager.instance.writeGameDataBase(r.ProxyKey.STJData,this.STJData,null)},__decorate([u],e)}(r.ProxyBase);n.default=h,n.sTJDataProxy=new h(p),cc._RF.pop(),cc._RF.pop()},{}],STJarBox:[function(t,e,a){"use strict";cc._RF.push(e,"bc98bjYOntOc7/Xz14jZZOk","STJarBox");var i=t,o=e,n=a;cc._RF.push(o,"22ed7ivu7dM2IDOZPrOQUhL","STJarBox"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("ResUtil"),s=i("HomeEnum"),c=i("DataManager"),l=cc._decorator,u=l.ccclass,p=(l.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.radomId=0,e}return __extends(e,t),e.prototype.init=function(t){var e=this;this.radomId=t;var a=c.DataManager.instance.eData.data_jarmonster[this.radomId],i=cc.find("show/icon",this.node);r.ResUtil.loadAsset({bundleName:s.Bundles.SmashTheJar,path:"textrues/role/"+a.res,type:cc.SpriteFrame}).then(function(t){e.node&&e.node.isValid&&(i.getComponent(cc.Sprite).spriteFrame=t,e.node.getChildByName("show").active=!1)})},e.prototype.playLight=function(){var t=this.node.getChildByName("liangguanzi");this.schedule(function(){t.active=!t.active},.2)},e.prototype.showLight=function(){var t=this;this.node.getChildByName("show").active=!0,this.node.getChildByName("guanzi").active=!1,this.scheduleOnce(function(){t.node.getChildByName("show").active=!1,t.node.getChildByName("guanzi").active=!0},3)},__decorate([u],e)}(cc.Component));n.default=p,cc._RF.pop(),cc._RF.pop()},{}],STLosePopup:[function(t,e,a){"use strict";cc._RF.push(e,"1d2208znbdC9ZdAFgXcjf4b","STLosePopup");var i=t,o=e,n=a;cc._RF.push(o,"42e876oErxPGppiCGM+S95x","STLosePopup"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("PopupBase"),s=i("SceneManager"),c=i("AdsMgr"),l=i("HomeEnum"),u=i("DataManager"),p=i("UserDataProxy"),h=i("ResUtil"),d=i("AnimationMgr"),m=i("AudioManager"),f=i("STJDataProxy"),_=cc._decorator,y=_.ccclass,g=_.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mTips1=null,e.mTips2=null,e.mItemLayout=null,e._reawards=[],e._isCanClick=!0,e}return __extends(e,t),e.prototype.init=function(e){t.prototype.init.call(this,e);var a=[];m.AudioManager.instance.playEffectPath("sounds/lose","Res");var i=Math.floor(1e3*Math.random())%3+1,o=u.DataManager.instance.eData.datasettlement[1]["des"+i].split("|");this.mTips1.string=o[0],this.mTips2.string=o[1],this._reawards=a;var n=u.DataManager.instance.eData.datapara[1904];if(n)for(var r=n.num.split("|"),s=0;s<r.length;s++){var c=r[s].split("_"),p={};p.id=c[0],p.num=c[1],a.push(p)}a.length;for(var d=function(t){var e=u.DataManager.instance.eData.dataitem[a[t].id],i=f.mItemLayout.children[t];i||((i=cc.instantiate(f.mItemLayout.children[0])).parent=f.mItemLayout),i.active=!0;var o=i.getChildByName("itemBg").getComponent(cc.Sprite);h.ResUtil.loadAsset({path:"textures/public/item_bg"+e.qulity,type:cc.SpriteFrame,bundleName:l.Bundles.GAME}).then(function(t){o.spriteFrame=t}).catch(function(t){console.log("error:",t)});var n=i.getChildByName("itemImg").getComponent(cc.Sprite);h.ResUtil.loadAsset({path:"textures/item/"+e.icon,type:cc.SpriteFrame,bundleName:l.Bundles.GAME}).then(function(t){n.spriteFrame=t}).catch(function(t){console.log("error:",t)}),i.getChildByName("itemNum").getComponent(cc.Label).string="x"+a[t].num},f=this,_=(s=0,a.length);s<_;s++)d(s)},e.prototype.toHome=function(t){var e=this;this._isCanClick=!1;var a=this.node.getChildByName("layout"),i=0;f.sTJDataProxy.STJData.btnStartTime=(new Date).getTime(),f.sTJDataProxy.saveData();for(var o=this._reawards.length,n=o>0?2:0,r=function(n){var r=a.children[n];if(!r.active)return"continue";var s=c._reawards[i];s.num=t?2*s.num:s.num,c.scheduleOnce(function(){s&&(r.active=!1,d.default.instance.showAwardAni(s,e.node,r,0,cc.v3(-250,s.id>6?-850:850)),p.userDataProxy.addProp(s.id,s.num,i+1==o))},.1*i),i++},c=this,l=0;l<a.children.length;++l)r(l);this.scheduleOnce(function(){s.SceneManager.instance.runScene("Home",""),e.removeUI()},.1*i+n)},e.prototype.onClickBtnClose=function(){this._isCanClick&&this.toHome(!1)},e.prototype.onClickBtnDouble=function(){var t=this;this._isCanClick&&c.default.showVideoAds({id:1,eventId:"st_double_reward",success:function(){t.toHome(!0)},fail:function(t){return console.log(t)},error:function(t){return console.log(t)}},!0)},__decorate([g(cc.Label)],e.prototype,"mTips1",void 0),__decorate([g(cc.Label)],e.prototype,"mTips2",void 0),__decorate([g(cc.Node)],e.prototype,"mItemLayout",void 0),__decorate([y],e)}(r.PopupBase);n.default=v,cc._RF.pop(),cc._RF.pop()},{}],STMonster:[function(t,e,a){"use strict";cc._RF.push(e,"4c8adQHJ9xKj7JqVY+jVh2g","STMonster");var i=t,o=e,n=a;cc._RF.push(o,"65de954W/VCRbmON0aGujL+","STMonster"),Object.defineProperty(n,"__esModule",{value:!0});var s=i("GameUIManager"),c=i("AudioManager"),l=i("EventManager"),u=i("CommonUtil"),p=i("ResUtil"),h=i("PopupManager"),d=i("AnimationCfgMgr"),m=i("AnimationCtrl"),f=i("GameEnum"),_=i("HomeEnum"),y=i("DataManager"),g=i("STJDataProxy"),v=i("Util"),P=i("STRoleBase"),b=cc._decorator,D=b.ccclass,S=b.property,C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mColliderNode=null,e.mBody=null,e.mAnimCtrl=null,e.mMonsterId=0,e._isReadyOK=!1,e._moveDir=null,e._moveSpeed=0,e._target=null,e._enemyInfo=null,e._hp=0,e._hpMax=0,e._atkRange=0,e._soliderAtkDis=0,e._atkInterval=0,e._amimState=f.RoleState.Dead,e._atkReady=!0,e._atkInverval=0,e._atkIntervalMulti=0,e._atkAddPercent=0,e._moveSpdAddPercent=0,e._isFrezyReady=!1,e._isBoomReady=!1,e._isAnimReady=!1,e._moveBuff=1,e._col=0,e.mDamageNumberObjects=[],e}return __extends(e,t),Object.defineProperty(e.prototype,"hpMax",{get:function(){return this._hpMax},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"amimState",{get:function(){return this._amimState},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"monsterId",{get:function(){return this.mMonsterId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bodyHeight",{get:function(){return this.mBody.height},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"col",{get:function(){return this._col},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){this._atkIntervalMulti=0,this._isReadyOK=!1},e.prototype.update=function(t){if(g.sTJDataProxy.gameState==f.GameState.PLAYING&&this._enemyInfo&&this._amimState!=f.RoleState.Dead&&this._isReadyOK&&(this._atkInverval>=0&&(this._atkInverval-=t*(1+this._atkIntervalMulti)),this.checkAtk(),this._amimState==f.RoleState.Move&&this.move(t),this._amimState==f.RoleState.Attack)){if(!this._target||!this._target.isValid)return;this._atkReady&&this._atkInverval<=0&&this.attack()}},e.prototype.initEnemy=function(t,e,a){var i=this;if(this._isReadyOK=!1,this._enemyInfo=t,this._col=e,this._atkAddPercent=0,this._moveSpdAddPercent=0,this._atkIntervalMulti=0,this._isAnimReady=!1,this._isFrezyReady=!1,this._isBoomReady=!1,this.mBody.scaleX=-1,this.mBody.scaleY=1,this.mMonsterId=Number(t.res),this.mAnimCtrl)this.mAnimCtrl.loadAtlasAnimation(d.AnimationCfgMgr.instance.getAnimationCfg(y.DataManager.instance.eData.datamonster[t.res])).then(function(){i.playMoveAnim(),i._amimState=f.RoleState.Move,i._isAnimReady=!0,i._atkReady=!0;var e=g.sTJDataProxy.stagetAddBuff-g.sTJDataProxy.stagetJianBuff;i._hpMax=Math.floor(t.hp*e),i._hp=i._hpMax,i._moveSpeed=t.speed,i.node.zIndex=-i.node.y,i._hp=i._hpMax,i._moveSpeed=t.speed,i.node.zIndex=-i.node.y,i._isReadyOK=!0,a&&a(),2006==i._enemyInfo.id&&(c.AudioManager.instance.playEffectPath("sounds/skills",_.Bundles.SmashTheJar),i.triggerShapeShiftSkill())});else{this.playMoveAnim(),this._amimState=f.RoleState.Move,this._isAnimReady=!0,this._atkReady=!0;var o=g.sTJDataProxy.stagetAddBuff-g.sTJDataProxy.stagetJianBuff;this._hpMax=Math.floor(t.hp*o),this._hp=this._hpMax,this._moveSpeed=t.speed,this.node.zIndex=-this.node.y,this._hp=this._hpMax,this._moveSpeed=t.speed,this.node.zIndex=-this.node.y,this._isReadyOK=!0,a&&a(),2006==this._enemyInfo.id&&(c.AudioManager.instance.playEffectPath("sounds/skills",_.Bundles.SmashTheJar),this.triggerShapeShiftSkill())}},e.prototype.stopMoveBuff=function(t,e){var a=this;if(e<this._moveBuff){this._moveBuff=e;var i=null;((i=this.mAnimCtrl?this.mAnimCtrl.node:this.mBody)||i.isValid)&&(i.color=cc.Color.BLUE,this.unscheduleAllCallbacks(),this.scheduleOnce(function(){a._moveBuff=1,(i||i.isValid)&&(i.color=cc.Color.WHITE)},t))}},e.prototype.breath=function(){this._amimState!=f.RoleState.Dead&&(this._amimState=f.RoleState.Breath,this.playMoveAnim())},e.prototype.playBreath=function(){this._amimState!=f.RoleState.Dead&&this._isAnimReady&&this.mAnimCtrl.playAnim("breath",!0)},e.prototype.playMoveAnim=function(){this.mAnimCtrl.playAnim("move",!0,null,null,3)},e.prototype.attack=function(){var t=this;if(this._amimState!=f.RoleState.Dead)return this._atkReady=!1,this.playAttack(function(){t._atkInverval=t._enemyInfo.speed,t._atkReady=!0,t.breath(),t._amimState=f.RoleState.Move},this._target)},e.prototype.playAttack=function(t,e){var a=this;this._amimState!=f.RoleState.Dead&&this._isAnimReady&&this.playAtkAnim(function(){a.shoot(e),t&&t()})},e.prototype.playAtkAnim=function(t){this.scheduleOnce(function(){t&&t()},.5)},e.prototype.hit=function(){cc.Tween.stopAllByTarget(this.mBody),this.mBody.scaleX=-1,this.mBody.scaleY=1;var t=null;((t=this.mAnimCtrl?this.mAnimCtrl.node:this.mBody)||t.isValid)&&(t.color==cc.Color.BLUE&&(t.color=cc.Color.RED,this.scheduleOnce(function(){(t||t.isValid)&&(t.color=cc.Color.WHITE)},.2)),cc.tween(this.mBody).to(.1,{scaleX:-1.2,scaleY:1.2}).to(.2,{scaleX:-1,scaleY:1}).start())},e.prototype.getMoveSpeed=function(){return this._enemyInfo.move*this._moveBuff},e.prototype.move=function(t){if(this._amimState!=f.RoleState.Dead&&this._amimState!=f.RoleState.Attack){this._moveDir||(this._moveDir=cc.v3(0,-1,0));var e=this.getMoveSpeed()*t,a=this.node.position.clone();a.y-=e,this.node.position=a,this.node.zIndex=-this.node.y,this.node.y<-cc.winSize.height/2-50&&(this.recycle(),g.sTJDataProxy.gameState=f.GameState.OVER,h.PopupManager.instance.show({bundleName:_.Bundles.SmashTheJar,path:"prefabs/popups/STLosePopup",keep:!0}))}},e.prototype.checkAtk=function(){for(var t=null,e=0;e<g.sTJDataProxy.soldiers.length;e++){var a=g.sTJDataProxy.soldiers[e];if(a&&a.isValid){var i=a.getComponent(P.default);i&&i.col===this._col&&cc.Vec2.distance(cc.v2(this.node.x,this.node.y),cc.v2(a.x,a.y))<=this._enemyInfo.num&&(t=a)}}t?(this._target=t,this._amimState=f.RoleState.Attack):(this.playMoveAnim(),this._amimState=f.RoleState.Move)},e.prototype.shoot=function(t){this._amimState!=f.RoleState.Dead&&t&&t.isValid&&(c.AudioManager.instance.playEffectPath("sounds/hit2",_.Bundles.SmashTheJar),t.getComponent(P.default).beAttack(this._enemyInfo.atk))},e.prototype.subHp=function(t){isNaN(t)&&(t=1),this._hp-=t,isNaN(this._hp)&&(this._hp=10),this._hp<0&&(this._hp=0)},e.prototype.showHurtLab=function(t,e){var a=this.node.position;a.y+=this.mBody.height,v.default.showHurt(Math.ceil(t),e?v.HurtType.CRIT:v.HurtType.NORMAL,a,this,g.sTJDataProxy.effectLayer)},e.prototype.beAttack=function(t,e,a){return void 0===a&&(a=!0),!this._enemyInfo||this._amimState==f.RoleState.Dead||(t.num=1*t.num,this.subHp(t.num),a&&this.showHurtLab(t.num,t.isCrit),c.AudioManager.instance.playEffectPath("sounds/hit",_.Bundles.RES),this._hp<=0?(this.dealDie(e),!0):(this.hit(),!1))},e.prototype.dealDie=function(t){if(this._amimState==f.RoleState.Dead)return!0;if(this._amimState=f.RoleState.Dead,this.playDie(t),2005==this._enemyInfo.id&&g.sTJDataProxy.soldiers.length>0){s.gameUIMgr.showTips(this._enemyInfo.des),c.AudioManager.instance.playEffectPath("sounds/skills",_.Bundles.SmashTheJar);var e=Math.floor(Math.random()*g.sTJDataProxy.soldiers.length),a=g.sTJDataProxy.soldiers[e];if(a&&a.isValid){var i=a.getComponent(P.default);i&&i.skillKillDie()}}},e.prototype.triggerShapeShiftSkill=function(){var t,e,a,i=this,o=null===(a=g.sTJDataProxy.battleView)||void 0===a?void 0:a.getComponent("STBattleView");if(o){var n=o.getGridsByRow(7);if(0!==n.length){var s=this.node.position,l=null,h=1/0;try{for(var d=r(n),m=d.next();!m.done;m=d.next()){var f=m.value,y=Math.abs(f.x-s.x);y<h&&(h=y,l=f)}}catch(v){t={error:v=VM2_INTERNAL_STATE_DO_NOT_USE_OR_PROGRAM_WILL_FAIL.handleException(v)}}finally{try{m&&!m.done&&(e=d.return)&&e.call(d)}finally{if(t)throw t.error}}l?(c.AudioManager.instance.playEffectPath("sounds/bonus",_.Bundles.SmashTheJar),p.ResUtil.loadAsset({bundleName:_.Bundles.SmashTheJar,path:"prefabs/LightEffect",type:cc.Prefab}).then(function(t){var e=cc.instantiate(t);e.parent=i.node,e.setPosition(cc.v3(0,0));var a=e.getComponent(sp.Skeleton);a.setAnimation(0,"start",!1),a.setCompleteListener(null),a.setCompleteListener(function(){e.destroy(),e.removeFromParent()}),cc.tween(i.node).to(.2,{position:cc.v3(l.x,l.y)}).start()}).catch(function(t){u.CommonUtil.print(t)})):console.warn("\u672a\u627e\u5230\u5408\u9002\u7684\u4f20\u9001\u76ee\u6807\u4f4d\u7f6e")}else console.warn("\u7b2c7\u6392\u6ca1\u6709\u53ef\u7528\u683c\u5b50")}else console.warn("\u65e0\u6cd5\u83b7\u53d6\u6218\u573a\u89c6\u56fe\uff0c\u79fb\u5f62\u6362\u5f71\u6280\u80fd\u5931\u8d25")},e.prototype.playMoveAnimTS=function(){},e.prototype.playDeadAnim=function(t){this.mAnimCtrl.playAnim("die",!1,function(){t&&t()},null,5)},e.prototype.playDie=function(t){var e=this;this._isBoomReady?(this.mAnimCtrl.node.active=!1,this.playDeadAnim(function(){e.recycle(t)})):this.recycle(t)},e.prototype.recycle=function(){var t=g.sTJDataProxy.enemySoldiers.indexOf(this.node);-1!=t&&g.sTJDataProxy.enemySoldiers.splice(t,1),this.node.destroy(),this.node.removeFromParent(),l.EventManager.instance.emit(g.STJDataEvent.CHECK_GAME_END)},e.prototype.pushDamageNumberObject=function(t){this.mDamageNumberObjects&&(this.damageNumberObjectActive(),this.mDamageNumberObjects.push(t))},e.prototype.removeDamageNumberObject=function(t){if(this.mDamageNumberObjects)for(var e=0;e<this.mDamageNumberObjects.length;++e)if(this.mDamageNumberObjects[e]==t){this.mDamageNumberObjects.splice(e,1);break}},e.prototype.damageNumberObjectActive=function(){if(this.mDamageNumberObjects)for(var t=0;t<this.mDamageNumberObjects.length;++t){var e=this.mDamageNumberObjects[t],a=cc.moveBy(.1,cc.v2(0,30));e&&e.isValid&&e.node.runAction(a)}},__decorate([S(cc.Node)],e.prototype,"mColliderNode",void 0),__decorate([S(cc.Node)],e.prototype,"mBody",void 0),__decorate([S({type:m.default})],e.prototype,"mAnimCtrl",void 0),__decorate([D],e)}(cc.Component);n.default=C,cc._RF.pop(),cc._RF.pop()},{}],STRole1001:[function(t,e,a){"use strict";cc._RF.push(e,"f45dbxuadZIgaNecxby0OYU","STRole1001");var i=t,o=e,n=a;cc._RF.push(o,"a754e2s9oNLxYkmTqkD7AQK","STRole1001"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("EventManager"),s=i("GameEnum"),c=i("STJDataProxy"),l=i("STRoleBase"),u=cc._decorator,p=u.ccclass,h=(u.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._atkInverval=1,e}return __extends(e,t),e.prototype.update=function(t){var e=this;c.sTJDataProxy.gameState==s.GameState.PLAYING&&this._amimState!=s.RoleState.Dead&&(this._atkInverval>=0&&(this._atkInverval-=t),this._atkInverval<=0&&(this.palyAttackAni(function(){e.addWood()}),this._atkInverval=5*c.sTJDataProxy.speedAtkBuff))},e.prototype.addWood=function(){r.EventManager.instance.emit(c.STJDataEvent.WOOD_ADD,this.node.convertToWorldSpaceAR(cc.v3()),5*this.wood)},__decorate([p],e)}(l.default));n.default=h,cc._RF.pop(),cc._RF.pop()},{}],STRole1004:[function(t,e,a){"use strict";cc._RF.push(e,"2b4edM8j8BBrJXbtgeqz46O","STRole1004");var i=t,o=e,n=a;cc._RF.push(o,"b32380KdY5Nio+zrtKyV+3f","STRole1004"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("ResUtil"),s=i("GameEnum"),c=i("HomeEnum"),l=i("STJDataProxy"),u=i("STBulletLight"),p=i("STMonster"),h=i("STRoleBase"),d=cc._decorator,m=d.ccclass,f=(d.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onLoad=function(){r.ResUtil.loadAsset({bundleName:c.Bundles.SmashTheJar,path:"prefabs/STBuildLight",type:cc.Prefab}).then(function(){})},e.prototype.update=function(t){l.sTJDataProxy.gameState==s.GameState.PLAYING&&this._amimState!=s.RoleState.Dead&&(this._atkInverval>=0&&(this._atkInverval-=t),this._atkInverval<=0&&(this.attack(),this._atkInverval=this.getSpeedAtk()))},e.prototype.attack=function(){var t=this;if(this._amimState!=s.RoleState.Dead){var e=l.sTJDataProxy.enemySoldiers.filter(function(t){return t&&t.isValid&&t.getComponent(p.default).amimState!=s.RoleState.Dead});if(0!=e.length){var a=e[Math.floor(Math.random()*e.length)];r.ResUtil.loadAsset({bundleName:c.Bundles.SmashTheJar,path:"prefabs/STBuildLight",type:cc.Prefab}).then(function(e){a&&a.isValid&&t.palyAttackAni(function(){if(a&&a.isValid){var i=cc.instantiate(e);i.parent=l.sTJDataProxy.effectLayer;var o={num:t.atk,isCrit:!1};i.position=a.position,i.getComponent(u.default).initBulletLight(o),i.active=!0}})})}}},__decorate([m],e)}(h.default));n.default=f,cc._RF.pop(),cc._RF.pop()},{}],STRole1005:[function(t,e,a){"use strict";cc._RF.push(e,"75f51uKVdFN8rxFdFIX6cug","STRole1005");var i=t,o=e,n=a;cc._RF.push(o,"40461H0X6xBr4KVH8SDgmyh","STRole1005"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("STRoleBase"),s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.update=function(){},__decorate([c],e)}(r.default));n.default=l,cc._RF.pop(),cc._RF.pop()},{}],STRoleBase:[function(t,e,a){"use strict";cc._RF.push(e,"ed06bKGR9FNSaxwVPq2ZR4y","STRoleBase");var i=t,o=e,n=a;cc._RF.push(o,"70a16SNbs5IZZH9fNPhin37","STRoleBase"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("ResUtil"),c=i("GameEnum"),l=i("HomeEnum"),u=i("STJDataProxy"),p=i("Util"),h=i("STMonster"),d=i("STBullet"),m=cc._decorator,f=m.ccclass,_=m.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mbody=null,e.mbullet=null,e.mCollider=null,e.maxHp=0,e.hp=0,e.atkSpeed=0,e.atk=0,e.wood=0,e.atkRange=0,e._amimState=c.RoleState.Dead,e._atkInverval=0,e._roleId=0,e.mDamageNumberObjects=[],e}return __extends(e,t),Object.defineProperty(e.prototype,"col",{get:function(){return this._grid.col},enumerable:!1,configurable:!0}),e.prototype.update=function(t){u.sTJDataProxy.gameState==c.GameState.PLAYING&&this._amimState!=c.RoleState.Dead&&(this._atkInverval>=0&&(this._atkInverval-=t),this._atkInverval<=0&&(this.attack(),this._atkInverval=this.getSpeedAtk()))},e.prototype.getSpeedAtk=function(){return this.atkSpeed*u.sTJDataProxy.speedAtkBuff},e.prototype.attack=function(){var t=this;if(this._amimState!=c.RoleState.Dead){for(var e=!1,a=null,i=Number.MAX_VALUE,o=0;o<u.sTJDataProxy.enemySoldiers.length;o++){var n=u.sTJDataProxy.enemySoldiers[o];if(n&&n.isValid&&n.getComponent(h.default).amimState!=c.RoleState.Dead){var s=n.getComponent(h.default);if(s&&s.col===this.col&&n.y>=this.node.y){e=!0;var m=cc.Vec2.distance(cc.v2(this.node.x,this.node.y),cc.v2(n.x,n.y));m<i&&(i=m,a=n)}}}e&&a&&this.palyAttackAni(function(){r.AudioManager.instance.playEffectPath("sounds/launch",l.Bundles.SmashTheJar);var e=cc.instantiate(t.mbullet);u.sTJDataProxy.bulletLayer.addChild(e),e.active=!0,e.position=p.default.nodeParentChangeLocalPos(t.mbullet,u.sTJDataProxy.bulletLayer),e.getComponent(d.default).initBullet(t.atk,1,t._roleId)})}},e.prototype.initRole=function(t,e){this._roleId=t.id,this.maxHp=t.hp,this.hp=t.hp,this.atk=t.atk,this.wood=t.wood,this.atkRange=t.num,this.atkSpeed=t.speed,this._grid=e,this._atkInverval=this.getSpeedAtk(),this._amimState=c.RoleState.Breath},e.prototype.beAttack=function(t){this.mbody&&(this.mbody.color=cc.Color.RED,cc.Tween.stopAllByTarget(this.mbody),cc.tween(this.mbody).to(.2,{color:cc.Color.WHITE}).start()),this.showHurtLab(t,!1),this.hp-=t,this.hp<=0&&this.playDeath()},e.prototype.showHurtLab=function(t,e){var a=this.node.position;a.y+=50,p.default.showHurt(Math.ceil(t),e?p.HurtType.CRIT:p.HurtType.NORMAL,a,this,u.sTJDataProxy.effectLayer)},e.prototype.skillKillDie=function(){var t=this;s.ResUtil.loadAsset({bundleName:l.Bundles.SmashTheJar,path:"prefabs/ZhuaHen",type:cc.Prefab}).then(function(e){var a=cc.instantiate(e);a.parent=u.sTJDataProxy.effectLayer,a.setPosition(t.node.position),a.opacity=0,cc.tween(a).to(.1,{opacity:255}).delay(.2).to(.1,{opacity:0}).call(function(){a.destroy(),a.removeFromParent(),t.playDeath()}).start()})},e.prototype.palyAttackAni=function(t){cc.tween(this.mbody).to(.2,{scaleY:.6}).to(.1,{scale:1}).call(function(){t&&t()}).start()},e.prototype.playDeath=function(){if(this._amimState!=c.RoleState.Dead){this._amimState=c.RoleState.Dead,u.sTJDataProxy.jarStates.set(this._grid.id,"broken");var t=u.sTJDataProxy.soldiers.indexOf(this.node);-1!=t&&u.sTJDataProxy.soldiers.splice(t,1),this.node.destroy(),this.node.removeFromParent()}},e.prototype.pushDamageNumberObject=function(t){this.mDamageNumberObjects&&(this.damageNumberObjectActive(),this.mDamageNumberObjects.push(t))},e.prototype.removeDamageNumberObject=function(t){if(this.mDamageNumberObjects)for(var e=0;e<this.mDamageNumberObjects.length;++e)if(this.mDamageNumberObjects[e]==t){this.mDamageNumberObjects.splice(e,1);break}},e.prototype.damageNumberObjectActive=function(){if(this.mDamageNumberObjects)for(var t=0;t<this.mDamageNumberObjects.length;++t){var e=this.mDamageNumberObjects[t],a=cc.moveBy(.1,cc.v2(0,30));e&&e.isValid&&e.node.runAction(a)}},__decorate([_(cc.Node)],e.prototype,"mbody",void 0),__decorate([_(cc.Node)],e.prototype,"mbullet",void 0),__decorate([_(cc.Node)],e.prototype,"mCollider",void 0),__decorate([f],e)}(cc.Component);n.default=y,cc._RF.pop(),cc._RF.pop()},{}],STSelectItem:[function(t,e,a){"use strict";cc._RF.push(e,"81c5aOnj+ZN+plobsDHdG+Z","STSelectItem");var i=t,o=e,n=a;cc._RF.push(o,"945f0Ra/wRK+69NOk7mT7l4","STSelectItem"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("EventManager"),s=i("AdsMgr"),c=i("STJDataProxy"),l=cc._decorator,u=l.ccclass,p=l.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mName=null,e.level=null,e.startBtn=null,e._itemData=null,e._isCanLocked=!1,e}return __extends(e,t),e.prototype.updateData=function(t){if(this._itemData=t,this.level.string="\u7b2c"+t.id+"\u5173",this._isCanLocked=!1,c.sTJDataProxy.STJData.unlockLevels.indexOf(t.id)<0){this._isCanLocked=!1;var e=c.sTJDataProxy.STJData.unlocklookAd[t.id]||0;this.startBtn.getChildByName("locked").getChildByName("num").getComponent(cc.Label).string=e+"/3"}else this._isCanLocked=!0,this.startBtn.getChildByName("locked").active=!0;this.startBtn.getChildByName("unLocked").active=this._isCanLocked,this.startBtn.getChildByName("locked").active=!this._isCanLocked},e.prototype.onClickStart=function(){var t=this;this._isCanLocked?(c.sTJDataProxy.selectStageId=this._itemData.id,r.EventManager.instance.emit(c.STJDataEvent.Eenter_STJ_GAME)):s.default.showVideoAds({id:1,eventId:"shoot_unlock_game",success:function(){c.sTJDataProxy.STJData.unlocklookAd[t._itemData.id]?c.sTJDataProxy.STJData.unlocklookAd[t._itemData.id]+=1:c.sTJDataProxy.STJData.unlocklookAd[t._itemData.id]=1,c.sTJDataProxy.STJData.unlocklookAd[t._itemData.id]>=3&&(c.sTJDataProxy.STJData.unlockLevels.includes(t._itemData.id)||c.sTJDataProxy.STJData.unlockLevels.push(t._itemData.id)),c.sTJDataProxy.saveData(),t.updateData(t._itemData)},fail:function(){},error:function(t){cc.log(t)}},!0)},__decorate([p(cc.Label)],e.prototype,"mName",void 0),__decorate([p(cc.Label)],e.prototype,"level",void 0),__decorate([p(cc.Node)],e.prototype,"startBtn",void 0),__decorate([u],e)}(cc.Component);n.default=h,cc._RF.pop(),cc._RF.pop()},{}],STSelectPopup:[function(t,e,a){"use strict";cc._RF.push(e,"9af98xOmFtEo7wpDTul+FZW","STSelectPopup");var i=t,o=e,n=a;cc._RF.push(o,"9ce33XbL7tNDYRWmb+9Fppy","STSelectPopup"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("List"),s=i("EventManager"),c=i("PopupBase"),l=i("PopupManager"),u=i("SceneManager"),p=i("HomeEnum"),h=i("DataManager"),d=i("STJDataProxy"),m=i("STSelectItem"),f=cc._decorator,_=f.ccclass,y=f.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.list=null,e._itemList=[],e}return __extends(e,t),e.prototype.init=function(){},e.prototype.onEnable=function(){s.EventManager.instance.on(d.STJDataEvent.Eenter_STJ_GAME,this.onEnterGame,this)},e.prototype.onDisable=function(){s.EventManager.instance.off(d.STJDataEvent.Eenter_STJ_GAME,this.onEnterGame,this)},e.prototype.onEnterGame=function(){this.removeUI(),l.PopupManager.instance.removeAll(),setTimeout(function(){u.SceneManager.instance.runScene("SmashTheJar",p.Bundles.SmashTheJar)},200)},e.prototype.onShow=function(){this._itemList=Object.values(h.DataManager.instance.eData.data_jarstage),this.list.numItems=this._itemList.length},e.prototype.onListRender=function(t,e){var a=this._itemList[e];t.getComponent(m.default).updateData(a)},__decorate([y(r.default)],e.prototype,"list",void 0),__decorate([_],e)}(c.PopupBase);n.default=g,cc._RF.pop(),cc._RF.pop()},{}],STSettingPopup:[function(t,e,a){"use strict";cc._RF.push(e,"78155pmCM1IEpPlAvTxWbuZ","STSettingPopup");var i=t,o=e,n=a;cc._RF.push(o,"102314W5AtEyYJyBDO4lUV5","STSettingPopup"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("EventManager"),c=i("AppProxy"),l=i("PopupBase"),u=i("SceneManager"),p=i("GameEnum"),h=i("STJDataProxy"),d=i("UserSetDataProxy"),m=cc._decorator,f=m.ccclass,_=m.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nShake=null,e.musicVolumeSlider=null,e.musicVolumePro=null,e.effectVolumeSlider=null,e.effectVolumePro=null,e.mMusicVolumeLab=null,e.mEffectVolumeLab=null,e.mShakeLab=null,e}return __extends(e,t),e.prototype.init=function(){h.sTJDataProxy.gameState==p.GameState.PLAYING&&(h.sTJDataProxy.gameState=p.GameState.PAUSE),s.EventManager.instance.on(r.EAudioEvent.BACKGROUND_AUDIO_SWITCH_CHANGE,this.updateView,this),s.EventManager.instance.on(r.EAudioEvent.EFFECT_AUDIO_SWITCH_CHANGE,this.updateView,this),this.updateView()},e.prototype.onDisable=function(){s.EventManager.instance.off(r.EAudioEvent.BACKGROUND_AUDIO_SWITCH_CHANGE,this.updateView,this),s.EventManager.instance.off(r.EAudioEvent.EFFECT_AUDIO_SWITCH_CHANGE,this.updateView,this),t.prototype.onDisable.call(this),d.userSetDataProxy.saveData()},e.prototype.updateView=function(){this.musicVolumeSlider.progress=d.userSetDataProxy.setData.musicVolume,this.musicVolumePro.fillRange=d.userSetDataProxy.setData.musicVolume,this.effectVolumeSlider.progress=d.userSetDataProxy.setData.effectVolume,this.effectVolumePro.fillRange=d.userSetDataProxy.setData.effectVolume;var t=d.userSetDataProxy.setData.isOpenShake;this.nShake.getChildByName("Close").active=!t,this.nShake.getChildByName("Open").active=t,this.mShakeLab.string=t?"\u5f00":"\u5173",this.mMusicVolumeLab.string=(100*d.userSetDataProxy.setData.musicVolume).toFixed(0),this.mEffectVolumeLab.string=(100*d.userSetDataProxy.setData.effectVolume).toFixed(0)},e.prototype.onClickBtnEffectAudio=function(){},e.prototype.onClickBtnMusicAudio=function(){},e.prototype.onMusicVolumeSlider=function(t){this.musicVolumeSlider.progress=t.progress,this.musicVolumePro.fillRange=t.progress,r.AudioManager.instance.setBgmVolume(t.progress),d.userSetDataProxy.setData.musicVolume=t.progress,this.mMusicVolumeLab.string=(100*d.userSetDataProxy.setData.musicVolume).toFixed(0)},e.prototype.onEffectVolumeSlider=function(t){this.effectVolumeSlider.progress=t.progress,this.effectVolumePro.fillRange=t.progress,r.AudioManager.instance.setEffectVolume(t.progress),d.userSetDataProxy.setData.effectVolume=t.progress,this.mEffectVolumeLab.string=(100*d.userSetDataProxy.setData.effectVolume).toFixed(0)},e.prototype.onClickBtnShake=function(){d.userSetDataProxy.setVibrate(!d.userSetDataProxy.setData.isOpenShake),this.updateView()},e.prototype.onClickBtnBack=function(){h.sTJDataProxy.STJData.btnStartTime=(new Date).getTime(),h.sTJDataProxy.saveData(),this.removeUI(),u.SceneManager.instance.runScene("Home","",function(){s.EventManager.instance.emit(c.AppEvent.ENTER_GAME)})},e.prototype.onClickBtnClose=function(){h.sTJDataProxy.gameState==p.GameState.PAUSE&&(h.sTJDataProxy.gameState=p.GameState.PLAYING),this.removeUI()},__decorate([_(cc.Node)],e.prototype,"nShake",void 0),__decorate([_(cc.Slider)],e.prototype,"musicVolumeSlider",void 0),__decorate([_(cc.Sprite)],e.prototype,"musicVolumePro",void 0),__decorate([_(cc.Slider)],e.prototype,"effectVolumeSlider",void 0),__decorate([_(cc.Sprite)],e.prototype,"effectVolumePro",void 0),__decorate([_(cc.Label)],e.prototype,"mMusicVolumeLab",void 0),__decorate([_(cc.Label)],e.prototype,"mEffectVolumeLab",void 0),__decorate([_(cc.Label)],e.prototype,"mShakeLab",void 0),__decorate([f],e)}(l.PopupBase);n.default=y,cc._RF.pop(),cc._RF.pop()},{}],STSpAnimCtrl:[function(t,e,a){"use strict";cc._RF.push(e,"021a6gotOFD47f6c9f0fao9","STSpAnimCtrl");var i=e,o=a;cc._RF.push(i,"a7b4cBW1SNJXaGFrX1Ex8d2","STSpAnimCtrl"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,r=n.ccclass,s=n.property;n.menu,sp.SkeletonData.prototype.isTexturesLoaded=function(){for(var t=this.textures,e=t?t.length:0,a=0;a<e;a++)if(!t[a].loaded)return!1;return!0};var c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAnim=null,e.animFrameEventListener=new Map,e.animCompleteListener=new Map,e.onceOnComplete=null,e._onPlayAnimFunc=null,e._timeScale=1,e}return __extends(e,t),e.prototype.onLoad=function(){if(this.spAnim.setEventListener(this.onFrameEvent.bind(this)),this.spAnim.setCompleteListener(this.onCompleteEvent.bind(this)),this.spAnim.skeletonData){var t=this.spAnim.skeletonData.skeletonJson.animations;for(var e in t)for(var a in t)e!=a&&this.spAnim.setMix(e,a,.2)}},e.prototype.onDestroy=function(){this.animFrameEventListener.clear(),this.animCompleteListener.clear(),this.spAnim.setEventListener(null),this.spAnim.setCompleteListener(null)},e.prototype.init=function(t){if(void 0===t&&(t=null),this._timeScale=1,this.spAnim.enabled=!0,this.spAnim.node.opacity=255,t&&t.onPlayAnimFunc&&(this._onPlayAnimFunc=t.onPlayAnimFunc),null==t||!t.skeletonData||this.spAnim.skeletonData&&this.spAnim.skeletonData.name==t.skeletonData.name)return this.clearTracks(),this.spAnim.setToSetupPose(),this.animCompleteListener.clear(),void this.animFrameEventListener.clear();this.spAnim.skeletonData=t.skeletonData;var e=this.spAnim.skeletonData.skeletonJson.animations;for(var a in e)for(var i in e)a!=i&&this.spAnim.setMix(a,i,.2);this.clearTracks(),this.spAnim.setToSetupPose(),this.animCompleteListener.clear(),this.animFrameEventListener.clear()},e.prototype.playAnimWithFrame=function(t,e,a,i,o){if(void 0===e&&(e=!1),void 0===a&&(a=0),void 0===i&&(i=Number.MAX_SAFE_INTEGER),void 0===o&&(o=1),!this.spAnim)return null;if(this.node.active){var n=this.spAnim.findAnimation(t);if(n){var r=n.duration,s=Math.ceil(60*r);i=Math.min(i,s);var c=Math.max(0,a/60),l=Math.min(i/60,1),u=this.spAnim.setAnimation(0,t,e);return this.spAnim.timeScale=0,u.animationStart=c,u.animationEnd=l,this.spAnim.timeScale=o,this._timeScale=this.spAnim.timeScale,u}}},e.prototype.playAnim=function(t,e,a,i){if(void 0===e&&(e=1),void 0===a&&(a=!1),!this.spAnim)return null;if(this.node.active){if(t||(t=this.spAnim.defaultAnimation),!this.spAnim.isAnimationCached()){var o=this.spAnim.getCurrent(0);if(o&&o.animation.name==t)return null;this.spAnim.clearTrack(0)}return this.spAnim.setToSetupPose(),this.spAnim.timeScale=e,this._timeScale=this.spAnim.timeScale,this.onceOnComplete=i,this._onPlayAnimFunc&&this._onPlayAnimFunc(t,e,a),this.spAnim.setAnimation(0,t,a)}},e.prototype.playAnimFixSpeed=function(t,e,a,i){if(void 0===e&&(e=1),void 0===a&&(a=!1),!this.spAnim)return null;if(t||(t=this.spAnim.defaultAnimation),!this.spAnim.isAnimationCached()){var o=this.spAnim.getCurrent(0);if(o&&o.animation.name==t)return null;this.spAnim.clearTrack(0)}return this.spAnim.setToSetupPose(),this.spAnim.timeScale=e,this._timeScale=this.spAnim.timeScale,this.onceOnComplete=i,this.spAnim.setAnimation(0,t,a)},e.prototype.setTimeScale=function(t){t*this._timeScale!=this.spAnim.timeScale&&(this.spAnim.timeScale=this._timeScale*t)},e.prototype.getCurAnimTime=function(){if(!this.spAnim.isAnimationCached()){var t=this.spAnim.getCurrent(0);if(t)return t.animationEnd}return 0},e.prototype.registerFrameEvent=function(t,e){this.animFrameEventListener.set(e,t)},e.prototype.unregisterFrameEvent=function(t){this.animFrameEventListener.delete(t)},e.prototype.registerComplete=function(t,e){this.animCompleteListener.set(e,t)},e.prototype.unregisterComplete=function(t){this.animCompleteListener.delete(t)},e.prototype.onFrameEvent=function(t,e){var a=this;this.animFrameEventListener.forEach(function(i,o){i.call(o,t.animation.name,e.data.name,a)})},e.prototype.onCompleteEvent=function(t){this.onceOnComplete&&this.onceOnComplete(t),this.onceOnComplete=null,this.animCompleteListener.forEach(function(e,a){e.call(a,t)})},e.prototype.clearAnim=function(){this.clearTracks()},e.prototype.releaseRes=function(){},e.prototype.generateSomeNodes=function(t,e){var a=this.spAnim.attachUtil.generateAttachedNodes(t)[0];return e?(e instanceof cc.Prefab?a.addChild(cc.instantiate(e)):e.parent?e.parent=a:a.addChild(e),a):a},e.prototype.destroySomeNodes=function(t){this.spAnim.attachUtil.destroyAttachedNodes(t)},e.prototype.clearTracks=function(){this.spAnim.isAnimationCached()||this.spAnim.clearTracks()},e.prototype.clear=function(){this.clearTracks(),this.animCompleteListener.clear(),this.animFrameEventListener.clear()},e.prototype.clearOnceComplete=function(){this.onceOnComplete=null},__decorate([s(sp.Skeleton)],e.prototype,"spAnim",void 0),__decorate([r],e)}(cc.Component);o.default=c,cc._RF.pop(),cc._RF.pop()},{}],STTresureItem:[function(t,e,a){"use strict";cc._RF.push(e,"32900Hcw8VCxYdubd/jiBRE","STTresureItem");var i=t,o=e,n=a;cc._RF.push(o,"ea255xcK7hHiqqONuIZBwpq","STTresureItem"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("GameUIManager"),s=i("AudioManager"),c=i("EventManager"),l=i("ResUtil"),u=i("GameEnum"),p=i("HomeEnum"),h=i("STJDataProxy"),d=i("Util"),m=i("STBattleView"),f=i("STJarBox"),_=i("STMonster"),y=cc._decorator,g=y.ccclass,v=y.property,P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.iconImg=null,e.cdMask=null,e._itemData=null,e._isDragging=!1,e._previewNode=null,e._rangeIndicator=null,e._cdTimer=0,e}return __extends(e,t),e.prototype.init=function(t){var e=this;this._itemData=t,this.label.string=t.wood,this.node.getChildByName("name").getComponent(cc.Label).string=t.name,l.ResUtil.loadAsset({bundleName:p.Bundles.SmashTheJar,path:"textrues/ui/icon_"+t.id,type:cc.SpriteFrame}).then(function(t){e.iconImg.spriteFrame=t}),this.cdMask.active=!1,this.initDragEvents(),this.checkDragCondition()},e.prototype.checkDragCondition=function(){this._itemData&&(this._itemData.wood>h.sTJDataProxy.curWood?this.node.children.forEach(function(t){var e=t.getComponent(cc.Sprite);e&&d.default.setSpriteGrayMaterial(e)}):this.node.children.forEach(function(t){var e=t.getComponent(cc.Sprite);e&&d.default.setSpriteNormalMaterial(e)}))},e.prototype.initDragEvents=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},e.prototype.onTouchStart=function(t){if(t.stopPropagation(),this._cdTimer>0)r.gameUIMgr.showTips("\u51b7\u5374\u4e2d...");else if(this._itemData.wood>h.sTJDataProxy.curWood)r.gameUIMgr.showTips("\u6728\u5934\u4e0d\u591f\uff01");else{this._previewNode=cc.instantiate(this.iconImg.node),this._previewNode.parent=h.sTJDataProxy.effectLayer;var e=h.sTJDataProxy.effectLayer.convertToNodeSpaceAR(t.getLocation());this._previewNode.setPosition(e),this._previewNode.opacity=200,this._isDragging=!0,this.createRangeIndicator(e)}},e.prototype.onTouchMove=function(t){if(t.stopPropagation(),this._isDragging){var e=h.sTJDataProxy.effectLayer.convertToNodeSpaceAR(t.getLocation());this._previewNode.setPosition(e),this.updateRangeIndicator(e)}},e.prototype.onTouchEnd=function(t){if(t.stopPropagation(),this._isDragging){var e=h.sTJDataProxy.effectLayer.convertToNodeSpaceAR(t.getLocation());this.useTreasure(e),this._previewNode.destroy(),this._previewNode=null,this.clearRangeIndicator(),this._isDragging=!1}},e.prototype.update=function(t){h.sTJDataProxy.gameState==u.GameState.PLAYING&&this._cdTimer>0&&(this._cdTimer-=t,this.cdMask.getComponent(cc.Sprite).fillRange=-this._cdTimer/this._itemData.cd,this._cdTimer<1&&(this.unscheduleAllCallbacks(),this._cdTimer=0,this.cdMask.active=!1))},e.prototype.enterSkillCD=function(){this.cdMask.active=!0,this._cdTimer=this._itemData.cd},e.prototype.createRangeIndicator=function(t){this._rangeIndicator&&this._rangeIndicator.destroy(),this._rangeIndicator=new cc.Node("RangeIndicator"),this._rangeIndicator.parent=h.sTJDataProxy.effectLayer;var e=this._rangeIndicator.addComponent(cc.Graphics);switch(e.lineWidth=3,e.strokeColor=cc.Color.GREEN,e.fillColor=new cc.Color(255,255,0,50),this._itemData.id){case 1:this.drawRowRange(e,t);break;case 3:this.drawSingleTargetRange(e);break;case 4:this.drawCircleRange(e,200)}this._rangeIndicator.setPosition(t)},e.prototype.updateRangeIndicator=function(t){if(this._rangeIndicator){var e=this._rangeIndicator.getComponent(cc.Graphics);switch(e.clear(),this._itemData.id){case 1:this.drawRowRange(e,t);break;case 3:this.drawSingleTargetRange(e);break;case 4:this.drawCircleRange(e,200)}this._rangeIndicator.setPosition(t)}},e.prototype.drawRowRange=function(t,e){var a=h.sTJDataProxy.battleView.getComponent(m.default);if(a){var i=this.worldToGrid(e,a);if(!(i.row<0||i.row>=a.rows)){var o=-(a.cols-1)*a.gridWidth/2-a.gridWidth/2,n=(a.cols-1)*a.gridWidth/2+a.gridWidth/2,r=(a.rows-1)*a.gridHeight/2-180-i.row*a.gridHeight,s=o-e.x,c=n-e.x,l=r-e.y;t.rect(s,l-a.gridHeight/2,c-s,a.gridHeight),t.fill(),t.stroke()}}},e.prototype.drawSingleTargetRange=function(t){t.circle(0,0,50),t.fill(),t.stroke()},e.prototype.drawCircleRange=function(t,e){t.circle(0,0,e),t.fill(),t.stroke()},e.prototype.clearRangeIndicator=function(){this._rangeIndicator&&(this._rangeIndicator.destroy(),this._rangeIndicator=null)},e.prototype.useTreasure=function(t){console.log("\u4f7f\u7528\u9053\u5177 "+this._itemData.id+" \u5728\u4f4d\u7f6e:",t);var e=h.sTJDataProxy.battleView.getComponent(m.default);if(e){var a=!1;switch(this._itemData.id){case 1:s.AudioManager.instance.playEffectPath("sounds/mirror",p.Bundles.SmashTheJar),a=this.revealJarsInRow(t,e);break;case 2:s.AudioManager.instance.playEffectPath("sounds/Bell",p.Bundles.SmashTheJar),a=this.freezeAllMonsters(3);break;case 3:s.AudioManager.instance.playEffectPath("sounds/Spell",p.Bundles.SmashTheJar),a=this.freezeSingleMonster(t,e,10);break;case 4:s.AudioManager.instance.playEffectPath("sounds/thorn",p.Bundles.SmashTheJar),a=this.slowMonstersInArea(t,e,200,.5,5)}a&&this.enterSkillCD()}else console.error("\u65e0\u6cd5\u83b7\u53d6\u6218\u6597\u89c6\u56fe\u7ec4\u4ef6")},e.prototype.revealJarsInRow=function(t,e){var a=this,i=this.worldToGrid(t,e);return i.row<0||i.row>6?(r.gameUIMgr.showTips("\u65e0\u6548\u4f4d\u7f6e\uff01"),!1):(h.sTJDataProxy.curWood-=this._itemData.wood,c.EventManager.instance.emit(h.STJDataEvent.WOOD_UPDATE),e.grids.filter(function(t){return t.row===i.row}).forEach(function(t){h.sTJDataProxy.isJarIntact(t.id)&&t.node&&a.addRevealEffect(t.node)}),r.gameUIMgr.showTips("\u900f\u89c6\u6548\u679c\u5df2\u6fc0\u6d3b\uff01"),!0)},e.prototype.freezeAllMonsters=function(t){var e=this;return h.sTJDataProxy.curWood-=this._itemData.wood,c.EventManager.instance.emit(h.STJDataEvent.WOOD_UPDATE),h.sTJDataProxy.enemySoldiers.forEach(function(a){if(a&&a.isValid){var i=a.getComponent(_.default);i&&i.amimState!==u.RoleState.Dead&&e.freezeMonster(i,t)}}),r.gameUIMgr.showTips("\u6240\u6709\u602a\u7269\u88ab\u51b0\u51bb"+t+"\u79d2\uff01"),!0},e.prototype.freezeSingleMonster=function(t,e,a){var i=null,o=100;return h.sTJDataProxy.enemySoldiers.forEach(function(e){if(e&&e.isValid){var a=cc.Vec2.distance(t,new cc.Vec2(e.position.x,e.position.y));a<o&&(o=a,i=e.getComponent("STMonster"))}}),i&&i.amimState!==u.RoleState.Dead?(h.sTJDataProxy.curWood-=this._itemData.wood,c.EventManager.instance.emit(h.STJDataEvent.WOOD_UPDATE),this.freezeMonster(i,a),!0):(r.gameUIMgr.showTips("\u9644\u8fd1\u6ca1\u6709\u53ef\u51b0\u51bb\u7684\u602a\u7269\uff01"),!1)},e.prototype.slowMonstersInArea=function(t,e,a,i,o){var n=this,s=[];return h.sTJDataProxy.enemySoldiers.forEach(function(e){if(e&&e.isValid&&cc.Vec2.distance(t,new cc.Vec2(e.position.x,e.position.y))<=a){var r=e.getComponent(_.default);r&&r.amimState!==u.RoleState.Dead&&(s.push(r),n.slowMonster(r,i,o))}}),s.length>0?(r.gameUIMgr.showTips(s.length+"\u4e2a\u602a\u7269\u88ab\u51cf\u901f\uff01"),h.sTJDataProxy.curWood-=this._itemData.wood,c.EventManager.instance.emit(h.STJDataEvent.WOOD_UPDATE),this.showAreaEffect(t,o),!0):(r.gameUIMgr.showTips("\u8303\u56f4\u5185\u6ca1\u6709\u602a\u7269\uff01"),!1)},e.prototype.showTips=function(){r.gameUIMgr.showTips(this._itemData.des)},e.prototype.freezeMonster=function(t,e){t.stopMoveBuff(e,0)},e.prototype.slowMonster=function(t,e,a){t.stopMoveBuff(a,e)},e.prototype.worldToGrid=function(t,e){var a=-(e.cols-1)*e.gridWidth/2,i=(e.rows-1)*e.gridHeight/2-180,o=Math.round((t.x-a)/e.gridWidth);return{row:Math.round((i-t.y)/e.gridHeight),col:o}},e.prototype.addRevealEffect=function(t){t.getComponent(f.default).showLight()},e.prototype.showAreaEffect=function(t,e){var a=null;l.ResUtil.loadAsset({bundleName:p.Bundles.SmashTheJar,path:"prefabs/STTrap",type:cc.Prefab}).then(function(e){(a=cc.instantiate(e)).parent=h.sTJDataProxy.gridLayer,a.setPosition(t)}),this.scheduleOnce(function(){a&&(a.destroy(),a.removeFromParent())},e)},e.prototype.onDestroy=function(){this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this),this.clearRangeIndicator()},__decorate([v(cc.Label)],e.prototype,"label",void 0),__decorate([v(cc.Sprite)],e.prototype,"iconImg",void 0),__decorate([v(cc.Node)],e.prototype,"cdMask",void 0),__decorate([g],e)}(cc.Component);n.default=P,cc._RF.pop(),cc._RF.pop()},{}],STTresureLayer:[function(t,e,a){"use strict";cc._RF.push(e,"3761aNPES5E/rZj/VuHPYPS","STTresureLayer");var i=t,o=e,n=a;cc._RF.push(o,"5557fJMBGdJxIazGSUw1b6y","STTresureLayer"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("DataManager"),s=i("STTresureItem"),c=cc._decorator,l=c.ccclass,u=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.treasureNode=null,e}return __extends(e,t),e.prototype.start=function(){this.initView()},e.prototype.initView=function(){var t=r.DataManager.instance.eData.data_jartreasure,e=0;for(var a in t){var i=this.node.children[e];i||((i=cc.instantiate(this.treasureNode)).parent=this.node),i.getComponent(s.default).init(t[a]),e++}},__decorate([u(cc.Node)],e.prototype,"treasureNode",void 0),__decorate([l],e)}(cc.Component);n.default=p,cc._RF.pop(),cc._RF.pop()},{}],STWinPopup:[function(t,e,a){"use strict";cc._RF.push(e,"497b0Qtoa1INI8EQEB3b6xW","STWinPopup");var i=t,o=e,n=a;cc._RF.push(o,"1abeb0P7MdMbYYD94mgR9Iv","STWinPopup"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("PopupBase"),c=i("SceneManager"),l=i("AdsMgr"),u=i("HomeEnum"),p=i("DataManager"),h=i("UserDataProxy"),d=i("ResUtil"),m=i("AnimationMgr"),f=i("STJDataProxy"),_=cc._decorator,y=_.ccclass,g=_.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mTips1=null,e.mTips2=null,e.mItemLayout=null,e._reawards=[],e._isCanClick=!0,e}return __extends(e,t),e.prototype.init=function(e){t.prototype.init.call(this,e),f.sTJDataProxy.STJData.stageLoseNum[f.sTJDataProxy.selectStageId]&&(f.sTJDataProxy.STJData.stageLoseNum[f.sTJDataProxy.selectStageId]=0,f.sTJDataProxy.saveData());var a=f.sTJDataProxy.selectStageId+1;f.sTJDataProxy.STJData.unlockLevels.indexOf(a)<0&&(f.sTJDataProxy.STJData.unlockLevels.push(a),f.sTJDataProxy.saveData());var i=[];r.AudioManager.instance.playEffectPath("sounds/win","Res");var o=Math.floor(1e3*Math.random())%3+1,n=p.DataManager.instance.eData.datasettlement[1]["des"+o].split("|");this.mTips1.string=n[0],this.mTips2.string=n[1],this._reawards=i;var s=p.DataManager.instance.eData.datapara[1905];if(s)for(var c=s.num.split("|"),l=0;l<c.length;l++){var h=c[l].split("_"),m={};m.id=h[0],m.num=h[1],i.push(m)}i.length;for(var _=function(t){var e=p.DataManager.instance.eData.dataitem[i[t].id],a=y.mItemLayout.children[t];a||((a=cc.instantiate(y.mItemLayout.children[0])).parent=y.mItemLayout),a.active=!0;var o=a.getChildByName("itemBg").getComponent(cc.Sprite);d.ResUtil.loadAsset({path:"textures/public/item_bg"+e.qulity,type:cc.SpriteFrame,bundleName:u.Bundles.GAME}).then(function(t){o.spriteFrame=t}).catch(function(t){console.log("error:",t)});var n=a.getChildByName("itemImg").getComponent(cc.Sprite);d.ResUtil.loadAsset({path:"textures/item/"+e.icon,type:cc.SpriteFrame,bundleName:u.Bundles.GAME}).then(function(t){n.spriteFrame=t}).catch(function(t){console.log("error:",t)}),a.getChildByName("itemNum").getComponent(cc.Label).string="x"+i[t].num},y=this,g=(l=0,i.length);l<g;l++)_(l)},e.prototype.toHome=function(t){var e=this;this._isCanClick=!1;var a=this.node.getChildByName("layout"),i=0;f.sTJDataProxy.STJData.btnStartTime=(new Date).getTime(),f.sTJDataProxy.saveData();for(var o=this._reawards.length,n=o>0?2:0,r=function(n){var r=a.children[n];if(!r.active)return"continue";var c=s._reawards[i];c.num=t?2*c.num:c.num,s.scheduleOnce(function(){c&&(r.active=!1,m.default.instance.showAwardAni(c,e.node,r,0,cc.v3(-250,c.id>6?-850:850)),h.userDataProxy.addProp(c.id,c.num,i+1==o))},.1*i),i++},s=this,l=0;l<a.children.length;++l)r(l);this.scheduleOnce(function(){c.SceneManager.instance.runScene("Home",""),e.removeUI()},.1*i+n)},e.prototype.onClickBtnClose=function(){this._isCanClick&&this.toHome(!1)},e.prototype.onClickBtnDouble=function(){var t=this;this._isCanClick&&l.default.showVideoAds({id:1,eventId:"st_double_reward",success:function(){t.toHome(!0)},fail:function(t){return console.log(t)},error:function(t){return console.log(t)}},!0)},__decorate([g(cc.Label)],e.prototype,"mTips1",void 0),__decorate([g(cc.Label)],e.prototype,"mTips2",void 0),__decorate([g(cc.Node)],e.prototype,"mItemLayout",void 0),__decorate([y],e)}(s.PopupBase);n.default=v,cc._RF.pop(),cc._RF.pop()},{}],SceneBase:[function(t,e,a){"use strict";cc._RF.push(e,"5377fDvBNpEt4oUIXJQP4st","SceneBase");var i=t,o=e,n=a;cc._RF.push(o,"b4541vHeulJLYOVw9+eQEbp","SceneBase"),Object.defineProperty(n,"__esModule",{value:!0}),n.SceneBase=void 0;var r=i("ComponentBase"),s=i("EventManager"),c=i("SceneManager"),l=i("AppProxy"),u=cc._decorator,p=u.ccclass,h=(u.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bannerPosition=null,e.nativePosition=null,e}return __extends(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this),c.SceneManager.instance.setCurScene(this),s.EventManager.instance.emit(l.AppEvent.SCENE_CHANGED);var e=cc.view.getDesignResolutionSize(),a=this.node.getComponent(cc.Canvas);cc.winSize.width/cc.winSize.height<e.width/e.height?(a.fitWidth=!0,a.fitHeight=!1):(a.fitWidth=!1,a.fitHeight=!0)},e.prototype.switchSceneUI=function(t){void 0===t&&(t=0);for(var e=[],a=1;a<arguments.length;a++)e[a-1]=arguments[a]},__decorate([p],e)}(r.ComponentBase));n.SceneBase=h,cc._RF.pop(),cc._RF.pop()},{}],SceneManager:[function(t,e,a){"use strict";cc._RF.push(e,"4d94cq+EDhETpzoXtrKuBMB","SceneManager");var i=t,o=e,n=a;cc._RF.push(o,"61f3dJrlC1NU6SAdhsHzOvh","SceneManager"),Object.defineProperty(n,"__esModule",{value:!0}),n.SceneManager=void 0;var r=i("YZLLLoading"),s=i("ResUtil"),c=i("StringUtil"),l=function(){function t(){this._scene=null,this._fragment=null,this.loading=null}return Object.defineProperty(t,"instance",{get:function(){return null==this._instance&&(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"curScene",{get:function(){return this._scene},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fragment",{get:function(){return this._fragment},set:function(t){this._fragment=t},enumerable:!1,configurable:!0}),t.prototype.runScene=function(t,e,a){var i=this;this._scene&&(this._scene=null),this.showLoading("\u73a9\u547d\u52a0\u8f7d\u4e2d",255),c.StringUtil.isEmpty(e)?this.goScene(t,a):s.ResUtil.loadBundle({bundleName:e,success:function(){i.goScene(t,a)},fail:function(){i.hideLoading()}})},t.prototype.goScene=function(t,e){var a=this;cc.director.loadScene(t,function(){a.hideLoading(),e&&e()})},t.prototype.setCurScene=function(t){this._scene=t},t.prototype.setLoading=function(t){this.loading=t.getComponent(r.default)},t.prototype.showLoading=function(t,e,a,i){void 0===t&&(t="\u52a0\u8f7d\u4e2d"),void 0===e&&(e=120),void 0===a&&(a=null),void 0===i&&(i=!1),this.loading.show(t,e,a)},t.prototype.hideLoading=function(t,e){void 0===t&&(t=null),void 0===e&&(e=!1),this.loading.hide(t,e)},t._instance=null,t}();n.SceneManager=l,cc._RF.pop(),cc._RF.pop()},{}],ScrollViewEx:[function(t,e,a){"use strict";cc._RF.push(e,"cad67JB57RBs4rPvVGRk9CN","ScrollViewEx");var i=e,o=a;cc._RF.push(i,"81066X++4VIHLSDw8pCkSJB","ScrollViewEx"),Object.defineProperty(o,"__esModule",{value:!0});var n,r=cc._decorator,c=r.ccclass,l=r.property,u=r.menu,p=r.requireComponent,h=r.disallowMultiple;(function(t){t[t.ONE=1]="ONE",t[t.TWO=2]="TWO",t[t.MORE=3]="MORE"})(n||(n={}));var d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.childLayerType=n.ONE,e.childLayerNum=3,e._scrollView=null,e}return __extends(e,t),e.prototype.onLoad=function(){this._scrollView=this.node.getComponent(cc.ScrollView)},e.prototype.onEnable=function(){this.node.on("scrolling",this.onEventUpdateOpacity,this),this._scrollView.content.on(cc.Node.EventType.CHILD_REMOVED,this.onEventUpdateOpacity,this),this._scrollView.content.on(cc.Node.EventType.CHILD_ADDED,this.onEventUpdateOpacity,this),this._scrollView.content.on(cc.Node.EventType.CHILD_REORDER,this.onEventUpdateOpacity,this)},e.prototype.onDisable=function(){this.node.off("scrolling",this.onEventUpdateOpacity,this),this._scrollView.content.off(cc.Node.EventType.CHILD_REMOVED,this.onEventUpdateOpacity,this),this._scrollView.content.off(cc.Node.EventType.CHILD_ADDED,this.onEventUpdateOpacity,this),this._scrollView.content.off(cc.Node.EventType.CHILD_REORDER,this.onEventUpdateOpacity,this)},e.prototype.updateOpacity=function(){var t=this;this._scrollView.getComponentsInChildren(cc.Layout).forEach(function(t){t.updateLayout()});for(var e=this.childLayerType==n.MORE?this.childLayerNum:this.childLayerType,a=[],i=[this._scrollView.content];e>0;)a=[],i.forEach(function(t){a.push.apply(a,s(t.children))}),i=a.slice(),e--;a.forEach(function(e){e.opacity=t.checkCollision(e)?255:0})},e.prototype.onEventUpdateOpacity=function(){this.updateOpacity()},e.prototype.getBoundingBoxToWorld=function(t){var e=t._contentSize.width,a=t._contentSize.height,i=cc.rect(-t._anchorPoint.x*e,-t._anchorPoint.y*a,e,a);return t._calculWorldMatrix(),i.transformMat4(i,t._worldMatrix),i},e.prototype.checkCollision=function(t){var e=this.getBoundingBoxToWorld(this.node.getComponent(cc.ScrollView).content.parent),a=this.getBoundingBoxToWorld(t);return e.intersects(a)},__decorate([l({type:cc.Enum(n)})],e.prototype,"childLayerType",void 0),__decorate([l({type:cc.Integer,visible:function(){return this.childLayerType==n.MORE}})],e.prototype,"childLayerNum",void 0),__decorate([c,h(),p(cc.ScrollView),u("\u81ea\u5b9a\u4e49\u7ec4\u4ef6/ScrollViewEx")],e)}(cc.Component);o.default=d,cc._RF.pop(),cc._RF.pop()},{}],SelectLayout:[function(t,e,a){"use strict";cc._RF.push(e,"55e89bXVHdHR5YhiuwSgIx3","SelectLayout");var i=t,o=e,n=a;cc._RF.push(o,"5cb4cKhTEZCTLfs9pV3QYY5","SelectLayout"),Object.defineProperty(n,"__esModule",{value:!0}),n.EquipEvent=void 0;var r=i("EventManager"),s=i("CommonUtil"),c=i("MathUtil"),l=i("ResUtil"),u=i("GameEnum"),p=i("HomeEnum"),h=i("DataManager"),d=i("BattleDataProxy"),m=i("UserDataProxy"),f=i("EquipmentItem"),_=cc._decorator,y=_.ccclass,g=(_.property,[]);(n.EquipEvent||(n.EquipEvent={})).CHECK_BUFF="CHECK_BUFF";var v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.equipIdList=[],e._canRefresh=!1,e._gridsMap=null,e._greadWeights=[],e._refreshNum=1,e._superRefreshNum=0,e._superNeedRefreshNum=0,e._isRemoveSuperWeight=!1,e}return __extends(e,t),Object.defineProperty(e.prototype,"refreshNum",{set:function(t){this._refreshNum=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"superRefreshNum",{set:function(t){this._superRefreshNum=t,s.CommonUtil.print("\u91cd\u7f6e\u4f4e\u4fdd\u6b21\u6570")},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){this._canRefresh=!0,r.EventManager.instance.on(d.EBattleEvent.GM_ADD_EQUIP,this.gmAddEquip,this),this._greadWeights=[];for(var t=27;t<30;++t)this._greadWeights.push(Number(h.DataManager.instance.eData.datapara[t].num))},e.prototype.onEnable=function(){},e.prototype.onDestroy=function(){r.EventManager.instance.off(d.EBattleEvent.GM_ADD_EQUIP,this.gmAddEquip,this)},e.prototype.initData=function(t){this.equipIdList=[],g=[];var e=m.userDataProxy.userData.combatEqus;console.log("combatEqus:",e);for(var a=0;a<e.length;++a){var i=h.DataManager.instance.eData.dataplant[e[a]];this.equipIdList.push(i.id),g.push(u.EquipmentData[i.prefabKey].name)}this.refreshSeletItems(t,!0)},e.prototype.getGrade=function(t){var e=[];if(t==d.battleDataProxy.battleData.superPlantId){var a=h.DataManager.instance.eData.datasuperplant[d.battleDataProxy.battleData.superPlantId],i=d.battleDataProxy.superPlantNum;if(i>=a.chargeNum)for(var o=i-a.chargeNum,n=1;n<4;++n){var r=a["level"+n].split("|").map(Number)[o];r&&e.push(r)}}var l=[];e.length>=3?(l=e,s.CommonUtil.print("\u54c1\u7ea7\u6743\u91cd\u53d8\u5316:",l)):l=this._greadWeights;var u=c.MathUtil.weightedRandom(l);if(u<0)return console.log("G\u4e86\uff0c\u6743\u91cd\u6709\u95ee\u9898"),1;var p=u+1;return 1==m.userDataProxy.userData.curChapter&&p>2&&(p=2),p},e.prototype.getCanRefreshCombatEqus=function(){var t=m.userDataProxy.userData.combatEqus,e=[],a=0,i=h.DataManager.instance.eData.datasuperplant[d.battleDataProxy.battleData.superPlantId];if(!i)return t;var o=m.userDataProxy.userData.curWave;d.battleDataProxy.isEndless?o=d.battleDataProxy.endlessCurWave:d.battleDataProxy.weatherType!=u.WeatherType.NONE&&(o=m.userDataProxy.userData.curWeatherWave);var n=m.userDataProxy.userData.curChapter;if(1==n)return t.slice();var r=h.DataManager.instance.eData.datastage,c=d.battleDataProxy.getStageRewardCfg(n).monsterList.replace("stage","");for(var l in r){var p=r[l];if(p.wave==o&&p.stage==Number(c)){a=Number(p.refresh);break}}for(var f=d.battleDataProxy.getSuperPlantNum(),_=i.superNum-f,y=0;y<t.length;++y)t[y]==d.battleDataProxy.battleData.superPlantId&&0!=a&&_<=a&&!d.battleDataProxy.isActiveSuperPlant?s.CommonUtil.print("\u8d85\u6b66\u6570\u91cf\u5df2\u8fbe\u4e0a\u9650\uff0c\u4e0d\u518d\u5237\u65b0"):e.push(t[y]);return e},e.prototype.refreshSeletItems=function(t,e,a){if(void 0===e&&(e=!1),void 0===a&&(a=!1),this._canRefresh){for(this._gridsMap=t,this._canRefresh=!1;0<this.node.childrenCount;){var i=this.node.children[0];i.removeFromParent(),i.destroy()}this._isRemoveSuperWeight=!1,this.node.removeAllChildren();var o=[],n=m.userDataProxy.userData.combatEqus.slice(),r=h.DataManager.instance.eData.datasuperplant[d.battleDataProxy.battleData.superPlantId],l=[],p=1;3==n.length&&(p=.71);for(var f=0;f<n.length;++f){var _=h.DataManager.instance.eData.datarefresh[n[f]];if(_){var y=e?_.firstDrawPower:_.drawPower;if(_.id==d.battleDataProxy.battleData.superPlantId){var g=d.battleDataProxy.superPlantNum;if(g>=r.chargeNum){var v=g-r.chargeNum,P=r.refreshWeight.split("|").map(Number)[v];P&&(s.CommonUtil.print("\u5237\u65b0\u6743\u91cd\u8c03\u6574:"+y+"->"+y*P*p),y*=P*p)}}l.push(y)}}var b=m.userDataProxy.userData.curChapter,D=null;if(1==b&&!d.battleDataProxy.isEndless&&d.battleDataProxy.weatherType==u.WeatherType.NONE){var S=m.userDataProxy.userData.curWave,C=h.DataManager.instance.eData.data_specialrefresh;for(var E in C)if(C[E].refresh==this._refreshNum&&C[E].wave==S){D=C[E];break}}var B=8-d.battleDataProxy.superPlantNum;if(D&&B>0){o.length=0,B<3&&(B=3);var A=m.userDataProxy.userData.gameCourseData.curId;if(S=m.userDataProxy.userData.curWave,1==b&&A<11&&3==S){for(f=0;f<B;++f){var x=h.DataManager.instance.eData.dataplant[3],M={itemIdx:u.EquipmentData[x.prefabKey].name,grade:1};o.push(M)}d.battleDataProxy.sunshineNum=0;var N=d.battleDataProxy.sunshineNum;N=10*B,d.battleDataProxy.sunshineNum=N}else{var R=D.num.split("|").map(Number),T=D.level.split("|").map(Number);for(f=0;f<R.length;++f){var I=R[f];x=h.DataManager.instance.eData.dataplant[I],M={itemIdx:u.EquipmentData[x.prefabKey].name,grade:U=T[f],adFlag:!1},o.push(M)}}}else if(e){var w=h.DataManager.instance.eData.datapara[72].num.split("|").map(Number),k=(v=c.MathUtil.weightedRandom(w),h.DataManager.instance.eData.datapara[[69,70,71][v]].num.split("|")),F=m.userDataProxy.userData.combatEqus.slice(),L=F.indexOf(d.battleDataProxy.battleData.superPlantId);for(L>=0&&F.splice(L,1),f=0;f<k.length;++f){var O=1==(X=k[f].split("_").map(Number))[0],U=X[1];x=null,O?x=h.DataManager.instance.eData.dataplant[d.battleDataProxy.battleData.superPlantId]:(I=F[Math.floor(100*Math.random())%F.length],x=h.DataManager.instance.eData.dataplant[I]),M={itemIdx:u.EquipmentData[x.prefabKey].name,grade:U},o.push(M)}}else{if(a){var G=d.battleDataProxy.battleData.superPlantId,V=h.DataManager.instance.eData.datasuperplant[G];if(V){var H=d.battleDataProxy.getSuperPlantNum(),W=V.superNum-H,q=8-V.superNum;if(W<=V.chargeNum+q){this._superRefreshNum++,s.CommonUtil.print("\u8d85\u6b66refreshLevel\u6b21\u6570:",this._superRefreshNum);var z=!1,j=V.refreshLevel2.split("|"),Y=j[j.length-W];if(Y){var J=(X=Y.split("_").map(Number))[0],K=X[1],Z=X[2];if(J<=this._superRefreshNum)if(K>d.battleDataProxy.battleData.sunshineNum){for(this._superRefreshNum=0,f=0;f<Z;++f)s.CommonUtil.print("\u5237\u65b0\u8fbe\u5230\u4e0a\u9650\uff0c\u5f3a\u5236\u8865\u507f\u4e00\u4e2a\u4e8c\u7ea7\u8d85\u6b66"),x=h.DataManager.instance.eData.dataplant[G],o.push({itemIdx:u.EquipmentData[x.prefabKey].name,grade:2,plantId:G});z=!0}else s.CommonUtil.print("\u4e8c\u7ea7\u5237\u65b0\u8fbe\u5230\u8981\u6c42\uff0c\u4f46\u662f\u94b1\u592a\u591a\u4e86")}if(!z){var X,Q=V.refreshLevel1.split("|"),$=Q[Q.length-W];if($&&(J=(X=$.split("_").map(Number))[0],Z=X[1],this.setSuperNeedRefreshNum(J),this._superNeedRefreshNum<=this._superRefreshNum))for(this._superRefreshNum=0,f=0;f<Z;++f)s.CommonUtil.print("\u5237\u65b0\u8fbe\u5230\u4e0a\u9650\uff0c\u5f3a\u5236\u8865\u507f\u4e00\u4e2a\u4e00\u7ea7\u8d85\u6b66"),x=h.DataManager.instance.eData.dataplant[G],o.push({itemIdx:u.EquipmentData[x.prefabKey].name,grade:1,plantId:G})}}}}var tt=this.removeSuperWeight(o,l,n);for(l=tt.refreshPlantWeight,n=tt.combatEqus,f=0;f<3;++f){(v=c.MathUtil.weightedRandom(l))<0&&(v=0),x=h.DataManager.instance.eData.dataplant[n[v]],M={itemIdx:u.EquipmentData[x.prefabKey].name,grade:U=this.getGrade(x.id),plantId:n[v]},o.push(M);var et=this.removeSuperWeight(o,l,n);if(l=et.refreshPlantWeight,n=et.combatEqus,o.length>=3)break}}this.createEquipmentItem(o),this._refreshNum++}},e.prototype.removeSuperWeight=function(t,e,a){if(this._isRemoveSuperWeight||a.length<=1)return{refreshPlantWeight:e,combatEqus:a};var i=a.indexOf(d.battleDataProxy.battleData.superPlantId);return i>=0&&t.findIndex(function(t){return t.plantId==d.battleDataProxy.battleData.superPlantId})>=0&&(s.CommonUtil.print("\u5237\u4e86\u4e00\u4e2a\u8d85\u6b66\u4e86\uff0c\u4e0d\u518d\u5237\u65b0"),e.splice(i,1),a.splice(i,1),this._isRemoveSuperWeight=!0),{refreshPlantWeight:e,combatEqus:a}},e.prototype.setSuperNeedRefreshNum=function(t){if(this._superRefreshNum>1)this._superNeedRefreshNum<=0&&(this._superNeedRefreshNum=3);else{if(t<=3)this._superNeedRefreshNum=t;else{var e=Math.floor(1e3*Math.random())%(t-3+1);this._superNeedRefreshNum=e+3}s.CommonUtil.print("\u968f\u673a\u8d85\u6b66\u9700\u8981\u5237\u65b0\u7684\u6b21\u6570:",this._superNeedRefreshNum)}},e.prototype.orderItems=function(){},e.prototype.confirmItemsPos=function(t,e){if(this.node.children.length<=0)return null;for(var a=[],i=0,o=[],n=0;n<this.node.children.length;++n){var r=this.node.children[n];r!=e&&(o.push(r),i+=r.width)}i+=60*(this.node.children.length-1-(e?1:0));for(var s=0,c=function(e){var n=o[e];s=0==e?-(i/2-n.width/2):s+60+(o[e-1].width/2+n.width/2);var r=null;r=Math.floor(n.height/100)>=2?cc.v3(s,n.height/2):cc.v3(s,n.parent.height/2),a.push(r),n.getComponent(f.default).setOriginPosition(r.clone()),t?cc.tween(n).call(function(){n.getComponent(f.default).bAnim=!0}).to(.1,{position:r.clone()}).call(function(){n.getComponent(f.default).bAnim=!1,n.getComponent(f.default).setPriceLabIsShow(!0)}).start():n.position=r.clone()},l=0;l<o.length;++l)c(l);return a},e.prototype.createEquipmentItem=function(t,e){for(var a=this,i=0,o=t.length,n={},r=function(r){if(!t[r])return"continue";l.ResUtil.loadAsset({path:"prefabItem/"+t[r].itemIdx,type:cc.Prefab,bundleName:p.Bundles.GAME}).then(function(s){if(n[""+r]=s,Object.keys(n).length>=t.length){for(var c in n){var l=Number(c),p=cc.instantiate(n[l]);if(a.node.addChild(p),p.setSiblingIndex(l),p.getComponent(f.default).setIsCollider(!1),p.getComponent(f.default).level=t[l].grade,t[l].hasOwnProperty("adFlag"))p.getComponent(f.default).adFlag=t[l].adFlag;else{var h=t[l].itemIdx;p.getComponent(f.default).adFlag="Item0_4"==h||"Item0_5"==h||"Item0_6"==h||t[l].grade>=3}cc.Tween.stopAllByTarget(p),t[l].anim||cc.tween(p).repeatForever(cc.tween().to(1,{scale:.95}).to(1,{scale:1})).start()}a.confirmItemsPos()}e||(i++,m.userDataProxy.userData.curWave,d.battleDataProxy.isEndless?d.battleDataProxy.endlessCurWave:d.battleDataProxy.weatherType!=u.WeatherType.NONE&&m.userDataProxy.userData.curWeatherWave,i>=o&&(a._canRefresh=!0))}).catch(function(t){console.log("error:",t)})},s=0;s<t.length;++s)r(s)},e.prototype.gmAddEquip=function(t){var e=h.DataManager.instance.eData.dataplant[t.plantId],a={itemIdx:u.EquipmentData[e.prefabKey].name,grade:t.level,adFlag:t.level>2};this.createEquipmentItem([a],!0)},__decorate([y],e)}(cc.Component);n.default=v,cc._RF.pop(),cc._RF.pop()},{}],SelectSkillItem:[function(t,e,a){"use strict";cc._RF.push(e,"161ffOPhflNaa61/mle3TJ6","SelectSkillItem");var i=t,o=e,n=a;cc._RF.push(o,"36a4bCJWehO2ZcNdcYxZs37","SelectSkillItem"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("EventManager"),s=i("ResUtil"),c=i("HomeEnum"),l=i("BattleDataProxy"),u=cc._decorator,p=u.ccclass,h=u.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mRecommend=null,e.mLvBg=null,e.mGradeBg=null,e.mSkillIcon=null,e.mDes=null,e.mSelectEffect=null,e._skillData=null,e._isItemClick=!1,e._isCanClick=!0,e}return __extends(e,t),e.prototype.initSkillItem=function(t){var e=this;this._isItemClick=!1,this._isCanClick=!0,this._skillData=t,this.mRecommend.active=t.quality>=4,s.ResUtil.loadAsset({path:"textures/public/pic_dazhiwukuang_"+t.quality,type:cc.SpriteFrame,bundleName:c.Bundles.GAME}).then(function(t){e.mLvBg.spriteFrame=t}).catch(function(t){console.log("error:",t)}),s.ResUtil.loadAsset({path:"textures/skill/skillkuang_lv"+(t.quality-1),type:cc.SpriteFrame,bundleName:c.Bundles.GAME}).then(function(t){e.mGradeBg.spriteFrame=t}).catch(function(t){console.log("error:",t)}),s.ResUtil.loadAsset({path:"textures/skillIcon/"+t.icon,type:cc.SpriteFrame,bundleName:c.Bundles.GAME}).then(function(t){e.mSkillIcon.spriteFrame=t}).catch(function(t){console.log("error:",t)}),this.mDes.string=this._skillData.des,this.mSelectEffect.setCompleteListener(function(){e._isItemClick&&r.EventManager.instance.emit(l.EBattleEvent.SELECT_SKILL_FINISH,e.node)}),this.mSelectEffect.node.active=!1},e.prototype.playSelectEffect=function(t){this._isCanClick=!1,this._isItemClick=t,this.mSelectEffect.node.active=!0,this.mSelectEffect.setAnimation(0,"animation",!1)},e.prototype.onItemClick=function(){this._isCanClick&&(l.battleDataProxy.selectSkill(this._skillData.id,this.node),l.battleDataProxy.saveData(),this.playSelectEffect(!0))},__decorate([h(cc.Node)],e.prototype,"mRecommend",void 0),__decorate([h(cc.Sprite)],e.prototype,"mLvBg",void 0),__decorate([h(cc.Sprite)],e.prototype,"mGradeBg",void 0),__decorate([h(cc.Sprite)],e.prototype,"mSkillIcon",void 0),__decorate([h(cc.Label)],e.prototype,"mDes",void 0),__decorate([h(sp.Skeleton)],e.prototype,"mSelectEffect",void 0),__decorate([p],e)}(cc.Component);n.default=d,cc._RF.pop(),cc._RF.pop()},{}],SelectSkillPopup:[function(t,e,a){"use strict";cc._RF.push(e,"3b085HN/IlKjpAqKuEXtc1R","SelectSkillPopup");var i=t,o=e,n=a;cc._RF.push(o,"a9db3RCoy9ITbNkWYk4tNFJ","SelectSkillPopup"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("EventManager"),s=i("MathUtil"),c=i("PopupBase"),l=i("AdsMgr"),u=i("GameEnum"),p=i("DataManager"),h=i("BattleDataProxy"),d=i("UserDataProxy"),m=i("Util"),f=i("SelectSkillItem"),_=cc._decorator,y=_.ccclass,g=_.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mSkillLayout=null,e.mBtnRefresh=null,e.mBtnAll=null,e.mGetAllNum=null,e.mRefreshNum=null,e._selectSkillList=[],e._skillLists=[],e._isRefresh=!1,e._isCanClick=!0,e}return __extends(e,t),e.prototype.init=function(){r.EventManager.instance.on(d.EUserDataEvent.UPDATE_VIDEO_CARD,this.updateVideoCardNum,this),r.EventManager.instance.on(h.EBattleEvent.SELECT_SKILL_FINISH,this.selectSkill,this),this.initUI(),this.initSkillUI(),this.updateVideoCardNum()},e.prototype.onDestroy=function(){r.EventManager.instance.off(d.EUserDataEvent.UPDATE_VIDEO_CARD,this.updateVideoCardNum,this),r.EventManager.instance.off(h.EBattleEvent.SELECT_SKILL_FINISH,this.selectSkill,this)},e.prototype.updateVideoCardNum=function(){var t=this.mBtnAll.getChildByName("video");h.battleDataProxy.setVideoCardIcon(t,1);var e=this.mBtnRefresh.getChildByName("video");h.battleDataProxy.setVideoCardIcon(e,2)},e.prototype.initUI=function(){this._isCanClick=!0;var t=Number(p.DataManager.instance.eData.datapara[39].num),e=Number(p.DataManager.instance.eData.datapara[38].num),a=h.battleDataProxy.battleData.refreshNum;this.mRefreshNum.string=t-a+"/"+t,this.mBtnRefresh.getComponent(cc.Button).interactable=a<t;var i=h.battleDataProxy.battleData.getAllNum;if(this.mGetAllNum.string=e-i+"/"+e,this.mBtnAll.getComponent(cc.Button).interactable=i<e,a>=t)for(var o=this.mBtnRefresh.children,n=0;n<o.length;++n)"video"==(r=o[n]).name?m.default.setSpriteGrayMaterial(r.getComponent(cc.Sprite)):r.color=cc.color(75,75,75);if(i>=e)for(o=this.mBtnAll.children,n=0;n<o.length;++n){var r;"video"==(r=o[n]).name?m.default.setSpriteGrayMaterial(r.getComponent(cc.Sprite)):r.color=cc.color(75,75,75)}var s=this.node.getChildByName("residueNum");h.battleDataProxy.isEndless?(s.active=h.battleDataProxy.endlessSelectSkillNum>=0,s.getComponent(cc.Label).string="\u5269\u4f59\u9009\u62e9\u6b21\u6570\uff1a"+(h.battleDataProxy.endlessSelectSkillNum+1)):s.active=!1},e.prototype.initSkillUI=function(){if(this._skillLists=h.battleDataProxy.getSkillList(),this._skillLists&&this._skillLists.length<=0)return console.log("\u6ca1\u6280\u80fd\u4e86"),this.node.destroy(),void this.node.removeFromParent();var t=-1;this._isRefresh&&(this._isRefresh=!0,t=Math.floor(1e3*Math.random())%3),this._selectSkillList=[];for(var e=0;e<this.mSkillLayout.childrenCount;e++){var a=this.mSkillLayout.children[e],i=null;if(e==t)console.log("\u5fc5\u51fa\u6700\u9ad8\u7b49\u7ea7\u7684\u6280\u80fd\u5728\u4f4d\u7f6e:",t),i=this.randMaxLvSkill();else{var o=s.MathUtil.objectWeightedRandom(this._skillLists);i=this._skillLists[o],o>=0&&this._skillLists.splice(o,1)}i?(a.active=!0,a.getComponent(f.default).initSkillItem(i),this._selectSkillList.push(i)):a.active=!1}},e.prototype.randMaxLvSkill=function(){for(var t=2,e=0;e<this._skillLists.length;++e)(i=this._skillLists[e]).quality>t&&(t=i.quality);var a=[];for(e=0;e<this._skillLists.length;++e){var i;(i=this._skillLists[e]).quality==t&&a.push({skill:i,idx:e})}if(a.length<=0)return null;var o=a[Math.floor(1e3*Math.random())%a.length];return this._skillLists.splice(o.idx,1),o.skill},e.prototype.onDisable=function(){h.battleDataProxy.isStartFight?h.battleDataProxy.gameState=u.GameState.PLAYING:h.battleDataProxy.gameState=u.GameState.READY},e.prototype.onBtnGetAll=function(){var t=this;if(this._isCanClick){if(d.userDataProxy.getProp(4)>0)return d.userDataProxy.addProp(4,-1),void this.onGetAll();l.default.showVideoAds({id:1,eventId:"getAll_skill_ad",success:function(){t.onGetAll()},fail:function(){},error:function(t){cc.log(t)}},!0)}},e.prototype.getAllSkill=function(){for(var t=0;t<this._selectSkillList.length;++t){var e=this._selectSkillList[t],a=this.mSkillLayout.children[t];a&&a.isValid&&(a.getComponent(f.default).playSelectEffect(t==this._selectSkillList.length-1),h.battleDataProxy.selectSkill(e.id,a))}this._isCanClick=!1},e.prototype.selectSkill=function(){h.battleDataProxy.isEndless&&h.battleDataProxy.endlessSelectSkillNum>0?(h.battleDataProxy.endlessSelectSkillNum--,this.initUI(),this.initSkillUI(),this.updateVideoCardNum()):(this.removeUI(),h.battleDataProxy.saveData())},e.prototype.onBtnRefresh=function(){var t=this;if(d.userDataProxy.getProp(4)>0)return d.userDataProxy.addProp(4,-1),void this.onRefresh();l.default.showVideoAds({id:1,eventId:"refresh_skill_ad",success:function(){t.onRefresh()},fail:function(){},error:function(t){cc.log(t)}},!0)},e.prototype.onGetAll=function(){var t=h.battleDataProxy.battleData.getAllNum;t++,h.battleDataProxy.battleData.getAllNum=t,this.getAllSkill()},e.prototype.onRefresh=function(){this._isRefresh=!0;var t=h.battleDataProxy.battleData.refreshNum;t++,h.battleDataProxy.battleData.refreshNum=t,this.initUI(),this.initSkillUI()},__decorate([g(cc.Node)],e.prototype,"mSkillLayout",void 0),__decorate([g(cc.Node)],e.prototype,"mBtnRefresh",void 0),__decorate([g(cc.Node)],e.prototype,"mBtnAll",void 0),__decorate([g(cc.Label)],e.prototype,"mGetAllNum",void 0),__decorate([g(cc.Label)],e.prototype,"mRefreshNum",void 0),__decorate([y],e)}(c.PopupBase);n.default=v,cc._RF.pop(),cc._RF.pop()},{}],SelectSuperPlantPopup:[function(t,e,a){"use strict";cc._RF.push(e,"2e71arq3ZhDuo5xcypXQykO","SelectSuperPlantPopup");var i=t,o=e,n=a;cc._RF.push(o,"fb4c7w5j1xMj61LEJWqnjFi","SelectSuperPlantPopup"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("EventManager"),s=i("ResUtil"),c=i("PopupBase"),l=i("HomeEnum"),u=i("DataManager"),p=i("BattleDataProxy"),h=i("Util"),d=cc._decorator,m=d.ccclass,f=d.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mItemLayout=null,e._superPlantIds=[],e._courseItem=null,e}return __extends(e,t),e.prototype.init=function(){var t=p.battleDataProxy.superFrameDatas,e=this.mItemLayout.getChildByName("items1"),a=this.mItemLayout.getChildByName("items2");a.active=t.length>2;for(var i=function(i){var n=t[i],r=null;(r=i>=2?a.children[i-2]:e.children[i]).active=!0;var c=r.getChildByName("plantIcon"),p=r.getChildByName("plantName"),d=u.DataManager.instance.eData.dataplant[n.plantId];p.getComponent(cc.Label).string="\u8d85\u7ea7"+d.name,c.getComponent(cc.Sprite).spriteFrame=n.frame;var m=r.getChildByName("btnSelect");h.default.addButtonListener(m,"SelectSuperPlantPopup","onBtnSelect",o.node,n.plantId);var f=r.getChildByName("normalBg").getChildByName("normalIcon"),_="textures/botanyIcon/pic_plant"+n.plantId;s.ResUtil.loadAsset({path:_,type:cc.SpriteFrame,bundleName:l.Bundles.GAME}).then(function(t){f.getComponent(cc.Sprite).spriteFrame=t}).catch(function(t){console.log("error:",t)})},o=this,n=0;n<t.length;++n)i(n)},e.prototype.onShow=function(){},e.prototype.onBtnSelect=function(t,e){p.battleDataProxy.battleData.superPlantId=e,r.EventManager.instance.emit(p.EBattleEvent.SELECT_SUPER_PLANT),this.removeUI()},__decorate([f(cc.Node)],e.prototype,"mItemLayout",void 0),__decorate([m],e)}(c.PopupBase);n.default=_,cc._RF.pop(),cc._RF.pop()},{}],SensitiveUtils:[function(t,e,a){"use strict";cc._RF.push(e,"b09a9KuxnFOh542xIKrJEFS","SensitiveUtils");var i=t,o=e,n=a;cc._RF.push(o,"905f4fzG11HJrZ3gDG7zyVW","SensitiveUtils"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("CsvHelper"),s=function(){function t(){}return t.loadConfigCsv=function(t){var e=this,a=new r.default;a.loadCsv("csv/KeyWord",function(i){for(var o=0;o<i.length;++o)e.mKeyWordInfo.push(i[o].key);i.length=0,a=null,t&&t()})},t.getKeyWordInfo=function(){return this.mKeyWordInfo},t.getIsSensitive=function(t){for(var e=this.mKeyWordInfo,a=0;a<e.length;++a){var i=e[a];if("test"!=i&&"TEST"!=i&&""!=i&&-1!=t.indexOf(i))return!0}return!1},t.mKeyWordInfo=[],t}();n.default=s,cc._RF.pop(),cc._RF.pop()},{}],SetNikeNamePopup:[function(t,e,a){"use strict";cc._RF.push(e,"04fd7aBXipGJIyXh88/NATJ","SetNikeNamePopup");var i=t,o=e,n=a;cc._RF.push(o,"56ad8pbjXxGi7pSDMOqVdy0","SetNikeNamePopup"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("PopupBase"),s=i("SensitiveUtils"),c=i("GameUIManager"),l=cc._decorator,u=l.ccclass,p=l.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mEditBox=null,e._closeFunc=null,e}return __extends(e,t),e.prototype.init=function(t){this._closeFunc=t.closeFunc},e.prototype.onBtnSet=function(){var t=this.mEditBox.string;s.default.getIsSensitive(t)?c.gameUIMgr.showTips("\u540d\u5b57\u4e0d\u5408\u6cd5"):""!=t?(this._closeFunc(t),this.removeUI()):c.gameUIMgr.showTips("\u8bf7\u8f93\u5165\u6635\u79f0")},__decorate([p(cc.EditBox)],e.prototype,"mEditBox",void 0),__decorate([u],e)}(r.PopupBase);n.default=h,cc._RF.pop(),cc._RF.pop()},{}],ShimmerWhite:[function(t,e,a){"use strict";cc._RF.push(e,"23a0ch/N3hElIZtZVTxSd4o","ShimmerWhite");var i=e,o=a;cc._RF.push(i,"fea28B+xe9DB6i7IlWgQyUE","ShimmerWhite");var n=cc._decorator,r=n.ccclass,s=n.property,c=n.menu,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.duration=0,e.median=0,e.time=0,e.material=null,e.spAnim=null,e}return __extends(e,t),e.prototype.onLoad=function(){this.time=0,this.median=this.duration/2,this.node.getComponent(cc.Sprite)?this.material=this.node.getComponent(cc.Sprite).getMaterial(0):(this.spAnim=this.node.getComponent(sp.Skeleton),this.material=this.spAnim.getMaterial(0)),this.material.setProperty("u_rate",1)},e.prototype.onEnable=function(){this.time=0,this.material.setProperty("u_rate",1)},e.prototype.onDisable=function(){this.time=0,this.material.setProperty("u_rate",1)},e.prototype.show=function(t){void 0===t&&(t=this.duration),this.duration=t,this.time=this.duration,this.material.setProperty("u_rate",1)},e.prototype.showColor=function(t,e){void 0===e&&(e=this.duration),0==this.time&&(this.duration=e,this.time=this.duration,this.material.setProperty("u_rate",1),this.material.setProperty("u_color",cc.color(t)))},e.prototype.update=function(t){if(this.time>0){this.time-=t,this.time<0&&(this.time=0);var e=1-this.time/this.duration;this.material.setProperty("u_rate",e),this.spAnim&&this.spAnim._updateMaterial()}},__decorate([s(cc.Integer)],e.prototype,"duration",void 0),__decorate([r,c("Shader/ShimmerWhite")],e)}(cc.Component);o.default=l,cc._RF.pop(),cc._RF.pop()},{}],ShopItem:[function(t,e,a){"use strict";cc._RF.push(e,"7988f1wr3BEybXTM+8QtqCS","ShopItem");var i=t,o=e,n=a;cc._RF.push(o,"28736pgBDxNZa08ZPJq2xx/","ShopItem"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("EventManager"),c=i("MathUtil"),l=i("ResUtil"),u=i("AdsMgr"),p=i("GameEnum"),h=i("HomeEnum"),d=i("DataManager"),m=i("UserDataProxy"),f=i("GameUIManager"),_=cc._decorator,y=_.ccclass,g=(_.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._itemData=null,e._awardData=null,e._priceTotal=0,e}return __extends(e,t),e.prototype.init=function(t){this._itemData=t;var e=this._itemData.reward.split("_"),a=d.DataManager.instance.eData.dataitem[e[0]];if(this._awardData={},a.type==p.ItemType.BOX){var i=d.DataManager.instance.eData.databox[a.id],o=m.userDataProxy.userData.dailyData[this._itemData.id];if(i.type==p.BoxType.FIXED){var n=i.reward.split("_");o||(o={id:parseInt(n[0],10),num:parseInt(n[1],10),buyNum:0,totalNum:this._itemData.buyNum,freeNum:this._itemData.freeNum},m.userDataProxy.userData.dailyData[this._itemData.id]=o),this._awardData.cfg=d.DataManager.instance.eData.dataitem[n[0]]}else i.type==p.BoxType.RADOM&&(o||(o=this.getRandomItemData(i)),this._awardData.cfg=d.DataManager.instance.eData.dataitem[o.id]);this._awardData.radomData=o}1==this._itemData.showType&&(this._awardData.cfg=a,this.refreshItem(a)),this.refreshItem(this._awardData.cfg)},e.prototype.refreshItem=function(t){if(t){this._itemData.buyNum>1&&0==this._awardData.radomData.freeNum&&(this.node.getChildByName("proLabel").getComponent(cc.Label).string=this._awardData.radomData.buyNum+"/"+this._itemData.buyNum);var e=this.node.getChildByName("qulityBg"),a=this.node.getChildByName("numBox");101!=t.id&&102!=t.id?(l.ResUtil.loadAsset({path:"textures/public/item_bg"+t.qulity,type:cc.SpriteFrame,bundleName:h.Bundles.GAME}).then(function(t){e.getComponent(cc.Sprite).spriteFrame=t}).catch(function(t){console.log("error:",t)}),a.active=!1,this.node.getChildByName("numLabel").getComponent(cc.Label).string="x"+this._awardData.radomData.num):(e.getComponent(cc.Sprite).spriteFrame=null,this.node.getChildByName("numLabel").active=!1,a.getChildByName("numLabel").getComponent(cc.Label).string="x"+this._awardData.radomData.num,a.active=!0,102==t.id&&(a.active=!1));var i=e.getChildByName("icon").getComponent(cc.Sprite);if(i.node.scale=1.2,e.scale=.7,l.ResUtil.loadAsset({path:"textures/item/"+t.icon,type:cc.SpriteFrame,bundleName:h.Bundles.GAME}).then(function(t){i.spriteFrame=t}).catch(function(t){console.log("error:",t)}),this.node.getChildByName("nameLabel").getComponent(cc.Label).string=t.name,this._awardData.radomData.freeNum>0)this.node.getChildByName("mfBtn").active=!0,this.node.getChildByName("videoBtn").active=this.node.getChildByName("buyBtn").active=!1;else{101==t.id&&(this.node.getChildByName("proLabel").getComponent(cc.Label).string=this._itemData.buyNum-this._awardData.radomData.buyNum+"/"+this._itemData.buyNum),this.node.getChildByName("mfBtn").active=!1;var o=this.node.getChildByName("buyBtn");if(this._itemData.buyType==p.BuyType.GEMBUY||this._itemData.buyType==p.BuyType.GLODBUY){var n=o.getChildByName("layer"),r=n.getChildByName("icon").getComponent(cc.Sprite);this._itemData.buyType==p.BuyType.GEMBUY?l.ResUtil.loadAsset({path:"textures/item/icon_2",type:cc.SpriteFrame,bundleName:h.Bundles.GAME}).then(function(t){r.spriteFrame=t}).catch(function(t){console.log("error:",t)}):l.ResUtil.loadAsset({path:"textures/item/icon_1",type:cc.SpriteFrame,bundleName:h.Bundles.GAME}).then(function(t){r.spriteFrame=t}).catch(function(t){console.log("error:",t)}),this._priceTotal=Math.round(this.getItemPrice()*this._awardData.radomData.num),n.getChildByName("label").getComponent(cc.Label).string=c.MathUtil.formatValue(this._priceTotal),this._itemData.buyType==p.BuyType.GLODBUY?m.userDataProxy.userData.gold>=this._priceTotal?n.getChildByName("label").color=cc.Color.WHITE:n.getChildByName("label").color=cc.Color.RED:this._itemData.buyType==p.BuyType.GEMBUY&&(m.userDataProxy.userData.diamond>=this._priceTotal?n.getChildByName("label").color=cc.Color.WHITE:n.getChildByName("label").color=cc.Color.RED)}else o.active=!1;this._awardData.radomData.buyNum<this._awardData.radomData.totalNum?this.changeSpriteGray("2d-sprite"):this.changeSpriteGray("2d-gray-sprite")}}},e.prototype.changeSpriteGray=function(t){this.node.getChildByName("videoBtn").active="2d-sprite"==t&&this._itemData.buyType==p.BuyType.VIDEOBUY,this.node.getChildByName("buyBtn").active="2d-sprite"==t&&this._itemData.buyType!=p.BuyType.VIDEOBUY,this.node.getChildByName("tipsLabel").active=!("2d-sprite"==t),this.node.children.forEach(function(e){var a=e.getComponent(cc.Sprite);a&&a.setMaterial(0,cc.Material.getBuiltinMaterial(t))}),cc.find("qulityBg/icon",this.node).getComponent(cc.Sprite).setMaterial(0,cc.Material.getBuiltinMaterial(t)),this.node.getChildByName("nameLabel").color="2d-sprite"==t?cc.color(255,240,181):cc.color(254,254,254)},e.prototype.getItemPrice=function(){var t=0;return 6==this._awardData.cfg.id?t=this._itemData.buyType==p.BuyType.GLODBUY?Number(d.DataManager.instance.eData.datapara[11].num):Number(d.DataManager.instance.eData.datapara[12].num):this._itemData.buyType==p.BuyType.GLODBUY?9==this._awardData.cfg.id?t=Number(d.DataManager.instance.eData.datapara[218].num):10==this._awardData.cfg.id?t=Number(d.DataManager.instance.eData.datapara[220].num):2==this._awardData.cfg.qulity?t=Number(d.DataManager.instance.eData.datapara[2].num):3==this._awardData.cfg.qulity?t=Number(d.DataManager.instance.eData.datapara[4].num):4==this._awardData.cfg.qulity&&(t=Number(d.DataManager.instance.eData.datapara[7].num)):9==this._awardData.cfg.id?t=Number(d.DataManager.instance.eData.datapara[219].num):10==this._awardData.cfg.id?t=Number(d.DataManager.instance.eData.datapara[221].num):2==this._awardData.cfg.qulity?t=Number(d.DataManager.instance.eData.datapara[3].num):3==this._awardData.cfg.qulity?t=Number(d.DataManager.instance.eData.datapara[5].num):4==this._awardData.cfg.qulity&&(t=Number(d.DataManager.instance.eData.datapara[8].num)),t},e.prototype.getRandomItemData=function(t){for(var e=t.reward,a=t.weight,i=t.num,o=e.split("|"),n=a.split("|"),r=[],s=0;s<o.length;s++){var c=__read(o[s].split("_"),2),l=c[0],u=c[1];l&&u&&r.push({id:parseInt(l,10),num:parseInt(u,10),weight:parseInt(n[s],10)})}var p=m.userDataProxy.getWeightAwards(r,i);if(p.length>0){var h=p[0],d={id:h.id,num:h.num,buyNum:0,totalNum:this._itemData.buyNum,freeNum:this._itemData.freeNum};return m.userDataProxy.userData.dailyData[this._itemData.id]=d,m.userDataProxy.saveData(),d}return null},e.prototype.onOpenPropDetailPopup=function(){},e.prototype.getShopAward=function(){var t=m.userDataProxy.userData.dailyData[this._itemData.id];this._awardData.radomData.freeNum>0?t.freeNum-=1:t.buyNum+=1;var e=[{id:t.id,num:t.num}];m.userDataProxy.saveData(),this.init(this._itemData),f.gameUIMgr.showCongratsGettingPopup({list:e,type:1})},e.prototype.onMfClick=function(){r.AudioManager.instance.playEffectPath("sounds/click",h.Bundles.RES),this._awardData.radomData.freeNum>0&&(this.getShopAward(),s.EventManager.instance.emit(h.EHomeEvent.UPDATE_HOME_REDDOT,[h.HOME_REDDOT.SHOPRED]))},e.prototype.onBuyClick=function(){r.AudioManager.instance.playEffectPath("sounds/click",h.Bundles.RES),this._itemData.buyType==p.BuyType.GLODBUY?m.userDataProxy.userData.gold>=this._priceTotal?(m.userDataProxy.changeGold(-1*this._priceTotal),this.getShopAward()):f.gameUIMgr.showTips("\u91d1\u5e01\u4e0d\u591f\uff01"):this._itemData.buyType==p.BuyType.GEMBUY&&(m.userDataProxy.userData.diamond>=this._priceTotal?(m.userDataProxy.changeDiamond(-1*this._priceTotal),this.getShopAward()):(f.gameUIMgr.showTips("\u94bb\u77f3\u4e0d\u591f\uff01"),s.EventManager.instance.emit(h.EHomeEvent.SHOW_VIDEO_DIAMOMND_POPUP)))},e.prototype.onVideoClick=function(){var t=this;r.AudioManager.instance.playEffectPath("sounds/click",h.Bundles.RES),u.default.showVideoAds({id:1,eventId:"shop_"+(1==this._itemData.id?"diamondBox":"videoBox")+"_ad",success:function(){t.getShopAward()},fail:function(){},error:function(t){cc.log(t),f.gameUIMgr.showTips("\u6682\u65e0\u5e7f\u544a!")}},!0)},__decorate([y],e)}(cc.Component));n.default=g,cc._RF.pop(),cc._RF.pop()},{}],SimplyCircleCollider:[function(t,e,a){"use strict";cc._RF.push(e,"3be49WxLqlESrEaRRko/eas","SimplyCircleCollider");var i=t,o=e,n=a;cc._RF.push(o,"60b3bld8DJCxYaXYuST4iky","SimplyCircleCollider"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("SimplyCircle"),s=i("BaseSimplyCollider"),c=cc._decorator,l=c.ccclass,u=c.property,p=c.menu,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._canCollider=!0,e.radius=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"canCollider",{set:function(t){this._canCollider=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"circle",{get:function(){var t=this.node.convertToWorldSpaceAR(cc.v2(0,0));return new r.default(t.x,t.y,this.radius*this.node.scale)},enumerable:!1,configurable:!0}),e.prototype.drawCollider=function(){this.graphics.clear(),this.graphics.circle(0,0,this.radius*this.node.scale),this.graphics.stroke()},__decorate([u({type:cc.Integer})],e.prototype,"radius",void 0),__decorate([l,p("SimplyCollider/SimplyCircleCollider")],e)}(s.default);n.default=h,cc._RF.pop(),cc._RF.pop()},{}],SimplyCircle:[function(t,e,a){"use strict";cc._RF.push(e,"7a1f6FOXUJJZp6bHdTxzYKS","SimplyCircle");var i=t,o=e,n=a;cc._RF.push(o,"6677dbIf0lOraleDGuiMVb6","SimplyCircle"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("SimplyVec2"),s=function(){function t(t,e,a){this.x=0,this.y=0,this.radius=0,this.x=t,this.y=e,this.radius=a}return Object.defineProperty(t.prototype,"center",{get:function(){return new r.default(this.x,this.y)},enumerable:!1,configurable:!0}),t}();n.default=s,cc._RF.pop(),cc._RF.pop()},{}],SimplyCollisionDetector:[function(t,e,a){"use strict";cc._RF.push(e,"fa0c14r7IpD35ETwAFjLbrq","SimplyCollisionDetector");var i=t,o=e,n=a;cc._RF.push(o,"d474dZcJFJLxZlwP9fqNLEt","SimplyCollisionDetector"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("SimplyVec2"),s=function(){function t(){}return t.isCollisionCircleToCircle=function(t,e){return r.default.squaredDistance(t.center,e.center)<=(t.radius+e.radius)*(t.radius+e.radius)},t.isCollisionRectToCircle=function(t,e){var a=t.center,i=t.a3,o=t.rotation,n=e.radius,s=e.center;if(o%360!=0){var c=s.sub(a);s=a.add(c.rotate(-1*t.radian))}var l=i.sub(a),u=new r.default(Math.abs(s.x-a.x),Math.abs(s.y-a.y));return new r.default(Math.max(u.x-l.x,0),Math.max(u.y-l.y,0)).lengthSqr()<=n*n},t.isCollisionRectToRect=function(e,a){return e.rotation%360!=0||a.rotation%360!=0?t.isCollisionOBBRectToRect(e,a):t.isCollisionAABBRectToRect(e,a)},t.isCollisionAABBRectToRect=function(t,e){return t.intersects(e)},t.isCollisionOBBRectToRect=function(e,a){var i=e.rAxisX,o=e.rAxisY,n=a.rAxisX,r=a.rAxisY;return!!(t.rectCross(e,a,i)&&t.rectCross(e,a,o)&&t.rectCross(e,a,n)&&t.rectCross(e,a,r))},t.rectCross=function(t,e,a){var i=t.rVertexs.map(function(t){return r.default.dot(t,a)}).sort(function(t,e){return t-e}),o=e.rVertexs.map(function(t){return r.default.dot(t,a)}).sort(function(t,e){return t-e}),n=i[0],s=i[i.length-1],c=o[0],l=o[o.length-1];return s>=c&&l>=n},t.isCollisionPointToCircle=function(t,e){return r.default.distance(t,e.center)<=e.radius},t.isCollisionPointToRect=function(t,e){var a=e.center;if(e.rotation%360!=0){var i=t.sub(a);t=a.add(i.rotate(-1*e.radian))}return e.contains(t)},t}();n.default=s,cc._RF.pop(),cc._RF.pop()},{}],SimplyRectCollider:[function(t,e,a){"use strict";cc._RF.push(e,"99294vwRp1C9ZNX9s/hwZA5","SimplyRectCollider");var i=t,o=e,n=a;cc._RF.push(o,"81a83xMSoBPRYP4QNh/99h1","SimplyRectCollider"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("SimplyRect"),s=i("BaseSimplyCollider"),c=cc._decorator,l=c.ccclass,u=(c.property,c.menu),p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"rect",{get:function(){var t=this.node.convertToWorldSpaceAR(cc.v2(0,0)),e=this.node.angle*Math.PI/180,a=this.node.scaleX,i=this.node.scaleY,o=this.node.width*a,n=this.node.height*i,s=t.clone().add(cc.v2((.5-this.node.anchorX)*o,(.5-this.node.anchorY)*n));return t=t.clone().addSelf(s.sub(t).rotate(e)),new r.default(t.x,t.y,o,n,this.node.angle)},enumerable:!1,configurable:!0}),e.prototype.drawCollider=function(){var t=this.rect;this.graphics.clear(),this.graphics.rect((this.node.anchorX-1)*t.width,-this.node.anchorY*t.height,t.width,t.height),this.graphics.stroke()},__decorate([l,u("SimplyCollider/SimplyRectCollider")],e)}(s.default);n.default=p,cc._RF.pop(),cc._RF.pop()},{}],SimplyRect:[function(t,e,a){"use strict";cc._RF.push(e,"77d4fX3TwpNjpfX1Tso5xLE","SimplyRect");var i=t,o=e,n=a;cc._RF.push(o,"598fant6wFEHr8C24iJHkPH","SimplyRect"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("SimplyVec2"),s=function(){function t(t,e,a,i,o){void 0===o&&(o=0),this.x=0,this.y=0,this.width=0,this.height=0,this.rotation=0,this.x=t,this.y=e,this.width=a,this.height=i,this.rotation=o}return Object.defineProperty(t.prototype,"center",{get:function(){return new r.default(this.x,this.y)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"a1",{get:function(){return new r.default(this.x-this.width/2,this.y-this.height/2)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"a2",{get:function(){return new r.default(this.x+this.width/2,this.y-this.height/2)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"a3",{get:function(){return new r.default(this.x+this.width/2,this.y+this.height/2)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"a4",{get:function(){return new r.default(this.x-this.width/2,this.y+this.height/2)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"axisX",{get:function(){return new r.default(1,0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"axisY",{get:function(){return new r.default(0,1)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rA1",{get:function(){return this.rotation%360==0?this.a1:this.center.add(this.a1.sub(this.center).rotate(this.radian))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rA2",{get:function(){return this.rotation%360==0?this.a2:this.center.add(this.a2.sub(this.center).rotate(this.radian))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rA3",{get:function(){return this.rotation%360==0?this.a3:this.center.add(this.a3.sub(this.center).rotate(this.radian))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rA4",{get:function(){return this.rotation%360==0?this.a4:this.center.add(this.a4.sub(this.center).rotate(this.radian))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rAxisX",{get:function(){return this.rotation%360==0?this.axisX:this.axisX.rotate(this.radian)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rAxisY",{get:function(){return this.rotation%360==0?this.axisY:this.axisY.rotate(this.radian)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"vertexs",{get:function(){return[this.a1,this.a2,this.a3,this.a4]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rVertexs",{get:function(){return[this.rA1,this.rA2,this.rA3,this.rA4]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"radian",{get:function(){return this.rotation*Math.PI/180},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"xMin",{get:function(){return this.x-this.width/2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"xMax",{get:function(){return this.x+this.width/2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"yMin",{get:function(){return this.y-this.height/2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"yMax",{get:function(){return this.y+this.height/2},enumerable:!1,configurable:!0}),t.prototype.intersects=function(t){return!(this.xMax<t.xMin||t.xMax<this.xMin||this.yMax<t.yMin||t.yMax<this.yMin)},t.prototype.contains=function(t){return this.xMin<=t.x&&this.xMax>=t.x&&this.yMin<=t.y&&this.yMax>=t.y},t}();n.default=s,cc._RF.pop(),cc._RF.pop()},{}],SimplyVec2:[function(t,e,a){"use strict";cc._RF.push(e,"67329OAvU5Gs7y8dBnix8Hh","SimplyVec2");var i=e,o=a;cc._RF.push(i,"408975vCGhO2qE6SZetAITx","SimplyVec2"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=0,this.y=0,this.x=t,this.y=e}return t.ccVec2To=function(e){return new t(e.x,e.y)},t.dot=function(t,e){return t.x*e.x+t.y*e.y},t.subtract=function(t,e,a){return t.x=e.x-a.x,t.y=e.y-a.y,t},t.distance=function(t,e){var a=e.x-t.x,i=e.y-t.y;return Math.sqrt(a*a+i*i)},t.squaredDistance=function(t,e){var a=e.x-t.x,i=e.y-t.y;return a*a+i*i},t.prototype.set=function(t,e){return this.x=t,this.y=e,this},t.prototype.add=function(e,a){return(a=a||new t).x=this.x+e.x,a.y=this.y+e.y,a},t.prototype.sub=function(e,a){return t.subtract(a||new t,this,e)},t.prototype.lengthSqr=function(){return this.x*this.x+this.y*this.y},t.prototype.rotate=function(e,a){return(a=a||new t).x=this.x,a.y=this.y,a.rotateSelf(e)},t.prototype.rotateSelf=function(t){var e=Math.sin(t),a=Math.cos(t),i=this.x;return this.x=a*i-e*this.y,this.y=e*i+a*this.y,this},t.prototype.clone=function(){return new t(this.x,this.y)},t}();o.default=n,cc._RF.pop(),cc._RF.pop()},{}],Simulator:[function(t,e,a){"use strict";cc._RF.push(e,"6917aidlLBH85DQqpsjhRZh","Simulator");var i=t,o=e,n=a;cc._RF.push(o,"6bf1645WW1OQLPBKDn1kOEm","Simulator"),Object.defineProperty(n,"__esModule",{value:!0}),n.Simulator=void 0;var r=i("Agent"),s=i("Common"),c=i("kdtree"),l=function(){function t(){this.agentId=0,this.agentIdLst=[],this.aid2agent=Object.create(null),this.obstacles=[],this.kdTree=new c.KdTree,this.time=0}return Object.defineProperty(t,"instance",{get:function(){return t._inst||(t._inst=new t),t._inst},enumerable:!1,configurable:!0}),t.prototype.getAgent=function(t){return this.aid2agent[this.agentIdLst[t]]},t.prototype.getAgentByAid=function(t){return this.aid2agent[t]},t.prototype.getGlobalTime=function(){return this.time},t.prototype.getNumAgents=function(){return this.agentIdLst.length},t.prototype.getAgentAidByIdx=function(t){return this.agentIdLst[t]},t.prototype.setAgentPrefVelocity=function(t,e){this.aid2agent[t].prefVelocity_.copy(e)},t.prototype.getAgentPosition=function(t){return this.aid2agent[t]?this.aid2agent[t].position_:null},t.prototype.getAgentPrefVelocity=function(t){return this.aid2agent[t].prefVelocity_},t.prototype.getAgentVelocity=function(t){return this.aid2agent[t].velocity_},t.prototype.getAgentRadius=function(t){return this.aid2agent[t].radius_},t.prototype.getAgentOrcaLines=function(t){return this.aid2agent[t].orcaLines_},t.prototype.addAgent=function(t,e,a,i,o){if(void 0===e&&(e=null),void 0===a&&(a=null),void 0===i&&(i=null),void 0===o&&(o=null),!this.defaultAgent)throw new Error("no default agent");var n=new r.Agent;return n.position_.copy(t),n.maxNeighbors_=this.defaultAgent.maxNeighbors_,n.maxSpeed_=a||this.defaultAgent.maxSpeed_,n.neighborDist=this.defaultAgent.neighborDist,n.radius_=e||this.defaultAgent.radius_,n.timeHorizon=this.defaultAgent.timeHorizon,n.timeHorizonObst=this.defaultAgent.timeHorizonObst,n.velocity_.copy(i||this.defaultAgent.velocity_),n.id=this.agentId++,o&&o>=0&&(n.mass=o),this.aid2agent[n.id]=n,this.agentIdLst.push(n.id),n.id},t.prototype.removeAgent=function(t){if(this.hasAgent(t)){var e=this.agentIdLst.indexOf(t);e>=0&&(this.agentIdLst[e]=this.agentIdLst[this.agentIdLst.length-1],this.agentIdLst.length--),delete this.aid2agent[t]}},t.prototype.hasAgent=function(t){return!!this.aid2agent[t]},t.prototype.setAgentMass=function(t,e){this.aid2agent[t].mass=e},t.prototype.getAgentMass=function(t){return this.aid2agent[t].mass},t.prototype.setAgentRadius=function(t,e){this.aid2agent[t].radius_=e},t.prototype.setAgentDefaults=function(t,e,a,i,o,n,s){this.defaultAgent||(this.defaultAgent=new r.Agent),this.defaultAgent.maxNeighbors_=e,this.defaultAgent.maxSpeed_=n,this.defaultAgent.neighborDist=t,this.defaultAgent.radius_=o,this.defaultAgent.timeHorizon=a,this.defaultAgent.timeHorizonObst=i,this.defaultAgent.velocity_=s},t.prototype.run=function(t){this.kdTree.buildAgentTree(this.getNumAgents());for(var e=this.agentIdLst.length,a=0;a<e;a++)this.aid2agent[this.agentIdLst[a]].computeNeighbors(this),this.aid2agent[this.agentIdLst[a]].computeNewVelocity(t);for(a=0;a<e;a++)this.aid2agent[this.agentIdLst[a]].update(t);this.time+=t},t.prototype.addObstacle=function(t){if(t.length<2)return-1;for(var e=this.obstacles.length,a=0;a<t.length;++a){var i=new s.Obstacle;i.point=t[a],0!=a&&(i.previous=this.obstacles[this.obstacles.length-1],i.previous.next=i),a==t.length-1&&(i.next=this.obstacles[e],i.next.previous=i),i.direction=s.RVOMath.normalize(t[a==t.length-1?0:a+1].minus(t[a])),2==t.length?i.convex=!0:i.convex=s.RVOMath.leftOf(t[0==a?t.length-1:a-1],t[a],t[a==t.length-1?0:a+1])>=0,i.id=this.obstacles.length,this.obstacles.push(i)}return e},t.prototype.processObstacles=function(){this.kdTree.buildObstacleTree()},t.prototype.queryVisibility=function(t,e,a){return this.kdTree.queryVisibility(t,e,a)},t.prototype.getObstacles=function(){return this.obstacles},t.prototype.clear=function(){this.agentIdLst.length=0,this.agentId=0,this.aid2agent=Object.create(null),this.defaultAgent=null,this.kdTree=new c.KdTree,this.obstacles.length=0},t}();n.Simulator=l,cc._RF.pop(),cc._RF.pop()},{}],SkillDataMgr:[function(t,e,a){"use strict";cc._RF.push(e,"f5c7bHXZ7tNx6X5T70ME4E+","SkillDataMgr");var i=t,o=e,n=a;cc._RF.push(o,"5c697ss8KRKJqrW598+TyM3","SkillDataMgr"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("DataManager"),s=function(){function t(){this._skillAttributeData=[]}return Object.defineProperty(t,"instance",{get:function(){return null==this._instance&&(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t.prototype.pushSkillInfo=function(t){var e=r.DataManager.instance.eData.dataskill[t];this.pushSkillAttributeData(e)},t.prototype.pushSkillAttributeData=function(t){var e=t.attribute.split("_").map(Number);this._skillAttributeData.push({equipId:t.equipId,propertyId:e[0],propertyNum:e[1],needTime:t.needTime,skillId:t.id})},t.prototype.removeSkillInfo=function(){this._skillAttributeData.length=0},t.prototype.getSkillProperty=function(t,e){for(var a=0,i=0;i<this._skillAttributeData.length;++i){var o=this._skillAttributeData[i];0!=o.equipId&&o.equipId!=e||o.needTime>0||o.propertyId==t&&(a+=o.propertyNum)}return a},t._instance=null,t}();n.default=s,cc._RF.pop(),cc._RF.pop()},{}],SmashTheJar:[function(t,e,a){"use strict";cc._RF.push(e,"37117ckYOdPma4MfFgoY7xu","SmashTheJar");var i=t,o=e,n=a;cc._RF.push(o,"7defbZfWwdCZIcRP6O/nAYR","SmashTheJar"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("SceneBase"),s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this)},__decorate([c],e)}(r.SceneBase));n.default=l,cc._RF.pop(),cc._RF.pop()},{}],SocketEngine:[function(t,e,a){"use strict";cc._RF.push(e,"ae033mZ+IZJ+6KJUWdzlcI+","SocketEngine");var i=t,o=e,n=a;cc._RF.push(o,"7ae32HWJ/JBPo+Tdw84ex8a","SocketEngine"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("CommonUtil"),s=i("MyWScoket"),c=(i("base64").Base64,function(){function t(t){this._socket=new s.default(t),this._socket.setSocketSink(this),this._name=t}return t.prototype.setSocketEngineSink=function(t){this._socketEngineSink=t},t.prototype.connect=function(t,e){return this.initValue(),0===this._socket.connect("ws://"+t+":"+e)},t.prototype.connectUrl=function(t){return this.initValue(),0===this._socket.connect(t)},t.prototype.disconnect=function(){this.initValue(),this._socket.disconnect()},t.prototype.send=function(){return!!this.isAlive()||(r.CommonUtil.print("####### socket is not alive"),!1)},t.prototype.isAlive=function(){return this._socket.isOpen()},t.prototype.initValue=function(){},t.prototype.onopen=function(){this._socketEngineSink&&this._socketEngineSink.onEventSocketOpen()},t.prototype.onclose=function(t){this._socketEngineSink&&this._socketEngineSink.onEventSocketClose(t)},t.prototype.onerror=function(t){this._socketEngineSink&&this._socketEngineSink.onEventSocketError(t)},t.prototype.onmessage=function(){},t}());n.default=c,cc._RF.pop(),cc._RF.pop()},{}],SpAnimCtrl:[function(t,e,a){"use strict";cc._RF.push(e,"45231LyZvtEFK6ZQLskZ88Y","SpAnimCtrl");var i=e,o=a;cc._RF.push(i,"3b2fbhKFzJLfazx5JeuION+","SpAnimCtrl");var n=cc._decorator,r=n.ccclass,s=n.property,c=n.menu;sp.SkeletonData.prototype.isTexturesLoaded=function(){for(var t=this.textures,e=t?t.length:0,a=0;a<e;a++)if(!t[a].loaded)return!1;return!0};var l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAnim=null,e.animFrameEventListener=new Map,e.animCompleteListener=new Map,e.onceOnComplete=null,e._onPlayAnimFunc=null,e._timeScale=1,e}return __extends(e,t),e.prototype.onLoad=function(){if(this.spAnim.setEventListener(this.onFrameEvent.bind(this)),this.spAnim.setCompleteListener(this.onCompleteEvent.bind(this)),this.spAnim.skeletonData){var t=this.spAnim.skeletonData.skeletonJson.animations;for(var e in t)for(var a in t)e!=a&&this.spAnim.setMix(e,a,.2)}},e.prototype.onDestroy=function(){this.animFrameEventListener.clear(),this.animCompleteListener.clear(),this.spAnim.setEventListener(null),this.spAnim.setCompleteListener(null)},e.prototype.init=function(t){if(void 0===t&&(t=null),this._timeScale=1,this.spAnim.enabled=!0,this.spAnim.node.opacity=255,t&&t.onPlayAnimFunc&&(this._onPlayAnimFunc=t.onPlayAnimFunc),null==t||!t.skeletonData||this.spAnim.skeletonData&&this.spAnim.skeletonData.name==t.skeletonData.name)return this.clearTracks(),this.spAnim.setToSetupPose(),this.animCompleteListener.clear(),void this.animFrameEventListener.clear();this.spAnim.skeletonData=t.skeletonData;var e=this.spAnim.skeletonData.skeletonJson.animations;for(var a in e)for(var i in e)a!=i&&this.spAnim.setMix(a,i,.2);this.clearTracks(),this.spAnim.setToSetupPose(),this.animCompleteListener.clear(),this.animFrameEventListener.clear()},e.prototype.playAnimWithFrame=function(t,e,a,i,o){if(void 0===e&&(e=!1),void 0===a&&(a=0),void 0===i&&(i=Number.MAX_SAFE_INTEGER),void 0===o&&(o=1),!this.spAnim)return null;if(this.node.active){var n=this.spAnim.findAnimation(t);if(n){var r=n.duration,s=Math.ceil(60*r);i=Math.min(i,s);var c=Math.max(0,a/60),l=Math.min(i/60,1),u=this.spAnim.setAnimation(0,t,e);return this.spAnim.timeScale=0,u.animationStart=c,u.animationEnd=l,this.spAnim.timeScale=o,this._timeScale=this.spAnim.timeScale,u}}},e.prototype.playAnim=function(t,e,a,i){if(void 0===e&&(e=1),void 0===a&&(a=!1),!this.spAnim)return null;if(this.node.active){if(t||(t=this.spAnim.defaultAnimation),!this.spAnim.isAnimationCached()){var o=this.spAnim.getCurrent(0);if(o&&o.animation.name==t)return null;this.spAnim.clearTrack(0)}return this.spAnim.setToSetupPose(),this.spAnim.timeScale=e,this._timeScale=this.spAnim.timeScale,this.onceOnComplete=i,this._onPlayAnimFunc&&this._onPlayAnimFunc(t,e,a),this.spAnim.setAnimation(0,t,a)}},e.prototype.playAnimFixSpeed=function(t,e,a,i){if(void 0===e&&(e=1),void 0===a&&(a=!1),!this.spAnim)return null;if(t||(t=this.spAnim.defaultAnimation),!this.spAnim.isAnimationCached()){var o=this.spAnim.getCurrent(0);if(o&&o.animation.name==t)return null;this.spAnim.clearTrack(0)}return this.spAnim.setToSetupPose(),this.spAnim.timeScale=e,this._timeScale=this.spAnim.timeScale,this.onceOnComplete=i,this.spAnim.setAnimation(0,t,a)},e.prototype.setTimeScale=function(t){t*this._timeScale!=this.spAnim.timeScale&&(this.spAnim.timeScale=this._timeScale*t)},e.prototype.getCurAnimTime=function(){if(!this.spAnim.isAnimationCached()){var t=this.spAnim.getCurrent(0);if(t)return t.animationEnd}return 0},e.prototype.registerFrameEvent=function(t,e){this.animFrameEventListener.set(e,t)},e.prototype.unregisterFrameEvent=function(t){this.animFrameEventListener.delete(t)},e.prototype.registerComplete=function(t,e){this.animCompleteListener.set(e,t)},e.prototype.unregisterComplete=function(t){this.animCompleteListener.delete(t)},e.prototype.onFrameEvent=function(t,e){var a=this;this.animFrameEventListener.forEach(function(i,o){i.call(o,t.animation.name,e.data.name,a)})},e.prototype.onCompleteEvent=function(t){this.onceOnComplete&&this.onceOnComplete(t),this.onceOnComplete=null,this.animCompleteListener.forEach(function(e,a){e.call(a,t)})},e.prototype.clearAnim=function(){this.clearTracks()},e.prototype.releaseRes=function(){},e.prototype.generateSomeNodes=function(t,e){var a=this.spAnim.attachUtil.generateAttachedNodes(t)[0];return e?(e instanceof cc.Prefab?a.addChild(cc.instantiate(e)):e.parent?e.parent=a:a.addChild(e),a):a},e.prototype.destroySomeNodes=function(t){this.spAnim.attachUtil.destroyAttachedNodes(t)},e.prototype.clearTracks=function(){this.spAnim.isAnimationCached()||this.spAnim.clearTracks()},e.prototype.clear=function(){this.clearTracks(),this.animCompleteListener.clear(),this.animFrameEventListener.clear()},e.prototype.clearOnceComplete=function(){this.onceOnComplete=null},__decorate([s(sp.Skeleton)],e.prototype,"spAnim",void 0),__decorate([r,c("Utils/Components/SpAnimCtrl")],e)}(cc.Component);o.default=l,cc._RF.pop(),cc._RF.pop()},{}],SpineEx:[function(t,e){"use strict";cc._RF.push(e,"7ee27E3jtpKnInDYBposblc","SpineEx");var a=e;cc._RF.push(a,"c4c5bHvKwNMjrKTpA4Shs5M","SpineEx"),sp&&sp.Skeleton&&(sp.SkeletonData.copy=function(t){if(!t)return null;var e=new sp.SkeletonData;cc.js.mixin(e,t);var a=Date.now();e._uuid=t._uuid+"_"+a+"_copy";for(var i=e.textureNames,o=[],n=0;n<i.length;n++)e.atlasText=e.atlasText.replace(i[n],"copy_"+i[n]),o.push("copy_"+i[n]);return e.textureNames=o,e.init&&e.init(),e},sp.Skeleton.prototype.updateRegion=function(t,e){var a=this.findSlot(t);if(null!=a){var i=a.getAttachment();if(null!=i){var o=new sp.SkeletonTexture({width:e.width,height:e.height});o.setRealTexture(e);var n=new sp.spine.TextureAtlasRegion;n.width=e.width,n.height=e.height,n.originalWidth=e.width,n.originalHeight=e.height,n.rotate=!1,n.u=0,n.v=0,n.u2=1,n.v2=1,n.texture=o,n.renderObject=n,i.region=n,i.width=e.width,i.height=e.height,i instanceof sp.spine.MeshAttachment?i.updateUVs():(i.setRegion(n),i.updateOffset())}}}),cc._RF.pop(),cc._RF.pop()},{}],SqlUtil:[function(t,e,a){"use strict";cc._RF.push(e,"06ff17cX2NFEJNpuisk3ec0","SqlUtil");var i=t,o=e,n=a;cc._RF.push(o,"dd1c8lnSl5HrJ885ulfFTvM","SqlUtil");var r=function(t,e,a,i){return new(a||(a=Promise))(function(o,n){function r(t){try{c(i.next(t))}catch(e){n(e)}}function s(t){try{c(i.throw(t))}catch(e){n(e)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof a?e:new a(function(t){t(e)})).then(r,s)}c((i=i.apply(t,e||[])).next())})},s=function(){var t;return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(t){return function(e){return __decorate([t,e])}}};Object.defineProperty(n,"__esModule",{value:!0}),n.SqlUtil=void 0;var c=i("Logger"),l=i("Md5"),u=i("StringUtil"),p=i("TypeUtil"),h=(i("WorkerManager"),function(){function t(){}return Object.defineProperty(t,"key",{get:function(){return null==this._key&&(this._key=l.md5(yzll.gameConfig.name)),this._key},enumerable:!1,configurable:!0}),Object.defineProperty(t,"iv",{get:function(){return null==this._iv&&(this._iv=l.md5(yzll.gameConfig.gid)),this._iv},enumerable:!1,configurable:!0}),t.init=function(t){this._userId=t},t.setUserData=function(t,e){u.StringUtil.isEmpty(this._userId)||(this.addUserKey(t),this.set(this._userId+t,e))},t.getUserData=function(t,e){if(!u.StringUtil.isEmpty(this._userId))return this.get(this._userId+t,e)},t.removeUserData=function(t){u.StringUtil.isAnyEmpty(this._userId)||this.remove(this._userId+t)},t.clearUserData=function(){if(!u.StringUtil.isEmpty(this._userId)){this._userKeys||(this._userKeys=this.get("user_save_keys",[]));for(var t=0;t<this._userKeys.length;t++)this.remove(this._userId+this._userKeys[t])}},t.set=function(){return r(this,void 0,void 0,function(){return s()})},t.get=function(t,e){if(null!=t){t=yzll.gameConfig.name+t,t=l.md5(t);var a=this.getString(t);if(u.StringUtil.isEmpty(a),a&&-1!==a.indexOf("yzllVal"))return JSON.parse(a).yzllVal;if(null==e)return a;if(null===a)return e;if(p.TypeUtil.isString(e))return a;if(p.TypeUtil.isNumber(e))return Number(a);if(p.TypeUtil.isBoolean(e))return"true"==a;if(p.TypeUtil.isObject(e))try{return JSON.parse(a)}catch(r){return c.Logger.error("\u89e3\u6790\u6570\u636e\u5931\u8d25,str="+a),e}return a}c.Logger.error("\u5b58\u50a8\u7684key\u4e0d\u80fd\u4e3a\u7a7a")},t.remove=function(t){if(null!=t){delete this._tempData[t];var e=this._tempKeys.indexOf(t);-1!==e&&this._tempKeys.splice(e,1),t=yzll.gameConfig.name+t,t=l.md5(t),cc.sys.localStorage.removeItem(t)}else c.Logger.error("\u5b58\u50a8\u7684key\u4e0d\u80fd\u4e3a\u7a7a")},t.clear=function(){for(var t in this._tempData)delete this._tempData[t];this._tempKeys.length=0,cc.sys.localStorage.clear()},t.getString=function(t){var e=cc.sys.localStorage.getItem(t);return u.StringUtil.isEmpty(e)?null:e},t.addUserKey=function(t){this._userKeys||(this._userKeys=this.get("user_save_keys",[])),-1==this._userKeys.indexOf(t)&&(this._userKeys.push(t),this.set("user_save_keys",this._userKeys))},t.setLocalUserData=function(t,e){cc.sys.localStorage.setItem(t,e)},t.getLocalUserData=function(t,e){return cc.sys.localStorage.getItem(t)||e},t._key=null,t._iv=null,t._userId=null,t._userKeys=null,t._tempKeys=[],t._tempData={},t}());n.SqlUtil=h,cc._RF.pop(),cc._RF.pop()},{}],StringUtil:[function(t,e,a){"use strict";cc._RF.push(e,"9632bSxWCJPUYURamvgxrP6","StringUtil");var i=e,o=a,n=t("./helpers/typeof");cc._RF.push(i,"8a6c14uQGJJWZLpysJIHlPE","StringUtil");var r=function(t,e){var a="function"==typeof Symbol&&t[Symbol.iterator];if(!a)return t;var i,o,n=a.call(t),r=[];try{for(;(void 0===e||e-- >0)&&!(i=n.next()).done;)r.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(a=n.return)&&a.call(n)}finally{if(o)throw o.error}}return r},c=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(r(arguments[e]));return t};Object.defineProperty(o,"__esModule",{value:!0}),o.StringBuffer=o.StringUtil=void 0,function(t){function e(t){return null==t||""===t}function a(){for(var t=[],a=0;a<arguments.length;a++)t[a]=arguments[a];if(null==t||0==t.length)return!0;for(var i in t)if(e(i))return!0;return!1}t.formatDescStr=function(t,e,a,i){return void 0===i&&(i=/\[(.*?)\]/g),t.replace(i,function(t,i){var o=!1,n=i;if(i.includes("%")&&(o=!0,n=i.slice(0,i.length-1)),e.hasOwnProperty(n)){var r=e[n];return o?("string"==typeof r&&(r=r.split("|").map(Number)[a-1]),r*=100,(r=Math.round(100*r)/100)%1==0?Math.floor(r)+"%":r+"%"):("string"==typeof r&&(r=r.split("|").map(Number)[a-1]),r)}return t})},t.transRichText=function(t,e){return void 0===e&&(e="#69FF3A"),"<outline color=black width=1>"+t.replace(/(\d+%)|(\d+\u79d2)|(\d+)/g,function(t){return"<color="+e+">"+t+"</color>"})+"</color>"},t.isEmpty=e,t.isNotEmpty=function(t){return!e(t)},t.isAnyEmpty=a,t.isNoneEmpty=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return!a.apply(void 0,c(t))},t.versionCompare=function(t,e){for(var a=t.split("."),i=e.split("."),o=0;o<a.length;o++){if(null==i[o])return 1;if(a[o]!=i[o])return Number(a[o])-Number(i[o])}return 0},t.copyObj=function t(e){var a;for(var i in a="[object Array]"===Object.prototype.toString.call(e)?[]:{},e)null==e[i]?a[i]=e[i]:"object"==n(e[i])?a[i]=t(e[i]):a[i]=e[i];return a},t.strLenLimit=function(t,e,a){void 0===e&&(e=8),void 0===a&&(a="...");var i=t;return t.length>e&&(i=t.substring(0,e),i+=a),i}}(o.StringUtil||(o.StringUtil={}));var l=function(){function t(){this._strings=new Array}return t.prototype.append=function(t){this._strings.push(t)},t.prototype.toString=function(){return this._strings.join("")},t}();o.StringBuffer=l,cc._RF.pop(),cc._RF.pop()},{"./helpers/typeof":"typeof"}],StroageMgr:[function(t,e,a){"use strict";cc._RF.push(e,"952f84ph4pNna4GZxWu5E9E","StroageMgr");var i=e,o=a,n=t("./helpers/typeof");cc._RF.push(i,"d1347cGmpNMeb8n+IuCiin+","StroageMgr"),Object.defineProperty(o,"__esModule",{value:!0}),o.StroageMgr=o.Encrypt=o.StroageDict=void 0,o.StroageDict={LastResetDate:{k:"LastResetDate",v:0}},o.Encrypt={encrypt:function(t){for(var e=String.fromCharCode(t.charCodeAt(0)+t.length),a=1;a<t.length;a++)e+=String.fromCharCode(t.charCodeAt(a)+t.charCodeAt(a-1));return escape(e)},decrypt:function(t){t=unescape(t);for(var e=String.fromCharCode(t.charCodeAt(0)-t.length),a=1;a<t.length;a++)e+=String.fromCharCode(t.charCodeAt(a)-e.charCodeAt(a-1));return e}};var r=function(){function t(){}return Object.defineProperty(t,"Inst",{get:function(){return this.inst||(this.inst=new this)},enumerable:!1,configurable:!0}),t.prototype.clear=function(){var t=this.getNumber(o.StroageDict.LastResetDate);cc.sys.localStorage.clear(),this.setValue(o.StroageDict.LastResetDate,t)},t.prototype.getNumber=function(t){var e=cc.sys.localStorage.getItem(t.k),a=null;return 0===e?0:(a=e?o.Encrypt.decrypt(e):t.v,Number(a))},t.prototype.getString=function(t){var e,a=cc.sys.localStorage.getItem(t.k);return e=a?o.Encrypt.decrypt(a):t.v,String(e)},t.prototype.getBoolean=function(t){var e=cc.sys.localStorage.getItem(t.k)+"";if(!e)return t.v;var a=o.Encrypt.decrypt(e);return"true"!=a&&"false"!=a?t.v:"false"!=a},t.prototype.getObject=function(t){var e=cc.sys.localStorage.getItem(t.k);if(!e)return t.v;var a=o.Encrypt.decrypt(e);return JSON.parse(a)},t.prototype.setValue=function(t,e){"object"==n(e)&&(e=JSON.stringify(e)),e=o.Encrypt.encrypt(e+""),cc.sys.localStorage.setItem(t.k,e)},t.inst=null,t}();o.StroageMgr=r,cc._RF.pop(),cc._RF.pop()},{"./helpers/typeof":"typeof"}],SuperBullet6:[function(t,e,a){"use strict";cc._RF.push(e,"5196fuJyhtInZB5nYGWfZui","SuperBullet6");var i=t,o=e,n=a;cc._RF.push(o,"efa1agePxlC34NstBlPDXL9","SuperBullet6"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("SimplyRectCollider"),c=i("SimplyCollisionDetector"),l=i("HomeEnum"),u=i("BattleDataProxy"),p=i("EnemyBase"),h=cc._decorator,d=h.ccclass,m=h.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mSpine=null,e._synthesisLv=0,e._superRate=0,e._atkNum=0,e}return __extends(e,t),e.prototype.initBullet=function(t,e){var a=this;this._synthesisLv=t,this._superRate=e,this.mSpine.setAnimation(0,"atk",!0),this._atkNum=5,this.mSpine.setEventListener(function(t,e){e.data.name;var i=a.node.getComponent(s.default),o=u.battleDataProxy.enemyNodes.slice();a._atkNum--;for(var n=0;n<o.length;++n){var h=o[n];if(i){var d=h.getChildByName("collision").getComponent(s.default);if(d&&c.default.isCollisionRectToRect(d.rect,i.rect)){var m=h.getComponent(p.default).monsterCfg,f=u.battleDataProxy.getBulletHarm(m.type,6,a._synthesisLv,1,1,1,a._superRate);h.getComponent(p.default).beAttack(f,6)}}}r.AudioManager.instance.playEffectPath("sounds/bulletHit6",l.Bundles.RES),a._atkNum<=0&&(a.node.destroy(),a.node.removeFromParent())})},e.prototype.update=function(){},__decorate([m(sp.Skeleton)],e.prototype,"mSpine",void 0),__decorate([d],e)}(cc.Component);n.default=f,cc._RF.pop(),cc._RF.pop()},{}],SuperBulletPlant10:[function(t,e,a){"use strict";cc._RF.push(e,"6ce626NGLlM/o/XFCJ44+zs","SuperBulletPlant10");var i=t,o=e,n=a;cc._RF.push(o,"2b968XVGzJO4ri3LDDwsg8f","SuperBulletPlant10"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("MathUtil"),s=i("SimplyRectCollider"),c=i("SimplyCollisionDetector"),l=i("GameEnum"),u=i("BattleDataProxy"),p=i("EnemyBase"),h=i("BulletBase"),d=cc._decorator,m=d.ccclass,f=(d.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initBullet=function(e,a,i,o){var n=this;t.prototype.initBullet.call(this,e,a,i,o),this.mSpAni.setCompleteListener(function(t){"atk"==(t.animation?t.animation.name:"")&&(n.node.destroy(),n.node.removeFromParent())}),this.mSpAni.setEventListener(function(t,e){e.data.name,n.monsterColliderCheck()}),this.mSpAni.setAnimation(0,"stand",!0);var s=r.MathUtil.distance(this.node.position,this._atkTarget.position)/(100*this._moveSpd),c=this._atkTarget.position.clone().addSelf(cc.v3(0,250)),l=250/(100*this._moveSpd);Math.abs(this._atkTarget.x-this.node.x)<=this.node.width?cc.tween(this.node).to(s,{position:c}).by(l,{position:cc.v3(0,-250)}).delay(.1).call(function(){n.mSpAni.setAnimation(0,"atk",!1)}).start():this.bezierTo(cc.v2(this.node.position),this.getC2(cc.v2(this.node.position),cc.v2(c)),cc.v2(c),s,!0,function(){var t=250/(100*n._moveSpd);cc.tween(n.node).by(t,{position:cc.v3(0,-250)}).delay(.1).call(function(){n.mSpAni.setAnimation(0,"atk",!1)}).start()})},e.prototype.bezierTo=function(t,e,a,i,o,n,s,c){void 0===s&&(s=""),void 0===c&&(c=null),cc.Tween.stopAllByTarget(this.node),r.MathUtil.bezierTo(this.node,i,t,e,a,function(t,e){c&&c(t,e)},s).call(function(){n&&n()}).start()},e.prototype.getC2=function(t,e){var a=Math.abs(t.x-e.x),i=t.x>e.x?t.x-a/2:t.x+a/2,o=150*Math.random()+150;return t.y>e.y?cc.v2(i,t.y+o):cc.v2(i,e.y+o)},e.prototype.getPerpendicularVector=function(t,e){return cc.v2(-t.y,t.x).add(e)},e.prototype.monsterColliderCheck=function(){for(var t=this.node.getComponent(s.default),e=u.battleDataProxy.enemyNodes.slice(),a=0;a<e.length;++a){var i=e[a];if(t&&i&&i.isValid&&!this.getIsHaveCollisionNode(i)){var o=i.getChildByName("collision").getComponent(s.default);if(o&&c.default.isCollisionRectToRect(o.rect,t.rect)){var n=i.getComponent(p.default).monsterCfg,r=u.battleDataProxy.getBulletHarm(n.type,this._plantId,this._synthesisLv,this._atkCount,this._oneAtkTargetNum,this._atkRate,this._superRate);i.getComponent(p.default).beAttack(r,this._plantId)}}}},e.prototype.update=function(){u.battleDataProxy.gameState==l.GameState.PLAYING||u.battleDataProxy.gameState==l.GameState.READY?this._isPauseGame&&(this._isPauseGame=!1,this.node.resumeAllActions()):this._isPauseGame||(this._isPauseGame=!0,this.node.pauseAllActions())},__decorate([m],e)}(h.default));n.default=f,cc._RF.pop(),cc._RF.pop()},{}],SuperBulletPlant11:[function(t,e,a){"use strict";cc._RF.push(e,"41b71kAKoZAkp5NzgV9S+HM","SuperBulletPlant11");var i=t,o=e,n=a;cc._RF.push(o,"1e23dLSpqVJz4e9jaB1IF3v","SuperBulletPlant11"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("MathUtil"),s=i("GameEnum"),c=i("BattleDataProxy"),l=i("BulletBase"),u=cc._decorator,p=u.ccclass,h=(u.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initBullet=function(e,a,i,o,n){t.prototype.initBullet.call(this,e,a,i,o,n)},e.prototype.startMove=function(t){var e=this,a=r.MathUtil.distance(this.node.position,this._atkPos.clone())/(30*this._moveSpd),i=this._atkPos.clone();this.bezierTo(cc.v2(this.node.position),this.getC2(cc.v2(this.node.position),cc.v2(i)),cc.v2(i),a,!0,function(){e.addBulletHit(null),e.node.destroy(),e.node.removeFromParent(),t&&t()}),cc.tween(this.node).to(a,{angle:1440}).start()},e.prototype.bezierTo=function(t,e,a,i,o,n,s,c){void 0===s&&(s=""),void 0===c&&(c=null),cc.Tween.stopAllByTarget(this.node),r.MathUtil.bezierTo(this.node,i,t,e,a,function(t,e){c&&c(t,e)},s).call(function(){n&&n()}).start()},e.prototype.getC2=function(t,e){var a=Math.abs(t.x-e.x),i=t.x>e.x?t.x-a/2:t.x+a/2,o=250*Math.random()+250;return t.y>e.y?cc.v2(i,t.y+o):cc.v2(i,e.y+o)},e.prototype.getPerpendicularVector=function(t,e){return cc.v2(-t.y,t.x).add(e)},e.prototype.update=function(){c.battleDataProxy.gameState==s.GameState.PLAYING||c.battleDataProxy.gameState==s.GameState.READY?this._isPauseGame&&(this._isPauseGame=!1,this.node.resumeAllActions()):this._isPauseGame||(this._isPauseGame=!0,this.node.pauseAllActions())},__decorate([p],e)}(l.default));n.default=h,cc._RF.pop(),cc._RF.pop()},{}],SuperBulletPlant12:[function(t,e,a){"use strict";cc._RF.push(e,"db225EP+75NJ5kqgm7qpd2P","SuperBulletPlant12");var i=t,o=e,n=a;cc._RF.push(o,"cb71cH8+i5IQbB9Qp/IufWV","SuperBulletPlant12"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("BulletBase"),s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),__decorate([c],e)}(r.default));n.default=l,cc._RF.pop(),cc._RF.pop()},{}],SuperBulletPlant14:[function(t,e,a){"use strict";cc._RF.push(e,"1823cFyQsNAMLtuXfkZCq6g","SuperBulletPlant14");var i=t,o=e,n=a;cc._RF.push(o,"83ddebh8ZFNvLE594tpby6w","SuperBulletPlant14"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("SimplyRectCollider"),c=i("SimplyCollisionDetector"),l=i("GameEnum"),u=i("HomeEnum"),p=i("BattleDataProxy"),h=i("EnemyBase"),d=i("BulletBase"),m=cc._decorator,f=m.ccclass,_=m.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mSpAni2=null,e._isTopAni=!1,e._spShowTime=0,e}return __extends(e,t),e.prototype.initBullet=function(e,a,i,o){var n=this;t.prototype.initBullet.call(this,e,a,i,o),this.mSpAni.setCompleteListener(function(t){var e=t.animation?t.animation.name:"";if("appear"==e){var a=n._isTopAni?"atk_up":"atk_left";n.mSpAni.setAnimation(0,a,!1),r.AudioManager.instance.playEffectPath("sounds/superPlant14",u.Bundles.RES)}else"disappear"==e?n.mSpAni.node.active=!1:"atk_up"!=e&&"atk_left"!=e||n.mSpAni.setAnimation(0,"disappear",!1)}),this.mSpAni2.setCompleteListener(function(t){var e=t.animation?t.animation.name:"";if("appear"==e){var a=n._isTopAni?"atk_down":"atk_left";n.mSpAni2.setAnimation(0,a,!1),r.AudioManager.instance.playEffectPath("sounds/superPlant14",u.Bundles.RES)}else"disappear"==e?(n.node.destroy(),n.node.removeFromParent()):"atk_down"!=e&&"atk_left"!=e||n.mSpAni2.setAnimation(0,"disappear",!1)}),this.mSpAni.setEventListener(function(){n.spEventListener()}),this.mSpAni2.setEventListener(function(){n.spEventListener()}),this.node.scale=1.5},e.prototype.initOrientation=function(t){this._isTopAni=t>=0&&t<=4||t>=14,this._spShowTime=.15,this.mSpAni.setAnimation(0,"appear",!1),this.mSpAni2.node.active=!1,this.mSpAni2.node.scaleX=this._isTopAni?1:-1,this._isTopAni?(this.mSpAni2.node.x=0,this.mSpAni2.node.y=80,this.mSpAni.node.x=0,this.mSpAni.node.y=-60):(this.mSpAni2.node.x=-80,this.mSpAni2.node.y=0,this.mSpAni.node.x=80,this.mSpAni.node.y=0)},e.prototype.spEventListener=function(){for(var t=this.node.getComponent(s.default),e=p.battleDataProxy.enemyNodes.slice(),a=0;a<e.length;++a){var i=e[a];if(t){var o=i.getChildByName("collision").getComponent(s.default);if(o&&c.default.isCollisionRectToRect(o.rect,t.rect)){var n=i.getComponent(h.default).monsterCfg,l=p.battleDataProxy.getBulletHarm(n.type,14,this._synthesisLv,1,1,1,this._superRate);i.getComponent(h.default).beAttack(l,14)}}}r.AudioManager.instance.playEffectPath("sounds/bulletHit6",u.Bundles.RES)},e.prototype.update=function(t){if(p.battleDataProxy.gameState!=l.GameState.PLAYING&&p.battleDataProxy.gameState!=l.GameState.READY)return this.mSpAni.paused=!0,void(this.mSpAni2.paused=!0);this.mSpAni.paused=!1,this.mSpAni2.paused=!1,this._spShowTime>0&&(this._spShowTime-=t,this._spShowTime<=0&&(this.mSpAni2.node.active=!0,this.mSpAni2.setAnimation(0,"appear",!1)))},__decorate([_(sp.Skeleton)],e.prototype,"mSpAni2",void 0),__decorate([f],e)}(d.default);n.default=y,cc._RF.pop(),cc._RF.pop()},{}],SuperBulletPlant15:[function(t,e,a){"use strict";cc._RF.push(e,"79413ft64xBvLomcgvW+K9N","SuperBulletPlant15");var i=t,o=e,n=a;cc._RF.push(o,"7ed8aBkQkBOpoHAPLz/KzTf","SuperBulletPlant15"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("SimplyRectCollider"),s=i("SimplyCollisionDetector"),c=i("DataManager"),l=i("BattleDataProxy"),u=i("EnemyBase"),p=i("HeavyFogEffect"),h=cc._decorator,d=h.ccclass,m=h.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mSpine=null,e._synthesisLv=0,e._atkNum=0,e}return __extends(e,t),e.prototype.initBulletFire=function(t){var e=this;this._synthesisLv=t,this._atkNum=10,this.mSpine.setEventListener(function(){e.onEventListener()}),this.mSpine.setAnimation(0,"skill",!1),this.mSpine.setCompleteListener(function(){e.node.destroy(),e.node.removeFromParent()})},e.prototype.onEventListener=function(){for(var t,e=this.node.getComponent(r.default),a=l.battleDataProxy.enemyNodes.slice(),i=0;i<a.length;++i){var o=a[i];if(o&&o.isValid){if(this._atkNum<=0)break;var n=o.getChildByName("collision").getComponent(r.default);if(n&&s.default.isCollisionRectToRect(n.rect,e.rect)){var h=c.DataManager.instance.eData.datasuperplant[15].damage1,d=o.getComponent(u.default).monsterCfg,m=l.battleDataProxy.getBulletHarm(d.type,15,this._synthesisLv,1,1,1,h);o.getComponent(u.default).beAttack(m,15),this._atkNum--}}}var f=(null===(t=l.battleDataProxy.weatherHeavyFog)||void 0===t?void 0:t.children)||[];for(i=0;i<f.length;++i){var _=f[i],y=null==_?void 0:_.getComponent(r.default);y&&s.default.isCollisionRectToRect(e.rect,y.rect)&&_.getComponent(p.default).beBlownAway(this.node)}},__decorate([m(sp.Skeleton)],e.prototype,"mSpine",void 0),__decorate([d],e)}(cc.Component);n.default=f,cc._RF.pop(),cc._RF.pop()},{}],SuperBulletPlant2:[function(t,e,a){"use strict";cc._RF.push(e,"eebbc+tMUtKroZGYFF7hLY2","SuperBulletPlant2");var i=t,o=e,n=a;cc._RF.push(o,"7f06d7wrmNNII0QjgiQRU2n","SuperBulletPlant2"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("EventManager"),c=i("MathUtil"),l=i("GameEnum"),u=i("HomeEnum"),p=i("BattleDataProxy"),h=i("EnemyBase"),d=i("BulletBase"),m=i("BulletGrape"),f=cc._decorator,_=f.ccclass,y=f.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mBulletGrapePb=null,e._bombScope=100,e._isCanMove=!1,e._bombNum=1,e._atkNum=0,e._bulletNum=0,e}return __extends(e,t),e.prototype.initBullet=function(){},e.prototype.getCreatePos=function(t){if(t.x<=this.node.width/2-275){var e=t.y;return e=e>0?e>630?630:e:e<-390?-390:e,cc.v3(-285,e)}return t.y>0?cc.v3(t.x,630):cc.v3(t.x,-390)},e.prototype.initFixedPlantBullet=function(t,e,a){var i=this;if(!e||!e.isValid)return console.log("\u76ee\u6807\u4e22\u5931\uff0c\u8fd9\u6b21\u4e0d\u7b97"),this.node.destroy(),void this.node.removeFromParent();this._isCanMove=!0,this._isCheckCollision=!1,this._atkNum=t,this._atkTarget=e,this._bulletNum=a,this._atkPos=this.getCreatePos(e),this._moveNormalize=this.node.position.clone().sub(this._atkPos.clone()).normalize(),this.mSpAni.setCompleteListener(function(t){var e=t.animation?t.animation.name:"";"bomb1"!=e&&"bomb2"!=e||(i._bombNum--,i._bombNum>0?i.playBomb2():(i.node.destroy(),i.node.removeFromParent()))}),this.mSpAni.setEventListener(function(t,e){e.data.name;var a=p.battleDataProxy.enemyNodes.slice();r.AudioManager.instance.playEffectPath("sounds/plant12",u.Bundles.RES),s.EventManager.instance.emit(l.EGameEvent.SCREEN_SHAKE);for(var o=0;o<a.length;++o){var n=a[o];if(n&&n.isValid&&c.MathUtil.distance(n.position,i.node.position)<=i._bombScope){var d=n.getComponent(h.default).monsterCfg,f=p.battleDataProxy.getFixedPlantBulletHarm(i._atkNum,d.type,1);n.getComponent(h.default).beAttack(f,104,!0)}}for(o=0;o<i._bulletNum;++o){var _=cc.instantiate(i.mBulletGrapePb);p.battleDataProxy.bulletView.addChild(_),_.position=i.node.position,_.getComponent(m.default).initBullet(i._atkNum,o+1)}}),this.startMove()},e.prototype.playBomb2=function(){this.mSpAni.paused=!1,this.mSpAni.setAnimation(0,"bomb2",!1)},e.prototype.moveArrive=function(){this._isCanMove=!1,this.node.zIndex=-this.node.y,this.mSpAni.paused=!1,this.mSpAni.setAnimation(0,"bomb1",!1)},e.prototype.update=function(){this._isCanMove&&(p.battleDataProxy.gameState==l.GameState.PLAYING||p.battleDataProxy.gameState==l.GameState.READY?this._isPauseGame&&(this.mSpAni.paused=!1,this._isPauseGame=!1,this.node.resumeAllActions()):this._isPauseGame||(this._isPauseGame=!0,this.mSpAni.paused=!0,this.node.pauseAllActions()))},e.prototype.startMove=function(){var t=this,e=c.MathUtil.distance(this.node.position,this._atkPos.clone())/(60*this._moveSpd),a=this._atkPos.clone();this.bezierTo(cc.v2(this.node.position),this.getC2(cc.v2(this.node.position),cc.v2(a)),cc.v2(a),e,!0,function(){t.moveArrive()})},e.prototype.bezierTo=function(t,e,a,i,o,n,r,s){void 0===r&&(r=""),void 0===s&&(s=null),cc.Tween.stopAllByTarget(this.node),c.MathUtil.bezierTo(this.node,i,t,e,a,function(t,e){s&&s(t,e)},r).call(function(){n&&n()}).start()},e.prototype.getC2=function(t,e){var a=Math.abs(t.x-e.x),i=t.x>e.x?t.x-a/2:t.x+a/2,o=250*Math.random()+250;return t.y>e.y?cc.v2(i,t.y+o):cc.v2(i,e.y+o)},__decorate([y(cc.Prefab)],e.prototype,"mBulletGrapePb",void 0),__decorate([_],e)}(d.default);n.default=g,cc._RF.pop(),cc._RF.pop()},{}],SuperBulletPlant4:[function(t,e,a){"use strict";cc._RF.push(e,"8f2d3fArMpNaYwfFfryzkCB","SuperBulletPlant4");var i=t,o=e,n=a;cc._RF.push(o,"583611qNxxEo6JeCg+Vso0O","SuperBulletPlant4"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("MathUtil"),s=i("GameEnum"),c=i("BattleDataProxy"),l=i("BulletBase"),u=cc._decorator,p=u.ccclass,h=(u.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initBullet=function(e,a,i,o){t.prototype.initBullet.call(this,e,a,i,o)},e.prototype.startMove=function(t){var e=this,a=r.MathUtil.distance(this.node.position,this._atkPos.clone())/(30*this._moveSpd),i=this._atkPos.clone();this.bezierTo(cc.v2(this.node.position),this.getC2(cc.v2(this.node.position),cc.v2(i)),cc.v2(i),a,!0,function(){e.addBulletHit(null),e.node.destroy(),e.node.removeFromParent(),t&&t()})},e.prototype.bezierTo=function(t,e,a,i,o,n,s,c){void 0===s&&(s=""),void 0===c&&(c=null),cc.Tween.stopAllByTarget(this.node),r.MathUtil.bezierTo(this.node,i,t,e,a,function(t,e){c&&c(t,e)},s).call(function(){n&&n()}).start()},e.prototype.getC2=function(t,e){var a=Math.abs(t.x-e.x),i=t.x>e.x?t.x-a/2:t.x+a/2,o=250*Math.random()+250;return t.y>e.y?cc.v2(i,t.y+o):cc.v2(i,e.y+o)},e.prototype.getPerpendicularVector=function(t,e){return cc.v2(-t.y,t.x).add(e)},e.prototype.update=function(){c.battleDataProxy.gameState==s.GameState.PLAYING||c.battleDataProxy.gameState==s.GameState.READY?(this._isPauseGame&&(this._isPauseGame=!1,this.node.resumeAllActions()),this.setAngle()):this._isPauseGame||(this._isPauseGame=!0,this.node.pauseAllActions())},__decorate([p],e)}(l.default));n.default=h,cc._RF.pop(),cc._RF.pop()},{}],SuperBulletPlant5:[function(t,e,a){"use strict";cc._RF.push(e,"109c659b41MBpAOiMHHCOyF","SuperBulletPlant5");var i=t,o=e,n=a;cc._RF.push(o,"898a4dSgklKYbi2ko8ipgcI","SuperBulletPlant5"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("GameEnum"),s=i("BattleDataProxy"),c=i("BulletBase"),l=cc._decorator,u=l.ccclass,p=(l.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._atkEnemyNodes=[],e}return __extends(e,t),e.prototype.initBullet=function(e,a,i,o){t.prototype.initBullet.call(this,e,a,i,o),this._isPenetrate=!0},e.prototype.getIsCanAtk=function(t){for(var e=0;e<this._atkEnemyNodes.length;++e)if(this._atkEnemyNodes[e]==t)return!1;return!0},e.prototype.update=function(t){if(s.battleDataProxy.gameState==r.GameState.PLAYING||s.battleDataProxy.gameState==r.GameState.READY){var e=this._moveSpd*(t/(1/60)),a=this._moveNormalize;this.node.x-=e*a.x,this.node.y-=e*a.y;var i=cc.winSize;if(this.node.x>i.width||this.node.x<-i.width||this.node.y>i.height||this.node.y<-i.height)return this.node.destroy(),void this.node.removeFromParent();this._colliderTime-=t,this._colliderTime<=0&&(this._colliderTime=r.EGameEnum.CHECK_COLLIDER_TIME,this.monsterColliderCheck(!0))}},__decorate([u],e)}(c.default));n.default=p,cc._RF.pop(),cc._RF.pop()},{}],SuperBulletPlant6:[function(t,e,a){"use strict";cc._RF.push(e,"63884ChJn5G6oBHYyHPt9nn","SuperBulletPlant6");var i=t,o=e,n=a;cc._RF.push(o,"36a2fSG2MlCcKpupLHDCV8v","SuperBulletPlant6"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("EventManager"),c=i("MathUtil"),l=i("GameEnum"),u=i("HomeEnum"),p=i("BattleDataProxy"),h=i("EnemyPathIce"),d=i("BulletBase"),m=i("BulletFire"),f=cc._decorator,_=f.ccclass,y=f.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mBulletFirePb=null,e._enemyPathIdx=0,e._firePathIdx=0,e._isCanMove=!0,e._continueTime=0,e._atkNum=0,e}return __extends(e,t),e.prototype.update=function(t){if((p.battleDataProxy.gameState==l.GameState.PLAYING||p.battleDataProxy.gameState==l.GameState.READY)&&this._isCanMove){var e=this._moveSpd*(t/(1/60)),a=this._atkPos,i=this.node.position.clone().sub(a.clone()).normalize();this.node.x-=e*i.x,this.node.y-=e*i.y,c.MathUtil.distance(this.node.position,a)<=e&&this.moveArrive()}},e.prototype.initBullet=function(){},e.prototype.initFixedPlantBullet=function(t,e,a){var i=this;this._continueTime=e,this._atkRate=a,this._atkNum=t,this.mSpAni.setCompleteListener(function(e){if("bomb"==(e.animation?e.animation.name:"")){p.battleDataProxy.enemyPathIce.forEach(function(t){var e;t&&t.isValid&&(null===(e=t.getComponent(h.default))||void 0===e||e.playIceSp())}),p.battleDataProxy.enemyPathIce=[],s.EventManager.instance.emit(l.EGameEvent.SCREEN_SHAKE);var a=cc.instantiate(i.mBulletFirePb);p.battleDataProxy.battleView.addChild(a,-500),a.position=i.node.position,a.getComponent(m.default).initBulletFire(i._firePathIdx,t,i._continueTime,i._atkRate),i.node.destroy(),i.node.removeFromParent()}})},e.prototype.initAtkPos=function(t){this._enemyPathIdx=t;var e=p.battleDataProxy.enemyMovePaths[1];1==this._enemyPathIdx?(this._atkPos=cc.v3(0,e[0].y),this._firePathIdx=0):2==this._enemyPathIdx?(this._atkPos=cc.v3(e[1].x,90),this._firePathIdx=1):(this._atkPos=cc.v3(0,e[2].y),this._firePathIdx=2)},e.prototype.moveArrive=function(){this._isCanMove=!1,this.node.zIndex=-this.node.y,this.mSpAni.paused=!1,r.AudioManager.instance.playEffectPath("sounds/plant12",u.Bundles.RES),this.mSpAni.setAnimation(0,"bomb",!1)},__decorate([y(cc.Prefab)],e.prototype,"mBulletFirePb",void 0),__decorate([_],e)}(d.default);n.default=g,cc._RF.pop(),cc._RF.pop()},{}],SuperBulletPlant7:[function(t,e,a){"use strict";cc._RF.push(e,"82f45LqUqFOs41AO9E2LQYk","SuperBulletPlant7");var i=t,o=e,n=a;cc._RF.push(o,"d968fwrXelLWJ5w+lm2r92D","SuperBulletPlant7"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("MathUtil"),s=i("GameEnum"),c=i("BattleDataProxy"),l=i("BulletBase"),u=cc._decorator,p=u.ccclass,h=(u.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initBullet=function(e,a,i,o){t.prototype.initBullet.call(this,e,a,i,o)},e.prototype.startMove=function(t){var e=this,a=r.MathUtil.distance(this.node.position,this._atkPos.clone())/(30*this._moveSpd),i=this._atkPos.clone();this.bezierTo(cc.v2(this.node.position),this.getC2(cc.v2(this.node.position),cc.v2(i)),cc.v2(i),a,!0,function(){e.addBulletHit(null),e.node.destroy(),e.node.removeFromParent(),t&&t()})},e.prototype.bezierTo=function(t,e,a,i,o,n,s,c){void 0===s&&(s=""),void 0===c&&(c=null),cc.Tween.stopAllByTarget(this.node),r.MathUtil.bezierTo(this.node,i,t,e,a,function(t,e){c&&c(t,e)},s).call(function(){n&&n()}).start()},e.prototype.getC2=function(t,e){var a=Math.abs(t.x-e.x),i=t.x>e.x?t.x-a/2:t.x+a/2,o=250*Math.random()+250;return t.y>e.y?cc.v2(i,t.y+o):cc.v2(i,e.y+o)},e.prototype.getPerpendicularVector=function(t,e){return cc.v2(-t.y,t.x).add(e)},e.prototype.update=function(){c.battleDataProxy.gameState==s.GameState.PLAYING||c.battleDataProxy.gameState==s.GameState.READY?this._isPauseGame&&(this._isPauseGame=!1,this.node.resumeAllActions()):this._isPauseGame||(this._isPauseGame=!0,this.node.pauseAllActions())},__decorate([p],e)}(l.default));n.default=h,cc._RF.pop(),cc._RF.pop()},{}],SuperBulletPlant9:[function(t,e,a){"use strict";cc._RF.push(e,"6679cRpOIVEu47YgfjC5AHZ","SuperBulletPlant9");var i=t,o=e,n=a;cc._RF.push(o,"643c3BXUxlHR6cuqXMXxrKF","SuperBulletPlant9"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("MathUtil"),s=i("GameEnum"),c=i("BattleDataProxy"),l=i("SkillDataMgr"),u=i("EnemyBase"),p=i("BulletBase"),h=i("BulletBoom"),d=cc._decorator,m=d.ccclass,f=d.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mBulletBoomPb=null,e._checkSdTime=0,e._movePaths=[],e._movePathIdx=0,e._atkEnemyNodes=[],e._isMoveBack=!1,e._moveDis=0,e}return __extends(e,t),e.prototype.initBullet=function(e,a,i,o){t.prototype.initBullet.call(this,e,a,i,o);for(var n=c.battleDataProxy.enemyMovePaths[1],r=n.length-1;r>=0;--r)this._movePaths.push(n[r]);this._moveDis=0,this._atkEnemyNodes=[],this._movePathIdx=1,this.node.position=this._movePaths[0].position,this._atkPos=this._movePaths[this._movePathIdx].position,this.node.angle=90,this._isMoveBack=!1,this.mSpAni.setAnimation(0,"roll",!0)},e.prototype.getIsCanAtk=function(t){for(var e=0;e<this._atkEnemyNodes.length;++e)if(this._atkEnemyNodes[e]==t)return!1;return!0},e.prototype.getMoveSpd=function(){return this._moveSpd/4*(1+l.default.instance.getSkillProperty(2,this._plantId))},e.prototype.setIsMoveBack=function(){var t;this._isMoveBack||this.node.x+this.node.height/2>=this.node.parent.width/2&&(this._isMoveBack=!0,this._movePaths=this._movePaths.reverse(),this._atkPos=(null===(t=this._movePaths[1])||void 0===t?void 0:t.position)||null,this._movePathIdx=1,this._moveDis=r.MathUtil.distance(this._movePaths[0].position,this.node.position),this.node.scaleY=1)},e.prototype.addBulletBoom=function(){var t=cc.instantiate(this.mBulletBoomPb);c.battleDataProxy.bulletView.addChild(t,1e3),t.position=this.node.position,t.getComponent(h.default).initBulletBoom();for(var e=c.battleDataProxy.enemyNodes.slice(),a=0;a<e.length;++a){var i=e[a];if(i&&i.isValid&&r.MathUtil.distance(i.position,this.node.position)<=150){var o=i.getComponent(u.default).monsterCfg,n=c.battleDataProxy.getBulletHarm(o.type,this._plantId,this._synthesisLv,this._atkCount,this._oneAtkTargetNum,this._atkRate,this._superRate);i.getComponent(u.default).beAttack(n,this._plantId)}}this.node.destroy(),this.node.removeFromParent()},e.prototype.checkIsBoom=function(){var t=c.battleDataProxy.getPlantAtkTargets(1,this._plantId,!1);t.length<=0?this.addBulletBoom():t[0].getComponent(u.default).moveDis+this.node.width/2<this._moveDis&&this.addBulletBoom()},e.prototype.update=function(t){var e;if(c.battleDataProxy.gameState==s.GameState.PLAYING||c.battleDataProxy.gameState==s.GameState.READY){var a=this.getMoveSpd()*(t/(1/60)),i=this._atkPos;if(!i)return console.log("\u76ee\u6807\u4ee5\u7ecf\u4e22\u5931"),this.node.destroy(),void this.node.removeFromParent();var o=this.node.position.clone().sub(i.clone()).normalize();if(this.node.x-=a*o.x,this.node.y-=a*o.y,this.setIsMoveBack(),r.MathUtil.distance(this.node.position,i)<=a){if(this._movePathIdx++,this._atkPos=(null===(e=this._movePaths[this._movePathIdx])||void 0===e?void 0:e.position)||null,!this._atkPos)return void this.addBulletBoom();2==this._movePathIdx?(this.node.angle=0,this._isMoveBack&&(this.node.scaleY=-1)):this._isMoveBack?(this.node.angle=-90,this.node.scaleY=1):(this.node.angle=90,this.node.scaleY=-1)}for(var n=c.battleDataProxy.enemyNodes.slice(),l=0;l<n.length;++l){var p=n[l];if(p&&p.isValid&&!(p.x>=cc.winSize.width/2)&&this.getIsCanAtk(p)&&r.MathUtil.distance(p.position,this.node.position)<=this.node.width){var h=p.getComponent(u.default).monsterCfg,d=c.battleDataProxy.getBulletHarm(h.type,this._plantId,this._synthesisLv,this._atkCount,this._oneAtkTargetNum,this._atkRate,this._superRate);p.getComponent(u.default).beAttack(d,this._plantId),this._atkEnemyNodes.push(p)}}this._isMoveBack&&(this._moveDis+=this.getMoveSpd(),this._checkSdTime+=t,this._checkSdTime>=.3&&(this._checkSdTime=0))}},__decorate([f(cc.Prefab)],e.prototype,"mBulletBoomPb",void 0),__decorate([m],e)}(p.default);n.default=_,cc._RF.pop(),cc._RF.pop()},{}],SuperEquipItem:[function(t,e,a){"use strict";cc._RF.push(e,"ae8cfK5r11BZqXGY6MaynOw","SuperEquipItem");var i=t,o=e,n=a;cc._RF.push(o,"73bd3cv7htFzp5wKrbNamus","SuperEquipItem"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("EquipmentItem"),s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),__decorate([c],e)}(r.default));n.default=l,cc._RF.pop(),cc._RF.pop()},{}],SuperPlantActive:[function(t,e,a){"use strict";cc._RF.push(e,"2d56ez+g21IApkWzJCOGwEG","SuperPlantActive");var i=e,o=a;cc._RF.push(i,"837d2Bd7rNAp7cQzY81J0ua","SuperPlantActive"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,r=n.ccclass,s=n.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mSpine=null,e}return __extends(e,t),e.prototype.onLoad=function(){var t=this;this.mSpine.setCompleteListener(function(){t.node.destroy(),t.node.removeFromParent()})},e.prototype.play=function(){this.mSpine.setAnimation(0,"shanguang",!1)},__decorate([s(sp.Skeleton)],e.prototype,"mSpine",void 0),__decorate([r],e)}(cc.Component);o.default=c,cc._RF.pop(),cc._RF.pop()},{}],SuperPlantMapItem:[function(t,e,a){"use strict";cc._RF.push(e,"8315e4xLnRF85w8okKbmlrc","SuperPlantMapItem");var i=t,o=e,n=a;cc._RF.push(o,"55efbanRcRDBZ7lfZfUkL4x","SuperPlantMapItem"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("ResUtil"),s=i("HomeEnum"),c=i("NodePoolManager"),l=i("BattleDataProxy"),u=i("PlacePlantEffect"),p=cc._decorator,h=p.ccclass,d=p.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mRoot=null,e.mNewStarNum=0,e.mSuperIsActive=!1,e._plantNum=0,e._plantItemPos=[],e}return __extends(e,t),e.prototype.init=function(){var t=this;this.mRoot.children.forEach(function(e){t._plantItemPos.push(e.position.clone()),e.active=!1});var e=l.battleDataProxy.getSuperPlantNum();this.initSuperPlantNum(e)},e.prototype.initSuperPlantNum=function(t){var e=this;this.mRoot.children.forEach(function(t){e._plantItemPos.push(t.position.clone()),t.active=!1});for(var a=0;a<t;++a){var i=this.mRoot.children[a];if(!i)break;i.scale=1,i.opacity=255,i.active=!0}},e.prototype.updateSuperPlantNum=function(t){var e=this,a=this.mRoot.children;if(this._plantNum==t)return t>=a.length;for(var i=0;i<t;++i){var o=this.mRoot.children[i];if(!o)break;o.scale=1,o.opacity=255,o.active=!0}if(!this.node.parent.active)return t>=a.length;if(this._plantNum>t&&t<this.mRoot.childrenCount){var n=this.mRoot.children[t];n&&(cc.Tween.stopAllByTarget(n),n.scale=1,n.opacity=255,n.position=this._plantItemPos[t],cc.tween(n).by(.6,{position:cc.v3(0,50),opacity:-255,scale:1}).call(function(){n.active=!1}).start())}else{var r=this.mRoot.children[t-1];r&&(cc.Tween.stopAllByTarget(r),r.active=!0,r.scale=7,r.opacity=100,r.position=this._plantItemPos[t-1],cc.tween(r).to(.2,{scale:1,opacity:255}).call(function(){e.addPlacePlantEffect(r.position)}).start())}return this._plantNum=t,t>=a.length},e.prototype.addPlacePlantEffect=function(t){var e=this;r.ResUtil.loadAsset({path:"prefabs/item/PlacePlantEffect",type:cc.Prefab,bundleName:s.Bundles.GAME}).then(function(a){var i=c.default.instance.getNode(a);e.node.addChild(i),i.position=t,i.getComponent(u.default).play()}).catch(function(t){console.log("error:",t)})},__decorate([d(cc.Node)],e.prototype,"mRoot",void 0),__decorate([h],e)}(cc.Component);n.default=m,cc._RF.pop(),cc._RF.pop()},{}],SuperPlantMapPopup:[function(t,e,a){"use strict";cc._RF.push(e,"ab1faBwA1FF/aWlb0UfKgFA","SuperPlantMapPopup");var i=t,o=e,n=a;cc._RF.push(o,"c0fe9XRN99O57M0xZ5RVQt6","SuperPlantMapPopup"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("List"),s=i("ResUtil"),c=i("PopupBase"),l=i("HomeEnum"),u=i("DataManager"),p=i("UserDataProxy"),h=i("Util"),d=cc._decorator,m=d.ccclass,f=d.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mMyList=null,e._plantDatas=[],e}return __extends(e,t),e.prototype.init=function(){var t=u.DataManager.instance.eData.dataplant;for(var e in t){var a=t[e];this._plantDatas.push(a)}},e.prototype.onShow=function(){this.mMyList.numItems=this._plantDatas.length},e.prototype.onUpdateItem=function(t,e){var a=this._plantDatas[e],i=this.getSuperPlantIsUnlock(a.id),o=t.getChildByName("bg2"),n=t.getChildByName("bg1"),r=t.getChildByName("plantImg"),c=t.getChildByName("plantName");n.active=!i,o.active=i,s.ResUtil.loadAsset({path:"textures/superBigImg/pic_CWplant"+a.id,type:cc.SpriteFrame,bundleName:l.Bundles.GAME}).then(function(t){r.getComponent(cc.Sprite).spriteFrame=t}).catch(function(t){console.log("error:",t)}),c.getComponent(cc.Label).string=i?a.name:"\u672a\u89e3\u9501",c.color=i?cc.color("#FFEC4A"):cc.color(125,125,125),c.getComponent(cc.LabelOutline).color=i?cc.color("#4D2A1E"):cc.color(75,75,75),i?h.default.setSpriteNormalMaterial(r.getComponent(cc.Sprite)):h.default.setSpriteGrayMaterial(r.getComponent(cc.Sprite))},e.prototype.getSuperPlantIsUnlock=function(t){return(p.userDataProxy.getPlantData(t).lv||0)>=this.getSuperUnlockLevel(t)},e.prototype.getSuperUnlockLevel=function(t){for(var e=u.DataManager.instance.eData.dataplant[t].skillId.split("|").map(Number),a=0;a<e.length;++a)if(e[a]%1e4==5)return a+1;return 5},__decorate([f(r.default)],e.prototype,"mMyList",void 0),__decorate([m],e)}(c.PopupBase);n.default=_,cc._RF.pop(),cc._RF.pop()},{}],TTSidebarPopup:[function(t,e,a){"use strict";cc._RF.push(e,"0e49cVoDqxIPL6m77+sFoqS","TTSidebarPopup");var i=t,o=a;cc._RF.push(i,"62c37NOy5dJQqH59NAJQQlW","TTSidebarPopup"),Object.defineProperty(o,"__esModule",{value:!0});var n=i("GameUIManager"),r=i("EventManager"),s=i("FlyItemAnimCtrl2"),c=i("AppProxy"),l=i("PopupBase"),u=i("HomeEnum"),p=i("DataManager"),h=i("UserDataProxy"),d=cc._decorator,m=d.ccclass,f=d.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mBtnReceive=null,e.mBtnTarget=null,e}return __extends(e,t),e.prototype.onDisable=function(){r.EventManager.instance.emit(u.EHomeEvent.handlePublicize),r.EventManager.instance.off(c.AppEvent.GAME_SHOW,this.initUI,this)},e.prototype.init=function(){console.log("TTSidebarPopup->init"),this.mBtnReceive.active=this.mBtnTarget.active=!1,r.EventManager.instance.on(c.AppEvent.GAME_SHOW,this.initUI,this),this.initUI()},e.prototype.initUI=function(){this.mBtnReceive.active=!1,this.mBtnTarget.active=!0,console.log("onGameShow isGetSideBarAward::",h.userDataProxy.userData.isGetSideBarAward),console.log("isSidebarCardInGameForTT::",p.DataManager.isSidebarCardInGameForTT),p.DataManager.isSidebarCardInGameForTT&&h.userDataProxy.userData.isGetSideBarAward<=0?(this.mBtnReceive.active=!0,this.mBtnTarget.active=!1):(this.mBtnReceive.active=!1,this.mBtnTarget.active=!0)},e.prototype.btnCallback=function(t,e){switch(e){case"btn_receive":if(h.userDataProxy.userData.isGetSideBarAward>0)return;p.DataManager.isSidebarCardInGameForTT=!1,h.userDataProxy.userData.isGetSideBarAward=1;for(var a=p.DataManager.instance.eData.datapara[54].num.split("|"),i=0;i<a.length;++i){var o=a[i].split("_").map(Number);if(2==o[0]){h.userDataProxy.changeDiamond(o[1]);var n="textures/item/icon_2",l=this.node.getChildByName("quality");this.getAward(o[1],l,n,s.E_ItemIDType.DIAMOND)}else 1==o[0]&&(h.userDataProxy.changeGold(o[1]),n="textures/item/icon_1",l=this.node.getChildByName("quality copy"),this.getAward(o[1],l,n,s.E_ItemIDType.GOLD))}r.EventManager.instance.emit(c.AppEvent.GET_SIDEBAR),this.removeUI();break;case"btn_to_target":cc.sys.platform==cc.sys.BYTEDANCE_GAME?tt.navigateToScene({scene:"sidebar",success:function(){console.log("navigate to scene success")},fail:function(t){console.log("navigate to scene fail: ",t)}}):cc.sys.isBrowser&&(p.DataManager.isSidebarCardInGameForTT=!0,r.EventManager.instance.emit(c.AppEvent.GAME_SHOW))}},e.prototype.getAward=function(t,e,a,i){var o=[{id:i,num:t}];n.gameUIMgr.showCongratsGettingPopup({list:o,type:1})},__decorate([f(cc.Node)],e.prototype,"mBtnReceive",void 0),__decorate([f(cc.Node)],e.prototype,"mBtnTarget",void 0),__decorate([m],e)}(l.PopupBase);o.default=_,cc._RF.pop(),cc._RF.pop()},{}],TestNode:[function(t,e,a){"use strict";cc._RF.push(e,"da6bdXmKOhAq7DTOwBpy3te","TestNode");var i=t,o=e,n=a;cc._RF.push(o,"556e6iiqRZCHbeGjMwtsIuy","TestNode"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("EventManager"),s=i("PopupBase"),c=i("GameEnum"),l=i("DataManager"),u=i("BattleDataProxy"),p=i("GameUIManager"),h=i("MapBlockItem"),d=i("MapGridItem"),m=cc._decorator,f=m.ccclass,_=m.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mSkillBox=null,e.mPlantBox=null,e.mEnemyEditBox=null,e.mFixedEditBox=null,e.mNameEditBox=null,e.mNowBallNum=null,e.mBlockHpLab=null,e.mDadLab=null,e}return __extends(e,t),e.prototype.onEnable=function(){u.battleDataProxy.gameState=c.GameState.PAUSE,this.mNowBallNum.string="\u5f53\u524d\u7403\u6570\uff1a"+u.battleDataProxy.bulletBalls.length,this.mBlockHpLab.string=u.battleDataProxy.testBlock?"\u7816\u5757\u6b63\u5e38\u8840":"\u7816\u57571\u6ef4\u8840",this.mDadLab.string=u.battleDataProxy.endlessIsDad?"\u53d6\u6d88\u65e0\u654c":"\u5f00\u542f\u65e0\u654c"},e.prototype.onDestroy=function(){u.battleDataProxy.isStartFight?u.battleDataProxy.gameState=c.GameState.PLAYING:u.battleDataProxy.gameState=c.GameState.READY},e.prototype.onAddSkillBtn=function(){if(""!=this.mSkillBox.string){var t=Number(this.mSkillBox.string);u.battleDataProxy.checkHasSkill(t)?p.gameUIMgr.showTips("\u6280\u80fd\u5df2\u6dfb\u52a0"):l.DataManager.instance.eData.dataskill[t]?(u.battleDataProxy.selectSkill(t,null),u.battleDataProxy.saveData(),p.gameUIMgr.showTips("\u6dfb\u52a0\u6210\u529f")):p.gameUIMgr.showTips("\u6ca1\u6709\u8fd9\u4e2a\u6280\u80fd\uff01")}else p.gameUIMgr.showTips("\u8bf7\u8f93\u5165\u6280\u80fdid")},e.prototype.onAddPlantBtn=function(){if(""!=this.mPlantBox.string){var t=this.mPlantBox.string.split("_").map(Number),e=t[0];if(l.DataManager.instance.eData.dataplant[e]){var a=t[1]?t[1]:1;a>5&&(a=5),r.EventManager.instance.emit(u.EBattleEvent.GM_ADD_EQUIP,{plantId:e,level:a})}else p.gameUIMgr.showTips("\u6ca1\u6709\u8fd9\u4e2a\u690d\u7269")}else p.gameUIMgr.showTips("\u8bf7\u8f93\u5165\u690d\u7269id\u548c\u7b49\u7ea7")},e.prototype.onAddEnemyBtn=function(){if(u.battleDataProxy.isEndless)p.gameUIMgr.showTips("\u65e0\u5c3d\u6a21\u5f0f\u65e0\u6cd5\u4f7f\u7528\u8fd9\u4e2a\u529f\u80fd");else if(""!=this.mEnemyEditBox.string)if(u.battleDataProxy.isStartFight){var t=Number(this.mEnemyEditBox.string);l.DataManager.instance.eData.datamonster[t]?(r.EventManager.instance.emit(u.EBattleEvent.GM_ADD_ENEMY,t),this.removeUI()):p.gameUIMgr.showTips("\u6ca1\u6709\u8fd9\u4e2a\u602a\u7269")}else p.gameUIMgr.showTips("\u5728\u6218\u6597\u4e2d\u624d\u80fd\u4f7f\u7528");else p.gameUIMgr.showTips("\u8bf7\u8f93\u5165\u602a\u7269id")},e.prototype.onAddFixedBtn=function(){if(""!=this.mFixedEditBox.string){var t=Number(this.mFixedEditBox.string),e=l.DataManager.instance.eData.datastagereward[t];e?""!=e.plant?(r.EventManager.instance.emit(u.EBattleEvent.GM_ADD_FIXEDPLANT,t),this.removeUI()):p.gameUIMgr.showTips("\u8fd9\u4e00\u5173\u6ca1\u6709\u56fa\u5b9a\u690d\u7269!"):p.gameUIMgr.showTips("\u8f93\u5165\u5173\u5361\u6709\u8bef!")}else p.gameUIMgr.showTips("\u8bf7\u8f93\u5165\u56fa\u5b9a\u690d\u7269\u7684\u5173\u5361")},e.prototype.onAddBallBtn=function(){var t=u.battleDataProxy.battleData.ballNum;t++,u.battleDataProxy.battleData.ballNum=t,r.EventManager.instance.emit(u.EBattleEvent.GM_ADD_BALL);var e=u.battleDataProxy.sunshineNum;u.battleDataProxy.sunshineNum=e,this.removeUI()},e.prototype.onBtnBlockHp=function(){u.battleDataProxy.testBlock=!u.battleDataProxy.testBlock,this.removeUI()},e.prototype.onBtnRemoveBlock=function(){for(var t=u.battleDataProxy.blockLayout.children,e=0;e<t.length;++e){var a=t[e].getComponent(h.default).holdGrid,i=u.battleDataProxy.gridsMap.get(a);i&&(i.getComponent(d.default).bValid=!0)}u.battleDataProxy.blockLayout.removeAllChildren(),this.removeUI()},e.prototype.onBtnDad=function(){yzll.gameConfig.isZB?p.gameUIMgr.showTips("\u4f60\u65e0\u6cd5\u4f7f\u7528\u8fd9\u4e2a\u529f\u80fd"):(u.battleDataProxy.endlessIsDad=!u.battleDataProxy.endlessIsDad,this.mDadLab.string=u.battleDataProxy.endlessIsDad?"\u53d6\u6d88\u65e0\u654c":"\u5f00\u542f\u65e0\u654c")},e.prototype.onUserNameBtn=function(){if(!yzll.gameConfig.isZB&&u.battleDataProxy.isEndless){var t=this.mNameEditBox.string;if(""!=t){var e=Number(t);e&&l.DataManager.instance.eData.dataendlessstage[e]?(u.battleDataProxy.endlessCurWave=e,r.EventManager.instance.emit(u.EBattleEvent.GM_SET_ENDLESS_WAVE),this.removeUI()):p.gameUIMgr.showTips("\u8f93\u5165\u6709\u8bef")}else p.gameUIMgr.showTips("\u8bf7\u8f93\u5165\u6ce2\u6570")}else p.gameUIMgr.showTips("\u4f60\u65e0\u6cd5\u4f7f\u7528\u8fd9\u4e2a\u529f\u80fd")},__decorate([_(cc.EditBox)],e.prototype,"mSkillBox",void 0),__decorate([_(cc.EditBox)],e.prototype,"mPlantBox",void 0),__decorate([_(cc.EditBox)],e.prototype,"mEnemyEditBox",void 0),__decorate([_(cc.EditBox)],e.prototype,"mFixedEditBox",void 0),__decorate([_(cc.EditBox)],e.prototype,"mNameEditBox",void 0),__decorate([_(cc.Label)],e.prototype,"mNowBallNum",void 0),__decorate([_(cc.Label)],e.prototype,"mBlockHpLab",void 0),__decorate([_(cc.Label)],e.prototype,"mDadLab",void 0),__decorate([f],e)}(s.PopupBase);n.default=y,cc._RF.pop(),cc._RF.pop()},{}],TestPopup:[function(t,e,a){"use strict";cc._RF.push(e,"8b9ddtgjI9JgaK6YNPgy2DS","TestPopup");var i=t,o=e,n=a;cc._RF.push(o,"0dbc9MOajVCY5AXSh6nosuX","TestPopup"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("EventManager"),s=i("PopupBase"),c=i("SceneManager"),l=i("HomeEnum"),u=i("DataManager"),p=i("BattleDataProxy"),h=i("UserDataProxy"),d=i("GameUIManager"),m=cc._decorator,f=m.ccclass,_=m.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.propIdEditBox=null,e.propNumEditBox=null,e.levelEditBox=null,e.weatherlEditBox=null,e.mChapterEditBox=null,e.mWaveEditBox=null,e}return __extends(e,t),e.prototype.init=function(){},e.prototype.onAddProp=function(){var t=Number(this.propIdEditBox.string),e=Number(this.propNumEditBox.string);t&&e?(h.userDataProxy.addProp(t,e),d.gameUIMgr.showTips("\u6dfb\u52a0\u6210\u529f\uff01")):d.gameUIMgr.showTips("\u53c2\u6570\u9519\u8bef\uff01")},e.prototype.onSaveLevel=function(){if(cc.sys.isBrowser&&yzll.gameConfig.isZB&&!h.userDataProxy.userData.startGameRights)d.gameUIMgr.showTips("\u8bf7\u5148\u4f7f\u7528\u5151\u6362\u7801\u6fc0\u6d3b\u6e38\u620f~");else{var t=Number(this.levelEditBox.string),e=u.DataManager.instance.eData.datastagereward,a=0;for(var i in e)a=e[i].id;t>0&&t<a?(h.userDataProxy.userData.passChapter=t,h.userDataProxy.userData.curChapter=t+1,h.userDataProxy.saveData(),c.SceneManager.instance.runScene("Home","",function(){})):d.gameUIMgr.showTips("\u53c2\u6570\u9519\u8bef\uff01")}},e.prototype.onRemoveUser=function(){h.userDataProxy.mIsChangeVersion=!0,u.DataManager.instance.cleanGameDataBase(),this.removeUI()},e.prototype.onChapterClick=function(){if(""!=this.mChapterEditBox.string)if(""!=this.mWaveEditBox.string){var t=Number(this.mChapterEditBox.string);if(1==h.userDataProxy.userData.gameModel){if(t>h.userDataProxy.userData.passChapter+1)return void d.gameUIMgr.showTips("\u5173\u5361\u8fd8\u672a\u89e3\u9501");var e=u.DataManager.instance.eData.datastagereward,a=0;for(var i in e)a=e[i].id;if(t>a||t<=0)return void d.gameUIMgr.showTips("\u7b56\u5212\u6700\u5927\u5173\u5361\u53ea\u914d\u7f6e\u4e86"+a)}else{if(t>h.userDataProxy.userData.passWeatherChapter+1)return void d.gameUIMgr.showTips("\u5173\u5361\u8fd8\u672a\u89e3\u9501");if(t>6||t<=0)return void d.gameUIMgr.showTips("\u7b56\u5212\u6700\u5927\u5173\u5361\u53ea\u914d\u7f6e\u4e866")}if(cc.sys.isBrowser&&yzll.gameConfig.isZB&&!h.userDataProxy.userData.startGameRights)d.gameUIMgr.showTips("\u8bf7\u5148\u4f7f\u7528\u5151\u6362\u7801\u6fc0\u6d3b\u6e38\u620f~");else{var o=20;if(1==h.userDataProxy.userData.gameModel){var n=u.DataManager.instance.eData.datastagereward[t];o=Number(n.wave)}var r=Number(this.mWaveEditBox.string);if(r>o||r<=0)d.gameUIMgr.showTips("\u8f93\u5165\u7684\u5173\u5361\u6700\u5927\u6ce2\u6570\u53ea\u6709"+o);else{if(2==h.userDataProxy.userData.gameModel){h.userDataProxy.userData.cursWeatherChapter=t,h.userDataProxy.userData.curWeatherWave=r;var s=u.DataManager.instance.eData.data_weather[t];p.battleDataProxy.weatherType=s.weather}else h.userDataProxy.userData.curChapter=t,h.userDataProxy.userData.curWave=r;c.SceneManager.instance.runScene("Game","",function(){}),this.removeUI()}}}else d.gameUIMgr.showTips("\u8bf7\u8f93\u5165\u5173\u5361\u6ce2\u6570");else d.gameUIMgr.showTips("\u8bf7\u8f93\u5165\u5173\u5361id")},e.prototype.onVersionA=function(){u.DataManager.instance.userVersion="a",u.DataManager.instance.switchConfig(),r.EventManager.instance.emit(l.EHomeEvent.CHANGE_CONFIG_NOTIFY)},e.prototype.onVersionB=function(){u.DataManager.instance.userVersion="b",u.DataManager.instance.switchConfig(),r.EventManager.instance.emit(l.EHomeEvent.CHANGE_CONFIG_NOTIFY)},e.prototype.onVersionD=function(){u.DataManager.instance.userVersion="d",u.DataManager.instance.switchConfig(),r.EventManager.instance.emit(l.EHomeEvent.CHANGE_CONFIG_NOTIFY)},e.prototype.onBtnNextDay=function(){h.userDataProxy.newDataReset(),this.removeUI()},e.prototype.onBtnChapterWeather=function(){if(cc.sys.isBrowser&&yzll.gameConfig.isZB&&!h.userDataProxy.userData.startGameRights)d.gameUIMgr.showTips("\u8bf7\u5148\u4f7f\u7528\u5151\u6362\u7801\u6fc0\u6d3b\u6e38\u620f~");else{var t=this.weatherlEditBox.string;if(""!=t){var e=Number(t),a=u.DataManager.instance.eData.data_weather,i=0;for(var o in a)i=a[o].id;e>0&&e<i?(h.userDataProxy.userData.passWeatherChapter=e,h.userDataProxy.userData.cursWeatherChapter=e+1,h.userDataProxy.saveData(),c.SceneManager.instance.runScene("Home","",function(){})):d.gameUIMgr.showTips("\u53c2\u6570\u9519\u8bef\uff01")}else d.gameUIMgr.showTips("\u8bf7\u8f93\u5165\u8981\u901a\u8fc7\u7684\u7ae0\u8282")}},__decorate([_(cc.EditBox)],e.prototype,"propIdEditBox",void 0),__decorate([_(cc.EditBox)],e.prototype,"propNumEditBox",void 0),__decorate([_(cc.EditBox)],e.prototype,"levelEditBox",void 0),__decorate([_(cc.EditBox)],e.prototype,"weatherlEditBox",void 0),__decorate([_(cc.EditBox)],e.prototype,"mChapterEditBox",void 0),__decorate([_(cc.EditBox)],e.prototype,"mWaveEditBox",void 0),__decorate([f],e)}(s.PopupBase);n.default=y,cc._RF.pop(),cc._RF.pop()},{}],TimeUtil:[function(t,e,a){"use strict";cc._RF.push(e,"16c771OgfJEQ4zpZkl+5b3k","TimeUtil");var i=e,o=a;cc._RF.push(i,"b62daBY0P1GipTVXXROh2Vs","TimeUtil"),Object.defineProperty(o,"__esModule",{value:!0}),o.TimeUtil=o.DAY_TIMESTAMPS=o.HOUR_TIMESTAMPS=o.MINUTE_TIMESTAMPS=o.SECOND_TIMESTAMPS=void 0,o.SECOND_TIMESTAMPS=1e3,o.MINUTE_TIMESTAMPS=60*o.SECOND_TIMESTAMPS,o.HOUR_TIMESTAMPS=60*o.MINUTE_TIMESTAMPS,o.DAY_TIMESTAMPS=24*o.HOUR_TIMESTAMPS;var n=function(){function t(){}return Object.defineProperty(t,"useLocalDate",{set:function(t){this._useLocalDate=t},enumerable:!1,configurable:!0}),t.updateServerTime=function(t){this._useLocalDate||(this._diff=t-(new Date).getTime(),t||0!==this._updateTime?this._updateTime=t:this._updateTime=(new Date).getTime())},t.getTime=function(){return this._useLocalDate||0===this._updateTime?(new Date).getTime():(new Date).getTime()+this._diff},t.getDate=function(){return this._useLocalDate?new Date:new Date(this.getTime())},t.getDayStartTime=function(t){return new Date(t).setHours(0,0,0,0)},t.getDayEndTime=function(t){return new Date(t).setHours(23,59,59,999)},t.getWeekEndTime=function(t){var e=new Date(t).getDay();return this.getDayEndTime(t)+(0===e?0:(7-e)*o.DAY_TIMESTAMPS)},t.getMonthEndTime=function(t){var e=new Date(t);return 11===e.getMonth()?e.setFullYear(e.getFullYear()+1,0,0):e.setMonth(e.getMonth()+1,0),e.setHours(23,59,59,999)},t.isSameDay=function(t,e){return this.getDayStartTime(t)===this.getDayStartTime(e)},t.getDiffDayNum=function(t,e){var a=this.getDayStartTime(t),i=this.getDayStartTime(e);return Math.ceil(Math.abs(a-i)/o.DAY_TIMESTAMPS)},t.getDaysBetweenTimestamps=function(t,e){if("number"!=typeof t||"number"!=typeof e)throw new Error("\u8f93\u5165\u53c2\u6570\u5fc5\u987b\u4e3a\u6570\u5b57");var a=Math.abs(t-e);return Math.floor(a/864e5)},t.getCalendarDaysBetweenTimestamps=function(t,e){if("number"!=typeof t||"number"!=typeof e)throw new Error("\u8f93\u5165\u53c2\u6570\u5fc5\u987b\u4e3a\u6570\u5b57");var a=new Date(t);a.setHours(0,0,0,0);var i=new Date(e);i.setHours(0,0,0,0);var o=Math.abs(a.getTime()-i.getTime());return Math.ceil(o/864e5)},t.format=function(t){for(var e=[],a=1;a<arguments.length;a++)e[a-1]=arguments[a];for(var i=1;i<arguments.length;i++){var o="",r=!1,s=" ",c=256,l=(t=t.replace(/%%/g,"%$")).match(/%(?!\$)-?0?[0-9]*\.?[0-9]*[adfgs]/);if(!l||!(l=l[0]))break;"-"==(l=l.substr(1)).charAt(0)&&(r=!0,l=l.substr(1)),"0"==l.charAt(0)&&(s="0",l=l.substr(1));var u=l.split(/[\.adfgs]/);u.length>2?(c=parseInt(u[0]),parseInt(u[1])):u.length>1&&(c=parseInt(u[0]));var p=function(t){return t.length>c?t=r?t.substr(0,c):t.substr(-c):r?t+=n(s,c-t.length):t=n(s,c-t.length)+t,t};switch(l.charAt(l.length-1)){case"d":case"f":o=p(parseInt(arguments[i])+"");break;case"s":o=arguments[i]?p(arguments[i].toString()):""}t=t.replace(/%(?!\$)-?0?[0-9]*\.?[0-9]*[adfgs]/,o)}return t.replace(/%\$/g,"%")},t.formatMillisecond=function(t,e){var a=Math.floor(t/864e5);t-=864e5*a;var i=Math.floor(t/36e5);t-=36e5*i;var o=Math.floor(t/6e4);t-=6e4*o;var n=Math.floor(t/1e3);return(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/%%/g,"%$")).replace(/%d/g,a)).replace(/%0h/g,this.format("%02d",i))).replace(/%h/g,i)).replace(/%0m/g,this.format("%02d",o))).replace(/%m/g,o)).replace(/%0s/g,this.format("%02d",n))).replace(/%s/g,n)).replace(/%\$/g,"%")},t.format_HHMMSS=function(t){var e=Math.floor(t/1e3);return(Array(2).join("0")+Math.floor(e/3600)).slice(-2)+":"+(Array(2).join("0")+Math.floor(e%3600/60)).slice(-2)+":"+(Array(2).join("0")+Math.floor(e)%60).slice(-2)},t.format_HHMM=function(t){var e=Math.floor(t/1e3);return(Array(2).join("0")+Math.floor(e/3600)).slice(-2)+":"+(Array(2).join("0")+Math.floor(e%3600/60)).slice(-2)},t.format_MMSS=function(t){var e=Math.floor(t/1e3);return(Array(2).join("0")+Math.floor(e/60)).slice(-2)+":"+(Array(2).join("0")+Math.floor(e)%60).slice(-2)},t.getTomorrowZeroDate=function(){var t=new Date(this.getTime());return t.setDate(t.getDate()+1),t.setHours(0),t.setMinutes(0),t.setSeconds(0),t},t.getNextMonthZeroDate=function(){var t=new Date(this.getTime());return t.setMonth(t.getMonth()+1),t.setDate(1),t.setHours(0),t.setMinutes(0),t.setSeconds(0),t},t.getNextMondayDate=function(){var t=new Date;t.setHours(0),t.setMinutes(0),t.setSeconds(0);var e=(t.getDay()||7)-7;return new Date(t.getTime()-864e5*(e-1))},t._diff=0,t._updateTime=0,t._useLocalDate=!1,t}();o.TimeUtil=n,cc._RF.pop(),cc._RF.pop()},{}],TimerManager:[function(t,e,a){"use strict";cc._RF.push(e,"0583eTR6/9Oz4fEnVHWze3p","TimerManager");var i=t,o=e,n=a;cc._RF.push(o,"74d43FmcqtG3Zjc+41KvJQk","TimerManager"),Object.defineProperty(n,"__esModule",{value:!0}),n.TimerManager=void 0;var r=i("Logger"),s=function(){this.interval=0,this.dt=0,this.repeat=0,this.callback=null,this.pause=!1,this.check=!0},c=function(){function t(){this._timer=[],this._pause=!1,cc.director.on(cc.Director.EVENT_AFTER_UPDATE,this._update,this)}return Object.defineProperty(t,"instance",{get:function(){return null==this._instance&&(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t.prototype.hasSchedule=function(t){return null!=this._timer.find(function(e){return e.callback===t})},t.prototype.scheduleOnce=function(t,e,a){void 0===a&&(a=0);var i=this._timer.find(function(e){return e.callback===t});i||(i=new s,this._timer.push(i),i.callback=t),i.target=e,i.repeat=1,i.dt=a,i.check=e instanceof cc.Component},t.prototype.schedule=function(t,e,a,i,o){void 0===a&&(a=0),void 0===i&&(i=0),void 0===o&&(o=0);var n=this._timer.findIndex(function(e){return e.callback===t}),r=this._timer[n];if(-1===n){if(1==i&&a+o<0)return void(null==t||t.call(e));r=new s,this._timer.push(r),r.callback=t}r.target=e,r.interval=a,r.repeat=i,r.dt=a+o,r.check=e instanceof cc.Component,r.dt<0&&this.runTimer(r,n)},t.prototype.pause=function(t){var e=this._timer.find(function(e){return e.callback===t});e?e.pause=!0:r.Logger.warn("\u8be5\u5b9a\u65f6\u5668\u4e0d\u5b58\u5728\u6216\u5df2\u9500\u6bc1")},t.prototype.pauseAll=function(){this._pause=!0},t.prototype.resume=function(t){var e=this._timer.find(function(e){return e.callback===t});e?e.pause=!1:r.Logger.warn("\u8be5\u5b9a\u65f6\u5668\u4e0d\u5b58\u5728\u6216\u5df2\u9500\u6bc1")},t.prototype.resumeAll=function(){this._pause=!1},t.prototype.unschedule=function(t){var e=this._timer.findIndex(function(e){return e.callback===t});-1!==e?this._timer.splice(e,1):r.Logger.warn("\u8be5\u5b9a\u65f6\u5668\u4e0d\u5b58\u5728\u6216\u5df2\u9500\u6bc1")},t.prototype.unscheduleAll=function(){this._timer.length=0},t.prototype._update=function(){var t;if(!this._pause){var e=this._timer.length;if(0!==e)for(var a=cc.director.getDeltaTime(),i=null,o=e-1;o>=0;o--)!(i=this._timer[o]).check||(null===(t=i.target)||void 0===t?void 0:t.node)?i.pause||(i.dt-=a,i.dt<=0&&this.runTimer(i,o)):this._timer.splice(o,1)}},t.prototype.runTimer=function(t,e){var a,i;if(1===t.repeat)return this._timer.splice(e,1),void(null===(a=t.callback)||void 0===a||a.call(t.target));null===(i=t.callback)||void 0===i||i.call(t.target),t.dt=t.interval,0!==t.repeat&&t.repeat--},t._instance=null,t}();n.TimerManager=c,cc._RF.pop(),cc._RF.pop()},{}],Tips:[function(t,e,a){"use strict";cc._RF.push(e,"264a6iC8wVElaBzkFYL89eK","Tips");var i=t,o=e,n=a;cc._RF.push(o,"66d13iQnPRG9o0EkMA8iDV/","Tips"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("ComponentBase"),s=i("Queue"),c=cc._decorator,l=c.ccclass,u=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nView=null,e.nTipsItem=null,e.queue=new s.default,e.itemPool=null,e}return __extends(e,t),e.prototype.onLoad=function(){this.queue=new s.default,this.itemPool=new cc.NodePool},e.prototype.pushTips=function(t){var e=this;if(e.queue||(e.queue=new s.default),!(e.queue.size()>5)){e.node.zIndex=cc.macro.MAX_ZINDEX;var a=null;a=this.itemPool.size()<=0?cc.instantiate(e.nTipsItem):this.itemPool.get(),e.nView.addChild(a),a.active=!0;var i=a.getChildByName("Desc").getComponent(cc.RichText),o=a.getChildByName("Bg");i&&(i.string="<outline color = #000000>"+t+"</outline>",this.scheduleOnce(function(){o.width=(i.node.width+80)*i.node.scaleX,e.queue.enqueue(a),e.openAnim(a)},.02))}},e.prototype.openAnim=function(t){var e=this,a=this;t.scale=2,t.opacity=255,t.active=!0,cc.tween(t).to(.4,{scale:1.5},{easing:"circOut"}).delay(1).to(.3,{scale:1,opacity:0}).call(function(){var t=a.queue.dequeue();t.active=!1,e.itemPool.put(t)}).start()},__decorate([u(cc.Node)],e.prototype,"nView",void 0),__decorate([u(cc.Node)],e.prototype,"nTipsItem",void 0),__decorate([l],e)}(r.ComponentBase);n.default=p,cc._RF.pop(),cc._RF.pop()},{}],Toast:[function(t,e,a){"use strict";cc._RF.push(e,"ba935tIn7dKRLYJXgAEArEH","Toast");var i=t,o=e,n=a;cc._RF.push(o,"063114sEE9Et7KcqlTlnmX/","Toast"),Object.defineProperty(n,"__esModule",{value:!0}),n.Toast=void 0;var r=i("AppBase"),s=function(){function t(){this._bgColor=cc.color(255,255,255,180),this._textColor=cc.color(0,0,0,255),this._fontSize=30,this.bgNode=null,this.duration=0,this.textNode=null}return t.makeText=function(e,a,i){null==e&&(null==this.parentNode&&(this.parentNode=new cc.Node("Toast"),this.parentNode.width=r.rootNode.width,this.parentNode.height=r.rootNode.height,r.rootNode.addChild(this.parentNode,999)),e=this.parentNode);var o=new t;return o.duration=i,o.init(e,a),o},t.prototype.setFontSize=function(t){return this._fontSize=t,this.textNode.getComponent(cc.Label).fontSize=t,this},t.prototype.setBgColor=function(t){return this._bgColor=t,this.bgNode.color=this._bgColor,this},t.prototype.setTextColor=function(t){return this._textColor=t,this.textNode.color=this._textColor,this},t.prototype.setGravity=function(e){return e==t.CENTER?this.bgNode.y=0:e==t.TOP?this.bgNode.y=this.bgNode.parent.height/5*2:e==t.BOTTOM&&(this.bgNode.y=-this.bgNode.parent.height/5*2),this},t.prototype.show=function(){return this.bgNode.opacity=255,cc.tween(this.bgNode).by(this.duration/2,{x:0,y:0}).to(this.duration/2,{opacity:0}).call(function(t){t.destroy()}).start(),this},t.prototype.init=function(t,e){var a=t.width;this.bgNode=new cc.Node,this.textNode=new cc.Node,this.textNode.color=this._textColor;var i=this.textNode.addComponent(cc.Label);i.horizontalAlign=cc.Label.HorizontalAlign.CENTER,i.verticalAlign=cc.Label.VerticalAlign.CENTER,i.fontSize=this._fontSize,i.string=e,e.length*i.fontSize>3*a/5?(this.textNode.width=3*a/5,i.overflow=cc.Label.Overflow.RESIZE_HEIGHT):this.textNode.width=e.length*i.fontSize;var o=1+~~(e.length*i.fontSize/(3*a/5));this.textNode.height=i.fontSize*o;var n=this.bgNode.addComponent(cc.Graphics);n.arc(-this.textNode.width/2,0,this.textNode.height/2+20,.5*Math.PI,1.5*Math.PI,!0),n.lineTo(this.textNode.width/2,-(this.textNode.height/2+20)),n.arc(this.textNode.width/2,0,this.textNode.height/2+20,1.5*Math.PI,.5*Math.PI,!0),n.lineTo(-this.textNode.width/2,this.textNode.height/2+20),n.fillColor=this._bgColor,n.fill(),this.textNode.parent=this.bgNode,this.bgNode.opacity=0,this.bgNode.parent=t},t.CENTER=0,t.TOP=1,t.BOTTOM=2,t.LENGTH_SHORT=2,t.LENGTH_LONG=3.5,t.parentNode=null,t}();n.Toast=s,cc._RF.pop(),cc._RF.pop()},{}],TortWarningPopup:[function(t,e,a){"use strict";cc._RF.push(e,"11fc3ypHYVNPL/DINMvv8pU","TortWarningPopup");var i=t,o=e,n=a;cc._RF.push(o,"502d5A53HxLEoXLRgHhK2Xv","TortWarningPopup"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("PopupBase"),s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),__decorate([c],e)}(r.PopupBase));n.default=l,cc._RF.pop(),cc._RF.pop()},{}],TouchBlocker:[function(t,e,a){"use strict";cc._RF.push(e,"30336ZVF1RB4KegO/lQGV8q","TouchBlocker");var i=e,o=a;cc._RF.push(i,"97c7b9DL/9IEZM34Xit6+Mm","TouchBlocker"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,r=n.ccclass,s=n.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.target=null,e.isBlockAll=!1,e.isPassAll=!1,e.clickEvent=null,e.clickEventCaller=null,e}return __extends(e,t),e.prototype.onLoad=function(){this.registerEvent()},e.prototype.start=function(){this.reset()},e.prototype.onDestroy=function(){this.unregisterEvent()},e.prototype.registerEvent=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchEvent,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchEvent,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEvent,this)},e.prototype.unregisterEvent=function(){this.node.targetOff(this)},e.prototype.reset=function(){this.setSwallowTouches(!1)},e.prototype.onTouchEvent=function(t){var e=this;if(e.isPassAll)e.target&&e.target.activeInHierarchy&&e.target.getBoundingBoxToWorld().contains(t.getLocation())&&t.type==cc.Node.EventType.TOUCH_END&&e.clickEvent&&e.clickEvent.call(e.clickEventCaller);else{if(e.isBlockAll)return null==this.target&&t.type==cc.Node.EventType.TOUCH_END?void(e.clickEvent&&e.clickEvent.call(e.clickEventCaller)):void t.stopPropagationImmediate();e.target&&e.target.activeInHierarchy?e.target.getBoundingBoxToWorld().contains(t.getLocation())?t.type==cc.Node.EventType.TOUCH_END&&e.clickEvent&&e.clickEvent.call(e.clickEventCaller):t.stopPropagationImmediate():this.node.active=!1}},e.prototype.blockAll=function(){this.isBlockAll=!0,this.isPassAll=!1},e.prototype.passAll=function(){this.isPassAll=!0,this.isBlockAll=!1},e.prototype.setTarget=function(t){this.target=t,this.isBlockAll=!1,this.isPassAll=!1},e.prototype.setSwallowTouches=function(t){var e=this.node;e._touchListener&&e._touchListener.setSwallowTouches(t)},e.prototype.setClickTargetEvent=function(t,e){this.clickEvent=t,this.clickEventCaller=e},__decorate([s({type:cc.Node,tooltip:!1})],e.prototype,"target",void 0),__decorate([r],e)}(cc.Component);o.default=c,cc._RF.pop(),cc._RF.pop()},{}],TypeUtil:[function(t,e,a){"use strict";cc._RF.push(e,"a1f0bLaKWxDN60LL1IC8LEL","TypeUtil");var i=e,o=a,n=t("./helpers/typeof");cc._RF.push(i,"f7a0cyzNmRHXIPlSIGs+Zb+","TypeUtil"),Object.defineProperty(o,"__esModule",{value:!0}),o.TypeUtil=void 0,function(t){t.isString=function(t){return"[object String]"===Object.prototype.toString.call(t)},t.isNumber=function(t){return"[object Number]"===Object.prototype.toString.call(t)},t.isBoolean=function(t){return"[object Boolean]"===Object.prototype.toString.call(t)},t.isFunction=function(t){return"[object Function]"===Object.prototype.toString.call(t)},t.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)},t.isDate=function(t){return"[object Date]"===Object.prototype.toString.call(t)},t.isRegExp=function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},t.isNull=function(t){return null===t},t.isUndefined=function(t){return void 0===t},t.isObject=function(t){return"object"==n(t)}}(o.TypeUtil||(o.TypeUtil={})),cc._RF.pop(),cc._RF.pop()},{"./helpers/typeof":"typeof"}],UIReport:[function(t,e,a){"use strict";cc._RF.push(e,"084d2gmvQFEopWBPyPgd0Jh","UIReport");var i=t,o=e,n=a;cc._RF.push(o,"5aee2+4pjVNa6KzAAOV3NPS","UIReport");var r=i("PopupBase"),s=cc._decorator,c=s.ccclass,l=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.root=null,e.btnClose=null,e.btnPublicity=null,e.btnDataloss=null,e.btnGameStuck=null,e.btnunableAD=null,e.btnRender=null,e.tips=null,e.editBox=null,e.Rendernum=0,e}return __extends(e,t),e.prototype.start=function(){this.initEvent()},e.prototype.initEvent=function(){var t=this;this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){t.removeUI()},this),this.btnPublicity.on(cc.Node.EventType.TOUCH_END,function(){t.btnPublicity.children[0].active=!t.btnPublicity.children[0].active,t.Radio(1),t.canRender()},this),this.btnDataloss.on(cc.Node.EventType.TOUCH_END,function(){t.btnDataloss.children[0].active=!t.btnDataloss.children[0].active,t.Radio(2),t.canRender()},this),this.btnGameStuck.on(cc.Node.EventType.TOUCH_END,function(){t.btnGameStuck.children[0].active=!t.btnGameStuck.children[0].active,t.Radio(3),t.canRender()},this),this.btnunableAD.on(cc.Node.EventType.TOUCH_END,function(){t.btnunableAD.children[0].active=!t.btnunableAD.children[0].active,t.Radio(4),t.canRender()},this),this.btnRender.on(cc.Node.EventType.TOUCH_END,function(){t.Render()},this)},e.prototype.canRender=function(){this.btnPublicity.children[0].active||this.btnDataloss.children[0].active||this.btnGameStuck.children[0].active||this.btnunableAD.children[0].active?this.btnRender.active=!0:this.btnRender.active=!1},e.prototype.Radio=function(t){for(var e=1;e<5;e++)e!=t&&(this.root.children[e].children[0].active=!1)},e.prototype.Render=function(){for(var t=1;t<5;t++)this.root.children[t].children[0].active&&(this.root.children[t].children[0].active=!1,this.btnRender.active=!1);this.tips.active=!0,cc.tween(this.tips).to(1,{y:143.079}).start(),this.scheduleOnce(this.removeUI,1)},__decorate([l(cc.Node)],e.prototype,"root",void 0),__decorate([l(cc.Node)],e.prototype,"btnClose",void 0),__decorate([l(cc.Node)],e.prototype,"btnPublicity",void 0),__decorate([l(cc.Node)],e.prototype,"btnDataloss",void 0),__decorate([l(cc.Node)],e.prototype,"btnGameStuck",void 0),__decorate([l(cc.Node)],e.prototype,"btnunableAD",void 0),__decorate([l(cc.Node)],e.prototype,"btnRender",void 0),__decorate([l(cc.Node)],e.prototype,"tips",void 0),__decorate([l(cc.EditBox)],e.prototype,"editBox",void 0),__decorate([c],e)}(r.PopupBase);n.default=u,cc._RF.pop(),cc._RF.pop()},{}],UniformScale:[function(t,e,a){"use strict";cc._RF.push(e,"2aa2dyl0/5PEYEvxCnLlHXo","UniformScale");var i=e,o=a;cc._RF.push(i,"af38foZgIxE7qspv0203S61","UniformScale"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,r=n.ccclass,s=(n.property,n.menu),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onLoad=function(){this.node.scale=cc.view.getVisibleSize().width/this.node.width},__decorate([r,s("\u81ea\u5b9a\u4e49\u7ec4\u4ef6/\u7b49\u6bd4\u9002\u914d")],e)}(cc.Component);o.default=c,cc._RF.pop(),cc._RF.pop()},{}],UnlockNewPlantPopup:[function(t,e,a){"use strict";cc._RF.push(e,"71741WDVY5KmLsTktJzrEYk","UnlockNewPlantPopup");var i=t,o=e,n=a;cc._RF.push(o,"33bae7PuIFHJo0NDieam40j","UnlockNewPlantPopup"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("PopupBase"),c=i("HomeEnum"),l=i("DataManager"),u=i("UserDataProxy"),p=cc._decorator,h=p.ccclass,d=p.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mPlantSpine=null,e.mPlantName=null,e.mBtnClose=null,e._plantId=0,e._closeFunc=null,e}return __extends(e,t),e.prototype.init=function(t){var e=this;this._closeFunc=t.closeFunc,this.mPlantSpine.setCompleteListener(function(t){var a=t.animation?t.animation.name:"";"1"==a?(e.mBtnClose.active=!0,e.mPlantSpine.setAnimation(0,"2",!0)):"3"==a&&(u.userDataProxy.mNewUnlockPlantIds.length<=0?(e.node.destroy(),e.node.removeFromParent(),e._closeFunc&&e._closeFunc()):(e.setPlantInfo(),e.playSpine()))}),this.setPlantInfo()},e.prototype.setPlantInfo=function(){this._plantId=u.userDataProxy.mNewUnlockPlantIds[0];var t=l.DataManager.instance.eData.dataplant[this._plantId];this.mPlantName.node.active=!0,this.mPlantName.string=t.name,this.mBtnClose.active=!1,this.mPlantSpine.node.active=!1,u.userDataProxy.mNewUnlockPlantIds.splice(0,1)},e.prototype.playSpine=function(){this.mPlantSpine.node.active=!0,this.mPlantSpine.setSkin("plant"+this._plantId),this.mPlantSpine.setAnimation(0,"1",!1)},e.prototype.onShow=function(){this.playSpine(),r.AudioManager.instance.playEffectPath("sounds/getPlant",c.Bundles.RES)},e.prototype.onBtnClose=function(){this.mBtnClose.active=!1,this.mPlantName.node.active=!1,this.mPlantSpine.setAnimation(0,"3",!1)},__decorate([d(sp.Skeleton)],e.prototype,"mPlantSpine",void 0),__decorate([d(cc.Label)],e.prototype,"mPlantName",void 0),__decorate([d(cc.Node)],e.prototype,"mBtnClose",void 0),__decorate([h],e)}(s.PopupBase);n.default=m,cc._RF.pop(),cc._RF.pop()},{}],UserCenterManager:[function(t,e,a){"use strict";cc._RF.push(e,"ba492XESQlKgp9XrZ4CPsu6","UserCenterManager");var i=t,o=e,n=a;cc._RF.push(o,"ca0bd3TkP5Bi6Ccg7v3aZY+","UserCenterManager");var r=function(t,e,a,i){return new(a||(a=Promise))(function(o,n){function r(t){try{c(i.next(t))}catch(e){n(e)}}function s(t){try{c(i.throw(t))}catch(e){n(e)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof a?e:new a(function(t){t(e)})).then(r,s)}c((i=i.apply(t,e||[])).next())})},s=function(){var t;return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(t){return function(e){return __decorate([t,e])}}};Object.defineProperty(n,"__esModule",{value:!0}),n.UserCenterManager=void 0;var c=i("CommonUtil"),l=function(){function t(){this.loginUrl="https://"+yzll.gameConfig.loginServerLineAddr,this._userCenterUrl="",this._wsUrl="",this.curServerData=null}return Object.defineProperty(t,"instance",{get:function(){return null==t._instance&&(t._instance=new t),t._instance},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wsUrl",{get:function(){return this._wsUrl},enumerable:!1,configurable:!0}),t.prototype.loginUserCenter=function(){yzll.gameConfig.appid,yzll.gameConfig.isTest?this.loginUrl="http://"+yzll.gameConfig.loginServerLineAddr:cc.sys.isBrowser&&cc.sys.browserType&&(this.loginUrl="http://"+yzll.gameConfig.loginServerLocalAddr+":"+yzll.gameConfig.httpServerLocalPort);var t=this.loginUrl+"/"+yzll.gameConfig.httpServerLinePort;c.CommonUtil.print("loginUrl:",t)},t.prototype.initNotice=function(){return r(this,void 0,Promise,function(){return s()})},t._instance=null,t}();n.UserCenterManager=l,cc._RF.pop(),cc._RF.pop()},{}],UserDataProxy:[function(t,e,a){"use strict";cc._RF.push(e,"99b82TN3rhIpa7DjW3VOwBj","UserDataProxy");var i=t,o=e,n=a;cc._RF.push(o,"1cf20Ew3o9BgJb59ud3530x","UserDataProxy"),Object.defineProperty(n,"__esModule",{value:!0}),n.userDataProxy=n.UserDataProxy=n.UserData=n.SaveUserDataKey=n.EUserDataEvent=void 0;var r,s=i("GameUIManager"),c=i("ProxyBase"),l=i("EventManager"),u=i("GameEnum"),p=i("HomeEnum"),h=i("DataManager");(function(t){t.POWER_UPDATE="EUserDataEvent.PowerUpdate",t.GOLD_UPDATE="EUserDataEvent.GoldUpdate",t.DIAMOD_UPDATE="EUserDataEvent.DiamodUpdate",t.GM_COMMAND="GM_COMMAND",t.UPDATE_UNLOCK_PLANT="UPDATE_UNLOCK_PLANT",t.UPDATE_WEAR_PLANT="UPDATE_WEAR_PLANT",t.UPDATE_PLANT_LEVEL="UPDATE_PLANT_LEVEL",t.REFRESH_DIAMOND="REFRESH_DIAMOND",t.REFRESH_MONEY="REFRESH_MONEY",t.UPDATE_VIDEO_CARD="UPDATE_VIDEO_CARD",t.UPDATE_LOOP_REWARD_RED="UPDATE_LOOP_REWARD_RED",t.COURSE_OPEN="COURSE_OPEN",t.CLOSE_EQUIP_DETAILS="CLOSE_EQUIP_DETAILS"})(r=n.EUserDataEvent||(n.EUserDataEvent={})),n.SaveUserDataKey||(n.SaveUserDataKey={});var d=function(){this.newPlayer=!0,this.name="\u73a9\u5bb6\u540d\u5b57",this.gold=0,this.diamond=0,this.power=0,this.passChapter=0,this.curChapter=1,this.lastLoginTime=1,this.lastPowerTime=1,this.isGetSideBarAward=0,this.sweeping=0,this.loopNum=0,this.videoPower=0,this.passWeatherChapter=0,this.cursWeatherChapter=1,this.combatEqus=[3],this.superEquipId=0,this.curWave=1,this.plantLvDatas=[],this.propData=[],this.refreshNum=0,this.dailyData={},this.passWave=0,this.videoDiamondNum=0,this.curWeatherWave=0,this.plantDatas=[],this.startGameRights=!1,this.unlockPlantIds=[],this.versionStr="",this.gameCourseData={curId:0,completeId:0,isComplete:!1},this.gameModel=1};n.UserData=d;var m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mPlantColors=["#2A6E2E","#2D438C","#6B30A6"],e.mNewUnlockPlantIds=[],e.mOnLineTime=0,e.mIsChangeVersion=!1,e.mYesterdayRank=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"userData",{get:function(){return this._data},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"combatEqus",{get:function(){return this.userData.combatEqus},enumerable:!1,configurable:!0}),e.prototype.initData=function(){var t=this;setInterval(function(){t.mOnLineTime++,[1,3,5,7,10,12,15,20,30].indexOf(t.mOnLineTime)>=0&&mm.platform.umaTrackEvent("time",{userA:"time_"+t.mOnLineTime})},6e4);for(var e=h.DataManager.instance.eData.dataplant,a=n.userDataProxy.userData.passChapter,i=0;i<this.userData.combatEqus.length;++i){var o=e[this.userData.combatEqus[i]];o?o.stageID>=a+1&&n.userDataProxy.userData.combatEqus.indexOf(o.id)>=0&&this.userData.combatEqus.splice(i--,1):this.userData.combatEqus.splice(i--,1)}this.userData.versionStr&&""!=this.userData.versionStr||(this.userData.versionStr=mm.platform.versionStr,this.saveData())},e.prototype.getPropDatas=function(t){return this.userData.propData[t]||0},e.prototype.changeGold=function(t){var e=Number(t);e?(this.userData.gold+=Math.floor(e),this.userData.gold<0&&(this.userData.gold=0),l.EventManager.instance.emit(r.GOLD_UPDATE)):console.log("changeGold\u5185\u5bb9\u4e0d\u5408\u6cd5\uff01:",t)},e.prototype.changeDiamond=function(t){var e=Number(t);e?(this.userData.diamond+=e,this.userData.diamond<0&&(this.userData.diamond=0),this.saveData(),l.EventManager.instance.emit(r.DIAMOD_UPDATE)):console.log("changeDiamond\u5185\u5bb9\u4e0d\u5408\u6cd5\uff01:",t)},e.prototype.updatePower=function(t){var e=Number(t);e?(n.userDataProxy.userData.power+=e,n.userDataProxy.userData.power<0&&(n.userDataProxy.userData.power=0),this.saveData(),l.EventManager.instance.emit(r.POWER_UPDATE)):console.log("updatePower\u5185\u5bb9\u4e0d\u5408\u6cd5\uff01:",t)},e.prototype.saveData=function(t){h.DataManager.instance.writeGameDataBase("UserData",this.userData,t)},e.prototype.resetData=function(t){var e=this.userData.startGameRights;this._data=new d,this._data.startGameRights=e,this.saveData(t)},e.prototype.newDataReset=function(){this.userData.sweeping=0,this.userData.videoPower=0,this.userData.refreshNum=0,this.userData.dailyData={},this.userData.refreshNum=0,this.userData.videoDiamondNum=0,n.userDataProxy.userData.boxData?(this.userData.boxData.cdTime=0,this.userData.boxData.bigState=0):n.userDataProxy.userData.boxData={cdTime:0,bigState:0,level:1,exp:0},this.userData.goldData={videoNum:0,mfNum:0},n.userDataProxy.userData.endlessData?(this.userData.endlessData.maxWave=0,this.userData.endlessData.isReceive=0,n.userDataProxy.userData.endlessData.playNum=Number(h.DataManager.instance.eData.datapara[1001].num)):n.userDataProxy.userData.endlessData={maxWave:0,isReceive:0,myRank:0,playNum:Number(h.DataManager.instance.eData.datapara[1001].num)},this.saveData(),mm.platform.umaTrackEvent("dau",{userA:"dau"})},e.prototype.getAward=function(t){for(var e=0;e<t.length;++e){var a=t[e];1==a.id?this.changeDiamond(a.num):2==a.id||(3==a.id?this.changeGold(a.num):3001==a.id||a.id)}},e.prototype.showCourse=function(t){return!(t.courseId>27)&&(this.checkCourseCanOpen(t.courseId)?(s.gameUIMgr.showCoursePopup(t),!0):void 0)},e.prototype.checkCourseIsComplete=function(t){if(this.checkCourseCanOpen(t))return!0},e.prototype.checkCourseCanOpen=function(t){var e=this.userData.gameCourseData;return!e.isComplete&&t==e.curId+1},e.prototype.completeCourse=function(t){var e=this.userData.gameCourseData;if(t!=e.curId+1)return!1;e.completeId=t,e.curId=t;var a=t+1;return h.DataManager.instance.eData.datagameguid[e.curId]||(e.isComplete=!0),this.saveData(),l.EventManager.instance.emit(r.COURSE_OPEN,a),!0},e.prototype.getPlantData=function(t){for(var e=0;e<this.userData.plantDatas.length;++e){var a=this.userData.plantDatas[e];if(a.id==t)return a}return{id:t,lv:1}},e.prototype.updatePlantLv=function(t,e){for(var a=0;a<this.userData.plantDatas.length;++a){var i=this.userData.plantDatas[a];if(i.id==t)return void(i.lv=e)}this.userData.plantDatas.push({id:t,lv:e}),this.saveData()},e.prototype.getWeightAwards=function(t,e){for(var a=[],i=0;i<e&&!(t.length<=0);i++){for(var o=this.getWeightAward(t),n=0;n<t.length;n++)if(t[n].id==o.id){t.splice(n,1);break}a.push(o)}return a},e.prototype.getWeightAward=function(t){var e;t.sort(function(t,e){return t.weight-e.weight});var a=(e=this.arrWeightAdd(t))[e.length-1].weight,i=Math.random()*a;return this.getRadomAward(i,e)},e.prototype.arrWeightAdd=function(t){if(!t||t.length<=0)return[];for(var e=[],a=0;a<t.length;a++)0==a?e[a]=t[a]:(e[a]=t[a],e[a].weight=e[a-1].weight+t[a].weight);return e},e.prototype.getRadomAward=function(t,e){if(1==e.length)return e[0].id;var a=0;if(t<=e[0].weight)return e[a];if(t>=e[e.length-1].weight)return e[a=e.length-1];for(var i=0;i<e.length;i++)if(t<=e[i].weight)a=i;else{if(t>e[i].weight&&t<=e[i+1].weight){a=i+1;break}if(t>e[i].weight&&t<=e[i+1].weight){a=i+1;break}}return e[a]},e.prototype.checkBoxRetrunAwards=function(t){for(var e,a,i=[],o=0,n=t.length;o<n;o++){var r=h.DataManager.instance.eData.dataitem[t[o].id];if(r)if(r.type==u.ItemType.BOX){var s=h.DataManager.instance.eData.databox[t[o].id];if(!s)continue;if(s.type==u.BoxType.FIXED)for(var c=s.reward.split("_"),l=0;l<t[o].num;l++)i.push({id:c[0],num:Number(c[0])});else if(s.type==u.BoxType.RADOM){for(var p=s.reward.split("|"),d=s.weight.split("|"),m=[],f=0;f<p.length;f++){var _=__read(p[f].split("_"),2),y=_[0],g=_[1];y&&g&&m.push({id:parseInt(y,10),num:parseInt(g,10),weight:parseInt(d[f],10)})}var v=null;for(l=0;l<t[o].num;l++)if((v=this.getWeightAwards(JSON.parse(JSON.stringify(m)),1)).length>0){var P=v[0];i.push({id:P.id,num:P.num})}}}else i.push({id:t[o].id,num:t[o].num})}var b={};try{for(var D=__values(i),S=D.next();!S.done;S=D.next()){var C=S.value;b[C.id]?b[C.id]+=C.num:b[C.id]=C.num}}catch(A){e={error:A}}finally{try{S&&!S.done&&(a=D.return)&&a.call(D)}finally{if(e)throw e.error}}var E=[];for(var B in b)E.push({id:B,num:b[B]});return E},e.prototype.getWearItemIsUnlock=function(t){if(t<Number(h.DataManager.instance.eData.datapara[34].num))return{isUnlock:!0,unlockChapter:0};var e=n.userDataProxy.userData.passChapter;if(2==t){var a=Number(h.DataManager.instance.eData.datapara[35].num);return{isUnlock:e>=a,unlockChapter:a}}if(1==t){var i=Number(h.DataManager.instance.eData.datapara[43].num);return{isUnlock:e>=i,unlockChapter:i}}var o=Number(h.DataManager.instance.eData.datapara[36].num);return{isUnlock:e>=o,unlockChapter:o}},e.prototype.addProp=function(t,e,a){if(void 0===a&&(a=!0),1!=t)if(2!=t)if(3!=t){var i=this.userData.propData;i[t]?i[t]+=e:i[t]=e,6==t||(t>=1001&&t<=1014?l.EventManager.instance.emit(p.EHomeEvent.UPDATE_HOME_REDDOT,[p.HOME_REDDOT.PLANTRED]):5==t||2001==t||2002==t||4==t&&l.EventManager.instance.emit(r.UPDATE_VIDEO_CARD)),this.saveData()}else this.updatePower(e);else this.changeDiamond(e);else this.changeGold(e)},e.prototype.getProp=function(t){return 0|this.userData.propData[t]},e.prototype.getIsUnlockPlant=function(t){return!(this.userData.unlockPlantIds.indexOf(t)<0&&(this.userData.unlockPlantIds.push(t),this.saveData(),1))},e}(c.ProxyBase);n.UserDataProxy=m,n.userDataProxy=new m(d),cc._RF.pop(),cc._RF.pop()},{}],UserSetDataProxy:[function(t,e,a){"use strict";cc._RF.push(e,"4e1c8SnQ1BCgbZYSveWc0TB","UserSetDataProxy");var i=t,o=e,n=a;cc._RF.push(o,"b438bt6tn1PyqMVk+7MENnX","UserSetDataProxy"),Object.defineProperty(n,"__esModule",{value:!0}),n.userSetDataProxy=n.SetData=void 0;var r=i("AudioManager"),s=i("ProxyBase"),c=i("EventManager"),l=i("GameEnum"),u=i("DataManager"),p=function(){this.isOpenShake=!0,this.musicVolume=1,this.effectVolume=1};n.SetData=p;var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.notActiveTime=0,e}return __extends(e,t),e.prototype.initData=function(){c.EventManager.instance.on(l.EGameEvent.SCENE_TOUCH_START,this.onSceneTouch,this),r.AudioManager.instance.setBgmVolume(this._data.musicVolume),r.AudioManager.instance.setEffectVolume(this._data.effectVolume)},Object.defineProperty(e.prototype,"setData",{get:function(){return this._data},enumerable:!1,configurable:!0}),e.prototype.updateSecond=function(){},e.prototype.onSceneTouch=function(){this.resetNotActiveTime()},e.prototype.resetNotActiveTime=function(){this.notActiveTime=0},e.prototype.setEffectAudio=function(t){r.AudioManager.instance.isOpenEffectAudio=t,this.saveData()},e.prototype.setBackgroundAudio=function(t){r.AudioManager.instance.isOpenBackgroundAudio=t,this.saveData()},e.prototype.setVibrate=function(t){this.setData.isOpenShake=t,this.saveData()},e.prototype.saveData=function(){u.DataManager.instance.writeGameDataBase(s.ProxyKey.SetData,this.setData)},e}(s.ProxyBase);n.default=h,n.userSetDataProxy=new h(p),cc._RF.pop(),cc._RF.pop()},{}],Util:[function(t,e,a){"use strict";cc._RF.push(e,"fa8e1K0w9FOKp97bTxKXo+R","Util");var i=t,o=e,n=a;cc._RF.push(o,"6b74czsnGFDDIQ5uG+nu6xN","Util"),Object.defineProperty(n,"__esModule",{value:!0}),n.HurtType=void 0;var r,s=i("CommonUtil"),c=i("MathUtil"),l=i("ResUtil"),u=i("HomeEnum"),p=i("NodePoolManager");(function(t){t[t.NORMAL=0]="NORMAL",t[t.CRIT=1]="CRIT",t[t.RECOVERY=2]="RECOVERY"})(r=n.HurtType||(n.HurtType={}));var h=function(){function t(){}return t.getClassName=function(e){if("function"==typeof e){var a=e.prototype;if(a&&a.hasOwnProperty("__classname__")&&a.__classname__)return a.__classname__;var i="";if(e.name&&(i=e.name),e.toString){var o,n=e.toString();(o="["===n.charAt(0)?n.match(/\[\w+\s*(\w+)\]/):n.match(/function\s*(\w+)/))&&2===o.length&&(i=o[1])}return"Object"!==i?i:""}return e&&e.constructor?t.getClassName(e.constructor):""},t.numberEnumToArray=function(t){return Object.values(t).filter(function(t){return"number"==typeof t})},t.deepCloneObj=function(e){var a=Array.isArray(e)?[]:{};for(var i in e){var o=e[i];o&&(o instanceof Function?a[i]=new Function("return"+o.toString())():a[i]="object"==_typeof2(o)?t.deepCloneObj(o):o)}return a},t.addButtonListener=function(t,e,a,i,o){var n=t.getComponent(cc.Button)||t.addComponent(cc.Button),r=new cc.Component.EventHandler;r.component=e,r.handler=a,r.target=i,r.customEventData=o,n.clickEvents.splice(0,n.clickEvents.length),n.clickEvents.push(r)},t.addToggleListener=function(t,e,a,i,o){var n=t.getComponent(cc.Toggle)||t.addComponent(cc.Toggle),r=new cc.Component.EventHandler;r.component=e,r.handler=a,r.target=i,r.customEventData=o,n.clickEvents.splice(0,n.clickEvents.length),n.clickEvents.push(r)},t.shake=function(t,e,a,i,o){void 0===e&&(e=1),void 0===a&&(a=.08),void 0===i&&(i=2),cc.Tween.stopAllByTarget(t),t.position=cc.Vec3.ZERO,cc.tween(t).by(a/2,{position:cc.v3(e,0,0)}).by(a/2,{position:cc.v3(-e,0,0)}).by(a/2,{position:cc.v3(0,-e,0)}).by(a/2,{position:cc.v3(0,e,0)}).by(a/2,{position:cc.v3(-e,0,0)}).by(a/2,{position:cc.v3(e,0,0)}).by(a/2,{position:cc.v3(0,e,0)}).by(a/2,{position:cc.v3(0,-e,0)}).union().repeat(i).call(function(){o&&o()}).start()},t.getTimeFormat=function(t,e){return t<60?"%0s\u79d2":t<3600?"%0m\u5206%0s\u79d2":t<86400?e?"%0h:%0m:%0s":"%h\u5c0f\u65f6":"%d\u5929"},t.setSpriteNormalMaterial=function(t){t.setMaterial(0,cc.Material.getBuiltinMaterial("2d-sprite"))},t.setSpriteGrayMaterial=function(t){t.setMaterial(0,cc.Material.getBuiltinMaterial("2d-gray-sprite"))},t.nodeWorldPos=function(t){return t.convertToWorldSpaceAR(cc.v3())},t.nodeLocalPos=function(t,e){return t.convertToNodeSpaceAR(e)},t.nodeParentChangeLocalPos=function(e,a){var i=t.nodeWorldPos(e);return t.nodeLocalPos(a,i)},t.delay=function(t,e,a){var i=setTimeout(function(){clearTimeout(i),e&&e.call(a)},1e3*t);return i},t.promiseDelay=function(t,e,a){return new Promise(function(i){var o=setTimeout(function(){clearTimeout(o),e&&e.call(a),i()},1e3*t)})},t.getAnimationTimeByName=function(t,e){var a=t.getState();if(null==a)throw"[ERROR SPINE ANIMATION] \u65e0\u6cd5\u83b7\u53d6\u83b7\u53d6\u52a8\u753b\u72b6\u6001>";var i=a.data.skeletonData.animations,o=0;for(var n in i)if(Object.prototype.hasOwnProperty.call(i,n)){var r=i[n];r.name==e&&(o=r.duration)}return o},t.sumArray=function(t){return t.reduce(function(t,e){return t+e},0)},t.checkSpecialCharacters=function(t){return/[.*+?#$\[\]{}()|\\/<:;'"<>!=,!\-_`|]/.test(t)},t.getMapKey=function(t,e){t+=4096,e+=4096;var a=Math.floor(e/100),i=Math.floor(t/100);return{key:a+"|"+i,row:a,col:i}},t.showHurt=function(t,e,a,i,o,n){var h=this;t&&(t=Math.abs(t),l.ResUtil.loadAsset({bundleName:u.Bundles.GAME,path:"prefabs/root/HurtLabel",type:cc.Prefab}).then(function(s){var l=p.default.instance.getNode(s);switch(l.getChildByName("miss").active=!1,l.getChildByName("Num").active=!0,l.getChildByName("Num").getComponent(cc.Label).string=c.MathUtil.formatNumber(t),l.opacity=255,l.position=a,e){case r.CRIT:l.getChildByName("Num").color=cc.Color.RED;break;case r.RECOVERY:l.getChildByName("Num").color=cc.Color.GREEN;break;default:l.getChildByName("Num").color=cc.Color.WHITE}o.addChild(l),h.playHurtEffect(l,function(){n&&n.isValid&&-1!=n.name.indexOf("Enemy")&&n.getComponent("EnemyBase").removeHurtItemNode(l),p.default.instance.putNode(l)},i,e),n&&n.isValid&&-1!=n.name.indexOf("Enemy")&&n.getComponent("EnemyBase").updateHurtItemNode(l)}).catch(function(t){s.CommonUtil.print(t)}))},t.showMiss=function(t,e,a,i){var o=this;l.ResUtil.loadAsset({bundleName:u.Bundles.GAME,path:"prefabs/root/HurtLabel",type:cc.Prefab}).then(function(n){var r=p.default.instance.getNode(n);r.getChildByName("miss").active=!0,r.getChildByName("Num").active=!1,r.opacity=255,r.position=t,a.addChild(r),o.playHurtEffect(r,function(){i&&i.isValid&&-1!=i.name.indexOf("Enemy")&&i.getComponent("EnemyBase").removeHurtItemNode(r),p.default.instance.putNode(r)},e,1),i&&i.isValid&&-1!=i.name.indexOf("Enemy")&&i.getComponent("EnemyBase").updateHurtItemNode(r)}).catch(function(t){s.CommonUtil.print(t)})},t.playHurtEffect=function(t,e,a,i){var o=this;t.opacity=255,t.scale=1;var n=cc.sequence(cc.delayTime(.4),cc.fadeOut(.25)),s=cc.moveBy(.15,cc.v2(0,60)),c=cc.moveBy(.1,cc.v2(0,-10)),l=cc.scaleTo(.15,r.CRIT?1.8:1.5),u=cc.scaleTo(.075,1.2),p=cc.sequence(l,u),h=l;t.runAction(cc.sequence(cc.spawn(i==r.NORMAL?p:h,s),cc.callFunc(function(){a.pushDamageNumberObject(o)}),c,n,cc.callFunc(function(){a&&a.isValid&&a.removeDamageNumberObject(o),e&&e()})))},t.getRotationAngle=function(t,e){var a=Math.atan2(e.y-t.y,e.x-t.x);return a<0?a+=2*Math.PI:a>2*Math.PI&&(a-=2*Math.PI),180*a/Math.PI},t.formatNumToString=function(t,e){if(void 0===e&&(e=1),t>=1e3){var a=t/1e3,i=t%1e3,o=Math.min(i?Math.min(e,String(i).length-1):0,2),n=a.toFixed(o);return n.endsWith(".0")&&(n=n.slice(0,-2)),n+"k"}return t.toString()},t.formatTimeMS=function(t,e,a){var i;void 0===a&&(a=":");var o=function(t){return t<10?"0"+t:t},n=new Date,r=n.getTimezoneOffset();n.setTime(t+6e4*r);var s=n.getDate()-1,c=n.getHours()+24*s,l=n.getMinutes(),u=n.getSeconds();return 1==e?i=""+o(c)+a+o(l)+a+o(u):2==e?i=o(c)+"\u65f6"+o(l)+"\u5206"+o(u)+"\u79d2":3==e?(i=c>0?""+o(c)+a:"",i+=""+o(l)+a+o(u)):4==e&&(i=c>0?o(c)+"\u65f6":"",i+=o(l)+"\u5206"+o(u)+"\u79d2"),i},t.getNextDayZeroTimestamp=function(){return new Date(Date.now()+864e5).setHours(0,0,0,0)},t.convertToTargetNodeSpace=function(t,e){if(!t||!t.isValid)return cc.v3(0,0);if(!e||!e.isValid)return cc.v3(0,0);var a=t.convertToWorldSpaceAR(cc.v2(0,0)),i=e.parent.convertToNodeSpaceAR(a);return cc.v3(i)},t.getQuilityName=function(t){switch(t){case 1:return"\u4e00\u822c";case 2:return"\u7a00\u6709";case 3:return"\u82f1\u96c4";case 4:return"\u4f20\u8bf4"}return""},t.getGradeName=function(t){var e="";switch(t){case 1:e="\u666e\u901a";break;case 2:case 3:e="\u7a00\u6709";break;case 4:e="\u53f2\u8bd7";break;case 5:e="\u4f20\u8bf4"}return e},t.retainTowPlaces=function(t){return t.toString().match(/^-?\d+(?:\.\d{0,2})?/)[0]},t.getRandomNum=function(t,e,a){void 0===a&&(a=!0);var i=e-t,o=Math.random()*i+t;return a&&(o=Math.round(o)),o},t.randSortArray=function(t){return t.sort(function(){return.5-Math.random()})},t.getTimeLeftTime=function(t,e){return e-(Date.now()-t)},t}();n.default=h,cc._RF.pop(),cc._RF.pop()},{}],VideoDiamondPopup:[function(t,e,a){"use strict";cc._RF.push(e,"831a8QmKohEfYq1Cn0bV6if","VideoDiamondPopup");var i=t,o=e,n=a;cc._RF.push(o,"3029eup0Z1Iz68KoCLTzA8O","VideoDiamondPopup"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("PopupBase"),s=i("DataManager"),c=i("UserDataProxy"),l=cc._decorator,u=l.ccclass,p=(l.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._closeFunc=null,e}return __extends(e,t),e.prototype.init=function(t){this._closeFunc=t.closeFunc,this.node.getChildByName("addNum").getComponent(cc.Label).string="+"+s.DataManager.instance.eData.datapara[46].num;var e=this.node.getChildByName("residue"),a=Number(s.DataManager.instance.eData.datapara[47].num);e.getComponent(cc.Label).string="\u5269\u4f59\u6b21\u6570\uff1a"+(a-c.userDataProxy.userData.videoDiamondNum)+"/"+a},e.prototype.onVideoBtn=function(){this._closeFunc&&this._closeFunc(),this.removeUI()},__decorate([u],e)}(r.PopupBase));n.default=p,cc._RF.pop(),cc._RF.pop()},{}],VideoFlagLogic:[function(t,e,a){"use strict";cc._RF.push(e,"7a1f52id+lAH5xTVagNE7kL","VideoFlagLogic");var i=t,o=e,n=a;cc._RF.push(o,"6377eT3VfNCsY275PCridTJ","VideoFlagLogic"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("ResUtil"),s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._originSpf=null,e}return __extends(e,t),e.prototype.onLoad=function(){this._originSpf=this.node.getComponent(cc.Sprite).spriteFrame},e.prototype.onDestroy=function(){},e.prototype.onEnable=function(){"\u52a0\u65f6\u89c6\u9891\u5c0f\u56fe\u6807"===this.node.name?this.node.active=!0:this.node.getComponent(cc.Sprite).spriteFrame=this._originSpf,this.refreshFlagStatus()},e.prototype.playHideAnim=function(){var t=this;"\u52a0\u65f6\u89c6\u9891\u5c0f\u56fe\u6807"===this.node.name?this.node.active=!1:r.ResUtil.loadAsset({bundleName:"Res",path:"FreeAdFlag",type:cc.SpriteFrame}).then(function(e){t.node.getComponent(cc.Sprite).spriteFrame=e}).catch(function(){})},e.prototype.reLightVideoFlag=function(){"\u52a0\u65f6\u89c6\u9891\u5c0f\u56fe\u6807"===this.node.name?this.node.active=!0:this.node.getComponent(cc.Sprite).spriteFrame=this._originSpf,this.refreshFlagStatus()},e.prototype.refreshFlagStatus=function(){},__decorate([c],e)}(cc.Component));n.default=l,cc._RF.pop(),cc._RF.pop()},{}],VideoPhysicalPopup:[function(t,e,a){"use strict";cc._RF.push(e,"a0fceioJl9OdIbwJvcWkzt4","VideoPhysicalPopup");var i=t,o=e,n=a;cc._RF.push(o,"c5f14RIA+1B4IQ3cdqHWG3S","VideoPhysicalPopup"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("PopupBase"),s=i("AdsMgr"),c=i("DataManager"),l=i("UserDataProxy"),u=i("AnimationMgr"),p=cc._decorator,h=p.ccclass,d=p.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mAddNum=null,e}return __extends(e,t),e.prototype.init=function(){this.mAddNum.string="+"+c.DataManager.instance.eData.datapara[24].num},e.prototype.onBtnVideo=function(){var t=this;s.default.showVideoAds({id:1,eventId:"video_physical_ad",success:function(){var e=Number(c.DataManager.instance.eData.datapara[24].num);l.userDataProxy.addProp(3,e),u.default.instance.showAwardAni({id:3,num:e},t.node.parent,t.mAddNum.node),t.removeUI()},fail:function(){},error:function(t){cc.log(t)}},!0)},__decorate([d(cc.Label)],e.prototype,"mAddNum",void 0),__decorate([h],e)}(r.PopupBase);n.default=m,cc._RF.pop(),cc._RF.pop()},{}],VideoSunshinePopup:[function(t,e,a){"use strict";cc._RF.push(e,"8a59bfUoPhGII+gXsLE4xQI","VideoSunshinePopup");var i=t,o=e,n=a;cc._RF.push(o,"49982WUq2tA6LRun3zafHoR","VideoSunshinePopup"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("PopupBase"),s=i("BattleDataProxy"),c=cc._decorator,l=c.ccclass,u=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._closeFunc=null,e}return __extends(e,t),e.prototype.init=function(t){this._closeFunc=t.closeFunc;var e=this.node.getChildByName("BtnVideo").getChildByName("videoIcon");s.battleDataProxy.setVideoCardIcon(e,4,1.5)},e.prototype.onVideoBtn=function(){this._closeFunc&&this._closeFunc(),this.removeUI()},__decorate([l],e)}(r.PopupBase));n.default=u,cc._RF.pop(),cc._RF.pop()},{}],ViewGroupNesting:[function(t,e,a){"use strict";cc._RF.push(e,"e36b8s5g5pOTLQvTz0mLEr1","ViewGroupNesting");var i=e,o=a;cc._RF.push(i,"bbd68erKuJKR767SX/yKM2Y","ViewGroupNesting"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,r=n.ccclass,s=(n.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.events=[],e}return __extends(e,t),e.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchHandle,this,!0),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchHandle,this,!0),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchHandle,this,!0),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchHandle,this,!0)},e.prototype.onTouchHandle=function(t){if(!t.sham&&!t.simulate&&t.target!==this.node){var e=new cc.Event.EventTouch(t.getTouches(),t.bubbles);e.type=t.type,e.touch=t.touch,e.sham=!0,this.events.push(e)}},e.prototype.update=function(){if(0!==this.events.length){for(var t=0;t<this.events.length;t++)this.node.dispatchEvent(this.events[t]);this.events.length=0}},__decorate([r],e)}(cc.Component));o.default=s,cc._RF.pop(),cc._RF.pop()},{}],WearPlantItem:[function(t,e,a){"use strict";cc._RF.push(e,"65affc40J1GMYLC3jlXV2Eo","WearPlantItem");var i=t,o=e,n=a;cc._RF.push(o,"c8fb8kUuUNIa6ugY+7QXffH","WearPlantItem"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("EventManager"),s=i("ResUtil"),c=i("HomeEnum"),l=i("DataManager"),u=i("BattleDataProxy"),p=i("UserDataProxy"),h=i("GameUIManager"),d=cc._decorator,m=d.ccclass,f=d.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mPlantInfo=null,e.mLock=null,e.mNotTips=null,e.mGreadBg=null,e.mPlantImg=null,e.mPlantName=null,e.mLvLab=null,e.mBtnDetails=null,e.mBtnRemove=null,e.mBar=null,e.mBarNum=null,e._isUnlock=!1,e._plantData=null,e._unlockChapter=0,e._idx=0,e}return __extends(e,t),e.prototype.initWearPlantItem=function(t,e,a){if(this._isUnlock=t,this._idx=e,this._unlockChapter=a,this.mLock.active=!t,this.mBtnDetails.active=!1,this.mBtnDetails.x=-65,this.mBtnRemove.active=!0,this.mBtnRemove.x=65,this.mBtnDetails.zIndex=1,this.mBtnRemove.zIndex=1,this.node.getComponent(cc.Button).interactable=t,this._isUnlock){var i=p.userDataProxy.combatEqus[e];i&&0!=i?(this.mNotTips.active=!1,this.mPlantInfo.active=!0,this.setPlantInfo(i)):(this.mNotTips.active=!0,this.mPlantInfo.active=!1,this.node.getComponent(cc.Button).interactable=!1)}else this.mNotTips.active=!1,this.mPlantInfo.active=!1,this.mLock.getChildByName("unlockTips").getComponent(cc.Label).string="\u901a\u8fc7\u7b2c"+a+"\u7ae0\u540e\u89e3\u9501"},e.prototype.setPlantInfo=function(t){var e=this;this._plantData=l.DataManager.instance.eData.dataplant[t],s.ResUtil.loadAsset({path:"textures/public/pic_zhiwukuang_"+this._plantData.qulity,type:cc.SpriteFrame,bundleName:c.Bundles.GAME}).then(function(t){e.mGreadBg.spriteFrame=t}).catch(function(t){console.log("error:",t)}),s.ResUtil.loadAsset({path:"textures/botanyIcon/pic_plant"+t,type:cc.SpriteFrame,bundleName:c.Bundles.GAME}).then(function(t){e.mPlantImg.spriteFrame=t}).catch(function(t){console.log("error:",t)}),this.updatePlantLevel(),this.mPlantName.node.color=cc.color(p.userDataProxy.mPlantColors[this._plantData.qulity-2]),this.mLvLab.node.color=cc.color(p.userDataProxy.mPlantColors[this._plantData.qulity-2])},e.prototype.onItemClick=function(){this.mBtnRemove.active=!0,5==p.userDataProxy.userData.gameCourseData.curId&&(p.userDataProxy.completeCourse(6),r.EventManager.instance.emit(u.EBattleEvent.LOSE_COURSE_VIEW)),h.gameUIMgr.showPlantEquipDetailsPopup(this._plantData,!1,this._idx)},e.prototype.hideBtn=function(){},e.prototype.onBtnDetails=function(){h.gameUIMgr.showPlantEquipDetailsPopup(this._plantData,!1,this._idx)},e.prototype.onBtnRemove=function(){p.userDataProxy.userData.gameCourseData.curId<=7?console.log("\u6559\u7a0b\u4e2d\u4e0d\u80fd\u4e0b\u690d\u7269"):(p.userDataProxy.userData.combatEqus[this._idx]=0,p.userDataProxy.saveData(),this.initWearPlantItem(this._isUnlock,this._idx,this._unlockChapter),r.EventManager.instance.emit(p.EUserDataEvent.UPDATE_UNLOCK_PLANT))},e.prototype.updatePlantLevel=function(){if(this._plantData){this.mPlantName.string=this._plantData.name;var t=p.userDataProxy.getPlantData(this._plantData.id).lv;this.mLvLab.string="Lv."+t;var e=p.userDataProxy.getPropDatas(this._plantData.needItem),a=Number(this._plantData.needNum.split("|")[t-1]);this.mBar.fillRange=e/a,this.mBarNum.string=e+"/"+a;var i=this.mBar.node.parent.getChildByName("arrow");if(i.active=e>=a,i.y=-78,cc.Tween.stopAllByTarget(i),i.active){var o=cc.tween(i).by(.3,{position:cc.v3(0,5)}).by(.3,{position:cc.v3(0,-5)}).delay(.15);cc.tween(i).repeatForever(o).start()}this.checkMax()}},e.prototype.checkMax=function(){var t=p.userDataProxy.getPlantData(this._plantData.id).lv;u.battleDataProxy.getPlantAtk(this._plantData.id,1,t+1)<=0&&(this.mBar.fillRange=1,this.mBarNum.string="Max",this.mBar.node.parent.getChildByName("arrow").active=!1)},__decorate([f(cc.Node)],e.prototype,"mPlantInfo",void 0),__decorate([f(cc.Node)],e.prototype,"mLock",void 0),__decorate([f(cc.Node)],e.prototype,"mNotTips",void 0),__decorate([f(cc.Sprite)],e.prototype,"mGreadBg",void 0),__decorate([f(cc.Sprite)],e.prototype,"mPlantImg",void 0),__decorate([f(cc.Label)],e.prototype,"mPlantName",void 0),__decorate([f(cc.Label)],e.prototype,"mLvLab",void 0),__decorate([f(cc.Node)],e.prototype,"mBtnDetails",void 0),__decorate([f(cc.Node)],e.prototype,"mBtnRemove",void 0),__decorate([f(cc.Sprite)],e.prototype,"mBar",void 0),__decorate([f(cc.Label)],e.prototype,"mBarNum",void 0),__decorate([m],e)}(cc.Component);n.default=_,cc._RF.pop(),cc._RF.pop()},{}],WeatherHeavyFog:[function(t,e,a){"use strict";cc._RF.push(e,"92e98JevxtJSohH6OWZX9bg","WeatherHeavyFog");var i=t,o=e,n=a;cc._RF.push(o,"a0265MyikxCNrkXwidFcdRy","WeatherHeavyFog"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("BattleDataProxy"),s=i("HeavyFogEffect"),c=cc._decorator,l=c.ccclass,u=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mHeavyFogEffectPb=null,e.mCheckTopHeavyFogs=[],e.mCheckDownHeavyFogs=[],e._heavyFogPos=[{imageId:1,pos:cc.v3(270,530),scale:1},{imageId:1,pos:cc.v3(94,588),scale:1},{imageId:1,pos:cc.v3(-353,458),scale:1},{imageId:1,pos:cc.v3(-186,323),scale:1.5},{imageId:2,pos:cc.v3(-232,171),scale:1},{imageId:1,pos:cc.v3(-340,66),scale:1},{imageId:1,pos:cc.v3(-205,-128),scale:1},{imageId:1,pos:cc.v3(-400,-243),scale:1.6},{imageId:1,pos:cc.v3(-290,-462),scale:1},{imageId:1,pos:cc.v3(-140,-548),scale:1},{imageId:2,pos:cc.v3(4,-462),scale:1},{imageId:1,pos:cc.v3(118,-580),scale:1},{imageId:1,pos:cc.v3(253,-246),scale:1.3},{imageId:1,pos:cc.v3(413,40),scale:1.5},{imageId:1,pos:cc.v3(346,214),scale:1.5},{imageId:2,pos:cc.v3(-148,545),scale:1.5}],e}return __extends(e,t),e.prototype.onLoad=function(){r.battleDataProxy.weatherHeavyFog=this.node;for(var t=this._heavyFogPos.length,e=0;e<t;++e){var a=this._heavyFogPos[e],i=cc.instantiate(this.mHeavyFogEffectPb);this.node.addChild(i),i.getComponent(s.default).initHeavyFogEffect(a,e),10!=e&&12!=e&&13!=e&&14!=e&&(e<=5||15==e?this.mCheckTopHeavyFogs.push(i):this.mCheckDownHeavyFogs.push(i))}},__decorate([u(cc.Prefab)],e.prototype,"mHeavyFogEffectPb",void 0),__decorate([l],e)}(cc.Component);n.default=p,cc._RF.pop(),cc._RF.pop()},{}],WeatherIceBroken:[function(t,e,a){"use strict";cc._RF.push(e,"be959IGXa1CFKcJbHvlCKc+","WeatherIceBroken");var i=t,o=e,n=a;cc._RF.push(o,"114741y6/JCg4V1ynDmI+k4","WeatherIceBroken"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("Util"),s=cc._decorator,c=s.ccclass,l=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mBrokenSpine=null,e}return __extends(e,t),e.prototype.show=function(t){var e=this;if(t){var a=r.default.convertToTargetNodeSpace(t,this.node);this.node.position=a}this.mBrokenSpine.setCompleteListener(function(){e.node.destroy(),e.node.removeFromParent()}),this.mBrokenSpine.setAnimation(0,"broken",!1)},__decorate([l(sp.Skeleton)],e.prototype,"mBrokenSpine",void 0),__decorate([c],e)}(cc.Component);n.default=u,cc._RF.pop(),cc._RF.pop()},{}],WeatherIceEffect:[function(t,e,a){"use strict";cc._RF.push(e,"99cc5i/WAVJjqz17UPQ9nAT","WeatherIceEffect");var i=t,o=e,n=a;cc._RF.push(o,"ef3c3yVNW9FV66gHv48XvXv","WeatherIceEffect"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("Util"),s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initWeatherIceEffect=function(t){var e=r.default.convertToTargetNodeSpace(t,this.node);this.node.position=e;for(var a=this.node.children[0],i=0;i<5;++i){var o=cc.instantiate(a);o.active=!0,this.node.addChild(o);var n=-this.node.width/2+Math.floor(100*Math.random())%this.node.width,s=-this.node.height/2+Math.floor(100*Math.random())%this.node.height;o.position=cc.v3(n,s)}},__decorate([c],e)}(cc.Component));n.default=l,cc._RF.pop(),cc._RF.pop()},{}],WeatherNightLight:[function(t,e,a){"use strict";cc._RF.push(e,"c562esl4rNDf6moPJrEmcZD","WeatherNightLight");var i=e,o=a;cc._RF.push(i,"d99066fV6hPNaamp4yuTWDs","WeatherNightLight"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,r=n.ccclass,s=n.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mLight=null,e}return __extends(e,t),e.prototype.show=function(){var t=cc.tween(this.mLight).to(1,{opacity:125}).to(1,{opacity:255});cc.tween(this.mLight).repeatForever(t).start()},__decorate([s(cc.Node)],e.prototype,"mLight",void 0),__decorate([r],e)}(cc.Component);o.default=c,cc._RF.pop(),cc._RF.pop()},{}],WeatherNight:[function(t,e,a){"use strict";cc._RF.push(e,"94dcfzJ7NdDG6G/2bz5fqLc","WeatherNight");var i=e,o=a;cc._RF.push(i,"c5f6dhIYC1D2IycDSASUAJz","WeatherNight"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,r=n.ccclass,s=(n.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),__decorate([r],e)}(cc.Component));o.default=s,cc._RF.pop(),cc._RF.pop()},{}],WeatherRain:[function(t,e,a){"use strict";cc._RF.push(e,"23f21aisopEP4tBrrMob+8z","WeatherRain");var i=t,o=e,n=a;cc._RF.push(o,"1fb6dlsL7ZHjbZmRhH6z1gR","WeatherRain"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("GameEnum"),s=i("BattleDataProxy"),c=i("Util"),l=i("MapGridItem"),u=i("PuddlesWater"),p=cc._decorator,h=p.ccclass,d=p.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mPuddlesWaterPb=null,e._waterTime=0,e}return __extends(e,t),e.prototype.update=function(t){s.battleDataProxy.gameState!=r.GameState.PAUSE&&(this._waterTime+=t,this._waterTime>=10&&(this._waterTime=0,this.createPuddlesWater()))},e.prototype.createPuddlesWater=function(){for(var t=[],e=["1-1","4-1","7-1","10-1","1-4","4-4","7-4","10-4"],a=function(a){var i=e[a],o=s.battleDataProxy.gridsMap.get(i);return o?s.battleDataProxy.waterView.children.findIndex(function(t){return t.getComponent(u.default).rowCol==i})>=0?"continue":void t.push(o):"continue"},i=0;i<e.length;++i)a(i);if(t.length<=0)console.log("\u6ca1\u683c\u5b50\u4e86");else{var o=Math.floor(1e3*Math.random())%t.length,n=t[o],r=cc.instantiate(this.mPuddlesWaterPb);s.battleDataProxy.waterView.addChild(r);var p=c.default.convertToTargetNodeSpace(n,r);r.position=p,r.getComponent(u.default).rowCol=n.getComponent(l.default).rowCol,r.getComponent(u.default).show()}},__decorate([d(cc.Prefab)],e.prototype,"mPuddlesWaterPb",void 0),__decorate([h],e)}(cc.Component);n.default=m,cc._RF.pop(),cc._RF.pop()},{}],WeatherSandWind:[function(t,e,a){"use strict";cc._RF.push(e,"f57afm8xndEmYtILdj+KK+6","WeatherSandWind");var i=t,o=e,n=a;cc._RF.push(o,"8d37c197RVI3q1pEJzSD84v","WeatherSandWind"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("GameEnum"),s=i("BattleDataProxy"),c=i("WeatherTornado"),l=cc._decorator,u=l.ccclass,p=l.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mWeatherTornadoPb=null,e.mWeatherTumbleweedPb=null,e._tornadoTime=0,e._tumbleweedTime=0,e}return __extends(e,t),e.prototype.update=function(t){s.battleDataProxy.gameState!=r.GameState.PAUSE&&(this._tornadoTime+=t,this._tornadoTime>=5&&(this._tornadoTime=0,this.createWeatherTornado()),this._tumbleweedTime+=t,this._tumbleweedTime>=2&&(this._tumbleweedTime=0,this.createWeatherTumbleweed()))},e.prototype.createWeatherTornado=function(){var t=cc.instantiate(this.mWeatherTornadoPb);s.battleDataProxy.bulletView.addChild(t);var e=this.randTornadoPos();t.position=e.nodePos,t.getComponent(c.default).startMove(e.targetPos)},e.prototype.randTornadoPos=function(){var t=0,e=0;Math.floor(1e3*Math.random())%2==0?(t=-s.battleDataProxy.battleView.width/2,e=Math.abs(t)):e=-(t=s.battleDataProxy.battleView.width/2);var a=0,i=0,o=Math.floor(1e3*Math.random())%2==0,n=s.battleDataProxy.battleView.height;return o?(a=Math.floor(1e3*Math.random())%(n/2),i=-Math.floor(1e3*Math.random())%(n/2)):(a=-Math.floor(1e3*Math.random())%(n/2),i=Math.floor(1e3*Math.random())%(n/2)),{nodePos:cc.v3(t,a),targetPos:cc.v3(e,i)}},e.prototype.createWeatherTumbleweed=function(){var t=cc.instantiate(this.mWeatherTumbleweedPb);s.battleDataProxy.bulletView.addChild(t),t.position=this.randTumbleweedPos(),t.zIndex=-t.y},e.prototype.randTumbleweedPos=function(){var t=Math.floor(1e4*Math.random())%(cc.winSize.height-200)+100;return cc.v3(0,-cc.winSize.height/2+t)},__decorate([p(cc.Prefab)],e.prototype,"mWeatherTornadoPb",void 0),__decorate([p(cc.Prefab)],e.prototype,"mWeatherTumbleweedPb",void 0),__decorate([u],e)}(cc.Component);n.default=h,cc._RF.pop(),cc._RF.pop()},{}],WeatherSnow:[function(t,e,a){"use strict";cc._RF.push(e,"a7b8chaeTFA5aE0K6oT6wWo","WeatherSnow");var i=e,o=a;cc._RF.push(i,"f2ba6s9fTxMYq24q15g5ECV","WeatherSnow"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,r=n.ccclass,s=(n.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),__decorate([r],e)}(cc.Component));o.default=s,cc._RF.pop(),cc._RF.pop()},{}],WeatherThunder:[function(t,e,a){"use strict";cc._RF.push(e,"bb095NA9V1EUICuu5rV04uG","WeatherThunder");var i=t,o=e,n=a;cc._RF.push(o,"1c3b3edwN5MEZBoEywulYX/","WeatherThunder"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("AudioManager"),s=i("GameEnum"),c=i("HomeEnum"),l=i("BattleDataProxy"),u=i("UserDataProxy"),p=i("Util"),h=i("EquipmentItem"),d=cc._decorator,m=d.ccclass,f=d.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mThunders=[],e._atkTarget=null,e._atkTime=0,e._isCanAtk=!1,e}return __extends(e,t),e.prototype.onLoad=function(){for(var t=this,e=function(e){var i=a.mThunders[e];i.setCompleteListener(function(){i.node.active=!1}),i.setEventListener(function(e,a){var i;a.data.name,t._atkTarget&&t._atkTarget.isValid&&(null===(i=t._atkTarget.getComponent(h.default))||void 0===i||i.lightningStroke())}),i.node.active=!1},a=this,i=0;i<this.mThunders.length;++i)e(i)},e.prototype.setAtkTarget=function(t,e){this._atkTarget=t;var a=p.default.convertToTargetNodeSpace(t,this.mThunders[e].node);this.mThunders[e].node.position=a.subSelf(l.battleDataProxy.gameCamera.position),this.mThunders[e].node.active=!0,this.mThunders[e].setAnimation(0,"atk",!1)},e.prototype.update=function(t){var e,a;if(l.battleDataProxy.gameState==s.GameState.PLAYING&&(this._isCanAtk||(this._atkTime+=t,this._atkTime>=2&&(this._atkTime=0,this._isCanAtk=!0)),this._isCanAtk)){this._isCanAtk=!1;var i=[],o=1;u.userDataProxy.userData.curWeatherWave>=6&&u.userDataProxy.userData.curWeatherWave<=10?o=2:u.userDataProxy.userData.curWeatherWave>=11&&u.userDataProxy.userData.curWeatherWave<=15?o=3:u.userDataProxy.userData.curWeatherWave>15&&(o=4);for(var n=0;n<(null===(a=null===(e=l.battleDataProxy.equipRoot)||void 0===e?void 0:e.children)||void 0===a?void 0:a.length);++n)(m=l.battleDataProxy.equipRoot.children[n]).getComponent(h.default).mIsFixedPlant||i.push(m);if(i.length<=0)return;r.AudioManager.instance.playEffectPath("sounds/thunder",c.Bundles.RES);for(var p=0;p<o&&!(i.length<=0);++p){var d=Math.floor(1e3*Math.random())%i.length,m=i[d];this.setAtkTarget(m,p),i.splice(d,1)}}},__decorate([f(sp.Skeleton)],e.prototype,"mThunders",void 0),__decorate([m],e)}(cc.Component);n.default=_,cc._RF.pop(),cc._RF.pop()},{}],WeatherTornado:[function(t,e,a){"use strict";cc._RF.push(e,"cce87rLVWJADJBcps8Gnqjr","WeatherTornado");var i=t,o=e,n=a;cc._RF.push(o,"b3882aXrKtPNKMbgbmJUM0p","WeatherTornado"),Object.defineProperty(n,"__esModule",{value:!0});var r=i("MathUtil"),s=i("SimplyRectCollider"),c=i("SimplyCollisionDetector"),l=i("GameEnum"),u=i("BattleDataProxy"),p=i("EquipmentItem"),h=cc._decorator,d=h.ccclass,m=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._moveTarget=null,e._moveSpeed=3,e._checkTime=0,e}return __extends(e,t),e.prototype.startMove=function(t){this._moveTarget=t},e.prototype.update=function(t){if(u.battleDataProxy.gameState!=l.GameState.PAUSE&&this._moveTarget){if(r.MathUtil.distance(this.node.position,this._moveTarget)<=this._moveSpeed)return this.node.destroy(),void this.node.removeFromParent();var e=this.node.position.clone().sub(this._moveTarget.clone()).normalize();this.node.x-=this._moveSpeed*e.x,this.node.y-=this._moveSpeed*e.y,this.node.zIndex=-this.node.y,this._checkTime+=t,this._checkTime>=.3&&(this._checkTime=0,this.plantColliderCheck())}},e.prototype.plantColliderCheck=function(){for(var t,e,a,i,o,n=this.node.getComponent(s.default),r=0;r<(null===(e=null===(t=u.battleDataProxy.equipRoot)||void 0===t?void 0:t.children)||void 0===e?void 0:e.length);++r){var l=u.battleDataProxy.equipRoot.children[r];if(n&&!(null===(a=l.getComponent(p.default))||void 0===a?void 0:a.isBeWindUp)&&!(null===(i=l.getComponent(p.default))||void 0===i?void 0:i.mIsFixedPlant)){var h=null===(o=l.getChildByName("root"))||void 0===o?void 0:o.getChildByName("collisions");if(h)for(var d=0;d<h.childrenCount;++d){var m=h.children[d].getComponent(s.default);if(m&&c.default.isCollisionRectToRect(n.rect,m.rect))return l.getComponent(p.default).beWindUp(this.node),this.node.destroy(),void this.node.removeFromParent()}}}},__decorate([d],e)}(cc.Component));n.default=m,cc._RF.pop(),cc._RF.pop()},{}],WeatherTumbleweed:[function(t,e,a){"use strict";cc._RF.push(e,"7f4c5C+T7xBSL/B8GkvQRjS","WeatherTumbleweed");var i=e,o=a;cc._RF.push(i,"8b8c9vQJkhDvoJM7AZtQPj8","WeatherTumbleweed"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,r=n.ccclass,s=n.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mTumbleweedSp=null,e}return __extends(e,t),e.prototype.onLoad=function(){var t=this;this.mTumbleweedSp.setCompleteListener(function(){t.node.destroy(),t.node.removeFromParent()})},e.prototype.show=function(){this.mTumbleweedSp.setAnimation(0,"move",!1)},__decorate([s(sp.Skeleton)],e.prototype,"mTumbleweedSp",void 0),__decorate([r],e)}(cc.Component);o.default=c,cc._RF.pop(),cc._RF.pop()},{}],WorkerManager:[function(t,e,a){"use strict";cc._RF.push(e,"aff2f+p/6dBt7Oot0ciWp5i","WorkerManager");var i=e,o=a;cc._RF.push(i,"f30adhg3KNHD7uGkpkfTIfw","WorkerManager"),Object.defineProperty(o,"__esModule",{value:!0}),o.WorkerManager=void 0;var n=function(){function t(){this._worker=null,this._tasks={},this._msgId=0,this._createWorker()}return Object.defineProperty(t,"instance",{get:function(){return null==t._instance&&(t._instance=new t),t._instance},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSupport",{get:function(){return null!=this._worker},enumerable:!1,configurable:!0}),t.prototype._createWorker=function(){var t=this;null!=this._worker&&this._worker.terminate(),this._worker=yzll.createWorker("workers/index.js",{useExperimentalWorker:!0}),null!=this._worker&&(this._worker.onProcessKilled&&this._worker.onProcessKilled(function(){t._createWorker()}),this._worker.onMessage(function(e){var a,i,o=e.msgId,n=e.data;null===(i=(a=t._tasks)[o])||void 0===i||i.call(a,null,n)}))},t.prototype.postMessage=function(t,e){var a=this;if(null==this._worker)return null==e?Promise.reject({errCode:-1,errMsg:"\u4e0d\u652f\u6301\u7684\u5e73\u53f0"}):void(null==e||e({errCode:-1,errMsg:"\u4e0d\u652f\u6301\u7684\u5e73\u53f0"}));if(t.type){var i=t.type+"_"+this._msgId;if(this._msgId++,null==e)return new Promise(function(e,o){a._tasks[i]=function(t,a){t?o(t):e(a)},t.msgId=i,a._worker.postMessage(t)});this._tasks[i]=e,t.msgId=i,this._worker.postMessage(t)}else console.error("\u8bf7\u5148\u5b9a\u4e49type\u5b57\u6bb5")},t._instance=null,t}();o.WorkerManager=n,cc._RF.pop(),cc._RF.pop()},{}],YZLLLoading:[function(t,e,a){"use strict";cc._RF.push(e,"411d7Qcd2JAZ7ZQBrDFdK0e","YZLLLoading");var i=e,o=a;cc._RF.push(i,"b4009bVrDVM7L1rmiYb/rFo","YZLLLoading"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,r=n.ccclass,s=n.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nBg=null,e.nCenterView=null,e.lPoint=null,e.lDesc=null,e.sSpine=null,e.pointStr="",e.isShow=!1,e.isLock=!1,e}return __extends(e,t),e.prototype.show=function(t,e,a,i){var o=this;void 0===t&&(t="\u55b5\u55b5\u52a0\u8f7d\u4e2d"),void 0===e&&(e=120),void 0===a&&(a=null),void 0===i&&(i=!1),this.isShow||this.isLock||(this.isLock=i,this.node.setSiblingIndex(this.node.parent.childrenCount-1),this.nCenterView.active=!1,this.nBg.opacity=0,this.lDesc.string=t,this.pointStr="",this.lPoint.string=this.pointStr,this.unschedule(this.pointLoad),cc.Tween.stopAllByTarget(this.nBg),this.node.active=!0,this.isShow=!0,cc.tween(this.nBg).to(.3,{opacity:e}).call(function(){o.nCenterView.active=!0,a&&a()}).start(),this.schedule(this.pointLoad,.2))},e.prototype.hide=function(t,e){var a=this;void 0===t&&(t=null),void 0===e&&(e=!1),this.isShow&&(this.isLock&&!e||(e&&(this.isLock=!1),this.isShow=!1,cc.Tween.stopAllByTarget(this.nBg),cc.tween(this.nBg).delay(.1).call(function(){a.unschedule(a.pointLoad),a.nCenterView.active=!1}).to(.1,{opacity:0}).call(function(){t&&t(),a.node.active=!1}).start()))},e.prototype.pointLoad=function(){this.pointStr.length>=3?this.pointStr="":this.pointStr+=".",this.lPoint.string=this.pointStr},__decorate([s(cc.Node)],e.prototype,"nBg",void 0),__decorate([s(cc.Node)],e.prototype,"nCenterView",void 0),__decorate([s(cc.Label)],e.prototype,"lPoint",void 0),__decorate([s(cc.Label)],e.prototype,"lDesc",void 0),__decorate([s(sp.Skeleton)],e.prototype,"sSpine",void 0),__decorate([r],e)}(cc.Component);o.default=c,cc._RF.pop(),cc._RF.pop()},{}],aes:[function(t,e,a){"use strict";cc._RF.push(e,"5dedaZQ6hVCj7WQTDjprsgP","aes");var i=e,o=a;cc._RF.push(i,"7251eNIMhpHo5k/GssV84ti","aes");var n,r=r||function(t){var e={},a=e.lib={},i=function(){},o=a.Base={extend:function(t){i.prototype=this;var e=new i;return t&&e.mixIn(t),e.hasOwnProperty("init")||(e.init=function(){e.$super.init.apply(this,arguments)}),e.init.prototype=e,e.$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},n=a.WordArray=o.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:4*t.length},toString:function(t){return(t||s).stringify(this)},concat:function(t){var e=this.words,a=t.words,i=this.sigBytes;if(t=t.sigBytes,this.clamp(),i%4)for(var o=0;o<t;o++)e[i+o>>>2]|=(a[o>>>2]>>>24-o%4*8&255)<<24-(i+o)%4*8;else if(65535<a.length)for(o=0;o<t;o+=4)e[i+o>>>2]=a[o>>>2];else e.push.apply(e,a);return this.sigBytes+=t,this},clamp:function(){var e=this.words,a=this.sigBytes;e[a>>>2]&=4294967295<<32-a%4*8,e.length=t.ceil(a/4)},clone:function(){var t=o.clone.call(this);return t.words=this.words.slice(0),t},random:function(e){for(var a=[],i=0;i<e;i+=4)a.push(4294967296*t.random()|0);return new n.init(a,e)}}),r=e.enc={},s=r.Hex={stringify:function(t){var e=t.words;t=t.sigBytes;for(var a=[],i=0;i<t;i++){var o=e[i>>>2]>>>24-i%4*8&255;a.push((o>>>4).toString(16)),a.push((15&o).toString(16))}return a.join("")},parse:function(t){for(var e=t.length,a=[],i=0;i<e;i+=2)a[i>>>3]|=parseInt(t.substr(i,2),16)<<24-i%8*4;return new n.init(a,e/2)}},c=r.Latin1={stringify:function(t){var e=t.words;t=t.sigBytes;for(var a=[],i=0;i<t;i++)a.push(String.fromCharCode(e[i>>>2]>>>24-i%4*8&255));return a.join("")},parse:function(t){for(var e=t.length,a=[],i=0;i<e;i++)a[i>>>2]|=(255&t.charCodeAt(i))<<24-i%4*8;return new n.init(a,e)}},l=r.Utf8={stringify:function(t){try{return decodeURIComponent(escape(c.stringify(t)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function(t){return c.parse(unescape(encodeURIComponent(t)))}},u=a.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new n.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=l.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var a=this._data,i=a.words,o=a.sigBytes,r=this.blockSize,s=o/(4*r);if(e=(s=e?t.ceil(s):t.max((0|s)-this._minBufferSize,0))*r,o=t.min(4*e,o),e){for(var c=0;c<e;c+=r)this._doProcessBlock(i,c);c=i.splice(0,e),a.sigBytes-=o}return new n.init(c,o)},clone:function(){var t=o.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0});a.Hasher=u.extend({cfg:o.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){u.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,a){return new t.init(a).finalize(e)}},_createHmacHelper:function(t){return function(e,a){return new p.HMAC.init(t,a).finalize(e)}}});var p=e.algo={};return e}(Math);n=(o=r).lib.WordArray,o.enc.Base64={stringify:function(t){var e=t.words,a=t.sigBytes,i=this._map;t.clamp(),t=[];for(var o=0;o<a;o+=3)for(var n=(e[o>>>2]>>>24-o%4*8&255)<<16|(e[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|e[o+2>>>2]>>>24-(o+2)%4*8&255,r=0;4>r&&o+.75*r<a;r++)t.push(i.charAt(n>>>6*(3-r)&63));if(e=i.charAt(64))for(;t.length%4;)t.push(e);return t.join("")},parse:function(t){var e=t.length,a=this._map;(i=a.charAt(64))&&-1!=(i=t.indexOf(i))&&(e=i);for(var i=[],o=0,r=0;r<e;r++)if(r%4){var s=a.indexOf(t.charAt(r-1))<<r%4*2,c=a.indexOf(t.charAt(r))>>>6-r%4*2;i[o>>>2]|=(s|c)<<24-o%4*8,o++}return n.create(i,o)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},function(t){function e(t,e,a,i,o,n,r){return((t=t+(e&a|~e&i)+o+r)<<n|t>>>32-n)+e}function a(t,e,a,i,o,n,r){return((t=t+(e&i|a&~i)+o+r)<<n|t>>>32-n)+e}function i(t,e,a,i,o,n,r){return((t=t+(e^a^i)+o+r)<<n|t>>>32-n)+e}function o(t,e,a,i,o,n,r){return((t=t+(a^(e|~i))+o+r)<<n|t>>>32-n)+e}for(var n=r,s=(l=n.lib).WordArray,c=l.Hasher,l=n.algo,u=[],p=0;64>p;p++)u[p]=4294967296*t.abs(t.sin(p+1))|0;l=l.MD5=c.extend({_doReset:function(){this._hash=new s.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(t,n){for(var r=0;16>r;r++){var s=t[c=n+r];t[c]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8)}r=this._hash.words;var c=t[n+0],l=(s=t[n+1],t[n+2]),p=t[n+3],h=t[n+4],d=t[n+5],m=t[n+6],f=t[n+7],_=t[n+8],y=t[n+9],g=t[n+10],v=t[n+11],P=t[n+12],b=t[n+13],D=t[n+14],S=t[n+15],C=e(C=r[0],A=r[1],B=r[2],E=r[3],c,7,u[0]),E=e(E,C,A,B,s,12,u[1]),B=e(B,E,C,A,l,17,u[2]),A=e(A,B,E,C,p,22,u[3]);C=e(C,A,B,E,h,7,u[4]),E=e(E,C,A,B,d,12,u[5]),B=e(B,E,C,A,m,17,u[6]),A=e(A,B,E,C,f,22,u[7]),C=e(C,A,B,E,_,7,u[8]),E=e(E,C,A,B,y,12,u[9]),B=e(B,E,C,A,g,17,u[10]),A=e(A,B,E,C,v,22,u[11]),C=e(C,A,B,E,P,7,u[12]),E=e(E,C,A,B,b,12,u[13]),B=e(B,E,C,A,D,17,u[14]),C=a(C,A=e(A,B,E,C,S,22,u[15]),B,E,s,5,u[16]),E=a(E,C,A,B,m,9,u[17]),B=a(B,E,C,A,v,14,u[18]),A=a(A,B,E,C,c,20,u[19]),C=a(C,A,B,E,d,5,u[20]),E=a(E,C,A,B,g,9,u[21]),B=a(B,E,C,A,S,14,u[22]),A=a(A,B,E,C,h,20,u[23]),C=a(C,A,B,E,y,5,u[24]),E=a(E,C,A,B,D,9,u[25]),B=a(B,E,C,A,p,14,u[26]),A=a(A,B,E,C,_,20,u[27]),C=a(C,A,B,E,b,5,u[28]),E=a(E,C,A,B,l,9,u[29]),B=a(B,E,C,A,f,14,u[30]),C=i(C,A=a(A,B,E,C,P,20,u[31]),B,E,d,4,u[32]),E=i(E,C,A,B,_,11,u[33]),B=i(B,E,C,A,v,16,u[34]),A=i(A,B,E,C,D,23,u[35]),C=i(C,A,B,E,s,4,u[36]),E=i(E,C,A,B,h,11,u[37]),B=i(B,E,C,A,f,16,u[38]),A=i(A,B,E,C,g,23,u[39]),C=i(C,A,B,E,b,4,u[40]),E=i(E,C,A,B,c,11,u[41]),B=i(B,E,C,A,p,16,u[42]),A=i(A,B,E,C,m,23,u[43]),C=i(C,A,B,E,y,4,u[44]),E=i(E,C,A,B,P,11,u[45]),B=i(B,E,C,A,S,16,u[46]),C=o(C,A=i(A,B,E,C,l,23,u[47]),B,E,c,6,u[48]),E=o(E,C,A,B,f,10,u[49]),B=o(B,E,C,A,D,15,u[50]),A=o(A,B,E,C,d,21,u[51]),C=o(C,A,B,E,P,6,u[52]),E=o(E,C,A,B,p,10,u[53]),B=o(B,E,C,A,g,15,u[54]),A=o(A,B,E,C,s,21,u[55]),C=o(C,A,B,E,_,6,u[56]),E=o(E,C,A,B,S,10,u[57]),B=o(B,E,C,A,m,15,u[58]),A=o(A,B,E,C,b,21,u[59]),C=o(C,A,B,E,h,6,u[60]),E=o(E,C,A,B,v,10,u[61]),B=o(B,E,C,A,l,15,u[62]),A=o(A,B,E,C,y,21,u[63]),r[0]=r[0]+C|0,r[1]=r[1]+A|0,r[2]=r[2]+B|0,r[3]=r[3]+E|0},_doFinalize:function(){var e=this._data,a=e.words,i=8*this._nDataBytes,o=8*e.sigBytes;a[o>>>5]|=128<<24-o%32;var n=t.floor(i/4294967296);for(a[15+(o+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),a[14+(o+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),e.sigBytes=4*(a.length+1),this._process(),a=(e=this._hash).words,i=0;4>i;i++)o=a[i],a[i]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8);return e},clone:function(){var t=c.clone.call(this);return t._hash=this._hash.clone(),t}}),n.MD5=c._createHelper(l),n.HmacMD5=c._createHmacHelper(l)}(Math),function(){var t,e=r,a=(t=e.lib).Base,i=t.WordArray,o=(t=e.algo).EvpKDF=a.extend({cfg:a.extend({keySize:4,hasher:t.MD5,iterations:1}),init:function(t){this.cfg=this.cfg.extend(t)},compute:function(t,e){for(var a=(s=this.cfg).hasher.create(),o=i.create(),n=o.words,r=s.keySize,s=s.iterations;n.length<r;){c&&a.update(c);var c=a.update(t).finalize(e);a.reset();for(var l=1;l<s;l++)c=a.finalize(c),a.reset();o.concat(c)}return o.sigBytes=4*r,o}});e.EvpKDF=function(t,e,a){return o.create(a).compute(t,e)}}(),r.lib.Cipher||function(){var t=(d=r).lib,e=t.Base,a=t.WordArray,i=t.BufferedBlockAlgorithm,o=d.enc.Base64,n=d.algo.EvpKDF,s=t.Cipher=i.extend({cfg:e.extend(),createEncryptor:function(t,e){return this.create(this._ENC_XFORM_MODE,t,e)},createDecryptor:function(t,e){return this.create(this._DEC_XFORM_MODE,t,e)},init:function(t,e,a){this.cfg=this.cfg.extend(a),this._xformMode=t,this._key=e,this.reset()},reset:function(){i.reset.call(this),this._doReset()},process:function(t){return this._append(t),this._process()},finalize:function(t){return t&&this._append(t),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(t){return{encrypt:function(e,a,i){return("string"==typeof a?m:h).encrypt(t,e,a,i)},decrypt:function(e,a,i){return("string"==typeof a?m:h).decrypt(t,e,a,i)}}}});t.StreamCipher=s.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var c=d.mode={},l=function(t,e,a){var i=this._iv;i?this._iv=void 0:i=this._prevBlock;for(var o=0;o<a;o++)t[e+o]^=i[o]},u=(t.BlockCipherMode=e.extend({createEncryptor:function(t,e){return this.Encryptor.create(t,e)},createDecryptor:function(t,e){return this.Decryptor.create(t,e)},init:function(t,e){this._cipher=t,this._iv=e}})).extend();u.Encryptor=u.extend({processBlock:function(t,e){var a=this._cipher,i=a.blockSize;l.call(this,t,e,i),a.encryptBlock(t,e),this._prevBlock=t.slice(e,e+i)}}),u.Decryptor=u.extend({processBlock:function(t,e){var a=this._cipher,i=a.blockSize,o=t.slice(e,e+i);a.decryptBlock(t,e),l.call(this,t,e,i),this._prevBlock=o}}),c=c.CBC=u,u=(d.pad={}).Pkcs7={pad:function(t,e){for(var i,o=(i=(i=4*e)-t.sigBytes%i)<<24|i<<16|i<<8|i,n=[],r=0;r<i;r+=4)n.push(o);i=a.create(n,i),t.concat(i)},unpad:function(t){t.sigBytes-=255&t.words[t.sigBytes-1>>>2]}},t.BlockCipher=s.extend({cfg:s.cfg.extend({mode:c,padding:u}),reset:function(){s.reset.call(this);var t=(e=this.cfg).iv,e=e.mode;if(this._xformMode==this._ENC_XFORM_MODE)var a=e.createEncryptor;else a=e.createDecryptor,this._minBufferSize=1;this._mode=a.call(e,this,t&&t.words)},_doProcessBlock:function(t,e){this._mode.processBlock(t,e)},_doFinalize:function(){var t=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){t.pad(this._data,this.blockSize);var e=this._process(!0)}else e=this._process(!0),t.unpad(e);return e},blockSize:4});var p=t.CipherParams=e.extend({init:function(t){this.mixIn(t)},toString:function(t){return(t||this.formatter).stringify(this)}}),h=(c=(d.format={}).OpenSSL={stringify:function(t){var e=t.ciphertext;return((t=t.salt)?a.create([1398893684,1701076831]).concat(t).concat(e):e).toString(o)},parse:function(t){var e=(t=o.parse(t)).words;if(1398893684==e[0]&&1701076831==e[1]){var i=a.create(e.slice(2,4));e.splice(0,4),t.sigBytes-=16}return p.create({ciphertext:t,salt:i})}},t.SerializableCipher=e.extend({cfg:e.extend({format:c}),encrypt:function(t,e,a,i){i=this.cfg.extend(i);var o=t.createEncryptor(a,i);return e=o.finalize(e),o=o.cfg,p.create({ciphertext:e,key:a,iv:o.iv,algorithm:t,mode:o.mode,padding:o.padding,blockSize:t.blockSize,formatter:i.format})},decrypt:function(t,e,a,i){return i=this.cfg.extend(i),e=this._parse(e,i.format),t.createDecryptor(a,i).finalize(e.ciphertext)},_parse:function(t,e){return"string"==typeof t?e.parse(t,this):t}})),d=(d.kdf={}).OpenSSL={execute:function(t,e,i,o){return o||(o=a.random(8)),t=n.create({keySize:e+i}).compute(t,o),i=a.create(t.words.slice(e),4*i),t.sigBytes=4*e,p.create({key:t,iv:i,salt:o})}},m=t.PasswordBasedCipher=h.extend({cfg:h.cfg.extend({kdf:d}),encrypt:function(t,e,a,i){return a=(i=this.cfg.extend(i)).kdf.execute(a,t.keySize,t.ivSize),i.iv=a.iv,(t=h.encrypt.call(this,t,e,a.key,i)).mixIn(a),t},decrypt:function(t,e,a,i){return i=this.cfg.extend(i),e=this._parse(e,i.format),a=i.kdf.execute(a,t.keySize,t.ivSize,e.salt),i.iv=a.iv,h.decrypt.call(this,t,e,a.key,i)}})}(),function(){for(var t=r,e=t.lib.BlockCipher,a=t.algo,i=[],o=[],n=[],s=[],c=[],l=[],u=[],p=[],h=[],d=[],m=[],f=0;256>f;f++)m[f]=128>f?f<<1:f<<1^283;var _=0,y=0;for(f=0;256>f;f++){var g=(g=y^y<<1^y<<2^y<<3^y<<4)>>>8^255&g^99;i[_]=g,o[g]=_;var v=m[_],P=m[v],b=m[P],D=257*m[g]^16843008*g;n[_]=D<<24|D>>>8,s[_]=D<<16|D>>>16,c[_]=D<<8|D>>>24,l[_]=D,D=16843009*b^65537*P^257*v^16843008*_,u[g]=D<<24|D>>>8,p[g]=D<<16|D>>>16,h[g]=D<<8|D>>>24,d[g]=D,_?(_=v^m[m[m[b^v]]],y^=m[m[y]]):_=y=1}var S=[0,1,2,4,8,16,32,64,128,27,54];a=a.AES=e.extend({_doReset:function(){for(var t=(a=this._key).words,e=a.sigBytes/4,a=4*((this._nRounds=e+6)+1),o=this._keySchedule=[],n=0;n<a;n++)if(n<e)o[n]=t[n];else{var r=o[n-1];n%e?6<e&&4==n%e&&(r=i[r>>>24]<<24|i[r>>>16&255]<<16|i[r>>>8&255]<<8|i[255&r]):(r=i[(r=r<<8|r>>>24)>>>24]<<24|i[r>>>16&255]<<16|i[r>>>8&255]<<8|i[255&r],r^=S[n/e|0]<<24),o[n]=o[n-e]^r}for(t=this._invKeySchedule=[],e=0;e<a;e++)n=a-e,r=e%4?o[n]:o[n-4],t[e]=4>e||4>=n?r:u[i[r>>>24]]^p[i[r>>>16&255]]^h[i[r>>>8&255]]^d[i[255&r]]},encryptBlock:function(t,e){this._doCryptBlock(t,e,this._keySchedule,n,s,c,l,i)},decryptBlock:function(t,e){var a=t[e+1];t[e+1]=t[e+3],t[e+3]=a,this._doCryptBlock(t,e,this._invKeySchedule,u,p,h,d,o),a=t[e+1],t[e+1]=t[e+3],t[e+3]=a},_doCryptBlock:function(t,e,a,i,o,n,r,s){for(var c=this._nRounds,l=t[e]^a[0],u=t[e+1]^a[1],p=t[e+2]^a[2],h=t[e+3]^a[3],d=4,m=1;m<c;m++){var f=i[l>>>24]^o[u>>>16&255]^n[p>>>8&255]^r[255&h]^a[d++],_=i[u>>>24]^o[p>>>16&255]^n[h>>>8&255]^r[255&l]^a[d++],y=i[p>>>24]^o[h>>>16&255]^n[l>>>8&255]^r[255&u]^a[d++];h=i[h>>>24]^o[l>>>16&255]^n[u>>>8&255]^r[255&p]^a[d++],l=f,u=_,p=y}f=(s[l>>>24]<<24|s[u>>>16&255]<<16|s[p>>>8&255]<<8|s[255&h])^a[d++],_=(s[u>>>24]<<24|s[p>>>16&255]<<16|s[h>>>8&255]<<8|s[255&l])^a[d++],y=(s[p>>>24]<<24|s[h>>>16&255]<<16|s[l>>>8&255]<<8|s[255&u])^a[d++],h=(s[h>>>24]<<24|s[l>>>16&255]<<16|s[u>>>8&255]<<8|s[255&p])^a[d++],t[e]=f,t[e+1]=_,t[e+2]=y,t[e+3]=h},keySize:8}),t.AES=e._createHelper(a)}(),r.pad.Iso10126={pad:function(t,e){var a=(a=4*e)-t.sigBytes%a;t.concat(r.lib.WordArray.random(a-1)).concat(r.lib.WordArray.create([a<<24],1))},unpad:function(t){t.sigBytes-=255&t.words[t.sigBytes-1>>>2]}},window.CryptoJS=r,cc._RF.pop(),cc._RF.pop()},{}],algo:[function(t,e,a){"use strict";cc._RF.push(e,"26fb0yIRDFMnLr2lqjXgOZd","algo");var i=e,o=a;cc._RF.push(i,"2ffd0ZRrFxP9YDG2cT1mPQC","algo"),o={cipher:function(t,e){for(var a=e.length/4-1,i=[[],[],[],[]],n=0;n<16;n++)i[n%4][Math.floor(n/4)]=t[n];i=o.addRoundKey(i,e,0,4);for(var r=1;r<a;r++)i=o.subBytes(i,4),i=o.shiftRows(i,4),i=o.mixColumns(i,4),i=o.addRoundKey(i,e,r,4);i=o.subBytes(i,4),i=o.shiftRows(i,4),i=o.addRoundKey(i,e,a,4);var s=new Array(16);for(n=0;n<16;n++)s[n]=i[n%4][Math.floor(n/4)];return s},keyExpansion:function(t){for(var e=t.length/4,a=e+6,i=new Array(4*(a+1)),n=new Array(4),r=0;r<e;r++){var s=[t[4*r],t[4*r+1],t[4*r+2],t[4*r+3]];i[r]=s}for(r=e;r<4*(a+1);r++){i[r]=new Array(4);for(var c=0;c<4;c++)n[c]=i[r-1][c];if(r%e==0)for(n=o.subWord(o.rotWord(n)),c=0;c<4;c++)n[c]^=o.rCon[r/e][c];else e>6&&r%e==4&&(n=o.subWord(n));for(c=0;c<4;c++)i[r][c]=i[r-e][c]^n[c]}return i},subBytes:function(t,e){for(var a=0;a<4;a++)for(var i=0;i<e;i++)t[a][i]=o.sBox[t[a][i]];return t},shiftRows:function(t,e){for(var a=new Array(4),i=1;i<4;i++){for(var o=0;o<4;o++)a[o]=t[i][(o+i)%e];for(o=0;o<4;o++)t[i][o]=a[o]}return t},mixColumns:function(t){for(var e=0;e<4;e++){for(var a=new Array(4),i=new Array(4),o=0;o<4;o++)a[o]=t[o][e],i[o]=128&t[o][e]?t[o][e]<<1^283:t[o][e]<<1;t[0][e]=i[0]^a[1]^i[1]^a[2]^a[3],t[1][e]=a[0]^i[1]^a[2]^i[2]^a[3],t[2][e]=a[0]^a[1]^i[2]^a[3]^i[3],t[3][e]=a[0]^i[0]^a[1]^a[2]^i[3]}return t},addRoundKey:function(t,e,a,i){for(var o=0;o<4;o++)for(var n=0;n<i;n++)t[o][n]^=e[4*a+n][o];return t},subWord:function(t){for(var e=0;e<4;e++)t[e]=o.sBox[t[e]];return t},rotWord:function(t){for(var e=t[0],a=0;a<3;a++)t[a]=t[a+1];return t[3]=e,t},sBox:[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],rCon:[[0,0,0,0],[1,0,0,0],[2,0,0,0],[4,0,0,0],[8,0,0,0],[16,0,0,0],[32,0,0,0],[64,0,0,0],[128,0,0,0],[27,0,0,0],[54,0,0,0]]},void 0!==i&&i.exports&&(i.exports=o),"function"==typeof define&&define.amd&&define([],function(){return o}),cc._RF.pop(),cc._RF.pop()},{}],base64:[function(t,e,a){(function(i,o){"use strict";cc._RF.push(e,"28e28q6GTRBk4ngj2PG3Qe5","base64");var n=e,r=a,s=t("./helpers/typeof");(function(t,e){cc._RF.push(n,"81b92CVj0ZPkIoWZS1ZYJTa","base64"),function(t,e){var a,i;"object"==s(r)&&void 0!==n?n.exports=e():"function"==typeof define&&define.amd?define(e):(a=t.Base64,(i=e()).noConflict=function(){return t.Base64=a,i},t.Meteor&&(Base64=i),t.Base64=i)}("undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t?t:void 0,function(){var t,a="function"==typeof e,i="function"==typeof TextDecoder?new TextDecoder:void 0,o="function"==typeof TextEncoder?new TextEncoder:void 0,n=Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="),r=(t={},n.forEach(function(e,a){return t[e]=a}),t),s=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,c=String.fromCharCode.bind(String),l="function"==typeof Uint8Array.from?Uint8Array.from.bind(Uint8Array):function(t){return new Uint8Array(Array.prototype.slice.call(t,0))},u=function(t){return t.replace(/=/g,"").replace(/[+\/]/g,function(t){return"+"==t?"-":"_"})},p=function(t){return t.replace(/[^A-Za-z0-9\+\/]/g,"")},h=function(t){for(var e,a,i,o,r="",s=t.length%3,c=0;c<t.length;){if((a=t.charCodeAt(c++))>255||(i=t.charCodeAt(c++))>255||(o=t.charCodeAt(c++))>255)throw new TypeError("invalid character found");r+=n[(e=a<<16|i<<8|o)>>18&63]+n[e>>12&63]+n[e>>6&63]+n[63&e]}return s?r.slice(0,s-3)+"===".substring(s):r},d="function"==typeof btoa?function(t){return btoa(t)}:a?function(t){return e.from(t,"binary").toString("base64")}:h,m=a?function(t){return e.from(t).toString("base64")}:function(t){for(var e=[],a=0,i=t.length;a<i;a+=4096)e.push(c.apply(null,t.subarray(a,a+4096)));return d(e.join(""))},f=function(t,e){return void 0===e&&(e=!1),e?u(m(t)):m(t)},_=function(t){if(t.length<2)return(e=t.charCodeAt(0))<128?t:e<2048?c(192|e>>>6)+c(128|63&e):c(224|e>>>12&15)+c(128|e>>>6&63)+c(128|63&e);var e=65536+1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320);return c(240|e>>>18&7)+c(128|e>>>12&63)+c(128|e>>>6&63)+c(128|63&e)},y=/[\ufffd-\ufffd][\ufffd-\ufffdF]|[^\x00-\x7F]/g,g=function(t){return t.replace(y,_)},v=a?function(t){return e.from(t,"utf8").toString("base64")}:o?function(t){return m(o.encode(t))}:function(t){return d(g(t))},P=function(t,e){return void 0===e&&(e=!1),e?u(v(t)):v(t)},b=function(t){return P(t,!0)},D=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,S=function(t){switch(t.length){case 4:var e=((7&t.charCodeAt(0))<<18|(63&t.charCodeAt(1))<<12|(63&t.charCodeAt(2))<<6|63&t.charCodeAt(3))-65536;return c(55296+(e>>>10))+c(56320+(1023&e));case 3:return c((15&t.charCodeAt(0))<<12|(63&t.charCodeAt(1))<<6|63&t.charCodeAt(2));default:return c((31&t.charCodeAt(0))<<6|63&t.charCodeAt(1))}},C=function(t){return t.replace(D,S)},E=function(t){if(t=t.replace(/\s+/g,""),!s.test(t))throw new TypeError("malformed base64.");t+="==".slice(2-(3&t.length));for(var e,a,i,o="",n=0;n<t.length;)e=r[t.charAt(n++)]<<18|r[t.charAt(n++)]<<12|(a=r[t.charAt(n++)])<<6|(i=r[t.charAt(n++)]),o+=64===a?c(e>>16&255):64===i?c(e>>16&255,e>>8&255):c(e>>16&255,e>>8&255,255&e);return o},B="function"==typeof atob?function(t){return atob(p(t))}:a?function(t){return e.from(t,"base64").toString("binary")}:E,A=a?function(t){return l(e.from(t,"base64"))}:function(t){return l(B(t).split("").map(function(t){return t.charCodeAt(0)}))},x=function(t){return A(N(t))},M=a?function(t){return e.from(t,"base64").toString("utf8")}:i?function(t){return i.decode(A(t))}:function(t){return C(B(t))},N=function(t){return p(t.replace(/[-_]/g,function(t){return"-"==t?"+":"/"}))},R=function(t){return M(N(t))},T=function(t){return{value:t,enumerable:!1,writable:!0,configurable:!0}},I=function(){var t=function(t,e){return Object.defineProperty(String.prototype,t,T(e))};t("fromBase64",function(){return R(this)}),t("toBase64",function(t){return P(this,t)}),t("toBase64URI",function(){return P(this,!0)}),t("toBase64URL",function(){return P(this,!0)}),t("toUint8Array",function(){return x(this)})},w=function(){var t=function(t,e){return Object.defineProperty(Uint8Array.prototype,t,T(e))};t("toBase64",function(t){return f(this,t)}),t("toBase64URI",function(){return f(this,!0)}),t("toBase64URL",function(){return f(this,!0)})},k={version:"3.7.7",VERSION:"3.7.7",atob:B,atobPolyfill:E,btoa:d,btoaPolyfill:h,fromBase64:R,toBase64:P,encode:P,encodeURI:b,encodeURL:b,utob:g,btou:C,decode:R,isValid:function(t){if("string"!=typeof t)return!1;var e=t.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(e)||!/[^\s0-9a-zA-Z\-_]/.test(e)},fromUint8Array:f,toUint8Array:x,extendString:I,extendUint8Array:w,extendBuiltins:function(){I(),w()},Base64:{}};return Object.keys(k).forEach(function(t){return k.Base64[t]=k[t]}),k}),cc._RF.pop()}).call(void 0,void 0!==i?i:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},o),cc._RF.pop()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},t("buffer").Buffer)},{"./helpers/typeof":"typeof",buffer:2}],classCallCheck:[function(t,e){"use strict";cc._RF.push(e,"9d22bwkb5FF6JjxyvLp2t37","classCallCheck"),e.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},cc._RF.pop()},{}],createClass:[function(t,e){"use strict";cc._RF.push(e,"336e8lzBKFDjZvLfhpLMC77","createClass");var a=t("./toPropertyKey");function i(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,a(o.key),o)}}e.exports=function(t,e,a){return e&&i(t.prototype,e),a&&i(t,a),Object.defineProperty(t,"prototype",{writable:!1}),t},cc._RF.pop()},{"./toPropertyKey":"toPropertyKey"}],encryptjs:[function(t,e,a){(function(i){"use strict";cc._RF.push(e,"197d3H+OsRLw4+6exSAlSam","encryptjs");var o=t,n=e,r=a,s=t("./helpers/typeof");(function(t){cc._RF.push(n,"75317cmvTxKFJ2j4/KR1XcW","encryptjs"),function(t,e){void 0!==r&&void 0!==n?n.exports=e():"function"==typeof define&&"object"==s(define.amd)?define(e):"function"==typeof define&&"object"==s(define.petal)?define("encryptjs",[],e):this.encryptjs=e()}(0,function(e){if((e={version:"1.0.0"}).init=function(){console.log("--------------------Applying Encryption Algorithm------------------ ")},void 0!==n&&n.exports)var a=o("algo");e.encrypt=function(t,i,o){if(128!=o&&192!=o&&256!=o)return"";t=String(t).utf8Encode(),i=String(i).utf8Encode();for(var n=o/8,r=new Array(n),s=0;s<n;s++)r[s]=isNaN(i.charCodeAt(s))?0:i.charCodeAt(s);var c=a.cipher(r,a.keyExpansion(r));c=c.concat(c.slice(0,n-16));var l=new Array(16),u=(new Date).getTime(),p=u%1e3,h=Math.floor(u/1e3),d=Math.floor(65535*Math.random());for(s=0;s<2;s++)l[s]=p>>>8*s&255;for(s=0;s<2;s++)l[s+2]=d>>>8*s&255;for(s=0;s<4;s++)l[s+4]=h>>>8*s&255;var m="";for(s=0;s<8;s++)m+=String.fromCharCode(l[s]);for(var f=a.keyExpansion(c),_=Math.ceil(t.length/16),y=new Array(_),g=0;g<_;g++){for(var v=0;v<4;v++)l[15-v]=g>>>8*v&255;for(v=0;v<4;v++)l[15-v-4]=g/4294967296>>>8*v;var P=a.cipher(l,f),b=g<_-1?16:(t.length-1)%16+1,D=new Array(b);for(s=0;s<b;s++)D[s]=P[s]^t.charCodeAt(16*g+s),D[s]=String.fromCharCode(D[s]);y[g]=D.join("")}var S=m+y.join("");return e.base64Encode(S)},e.decrypt=function(t,i,o){if(128!=o&&192!=o&&256!=o)return"";t=e.base64Decode(String(t)),i=String(i).utf8Encode();for(var n=o/8,r=new Array(n),s=0;s<n;s++)r[s]=isNaN(i.charCodeAt(s))?0:i.charCodeAt(s);var c=a.cipher(r,a.keyExpansion(r));c=c.concat(c.slice(0,n-16));var l=new Array(8),u=t.slice(0,8);for(s=0;s<8;s++)l[s]=u.charCodeAt(s);for(var p=a.keyExpansion(c),h=Math.ceil((t.length-8)/16),d=new Array(h),m=0;m<h;m++)d[m]=t.slice(8+16*m,24+16*m);t=d;var f=new Array(t.length);for(m=0;m<h;m++){for(var _=0;_<4;_++)l[15-_]=m>>>8*_&255;for(_=0;_<4;_++)l[15-_-4]=(m+1)/4294967296-1>>>8*_&255;var y=a.cipher(l,p),g=new Array(t[m].length);for(s=0;s<t[m].length;s++)g[s]=y[s]^t[m].charCodeAt(s),g[s]=String.fromCharCode(g[s]);f[m]=g.join("")}return f.join("").utf8Decode()};var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return e.base64Encode=function(t){var a,o,n,r,s,c,l,u="",p=0;for(t=e._utf8_encode(t);p<t.length;)r=(a=t.charCodeAt(p++))>>2,s=(3&a)<<4|(o=t.charCodeAt(p++))>>4,c=(15&o)<<2|(n=t.charCodeAt(p++))>>6,l=63&n,isNaN(o)?c=l=64:isNaN(n)&&(l=64),u=u+i.charAt(r)+i.charAt(s)+i.charAt(c)+i.charAt(l);return u},e.base64Decode=function(t){var a,o,n,r,s,c,l="",u=0;for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");u<t.length;)a=i.indexOf(t.charAt(u++))<<2|(r=i.indexOf(t.charAt(u++)))>>4,o=(15&r)<<4|(s=i.indexOf(t.charAt(u++)))>>2,n=(3&s)<<6|(c=i.indexOf(t.charAt(u++))),l+=String.fromCharCode(a),64!=s&&(l+=String.fromCharCode(o)),64!=c&&(l+=String.fromCharCode(n));return e._utf8_decode(l)},e._utf8_encode=function(t){t=t.replace(/\r\n/g,"\n");for(var e="",a=0;a<t.length;a++){var i=t.charCodeAt(a);i<128?e+=String.fromCharCode(i):i>127&&i<2048?(e+=String.fromCharCode(i>>6|192),e+=String.fromCharCode(63&i|128)):(e+=String.fromCharCode(i>>12|224),e+=String.fromCharCode(i>>6&63|128),e+=String.fromCharCode(63&i|128))}return e},e._utf8_decode=function(t){for(var e="",a=0,i=0,o=0;a<t.length;)(i=t.charCodeAt(a))<128?(e+=String.fromCharCode(i),a++):i>191&&i<224?(o=t.charCodeAt(a+1),e+=String.fromCharCode((31&i)<<6|63&o),a+=2):(o=t.charCodeAt(a+1),c3=t.charCodeAt(a+2),e+=String.fromCharCode((15&i)<<12|(63&o)<<6|63&c3),a+=3);return e},e.getTextEncryptAndSaveToTextFile=function(){throw Error("Command line not supported on this platform")},e.getTextEncryptAndSaveToJSONFile=function(){throw Error("Command line not supported on this platform")},e.writeCipherTextToJSON=function(t,e,a,o){null==o&&(o=a,a={});var n="object"==s(a)&&null!==a&&"spaces"in a?a.spaces:this.spaces;try{JSON.stringify(e,a?a.replacer:null,n)}catch(i){if(o)return o(i,null)}},void 0===String.prototype.utf8Encode&&(String.prototype.utf8Encode=function(){return unescape(encodeURIComponent(this))}),void 0===String.prototype.utf8Decode&&(String.prototype.utf8Decode=function(){try{return decodeURIComponent(escape(this))}catch(o){return this}}),void 0===String.prototype.base64Encode&&(String.prototype.base64Encode=function(){if("undefined"!=typeof btoa)return btoa(this);if(void 0!==t)return new t(this,"utf8").toString("base64");throw new Error("No Base64 Encode")}),void 0===String.prototype.base64Decode&&(String.prototype.base64Decode=function(){if("undefined"!=typeof atob)return atob(this);if(void 0!==t)return new t(this,"base64").toString("utf8");throw new Error("No Base64 Decode")}),e.init(),window.EncryptJS=e,e}),cc._RF.pop()}).call(void 0,i),cc._RF.pop()}).call(this,t("buffer").Buffer)},{"./helpers/typeof":"typeof",buffer:2}],"game.config":[function(t,e){"use strict";cc._RF.push(e,"0b989nwDMVKOoZmWxQGPiK3","game.config");var a=e;cc._RF.push(a,"bc443Ewo+5Oa7noxcrPFxJn","game.config"),window.yzll=window.yzll||{},window.yzll.gameConfig={name:"TanqiuClient",gid:"native_tanqiuClient",v:"1.0.1",server:"v2",appid:"tta4b6d20b3b8655b102",companyName:"\u539f\u5b50\u529b\u91cf",isKs:!1,debug:!1,is4399:!1,isTest:!1,gameTestBtn:!1,mainTestBtn:!1,isGM:!1,isZB:!1,bUseUma:!1,heartLog:!0,loginServerLocalAddr:"192.168.1.211",loginServerLineAddr:"42.192.10.208:10011",httpServerLocalPort:"10011",httpServerLinePort:"catWarLoginServer/login/",gameServerPort:"10010",reqNetType:0,remoteUrl:"",httpUrl:"",httpUrlDebug:"",hotUpdateUrl:"",publicKey:"",publicKeyDebug:"",sdk:{TD_APP_KEY:""},isopenCheck:!1,checkStr:"yuanzililiang"},cc._RF.pop(),cc._RF.pop()},{}],kdtree:[function(t,e,a){"use strict";cc._RF.push(e,"dea76+egL5Oia7Sb7FdNE/R","kdtree");var i=t,o=e,n=a;cc._RF.push(o,"a7ee442uqxHILoPf3eaf9Mo","kdtree"),Object.defineProperty(n,"__esModule",{value:!0}),n.KdTree=void 0;var r=i("Common"),s=i("Simulator"),c=function(){function t(t,e){this.a=t,this.b=e}return t.prototype.lessThan=function(t){return this.a<t.a||!(t.a<this.a)&&this.b<t.b},t.prototype.lessEqualThan=function(t){return this.a==t.a&&this.b==t.b||this.lessThan(t)},t.prototype.bigThan=function(t){return!this.lessEqualThan(t)},t.prototype.bigEqualThan=function(t){return!this.lessThan(t)},t}(),l=function(){},u=function(){},p=function(){function t(){this.MAX_LEAF_SIZE=10,this.agents=null,this.agentTree=[],this.obstacleTree=null}return t.prototype.buildAgentTree=function(t){if(!this.agents||this.agents.length!=t){this.agents=new Array(t);for(var e=0;e<this.agents.length;e++)this.agents[e]=s.Simulator.instance.getAgent(e);for(this.agentTree=new Array(2*this.agents.length),e=0;e<this.agentTree.length;e++)this.agentTree[e]=new l}0!=this.agents.length&&this.buildAgentTreeRecursive(0,this.agents.length,0)},t.prototype.buildObstacleTree=function(){this.obstacleTree=new u;for(var t=new Array(s.Simulator.instance.obstacles.length),e=0;e<t.length;e++)t[e]=s.Simulator.instance.obstacles[e];this.obstacleTree=this.buildObstacleTreeRecursive(t)},t.prototype.computeAgentNeighbors=function(t,e){return this.queryAgentTreeRecursive(t,e,0)},t.prototype.computeObstacleNeighbors=function(t,e){this.queryObstacleTreeRecursive(t,e,this.obstacleTree)},t.prototype.queryVisibility=function(t,e,a){return this.queryVisibilityRecursive(t,e,a,this.obstacleTree)},t.prototype.buildAgentTreeRecursive=function(t,e,a){this.agentTree[a].begin=t,this.agentTree[a].end=e,this.agentTree[a].minX=this.agentTree[a].maxX=this.agents[t].position_.x,this.agentTree[a].minY=this.agentTree[a].maxY=this.agents[t].position_.y;for(var i=t+1;i<e;++i)this.agentTree[a].maxX=Math.max(this.agentTree[a].maxX,this.agents[i].position_.x),this.agentTree[a].minX=Math.min(this.agentTree[a].minX,this.agents[i].position_.x),this.agentTree[a].maxY=Math.max(this.agentTree[a].maxY,this.agents[i].position_.y),this.agentTree[a].minY=Math.min(this.agentTree[a].minY,this.agents[i].position_.y);if(e-t>this.MAX_LEAF_SIZE){for(var o=this.agentTree[a].maxX-this.agentTree[a].minX>this.agentTree[a].maxY-this.agentTree[a].minY,n=.5*(o?this.agentTree[a].maxX+this.agentTree[a].minX:this.agentTree[a].maxY+this.agentTree[a].minY),r=t,s=e;r<s;){for(;r<s&&(o?this.agents[r].position_.x:this.agents[r].position_.y)<n;)++r;for(;s>r&&(o?this.agents[s-1].position_.x:this.agents[s-1].position_.y)>=n;)--s;if(r<s){var c=this.agents[r];this.agents[r]=this.agents[s-1],this.agents[s-1]=c,++r,--s}}var l=r-t;0==l&&(++l,++r,++s),this.agentTree[a].left=a+1,this.agentTree[a].right=a+2*l,this.buildAgentTreeRecursive(t,r,this.agentTree[a].left),this.buildAgentTreeRecursive(r,e,this.agentTree[a].right)}},t.prototype.buildObstacleTreeRecursive=function(t){if(0==t.length)return null;for(var e=new u,a=0,i=t.length,o=i,n=0;n<t.length;++n){for(var l=0,p=0,h=(C=t[n]).next,d=0;d<t.length;d++)if(n!=d){var m=(A=t[d]).next,f=r.RVOMath.leftOf(C.point,h.point,A.point),_=r.RVOMath.leftOf(C.point,h.point,m.point);f>=-r.RVOMath.RVO_EPSILON&&_>=-r.RVOMath.RVO_EPSILON?++l:f<=r.RVOMath.RVO_EPSILON&&_<=r.RVOMath.RVO_EPSILON?++p:(++l,++p);var y=new c(Math.max(l,p),Math.min(l,p)),g=new c(Math.max(i,o),Math.min(i,o));if(y.bigEqualThan(g))break}var v=new c(Math.max(l,p),Math.min(l,p)),P=new c(Math.max(i,o),Math.min(i,o));v.lessThan(P)&&(i=l,o=p,a=n)}for(var b=[],D=0;D<i;++D)b.push(null);var S=[];for(D=0;D<o;++D)S.push(null);var C,E=0,B=0;for(h=(C=t[n=a]).next,d=0;d<t.length;++d){var A;if(n!=d)if(m=(A=t[d]).next,f=r.RVOMath.leftOf(C.point,h.point,A.point),_=r.RVOMath.leftOf(C.point,h.point,m.point),f>=-r.RVOMath.RVO_EPSILON&&_>=-r.RVOMath.RVO_EPSILON)b[E++]=t[d];else if(f<=r.RVOMath.RVO_EPSILON&&_<=r.RVOMath.RVO_EPSILON)S[B++]=t[d];else{var x=r.RVOMath.det(h.point.minus(C.point),A.point.minus(C.point))/r.RVOMath.det(h.point.minus(C.point),A.point.minus(m.point)),M=A.point.plus(m.point.minus(A.point).scale(x)),N=new r.Obstacle;N.point=M,N.previous=A,N.next=m,N.convex=!0,N.direction=A.direction,N.id=s.Simulator.instance.obstacles.length,s.Simulator.instance.obstacles.push(N),A.next=N,m.previous=N,f>0?(b[E++]=A,S[B++]=N):(S[B++]=A,b[E++]=N)}}return e.obstacle=C,e.left=this.buildObstacleTreeRecursive(b),e.right=this.buildObstacleTreeRecursive(S),e},t.prototype.queryAgentTreeRecursive=function(t,e,a){if(this.agentTree[a].end-this.agentTree[a].begin<=this.MAX_LEAF_SIZE)for(var i=this.agentTree[a].begin;i<this.agentTree[a].end;++i)e=t.insertAgentNeighbor(this.agents[i],e);else{var o=r.RVOMath.sqr(Math.max(0,this.agentTree[this.agentTree[a].left].minX-t.position_.x))+r.RVOMath.sqr(Math.max(0,t.position_.x-this.agentTree[this.agentTree[a].left].maxX))+r.RVOMath.sqr(Math.max(0,this.agentTree[this.agentTree[a].left].minY-t.position_.y))+r.RVOMath.sqr(Math.max(0,t.position_.y-this.agentTree[this.agentTree[a].left].maxY)),n=r.RVOMath.sqr(Math.max(0,this.agentTree[this.agentTree[a].right].minX-t.position_.x))+r.RVOMath.sqr(Math.max(0,t.position_.x-this.agentTree[this.agentTree[a].right].maxX))+r.RVOMath.sqr(Math.max(0,this.agentTree[this.agentTree[a].right].minY-t.position_.y))+r.RVOMath.sqr(Math.max(0,t.position_.y-this.agentTree[this.agentTree[a].right].maxY));o<n?o<e&&n<(e=this.queryAgentTreeRecursive(t,e,this.agentTree[a].left))&&(e=this.queryAgentTreeRecursive(t,e,this.agentTree[a].right)):n<e&&o<(e=this.queryAgentTreeRecursive(t,e,this.agentTree[a].right))&&(e=this.queryAgentTreeRecursive(t,e,this.agentTree[a].left))}return e},t.prototype.queryObstacleTreeRecursive=function(t,e,a){if(null==a)return e;var i=a.obstacle,o=i.next,n=r.RVOMath.leftOf(i.point,o.point,t.position_);return e=this.queryObstacleTreeRecursive(t,e,n>=0?a.left:a.right),r.RVOMath.sqr(n)/r.RVOMath.absSq(o.point.minus(i.point))<e&&(n<0&&t.insertObstacleNeighbor(a.obstacle,e),this.queryObstacleTreeRecursive(t,e,n>=0?a.right:a.left)),e},t.prototype.queryVisibilityRecursive=function(t,e,a,i){if(null==i)return!0;var o=i.obstacle,n=o.next,s=r.RVOMath.leftOf(o.point,n.point,t),c=r.RVOMath.leftOf(o.point,n.point,e),l=1/r.RVOMath.absSq(n.point.minus(o.point));if(s>=0&&c>=0)return this.queryVisibilityRecursive(t,e,a,i.left)&&(r.RVOMath.sqr(s)*l>=r.RVOMath.sqr(a)&&r.RVOMath.sqr(c)*l>=r.RVOMath.sqr(a)||this.queryVisibilityRecursive(t,e,a,i.right));if(s<=0&&c<=0)return this.queryVisibilityRecursive(t,e,a,i.right)&&(r.RVOMath.sqr(s)*l>=r.RVOMath.sqr(a)&&r.RVOMath.sqr(c)*l>=r.RVOMath.sqr(a)||this.queryVisibilityRecursive(t,e,a,i.left));if(s>=0&&c<=0)return this.queryVisibilityRecursive(t,e,a,i.left)&&this.queryVisibilityRecursive(t,e,a,i.right);var u=r.RVOMath.leftOf(t,e,o.point),p=r.RVOMath.leftOf(t,e,n.point),h=1/r.RVOMath.absSq(e.minus(t));return u*p>=0&&r.RVOMath.sqr(u)*h>r.RVOMath.sqr(a)&&r.RVOMath.sqr(p)*h>r.RVOMath.sqr(a)&&this.queryVisibilityRecursive(t,e,a,i.left)&&this.queryVisibilityRecursive(t,e,a,i.right)},t}();n.KdTree=p,cc._RF.pop(),cc._RF.pop()},{}],toPrimitive:[function(t,e){"use strict";cc._RF.push(e,"9671cq2j3FN3K/FHhnIn7x6","toPrimitive");var a=t("./typeof");e.exports=function(t,e){if("object"!==a(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var o=i.call(t,e||"default");if("object"!==a(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)},cc._RF.pop()},{"./typeof":"typeof"}],toPropertyKey:[function(t,e){"use strict";cc._RF.push(e,"69fcf+L4xpFhrLskdqvvBGp","toPropertyKey");var a=t("./typeof"),i=t("./toPrimitive");e.exports=function(t){var e=i(t,"string");return"symbol"===a(e)?e:String(e)},cc._RF.pop()},{"./toPrimitive":"toPrimitive","./typeof":"typeof"}],typeof:[function(t,e){"use strict";function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t){return"function"==typeof Symbol&&"symbol"===a(Symbol.iterator)?e.exports=i=function(t){return a(t)}:e.exports=i=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":a(t)},i(t)}cc._RF.push(e,"2d740kXRBpKjqwpaBhElexW","typeof"),e.exports=i,cc._RF.pop()},{}]},{},["ActiveSuperPlant","AdsMgr","Agent","AnimUtils","AnimationCfgMgr","AnimationCtrl","AnimationMgr","AppBase","AppManager","AppProxy","ArcProgressBar","AudioManager","AudioUtil","BagBtnCtl","BallCollisionEffect","BaseSimplyCollider","BasicsProxy","BattleBaseInfoView","BattleDataProxy","BattleUI","BattleView","BgFit","BigBoxShopLayer","BlockInputManager","BossBall","BossSkilMark","BossSkill1","BossSkill2","BossSkill3","BossSkill4","BossSkill5","BossSkill6","BossSkill7","BossSkillBase","BossSkillCharm","BossSkillCourse","BossSkillSmoke","BoxIceClick","BoxIceCrush","BuildBase","BulletBall","BulletBase","BulletBoom","BulletFire","BulletGrape","BulletHit","BulletHit6","BulletPlant","BulletPlant10","BulletPlant101","BulletPlant106","BulletPlant11","BulletPlant12","BulletPlant13","BulletPlant14","BulletPlant15","BulletPlant2","BulletPlant4","BulletPlant6","BulletPlant7","BulletPlant9","BulletPlantNormal13","BulletPlantSplit","BulletPlantSplit13","BulletPoison","BulletSoundWave","BulletSpikerocks","BulletTornado","ButtonSafe","CServerItem","CaptureUtils","CollisionGoldItem","CollisionPlantItem","Combo50","ComboBase","ComboEffect","ComboNormal","Common","CommonRedPoint","CommonUtil","ComponentBase","CongratsGettingPopup","ContinueGamePopup","CorruptMark","CourseView","CsvHelper","CustomButton","CustomScrollView","CustomScrollViewEx","CustomToggle","CustomWidget","DataAD","DataAtt","DataBox","DataBuyGold","DataDailyShop","DataEndlessStage","DataGameGuid","DataItem","DataLevel","DataManager","DataMonster","DataPara","DataPlant","DataRefresh","DataSettlement","DataShopBox","DataSkill","DataStage","DataStage1","DataStage2","DataStage3","DataStage4","DataStage5","DataStage6","DataStage7","DataStageReward","DataSuperPlant","Data_BagStage","Data_BagWeapon","Data_BossSkill","Data_BridgeObstacle","Data_BridgeStage","Data_FixedPlant","Data_JarMonster","Data_JarStage","Data_JarTreasure","Data_SpecialRefresh","Data_Weather","Data_WeatherData","Data_ZombieMonster","Data_ZombiePlant","Data_ZombieStage","DestroyAllBlockEffect","DizzinessEffect","EData","E_AttrType","EarthSoilEffect","EndlessOverPopup","EndlessRewardPopup","EndlessStartPopup","Enemy4001","Enemy4002","Enemy4003","Enemy4004","Enemy4005","Enemy4006","Enemy4007","Enemy4008","Enemy4009","Enemy4010","EnemyBase","EnemyBoomDie","EnemyBoss","EnemyBoss2001","EnemyBoss2002","EnemyBoss2003","EnemyBoss2004","EnemyBoss2005","EnemyBoss2006","EnemyBoss2007","EnemyBoss2008","EnemyBoss2009","EnemyBulletBase","EnemyCrucifix","EnemyDetailsPopup","EnemyNormal","EnemyPathIce","EnemyThiefMark","EngineExUtils","EquipmentFragmentsPopup","EquipmentItem","EventManager","FixedPlantEquip101","FixedPlantEquip102","FixedPlantEquip103","FixedPlantEquip104","FixedPlantEquip105","FixedPlantEquip106","FixedPlantEquip107","FixedPlantEquipBase","FlyItemAnimCtrl","FlyItemAnimCtrl2","FragmentBase","FrenzyBar","GBaseData","GMPopup","GTBattleView","GTBoss","GTBtnCtl","GTBuff","GTBullet","GTBulletBase","GTBulletHit","GTDZBullet","GTDaoZhang","GTEquipment","GTGameMgr","GTGameUI","GTLosePopup","GTMonster","GTPlayerCtl","GTPoolMgr","GTScaleYAni","GTSettingPopup","GTSpAnimCtrl","GTWinPopup","GTXuanZhuan","GameCamera","GameComponent","GameEnum","GameGlobal","GameLoopRewardPopup","GameLosePopup","GameRevivePopup","GameSave","GameScene","GameSettingPopup","GameSound","GameUI","GameUIManager","GameWinPopup","GlodShopItem","GuardingDataProxy","GuardingtherBridge","Gutil","HeavyFogEffect","HollowOut","HomeBall","HomeBattleView","HomeBulletPlant","HomeCollisionBase","HomeEnum","HomePlantView","HomeScene","HomeShopView","HttpManager","HttpRequest","IceEffect","ItemAni","Joystick","LayoutAdaptive","List","ListItem","LoadScene","LoadUI","LoadUIBase","Logger","LongPress","MBFailPopup","MBGameDataProxy","MBScene","MBSettingPopup","MBWinPopup","MB_Actor","MB_AttrMgr","MB_AttrUI","MB_BagUI","MB_BagView","MB_BattleView","MB_Const","MB_Enemy","MB_EquipItem","MB_GameEnum","MB_GridItem","MB_Player","MB_PopHurt","MakeParameters","MapBlockEffect","MapBlockItem","MapGridItem","MathUtil","Md5","MessagePopup","MotionTrail","MyWScoket","NodePoolManager","Numeric","NumericData","OtherDataProxy","PlacePlantEffect","PlantEquip1","PlantEquip10","PlantEquip11","PlantEquip12","PlantEquip14","PlantEquip15","PlantEquip2","PlantEquip3","PlantEquip4","PlantEquip5","PlantEquip6","PlantEquip7","PlantEquip8","PlantEquip9","PlantEquipDetailsPopup","PlantEquipItem","PlantIceEffect","Platform","Platform4399","PlatformApp","PlatformKS","PlatformQGame","PlatformTT","PlatformWX","PopupBase","PopupManager","PromoteTipsPopup","ProtocolGameServer","ProtocolSendManager","ProxyBase","ProxyManager","PuddlesWater","Queue","RadarChart","RandomSuperPlantPopup","RandomUtil","RedDot","RedDotMgr","RedPoint","RedPointMgr","RedPointNode","RedPointPathConfig","RelicsDataProxy","RenderUtil","ReportInterface","ResUtil","RobotJSON","RollView","RushEffect","STBattleView","STBoss","STBtnCtl","STBullet","STBulletLight","STCardItem","STGameUI","STJDataProxy","STJarBox","STLosePopup","STMonster","STRole1001","STRole1004","STRole1005","STRoleBase","STSelectItem","STSelectPopup","STSettingPopup","STSpAnimCtrl","STTresureItem","STTresureLayer","STWinPopup","SceneBase","SceneManager","ScrollViewEx","SelectLayout","SelectSkillItem","SelectSkillPopup","SelectSuperPlantPopup","SensitiveUtils","SetNikeNamePopup","ShimmerWhite","ShopItem","SimplyCircle","SimplyCircleCollider","SimplyCollisionDetector","SimplyRect","SimplyRectCollider","SimplyVec2","Simulator","SkillDataMgr","SmashTheJar","SocketEngine","SpAnimCtrl","SpineEx","SqlUtil","StringUtil","StroageMgr","SuperBullet6","SuperBulletPlant10","SuperBulletPlant11","SuperBulletPlant12","SuperBulletPlant14","SuperBulletPlant15","SuperBulletPlant2","SuperBulletPlant4","SuperBulletPlant5","SuperBulletPlant6","SuperBulletPlant7","SuperBulletPlant9","SuperEquipItem","SuperPlantActive","SuperPlantMapItem","SuperPlantMapPopup","TTSidebarPopup","TestNode","TestPopup","TimeUtil","TimerManager","Tips","Toast","TortWarningPopup","TouchBlocker","TypeUtil","UIReport","UniformScale","UnlockNewPlantPopup","UserCenterManager","UserDataProxy","UserSetDataProxy","Util","VideoDiamondPopup","VideoFlagLogic","VideoPhysicalPopup","VideoSunshinePopup","ViewGroupNesting","WearPlantItem","WeatherHeavyFog","WeatherIceBroken","WeatherIceEffect","WeatherNight","WeatherNightLight","WeatherRain","WeatherSandWind","WeatherSnow","WeatherThunder","WeatherTornado","WeatherTumbleweed","WorkerManager","YZLLLoading","aes","algo","base64","encryptjs","game.config","Arrayincludes","Objectvalues","classCallCheck","createClass","toPrimitive","toPropertyKey","typeof","kdtree"]);